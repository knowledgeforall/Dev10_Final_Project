// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/maybe ../../../core/scheduling ../../../core/watchUtils ../../../chunks/common ../../../chunks/mat2d ../../../chunks/mat2df64 ../../../chunks/mat3f32 ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../symbols/cim/CIMResourceManager ./Container ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils ../../webgl/BufferObject ../../webgl/context-util ../../webgl/enums ../../webgl/FramebufferObject ../../webgl/ProgramTemplate ../../webgl/RenderingContext ../../webgl/VertexArrayObject ../../webgl/VertexElementDescriptor".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h,n,r,x,q,A,E,F,w,v,C,G,H){let L=function(O){function N(I,M){var U=O.call(this)||this;U._trash=new Set;U._clipData=new Float32Array(8);U._upperLeft=k.create();U._upperRight=k.create();U._lowerLeft=k.create();U._lowerRight=k.create();U._mat2=c.create();U._clipRendererInitialized=!1;U._renderRemainingTime=0;U._lastFrameRenderTime=0;U.renderRequested=!1;U.stage=u._assertThisInitialized(U);U._stationary=!0;const {canvas:T=document.createElement("canvas"),alpha:Q=
!0,stencil:J=!0,contextOptions:P={}}=M;U._canvas=T;const S=E.createContextOrErrorHTML("2d",T,{alpha:Q,antialias:!1,depth:!0,stencil:J});U.context=new C.RenderingContext(y.isSome(S)?S:null,P);U.resourceManager=new p;U.painter=new h(U.context,u._assertThisInitialized(U),U.resourceManager);z("esri-2d-profiler")&&(U._debugOutput=document.createElement("div"),U._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),I.appendChild(U._debugOutput));U._renderParameters={drawPhase:0,
state:U.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:U.context,painter:U.painter,timeline:M.timeline||new x.Timeline,renderingOptions:M.renderingOptions,requireFBO:!1,profiler:new n.Profiler(U.context,U._debugOutput),dataUploadCounter:0};U._taskHandle=l.addFrameTask({render:W=>U.renderFrame(W)});U._taskHandle.pause();U._lostWebGLContextHandle=D.on(T,"webglcontextlost",()=>{U.emit("webgl-error",{error:new B("webgl-context-lost")})});
T.setAttribute("style","width: 100%; height:100%; display:block;");I.appendChild(T);return U}u._inheritsLoose(N,O);var K=N.prototype;K.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&
(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;this.resourceManager.destroy();this.painter.dispose();this.context.dispose();this._canvas=null};K.trashDisplayObject=function(I){this._trash.add(I);this.requestRender()};K.untrashDisplayObject=function(I){return this._trash.delete(I)};
K.requestRender=function(){this._renderRemainingTime=2E3;this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};K.renderFrame=function(I){this._renderRemainingTime-=this._lastFrameRenderTime?I.time-this._lastFrameRenderTime:0;0>=this._renderRemainingTime&&this._taskHandle.pause();this._lastFrameRenderTime=I.time;this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=
window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=I.time;this._renderParameters.deltaTime=I.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};K._createTransforms=function(){return{dvs:e.create()}};K.renderChildren=function(I){for(const M of this.children)M.beforeRender(I);this._renderChildren(this.children,I);for(const M of this.children)M.afterRender(I)};K._renderChildren=
function(I,M){const U=this.context;M.profiler.recordStart("drawLayers");M.dataUploadCounter=0;this._beforeRenderChildren(M);M.drawPhase=b.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(U,this.background);for(const T of I)T.processRender(M);this.painter.renderLayers(U);M.drawPhase=b.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(U);for(const T of I)T.processRender(M);this.painter.renderLayers(U);if(this._isLabelDrawPhaseRequired(I)){M.drawPhase=b.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(U);
for(const T of I)T.processRender(M);this.painter.renderLayers(U)}if(z("esri-tiles-debug")){M.drawPhase=b.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(U);for(const T of I)T.processRender(M);this.painter.renderLayers(U)}M.profiler.recordEnd("drawLayers");this._afterRenderChildren()};K._beforeRenderChildren=function(I){const {context:M}=this,{state:U,pixelRatio:T}=I;M.setClearDepth(1);M.setClearColor(0,0,0,0);M.clear(M.gl.COLOR_BUFFER_BIT|M.gl.DEPTH_BUFFER_BIT);const {size:Q,rotation:J}=U;var P=
Math.round(Q[0]*T);I=Math.round(Q[1]*T);this._boundFBO=M.getBoundFramebufferObject();if(U.spatialReference.isWrappable){var S=d.toRadian(J),W=Math.abs(Math.cos(S)),Z=Math.abs(Math.sin(S)),V=Math.round(U.worldScreenWidth);if(Math.round(P*W+I*Z)<=V)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===P&&this._clipFBO.height===I||(this._clipFBO=new w.FramebufferObject(M,{colorTarget:F.TargetType.TEXTURE,depthStencilTarget:F.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:P,height:I}));
var Y=(this.state.padding.left-this.state.padding.right)/2,X=(this.state.padding.bottom-this.state.padding.top)/2,R=.5*P,aa=.5*I,ba=1/P,ca=1/I;V=.5*V*T;var da=.5*(P*Z+I*W);P=this._upperLeft;W=this._upperRight;Z=this._lowerLeft;var ea=this._lowerRight;f.set(P,-V,-da);f.set(W,V,-da);f.set(Z,-V,da);f.set(ea,V,da);a.fromTranslation(this._mat2,[R+Y,aa-X]);0!==J&&a.rotate(this._mat2,this._mat2,S);f.transformMat2d(P,P,this._mat2);f.transformMat2d(W,W,this._mat2);f.transformMat2d(Z,Z,this._mat2);f.transformMat2d(ea,
ea,this._mat2);S=this._clipData;S.set([2*Z[0]*ba-1,2*(I-Z[1])*ca-1,2*ea[0]*ba-1,2*(I-ea[1])*ca-1,2*P[0]*ba-1,2*(I-P[1])*ca-1,2*W[0]*ba-1,2*(I-W[1])*ca-1]);this._clipRendererInitialized||this._initializeClipRenderer(M);this._clipVBO.setData(S);this._boundFBO=M.getBoundFramebufferObject();M.bindFramebuffer(this._clipFBO);M.setDepthWriteEnabled(!0);M.setStencilWriteMask(255);M.setClearColor(0,0,0,0);M.setClearDepth(1);M.setClearStencil(0);M.clear(M.gl.COLOR_BUFFER_BIT|M.gl.DEPTH_BUFFER_BIT|M.gl.STENCIL_BUFFER_BIT);
M.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1};K._afterRenderChildren=function(){const I=this.context;I.logIno();if(this._clipFrame&&this._clipRendererInitialized){I.bindFramebuffer(this._boundFBO);this._boundFBO=null;I.bindVAO(this._clipVAO);I.useProgram(this._clipStencilProgram);I.setDepthWriteEnabled(!1);I.setDepthTestEnabled(!1);I.setStencilTestEnabled(!0);I.setBlendingEnabled(!1);I.setColorMask(!1,!1,!1,!1);I.setStencilOp(F.StencilOperation.KEEP,F.StencilOperation.KEEP,
F.StencilOperation.REPLACE);I.setStencilWriteMask(255);I.setStencilFunction(F.CompareFunction.ALWAYS,1,255);I.drawElements(F.PrimitiveType.TRIANGLES,6,F.DataType.UNSIGNED_SHORT,0);I.bindVAO();I.setColorMask(!0,!0,!0,!0);if(null!=this.background){const {r:M,g:U,b:T,a:Q}=this.background.color;I.setClearColor(Q*M/255,Q*U/255,Q*T/255,Q)}else I.setClearColor(0,0,0,0);I.clear(I.gl.COLOR_BUFFER_BIT);I.setBlendingEnabled(!0);I.setStencilFunction(F.CompareFunction.EQUAL,1,255);this.painter.blitTexture(I,this._clipFBO.colorTexture,
F.TextureSamplingMode.NEAREST,1);I.setStencilTestEnabled(!1)}};K.doRender=function(I){const M=this.context,{state:U,pixelRatio:T}=I;this._resizeCanvas(I);M.setViewport(0,0,T*U.size[0],T*U.size[1]);M.setDepthWriteEnabled(!0);M.setStencilWriteMask(255);O.prototype.doRender.call(this,I)};K.takeScreenshot=function(){var I=u._asyncToGenerator(function*(M){const {framebufferWidth:U,framebufferHeight:T}={framebufferWidth:Math.round(this._renderParameters.state.size[0]*M.resolutionScale),framebufferHeight:Math.round(this._renderParameters.state.size[1]*
M.resolutionScale)};var Q=this.context,J=this._state.clone();if(null!=M.rotation){var P=J.viewpoint;J.viewpoint.rotation=M.rotation;J.viewpoint=P}var S={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:J,pixelRatio:1,time:performance.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};const W=new w.FramebufferObject(Q,{colorTarget:F.TargetType.TEXTURE,depthStencilTarget:F.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:U,height:T});J=Q.getBoundFramebufferObject();
P=Q.getViewport();Q.bindFramebuffer(W);Q.setViewport(0,0,U,T);this._renderChildren(M.children,S);S=this._readbackScreenshot(W,{...M.cropArea,y:T-(M.cropArea.y+M.cropArea.height)});Q.bindFramebuffer(J);Q.setViewport(P.x,P.y,P.width,P.height);this.requestRender();Q=yield S;1===M.outputScale?J=Q:(J=new ImageData(Math.round(Q.width*M.outputScale),Math.round(Q.height*M.outputScale)),q.resampleHermite(Q,J,!0));return q.encodeResult(J,{format:M.format,quality:M.quality,rotation:0,disableDecorations:!1},
document.createElement("canvas"),{flipY:!0,premultipliedAlpha:!0})});return function(M){return I.apply(this,arguments)}}();K._readbackScreenshot=function(){var I=u._asyncToGenerator(function*(M,U){const T=q.createEmptyImageData(U.width,U.height,document.createElement("canvas"));yield M.readPixelsAsync(U.x,U.y,U.width,U.height,F.PixelFormat.RGBA,F.PixelType.UNSIGNED_BYTE,new Uint8Array(T.data.buffer));return T});return function(M,U){return I.apply(this,arguments)}}();K._resizeCanvas=function(I){const M=
this._canvas,U=M.style,{state:{size:T},pixelRatio:Q}=I;I=T[0];const J=T[1],P=Math.round(I*Q),S=Math.round(J*Q);if(M.width!==P||M.height!==S)M.width=P,M.height=S;U.width=I+"px";U.height=J+"px"};K._initializeClipRenderer=function(I){if(this._clipRendererInitialized)return!0;const M=v.createProgram(I,r.stencil);if(!M)return!1;const U=A.BufferObject.createVertex(I,F.Usage.STREAM_DRAW,this._clipData);var T=new Uint16Array([0,1,2,2,1,3]);T=A.BufferObject.createIndex(I,F.Usage.STATIC_DRAW,T);const Q=r.stencil.attributes,
J={geometry:[new H.VertexElementDescriptor("a_pos",2,F.DataType.FLOAT,0,8)]};I=new G.VertexArrayObject(I,Q,J,{geometry:U},T);this._clipStencilProgram=M;this._clipVBO=U;this._clipVAO=I;return this._clipRendererInitialized=!0};K._emptyTrash=function(){for(;0<this._trash.size;){const I=Array.from(this._trash);this._trash.clear();for(const M of I)M.processDetach()}};K._isLabelDrawPhaseRequired=function(I){let M=!1;for(const U of I){if(!(U instanceof m.Container)){M=M||!1;break}if(U.hasLabels)return!0;
M=M||this._isLabelDrawPhaseRequired(U.children)}return M};u._createClass(N,[{key:"background",get:function(){return this._background},set:function(I){this._background=I;this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(I){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=I)this._highlightOptionsHandle=g.init(this._highlightOptions,"version",()=>{this.painter.setHighlightOptions(I);
this.requestRender()})}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(I){this._renderingOptions=I;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(I){this._state=I;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(I){this._stationary!==I&&(this._stationary=I,this.requestRender())}}]);return N}(m.Container);t.EXTRA_RENDER_TIME=2E3;t.Stage=L;Object.defineProperty(t,"__esModule",{value:!0})})},
"esri/symbols/cim/CIMResourceManager":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/promiseUtils"],function(t,u,B,D){function z(y,l){if(y.includes(";base64,")){const g=new Image;g.src=y;return g.decode().then(()=>({ok:!0,value:g})).catch(d=>D.isAbortError(d)?{ok:!1,error:d}:{ok:!1,error:new B("invalid-resource",`Could not fetch requested resource at ${y}`)})}return u(y,{responseType:"image",...l}).then(g=>({ok:!0,value:g.data})).catch(g=>
D.isAbortError(g)?{ok:!1,error:g}:{ok:!1,error:new B("invalid-resource",`Could not fetch requested resource at ${y}`)})}return function(){function y(){this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEngine=null}var l=y.prototype;l.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};l.getResource=function(g){var d;return null!=(d=this._resourceMap.get(g))?d:null};l.fetchResource=function(){var g=t._asyncToGenerator(function*(d,a){const c={width:0,
height:0},e=this._resourceMap;var f=e.get(d);if(f)return c.width=f.width,c.height=f.height,c;if(f=this._inFlightResourceMap.get(d))return f;f=z(d,a);this._inFlightResourceMap.set(d,f);return f=f.then(k=>{this._inFlightResourceMap.delete(d);k.ok&&(e.set(d,k.value),k=k.value,c.width=k.width,c.height=k.height);return c})});return function(d,a){return g.apply(this,arguments)}}();l.deleteResource=function(g){this._inFlightResourceMap.delete(g);this._resourceMap.delete(g)};return y}()})},"esri/views/2d/engine/Container":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","../../../layers/effects/EffectView","./DisplayObject"],function(t,u,B,D,z){z=function(y){function l(){var d=y.apply(this,arguments)||this;d._childrenSet=new Set;d._needsSort=!1;d.children=[];d._effectView=null;return d}u._inheritsLoose(l,y);var g=l.prototype;g.updateTransitionProperties=function(d,a){y.prototype.updateTransitionProperties.call(this,d,a);this._effectView&&(this._effectView.transitionStep(d,a),this._effectView.transitioning&&
this.requestRender())};g.doRender=function(d){d=this.createRenderParams(d);this.renderChildren(d)};g.addChild=function(d){return this.addChildAt(d,this.children.length)};g.addChildAt=function(d,a=this.children.length){if(!d||this.contains(d))return d;this._needsSort=!0;const c=d.parent;c&&c!==this&&c.removeChild(d);a>=this.children.length?this.children.push(d):this.children.splice(a,0,d);this._childrenSet.add(d);d.parent=this;d.stage=this.stage;this!==this.stage&&(d.clips=this.clips);this.requestRender();
return d};g.contains=function(d){return this._childrenSet.has(d)};g.removeAllChildren=function(){this._childrenSet.clear();this._needsSort=!0;for(const d of this.children)this!==this.stage&&(d.clips=null),d.stage=null,d.parent=null;this.children.length=0};g.removeChild=function(d){return this.contains(d)?this.removeChildAt(this.children.indexOf(d)):d};g.removeChildAt=function(d){if(0>d||d>=this.children.length)return null;this._needsSort=!0;d=this.children.splice(d,1)[0];this._childrenSet.delete(d);
this!==this.stage&&(d.clips=null);d.stage=null;d.parent=null;return d};g.sortChildren=function(d){this._needsSort&&(this.children.sort(d),this._needsSort=!1)};g._createTransforms=function(){return{dvs:B.create()}};g.onAttach=function(){y.prototype.onAttach.call(this);const d=this.stage;for(const a of this.children)a.stage=d};g.onDetach=function(){y.prototype.onDetach.call(this);for(const d of this.children)d.stage=null};g.renderChildren=function(d){for(const a of this.children)a.beforeRender(d);for(const a of this.children)a.processRender(d);
for(const a of this.children)a.afterRender(d)};g.createRenderParams=function(d){return{...d,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:d.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};u._createClass(l,[{key:"blendMode",get:function(){return this._blendMode},set:function(d){this._blendMode=d;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(d){this._clips=d;this.children.forEach(a=>a.clips=d)}},{key:"computedEffects",
get:function(){var d,a;return null!=(d=null==(a=this._effectView)?void 0:a.effects)?d:null}},{key:"effect",get:function(){var d,a;return null!=(d=null==(a=this._effectView)?void 0:a.effect)?d:""},set:function(d){if(this._effectView||d)this._effectView||(this._effectView=new D.EffectView),this._effectView.effect=d,this.requestRender()}}]);return l}(z.DisplayObject);t.Container=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e){function f(m){m=c.parse(m)||[];var b=(b=m[0])?"type"in b:!1;return b?[{scale:-1,effects:m}]:m}function k(m,b,h){var n,r,x,q;return null!=(n=m[0])&&n.effects&&null!=(r=b[0])&&r.effects?(-1===(null==(x=m[0])?void 0:x.scale)||-1===(null==(q=b[0])?void 0:q.scale))&&(1<m.length||1<b.length)&&0>=h?!1:e.canInterpolateEffects(m[0].effects,b[0].effects):!0}function p(m,b,h){var n,r;const x=m.length>b.length?m:b;m=m.length>b.length?b:m;const q=m[m.length-1];b=null!=(n=null==
q?void 0:q.scale)?n:h;n=null!=(r=null==q?void 0:q.effects)?r:[];for(r=m.length;r<x.length;r++)m.push({scale:b,effects:[...n]});for(r=0;r<x.length;r++)m[r].scale=-1===m[r].scale?h:m[r].scale,x[r].scale=-1===x[r].scale?h:x[r].scale,e.normalizeEffects(m[r].effects,x[r].effects)}t.EffectView=function(m){function b(n){n=m.call(this,n)||this;n._from=null;n._to=null;n._final=null;n._current=[];n._time=0;n.duration=z("mapview-transitions-duration");n.effects=[];return n}u._inheritsLoose(b,m);var h=b.prototype;
h.canTransitionTo=function(n){try{return 0<this.scale&&k(this._current,f(n),this.scale)}catch{return!1}};h.transitionStep=function(n,r){this._applyTimeTransition(n);this._updateForScale(r)};h.end=function(){this._applyTimeTransition(this.duration)};h._transitionTo=function(n){0<this.scale&&k(this._current,n,this.scale)?(this._final=n,this._to=y.clone(n),p(this._current,this._to,this.scale),this._from=y.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=n);this._set("effects",
this._current[0]?y.clone(this._current[0].effects):[])};h._applyTimeTransition=function(n){if(this._to&&this._from&&this._current&&this._final){this._time+=n;n=Math.min(1,this._time/this.duration);for(let x=0;x<this._current.length;x++){const q=this._current[x],A=this._from[x],E=this._to[x];var r=A.scale;q.scale=r+(E.scale-r)*n;for(r=0;r<q.effects.length;r++)q.effects[r].interpolate(A.effects[r],E.effects[r],n)}1===n&&(this._current=this._final,this._set("effects",this._current[0]?y.clone(this._current[0].effects):
[]),this._from=this._to=this._final=null)}};h._updateForScale=function(n){this._set("scale",n);if(0!==this._current.length){var r=this._current,x=this._current.length-1,q,A=1;if(1===r.length||n>=r[0].scale)var E=q=r[0].effects;else if(n<=r[x].scale)E=q=r[x].effects;else for(let F=0;F<x;F++){const w=r[F],v=r[F+1];if(w.scale>=n&&v.scale<=n){A=(n-w.scale)/(v.scale-w.scale);q=w.effects;E=v.effects;break}}for(n=0;n<this.effects.length;n++)this.effects[n].interpolate(q[n],E[n],A)}};u._createClass(b,[{key:"effect",
set:function(n){const r=this._get("effect");n=n||"";if(r!==n){this._set("effect",n);try{this._transitionTo(f(n))}catch(x){this._transitionTo([]),l.getLogger(this.declaredClass).warn("Invalid Effect",{effect:n,error:x})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(n){this._updateForScale(n)}},{key:"transitioning",get:function(){return null!==this._to}}]);return b}(D);B.__decorate([g.property()],t.EffectView.prototype,"_to",void 0);
B.__decorate([g.property()],t.EffectView.prototype,"duration",void 0);B.__decorate([g.property({value:""})],t.EffectView.prototype,"effect",null);B.__decorate([g.property({readOnly:!0})],t.EffectView.prototype,"effects",void 0);B.__decorate([g.property({readOnly:!0})],t.EffectView.prototype,"hasEffects",null);B.__decorate([g.property({value:0})],t.EffectView.prototype,"scale",null);B.__decorate([g.property({readOnly:!0})],t.EffectView.prototype,"transitioning",null);t.EffectView=B.__decorate([a.subclass("esri.layers.effects.EffectView")],
t.EffectView);t.canInterpolateEffectStops=k;t.convertEffectToStops=f;t.normalizeEffectStops=p;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/DisplayObject":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ../../../core/has ../../../core/maybe ../../../core/promiseUtils".split(" "),function(t,u,B,D,z,y){const l=1/D("mapview-transitions-duration");B=function(g){function d(){var c=g.apply(this,arguments)||this;c._fadeOutResolver=null;
c._fadeInResolver=null;c._clips=null;c.computedVisible=!0;c.computedOpacity=1;c.fadeTransitionEnabled=!1;c.inFadeTransition=!1;c._isReady=!1;c._opacity=1;c._stage=null;c._visible=!0;return c}u._inheritsLoose(d,g);var a=d.prototype;a._getTransforms=function(){z.isNone(this._transforms)&&(this._transforms=this._createTransforms());return this._transforms};a.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=
null);this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=y.createResolver();this.requestRender();return this._fadeInResolver.promise};a.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=y.createResolver();this.requestRender();return this._fadeOutResolver.promise};a.beforeRender=function(c){this.updateTransitionProperties(c.deltaTime,
c.state.scale)};a.afterRender=function(c){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};a.remove=function(){var c;null==(c=this.parent)?void 0:c.removeChild(this)};a.setTransform=function(c){};a.processRender=function(c){this.stage&&this.computedVisible&&this.doRender(c)};a.requestRender=function(){this.stage&&this.stage.requestRender()};
a.processDetach=function(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.onDetach();this.emit("detach")};a.updateTransitionProperties=function(c,e){if(this.fadeTransitionEnabled){e=this._fadeOutResolver||!this.visible?0:this.opacity;const f=this.computedOpacity;f===e?this.computedVisible=this.visible:(c*=l,this.computedOpacity=f>e?Math.max(e,f-c):Math.min(e,f+c),this.computedVisible=0<this.computedOpacity,
c=e===this.computedOpacity,this.inFadeTransition=!c,c||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};a.onAttach=function(){};a.onDetach=function(){};a.doRender=function(c){};a.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};u._createClass(d,[{key:"clips",get:function(){return this._clips},set:function(c){this._clips=c;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",
get:function(){return this._opacity},set:function(c){this._opacity!==c&&(this._opacity=Math.min(1,Math.max(c,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(c){if(this._stage!==c){var e=this._stage;(this._stage=c)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):e.trashDisplayObject(this)}}},{key:"transforms",get:function(){return this._getTransforms()}},{key:"visible",get:function(){return this._visible},set:function(c){this._visible!==
c&&(this._visible=c,this.requestRender())}}]);return d}(B);t.DisplayObject=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(t){t.WGLGeometryType=void 0;(function(u){u[u.FILL=0]="FILL";u[u.LINE=1]="LINE";u[u.MARKER=2]="MARKER";u[u.TEXT=3]="TEXT";u[u.LABEL=4]="LABEL"})(t.WGLGeometryType||(t.WGLGeometryType={}));t.WGLGeometryTransactionStatus=void 0;(function(u){u[u.SUCCEEDED=0]="SUCCEEDED";u[u.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(t.WGLGeometryTransactionStatus||
(t.WGLGeometryTransactionStatus={}));t.WGLDrawPhase=void 0;(function(u){u[u.NONE=0]="NONE";u[u.MAP=1]="MAP";u[u.LABEL=2]="LABEL";u[u.LABEL_ALPHA=4]="LABEL_ALPHA";u[u.HITTEST=8]="HITTEST";u[u.HIGHLIGHT=16]="HIGHLIGHT";u[u.CLIP=32]="CLIP";u[u.DEBUG=64]="DEBUG";u[u.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(t.WGLDrawPhase||(t.WGLDrawPhase={}));t.VVType=void 0;(function(u){u[u.SIZE=0]="SIZE";u[u.COLOR=1]="COLOR";u[u.OPACITY=2]="OPACITY";u[u.ROTATION=3]="ROTATION"})(t.VVType||(t.VVType={}));t.WGLVVFlag=void 0;
(function(u){u[u.NONE=0]="NONE";u[u.OPACITY=1]="OPACITY";u[u.COLOR=2]="COLOR";u[u.ROTATION=4]="ROTATION";u[u.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";u[u.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";u[u.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";u[u.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(t.WGLVVFlag||(t.WGLVVFlag={}));t.WGLVVTarget=void 0;(function(u){u[u.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";u[u.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";u[u.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";
u[u.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(t.WGLVVTarget||(t.WGLVVTarget={}));t.MosaicType=void 0;(function(u){u[u.SPRITE=0]="SPRITE";u[u.GLYPH=1]="GLYPH"})(t.MosaicType||(t.MosaicType={}));Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/HittestEffectVTL ./effects/post-processing/EffectManager ./painter/RenderPass ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Renderbuffer".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h,n){function r(q,A,E,F){return q!==y.WGLDrawPhase.HIGHLIGHT&&(1!==F||u.isSome(A)&&"normal"!==A||u.isSome(E)&&0<E.length)}const x={[y.WGLGeometryType.FILL]:B.brushes.fill,[y.WGLGeometryType.LINE]:B.brushes.line,[y.WGLGeometryType.MARKER]:B.brushes.marker,[y.WGLGeometryType.TEXT]:B.brushes.text};return function(){function q(E,F,w){this.context=E;this._blitRenderer=new z.BitBlitRenderer;this._brushCache=new Map;this._vtlMaterialManager=new D;this._blendEffect=
new a.BlendEffect;this._fboPool=[];this.effects={highlight:new e,hittest:new f.HittestEffect,hittestVTL:new k.HittestEffectVTL,integrate:new d.AnimationEffect,insideEffect:new c.FeatureEffect("inside"),outsideEffect:new c.FeatureEffect("outside")};this.materialManager=new l(E);this.textureManager=new g(F,w);this._effectsManager=new p.EffectManager(F)}var A=q.prototype;A.getRenderTarget=function(){return this._renderTarget};A.setRenderTarget=function(E){this._renderTarget=E};A.getFbos=function(E,F){if(E!==
this._lastWidth||F!==this._lastHeight){this._lastWidth=E;this._lastHeight=F;if(this._fbos){for(var w in this._fbos)this._fbos[w].resize(E,F);return this._fbos}w={target:b.TextureType.TEXTURE_2D,pixelFormat:b.PixelFormat.RGBA,dataType:b.PixelType.UNSIGNED_BYTE,samplingMode:b.TextureSamplingMode.NEAREST,wrapMode:b.TextureWrapMode.CLAMP_TO_EDGE,width:E,height:F};const v={colorTarget:b.TargetType.TEXTURE,depthStencilTarget:b.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER};this._stencilBuf=E=new n.Renderbuffer(this.context,
{width:E,height:F,internalFormat:b.RenderbufferFormat.DEPTH_STENCIL});this._fbos={output:new h.FramebufferObject(this.context,v,w,E),blend:new h.FramebufferObject(this.context,v,w,E),effect0:new h.FramebufferObject(this.context,v,w,E)}}return this._fbos};A.acquireFbo=function(E,F){let w;w=0<this._fboPool.length?this._fboPool.pop():new h.FramebufferObject(this.context,{colorTarget:b.TargetType.TEXTURE,depthStencilTarget:b.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},{target:b.TextureType.TEXTURE_2D,
pixelFormat:b.PixelFormat.RGBA,dataType:b.PixelType.UNSIGNED_BYTE,samplingMode:b.TextureSamplingMode.NEAREST,wrapMode:b.TextureWrapMode.CLAMP_TO_EDGE,width:E,height:F},this._stencilBuf);const v=w.descriptor;v.width===E&&v.height===F||w.resize(E,F);return w};A.releaseFbo=function(E){this._fboPool.push(E)};A.getSharedStencilBuffer=function(){return this._stencilBuf};A.beforeRenderLayers=function(E,F=null){const {width:w,height:v}=E.getViewport();this._prevFBO=E.getBoundFramebufferObject();const C=this.getFbos(w,
v);E.bindFramebuffer(C.output);E.setColorMask(!0,!0,!0,!0);E.setDepthWriteEnabled(!0);if(u.isSome(F)){const {r:G,g:H,b:L,a:O}=F.color;E.setClearColor(O*G/255,O*H/255,O*L/255,O)}else E.setClearColor(0,0,0,0);E.setClearDepth(1);E.clear(E.gl.COLOR_BUFFER_BIT|E.gl.DEPTH_BUFFER_BIT);E.setDepthWriteEnabled(!1)};A.beforeRenderLayer=function(E,F,w){const {context:v,blendMode:C,effects:G,requireFBO:H,drawPhase:L}=E;H||r(L,C,G,w)?(v.bindFramebuffer(this._fbos.blend),v.setColorMask(!0,!0,!0,!0),v.setClearColor(0,
0,0,0),v.setDepthWriteEnabled(!0),v.setClearDepth(1),v.clear(v.gl.COLOR_BUFFER_BIT|v.gl.DEPTH_BUFFER_BIT),v.setDepthWriteEnabled(!1)):(E=this._getOutputFBO(),v.bindFramebuffer(E));v.setDepthWriteEnabled(!1);v.setDepthTestEnabled(!1);v.setStencilTestEnabled(!0);v.setClearStencil(F);v.setStencilWriteMask(255);v.clear(v.gl.STENCIL_BUFFER_BIT)};A.compositeLayer=function(E,F){const {context:w,blendMode:v,effects:C,requireFBO:G,drawPhase:H}=E;if(G||r(H,v,C,F)){u.isSome(C)&&0<C.length&&H===y.WGLDrawPhase.MAP&&
this._applyEffects(E,C);var L=this._getOutputFBO();w.bindFramebuffer(L);w.setStencilTestEnabled(!1);w.setStencilWriteMask(0);w.setBlendingEnabled(!0);w.setBlendFunctionSeparate(b.BlendFactor.ONE,b.BlendFactor.ONE_MINUS_SRC_ALPHA,b.BlendFactor.ONE,b.BlendFactor.ONE_MINUS_SRC_ALPHA);w.setColorMask(!0,!0,!0,!0);L=u.isNone(v)||H===y.WGLDrawPhase.HIGHLIGHT?"normal":v;this._blendEffect.draw(E,this._fbos.blend.colorTexture,b.TextureSamplingMode.NEAREST,L,F)}};A.renderLayers=function(E){E.bindFramebuffer(this._prevFBO);
if(this._fbos){var F=this._getOutputFBO();E.setStencilTestEnabled(!1);E.setStencilWriteMask(0);this.blitTexture(E,F.colorTexture,b.TextureSamplingMode.NEAREST)}};A.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._brushCache&&(this._brushCache.forEach(E=>E.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const E in this._fbos)this._fbos[E]&&this._fbos[E].dispose();
for(const E of this._fboPool)E.dispose();this._fboPool.length=0;if(this.effects)for(const E in this.effects)this.effects[E]&&this.effects[E].dispose();this._effectsManager.dispose();this._vtlMaterialManager&&(this._vtlMaterialManager.dispose(),this._vtlMaterialManager=null);this._prevFBO=null};A.getGeometryBrush=function(E){E=x[E];let F=this._brushCache.get(E);void 0===F&&(F=new E,this._brushCache.set(E,F));return this._brushCache.get(E)};A.renderObject=function(E,F,w,v){w=B.brushes[w];if(!w)return null;
let C=this._brushCache.get(w);void 0===C&&(C=new w,this._brushCache.set(w,C));C.prepareState(E,F,v);C.draw(E,F,v)};A.renderObjects=function(E,F,w,v){w=B.brushes[w];if(!w)return null;let C=this._brushCache.get(w);void 0===C&&(C=new w,this._brushCache.set(w,C));C.drawMany(E,F,v)};A.registerRenderPass=function(E){const F=E.brushes.map(w=>{this._brushCache.has(w)||this._brushCache.set(w,new w);return this._brushCache.get(w)});return new m(F,E)};A.setHighlightOptions=function(E){this.effects.highlight.setHighlightOptions(E)};
A.blitTexture=function(E,F,w,v=1){E.setBlendingEnabled(!0);E.setBlendFunctionSeparate(b.BlendFactor.ONE,b.BlendFactor.ONE_MINUS_SRC_ALPHA,b.BlendFactor.ONE,b.BlendFactor.ONE_MINUS_SRC_ALPHA);E.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(E,F,w,v)};A.getPostProcessingEffects=function(E){return this._effectsManager.getPostProcessingEffects(E)};A._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};A._applyEffects=function(E,F){const {context:w}=E;F=this._effectsManager.getPostProcessingEffects(F);
for(const {postProcessingEffect:v,effect:C}of F)w.bindFramebuffer(this._fbos.blend),v.draw(E,this._fbos.blend,C)};t._createClass(q,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);return q}()})},"esri/views/2d/engine/brushes":function(){define("exports ./flow/BrushFlow ./imagery/BrushRasterBitmap ./imagery/BrushVectorField ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h){const n={vtlBackground:d.WGLBrushVTLBackground,vtlFill:c.WGLBrushVTLFill,vtlLine:e.WGLBrushVTLLine,vtlCircle:a.WGLBrushVTLCircle,vtlSymbol:f.WGLBrushVTLSymbol};t.brushes={marker:b,line:m,fill:k,text:h,label:p,clip:y,stencil:g,bitmap:z,raster:B,rasterVF:D,flow:u,tileInfo:l,vtlBackground:d.WGLBrushVTLBackground,vtlFill:c.WGLBrushVTLFill,vtlLine:e.WGLBrushVTLLine,vtlCircle:a.WGLBrushVTLCircle,vtlSymbol:f.WGLBrushVTLSymbol};t.vtlBrushes=n;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/2d/engine/flow/BrushFlow":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(t,u,B,D){function z(l,g,d,a){switch(g){case "int":l.setUniform1iv(d,a);break;case "float":l.setUniform1fv(d,a);break;case "vec2":l.setUniform2fv(d,a);break;case "vec3":l.setUniform3fv(d,a);break;case "vec4":l.setUniform4fv(d,a)}}function y(l,g,d,a){"constant"===a.kind?z(l,d,`u_${g}`,
a.value):(z(l,"float",`u_${g}_stops`,a.stops),z(l,d,`u_${g}_values`,a.values),z(l,"int",`u_${g}_count`,[a.count]))}return function(l){function g(){return l.apply(this,arguments)||this}t._inheritsLoose(g,l);var d=g.prototype;d.dispose=function(){};d.prepareState=function(a){({context:a}=a);a.setColorMask(!0,!0,!0,!0);a.setStencilFunction(D.CompareFunction.EQUAL,0,255)};d.draw=function(a,c){const {context:e}=a,{displayData:f}=c;if(!u.isNone(f)&&("loaded"===f.state.name&&f.prepareForRendering(e),"attached"===
f.state.name)){var k=f.state.resources;e.setFaceCullingEnabled(!1);e.setBlendingEnabled(!0);e.setBlendFunctionSeparate(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA,D.BlendFactor.ONE,D.BlendFactor.ONE);var p=[];"ramp"===k.values.lineColor.kind&&p.push("vvLineColor");"ramp"===k.values.lineOpacity.kind&&p.push("vvLineOpacity");"ramp"===k.values.lineRenderWidth.kind&&p.push("vvLineRenderWidth");p=a.painter.materialManager.getProgram(a,{vsPath:"raster/flow",fsPath:"raster/flow",attributes:k.locations},
p);e.useProgram(p);p.setUniform1f("u_time",a.time/1E3);p.setUniform1f("u_fadeDuration",f.flowStyle.renderSettings.fadeDuration);p.setUniform1f("u_lineSpeed",f.flowStyle.renderSettings.lineSpeed);p.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);p.setUniformMatrix3fv("u_displayViewMat3",a.state.displayViewMat3);y(p,"lineColor","vec4",f.flowStyle.renderSettings.lineColor);y(p,"lineOpacity","float",f.flowStyle.renderSettings.lineOpacity);y(p,"lineRenderWidth","float",f.flowStyle.renderSettings.lineRenderWidth);
e.bindVAO(k.vertexArray);e.drawElements(D.PrimitiveType.TRIANGLES,k.indexBuffer.size,D.DataType.UNSIGNED_INT,0);f.flowStyle.animated&&c.requestRender()}};return g}(B)})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function t(){this.name=this.constructor.name||"UnnamedBrush"}var u=t.prototype;u.prepareState=function(B,D,z){};u.draw=function(B,D,z){};u.drawMany=function(B,D,z){for(const y of D)this.draw(B,y,z)};return t}()})},"esri/views/2d/engine/imagery/BrushRasterBitmap":function(){define("../../../../chunks/_rollupPluginBabelHelpers ./RasterBitmap ../webgl/VertexStream ../webgl/brushes/WGLBrush ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),
function(t,u,B,D,z,y){return function(l){function g(){var a=l.apply(this,arguments)||this;a._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])}};a._rendererUniformInfos=new Map;return a}t._inheritsLoose(g,l);var d=
g.prototype;d.dispose=function(){this._quad&&this._quad.dispose()};d.prepareState=function({context:a},c){a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(z.BlendFactor.ONE,z.BlendFactor.ONE_MINUS_SRC_ALPHA,z.BlendFactor.ONE,z.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(z.CompareFunction.EQUAL,c.stencilRef,255)};d.draw=function(a,c){var e;if(u.hasSource(c)&&!c.suspended){a.timeline.begin(this.name);var f=
!(null!=(e=a.context.capabilities.textureFloat)&&e.textureFloatLinear);c.updateTexture(a);e=this._getShaderVariations(c,f);e=a.painter.materialManager.getProgram(a,this._desc[c.symbolizerParameters.type],e);this._drawWithProgram(a.context,e,c);a.timeline.end(this.name)}};d._drawWithProgram=function(a,c,e,f=1,k=[0,0],p=!1){this._quad||(this._quad=new B(a,[0,0,1,0,0,1,1,1]));const {symbolizerParameters:m,transformGrid:b,width:h,height:n,opacity:r}=e;var x=m.type;a.useProgram(c);const q=this._getShaderVariations(e);
x=this._getUniformInfos(x,a,c,q);const {names:A,textures:E}=e.getTextures();y.setTextures(a,c,A,E);a=y.getBasicGridUniforms(f,k);p=y.getCommonUniforms(b,[h,n],[e.source.width,e.source.height],r,p);y.setUniforms(c,x,{u_coordScale:e.coordScale,u_dvsMat3:e.transforms.dvs,...a,...p});if(m.colormap){const {colormap:F,colormapOffset:w}=m;e=y.getColormapUniforms(F,w);y.setUniforms(c,x,e)}"stretch"===m.type?(e=y.getStretchUniforms(m),y.setUniforms(c,x,e)):"hillshade"===m.type&&(e=y.getShadedReliefUniforms(m),
y.setUniforms(c,x,e));this._quad.draw()};d._getUniformInfos=function(a,c,e,f){a=0<f.length?a+"-"+f.join("-"):a;if(this._rendererUniformInfos.has(a))return this._rendererUniformInfos.get(a);c=y.getUniformLocationInfos(c,e);this._rendererUniformInfos.set(a,c);return c};d._getShaderVariations=function(a,c=!1){const e=[],{interpolation:f}=a,{type:k,colormap:p}=a.symbolizerParameters;"cubic"===f?e.push("bicubic"):"bilinear"===f&&"stretch"===k&&null!=p?(e.push("bilinear"),e.push("nnedge")):c&&"bilinear"===
f&&e.push("bilinear");a.isRendereredSource?e.push("noop"):p&&e.push("applyColormap");a.transformGrid&&(e.push("applyProjection"),1===a.transformGrid.spacing[0]&&e.push("lookupProjection"));return e};return g}(D)})},"esri/views/2d/engine/imagery/RasterBitmap":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../layers/support/rasterFunctions/pixelUtils ../DisplayObject ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a){const c={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};g=function(f){function k(m=null,b=null,h=null){var n=f.call(this)||this;n._textureInvalidated=!0;n._colormapTextureInvalidated=!0;n._supportsBilinearTexture=!0;n.stencilRef=0;n.coordScale=[1,1];n._symbolizerParameters=null;n.height=null;n.isRendereredSource=
!1;n.pixelRatio=1;n.resolution=0;n.rotation=0;n._source=null;n.rawPixelData=null;n._suspended=!1;n._bandIds=null;n._interpolation=null;n._transformGrid=null;n.width=null;n.x=0;n.y=0;n.source=m;n.transformGrid=b;n.interpolation=h;return n}u._inheritsLoose(k,f);var p=k.prototype;p.destroy=function(){const m=this.getTextures();null==m?void 0:m.textures.forEach(b=>b.dispose());this._colormapTexture=this._transformGridTexture=this._rasterTexture=null};p.invalidateTexture=function(){this._textureInvalidated||
(this._textureInvalidated=!0,this.requestRender())};p._createTransforms=function(){return{dvs:z.create()}};p.setTransform=function(m){const b=D.identity(this.transforms.dvs),[h,n]=m.toScreenNoRotation([0,0],[this.x,this.y]);var r=this.resolution/this.pixelRatio/m.resolution;const x=r*this.width;r*=this.height;const q=Math.PI*this.rotation/180;D.translate(b,b,y.fromValues(h,n));D.translate(b,b,y.fromValues(x/2,r/2));D.rotate(b,b,-q);D.translate(b,b,y.fromValues(-x/2,-r/2));D.scaleByVec2(b,b,y.fromValues(x,
r));D.multiply(this.transforms.dvs,m.displayViewMat3,b)};p.getTextures=function(){if(!this._rasterTexture)return null;const m=[],b=[];this._transformGridTexture&&(b.push(this._transformGridTexture),m.push("u_transformGrid"));this._rasterTexture&&(b.push(this._rasterTexture),m.push("u_image"));this._colormapTexture&&(b.push(this._colormapTexture),m.push("u_colormap"));return{names:m,textures:b}};p.onAttach=function(){this.invalidateTexture()};p.onDetach=function(){this.invalidateTexture()};p.updateTexture=
function({context:m}){if(this.stage){var b=this._isValidSource(this.source);b&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(m));this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(m),this._rasterTexture&&(b?this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=a.createTransformTexture(m,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}else{var h,
n;null==(b=this._rasterTexture)?void 0:b.dispose();null==(h=this._transformGridTexture)?void 0:h.dispose();null==(n=this._colormapTexture)?void 0:n.dispose();this._colormapTexture=this._transformGridTexture=this._rasterTextureBandIds=this._rasterTexture=null}};p._createOrDestroyRasterTexture=function(m){var b,h;const n=B.isSome(this.source)?l.extractBands(this.source,this.bandIds):null;if(this._isValidSource(n)){var r=!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(r)return;this._rasterTexture.dispose();
this._rasterTexture=this._rasterTextureBandIds=null}this._supportsBilinearTexture=null==(b=m.capabilities.textureFloat)?void 0:b.textureFloatLinear;b=this._getTextureSamplingMethod(this.interpolation);r=this.isRendereredSource||!(null!=(h=m.capabilities.textureFloat)&&h.textureFloat);this._rasterTexture=a.createRasterTexture(m,n,b,r);this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=this._rasterTextureBandIds=
null)};p._isBandIdschanged=function(m){const b=this._rasterTextureBandIds;return!(null==b&&null==m||b&&m&&b.join("")===m.join(""))};p._isValidSource=function(m){var b;return B.isSome(m)&&0<(null==(b=m.pixels)?void 0:b.length)};p._getTextureSamplingMethod=function(m){const {type:b,colormap:h}=this.symbolizerParameters,n="lut"===b||"stretch"===b&&B.isSome(h);return!this._supportsBilinearTexture||n||"bilinear"!==m&&"cubic"!==m?"nearest":"bilinear"};p._updateColormapTexture=function(m){const b=this._colormap,
h=this.symbolizerParameters.colormap;if(!h)this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null;else if(!b)this._colormapTexture=a.createColormapTexture(m,h),this._colormap=h;else if(h.length!==b.length||h.some((n,r)=>n!==b[r]))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=a.createColormapTexture(m,h),this._colormap=h};u._createClass(k,[{key:"symbolizerParameters",get:function(){return this._symbolizerParameters||
c},set:function(m){this._symbolizerParameters!==m&&(this._symbolizerParameters=m,this._colormapTextureInvalidated=!0)}},{key:"source",get:function(){return this._source},set:function(m){this._source!==m&&(this._source=m,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=this._rasterTexture=null),this.invalidateTexture())}},{key:"suspended",get:function(){return this._suspended},set:function(m){this._suspended&&!m&&this.stage&&(this.ready(),this.requestRender());this._suspended=
m}},{key:"bandIds",get:function(){return this._bandIds},set:function(m){this._bandIds=m;this._isBandIdschanged(m)&&this.invalidateTexture()}},{key:"interpolation",get:function(){return this._interpolation||"nearest"},set:function(m){this._interpolation=m;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(m)?d.TextureSamplingMode.LINEAR:d.TextureSamplingMode.NEAREST)}},{key:"transformGrid",get:function(){return this._transformGrid},set:function(m){this._transformGrid=
m;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)}}]);return k}(g.DisplayObject);let e=function(f){function k(){return f.apply(this,arguments)||this}u._inheritsLoose(k,f);u._createClass(k,[{key:"source",get:function(){return this._source}}]);return k}(g);t.RasterBitmap=g;t.RasterBitmapWithSource=e;t.hasSource=function(f){return B.isSome(f.source)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports",
"../../../core/maybe","../PixelBlock"],function(t,u,B){function D(b){return u.isSome(b)&&"esri.layers.support.PixelBlock"===b.declaredClass&&b.pixels&&0<b.pixels.length}function z(b,h){b=Math.min(Math.max(b,-100),100);h=Math.min(Math.max(h,-100),100);let n,r;const x=new Uint8Array(256);for(n=0;256>n;n++)0<b&&100>b?r=(200*n-25500+510*h)/(2*(100-b))+128:0>=b&&-100<b?r=(200*n-25500+510*h)*(100+b)/2E4+128:100===b?(r=200*n-25500+256*(100-b)+510*h,r=0<r?255:0):-100===b&&(r=128),x[n]=255<r?255:0>r?0:r;return x}
function y(b,h,n,r,x,q,A,E){return{xmin:x<=n*b?0:x<n*b+b?x-n*b:b,ymin:q<=r*h?0:q<r*h+h?q-r*h:h,xmax:x+A<=n*b?0:x+A<n*b+b?x+A-n*b:b,ymax:q+E<=r*h?0:q+E<r*h+h?q+E-r*h:h}}function l(b,h,n,r,x,q){const {width:A,height:E}=n.block,{x:F,y:w}=n.offset,{width:v,height:C}=n.mosaic;n=y(A,E,r,x,F,w,v,C);let G=0;var H=0;if(q){var L=q.hasGCSSShiftTransform?360:q.halfWorldWidth,O=A*q.resolutionX,N=q.startX+r*O;O=N+O;N<L&&O>L?H=q.rightPadding:N>=L&&(G=q.leftMargin-q.rightPadding,H=0)}n.xmax-=H;if("number"===typeof h)for(q=
n.ymin;q<n.ymax;q++)for(H=(x*E+q-w)*v+(r*A-F)+G,L=n.xmin;L<n.xmax;L++)b[H+L]=h;else for(q=n.ymin;q<n.ymax;q++)for(H=(x*E+q-w)*v+(r*A-F)+G,L=q*A,N=n.xmin;N<n.xmax;N++)b[H+N]=h[L+N]}function g(b,h,n={}){const {clipOffset:r,clipSize:x,alignmentInfo:q,blockWidths:A}=n;if(A)return d(b,h,{blockWidths:A});var E=b.find(I=>D(I));if(u.isNone(E))return null;n=x?x.width:h.width;const F=x?x.height:h.height;var w=E.width,v=E.height;const C=h.width/w,G=h.height/v;h={offset:r||{x:0,y:0},mosaic:x||h,block:{width:w,
height:v}};w=E.pixelType;v=B.getPixelArrayConstructor(w);var H=E.pixels.length;E=[];for(var L=0;L<H;L++){var O=new v(n*F);for(let I=0;I<G;I++)for(let M=0;M<C;M++){var N=b[I*C+M];D(N)&&(N=N.pixels[L],l(O,N,h,M,I,q))}E.push(O)}let K;if(b.some(I=>u.isNone(I)||I.mask&&0<I.mask.length))for(K=new Uint8Array(n*F),v=0;v<G;v++)for(H=0;H<C;H++)O=b[v*C+H],(L=u.isSome(O)?O.mask:null)?l(K,L,h,H,v,q):O?l(K,1,h,H,v,q):l(K,0,h,H,v,q);b=new B({width:n,height:F,pixels:E,pixelType:w,mask:K});b.updateStatistics();return b}
function d(b,h,n){const r=b.find(H=>u.isSome(H));if(!u.isSome(r))return null;var x=b.some(H=>u.isSome(H)?!!H.mask:!0);const {width:q,height:A}=h;h=x?new Uint8Array(q*A):null;({blockWidths:n}=n);const E=[],F=r.getPlaneCount(),w=B.getPixelArrayConstructor(r.pixelType);if(x)for(let H=0,L=0;H<b.length;L+=n[H],H++)if(x=b[H],D(x)){var v=x.mask;for(var C=0;C<A;C++)for(var G=0;G<n[H];G++)h[C*q+G+L]=null==v?255:v[C*x.width+G]}for(x=0;x<F;x++){v=new w(q*A);for(let H=0,L=0;H<b.length;L+=n[H],H++)if(C=b[H],D(C)&&
(G=C.pixels[x],null!=G))for(let O=0;O<A;O++)for(let N=0;N<n[H];N++)v[O*q+N+L]=G[O*C.width+N];E.push(v)}b=new B({width:q,height:A,mask:h,pixels:E,pixelType:r.pixelType});b.updateStatistics();return b}function a(b){if(!D(b))return null;const h=b.clone(),{width:n,height:r,pixels:x,mask:q}=b;var A=x[0];b=h.pixels[0];for(let w=2;w<r-1;w++){const v=new Map;for(var E=w-2;E<w+2;E++)for(var F=0;4>F;F++){const C=E*n+F;f(v,A[C],q?q[C]:1)}b[w*n]=c(v);b[w*n+1]=b[w*n+2]=b[w*n];for(E=3;E<n-1;E++)F=(w-2)*n+E+1,f(v,
A[F],q?q[F]:1),F=(w-1)*n+E+1,f(v,A[F],q?q[F]:1),F=w*n+E+1,f(v,A[F],q?q[F]:1),F=(w+1)*n+E+1,f(v,A[F],q?q[F]:1),F=(w-2)*n+E-3,e(v,A[F],q?q[F]:1),F=(w-1)*n+E-3,e(v,A[F],q?q[F]:1),F=w*n+E-3,e(v,A[F],q?q[F]:1),F=(w+1)*n+E-3,e(v,A[F],q?q[F]:1),b[w*n+E]=c(v);b[w*n+E+1]=b[w*n+E]}for(A=0;A<n;A++)b[A]=b[n+A]=b[2*n+A],b[(r-1)*n+A]=b[(r-2)*n+A];h.updateStatistics();return h}function c(b){if(0===b.size)return 0;let h=0,n=-1,r=0;const x=b.keys();let q=x.next();for(;!q.done;)r=b.get(q.value),r>h&&(n=q.value,h=r),
q=x.next();return n}function e(b,h,n){0!==n&&(n=b.get(h),1===n?b.delete(h):b.set(h,n-1))}function f(b,h,n){0!==n&&b.set(h,b.has(h)?b.get(h)+1:1)}function k(b,h,n){let {x:r,y:x}=h;const {width:q,height:A}=n;if(0===r&&0===x&&A===b.height&&q===b.width)return b;const {width:E,height:F}=b;h=Math.max(0,x);const w=Math.max(0,r),v=Math.min(r+q,E),C=Math.min(x+A,F);if(0>v||0>C||!D(b))return null;r=Math.max(0,-r);x=Math.max(0,-x);const {pixels:G,mask:H}=b;var L=q*A,O=G.length;const N=[];for(var K=0;K<O;K++){var I=
G[K],M=B.createEmptyBand(b.pixelType,L);for(let U=h;U<C;U++){const T=U*E;let Q=(U+x-h)*q+r;for(let J=w;J<v;J++)M[Q++]=I[T+J]}N.push(M)}L=new Uint8Array(L);for(O=h;O<C;O++)for(K=O*E,I=(O+x-h)*q+r,M=w;M<v;M++)L[I++]=H?H[K+M]:1;b=new B({width:n.width,height:n.height,pixelType:b.pixelType,pixels:N,mask:L});b.updateStatistics();return b}function p(b,h=!0){if(!D(b))return null;const {pixels:n,width:r,height:x,mask:q,pixelType:A}=b;b=[];const E=Math.round(r/2),F=Math.round(x/2),w=x-1,v=r-1;for(var C=0;C<
n.length;C++){var G=n[C],H=B.createEmptyBand(A,E*F),L=0;for(var O=0;O<x;O+=2)for(var N=0;N<r;N+=2){var K=G[O*r+N];if(h){var I=N===v?K:G[O*r+N+1];const M=O===w?K:G[O*r+N+r],U=N===v?M:O===w?I:G[O*r+N+r+1];H[L++]=(K+I+M+U)/4}else H[L++]=K}b.push(H)}C=null;if(q)for(C=new Uint8Array(E*F),G=0,H=0;H<x;H+=2)for(L=0;L<r;L+=2)O=q[H*r+L],h?(N=L===v?O:q[H*r+L+1],K=H===w?O:q[H*r+L+r],I=L===v?K:H===w?N:q[H*r+L+r+1],C[G++]=O*N*K*I?1:0):C[G++]=O;return new B({width:E,height:F,pixelType:A,pixels:b,mask:C})}function m(b,
h,n,r,x=.5){const {width:q,height:A}=b,{width:E,height:F}=h;b=r.cols;r=r.rows;h=Math.ceil(E/b-.1/b);const w=Math.ceil(F/r-.1/r);let v,C,G,H,L;const O=h*b;var N=O*w*r;const K=new Float32Array(N),I=new Float32Array(N),M=new Uint32Array(N),U=new Uint32Array(N);let T=0,Q,J;for(let W=0;W<w;W++)for(let Z=0;Z<h;Z++){var P=12*(W*h+Z);N=n[P];v=n[P+1];C=n[P+2];G=n[P+3];H=n[P+4];L=n[P+5];for(var S=0;S<r;S++){T=(W*r+S)*O+Z*b;J=(S+.5)/r;for(let V=0;V<S;V++)Q=(V+.5)/b,K[T+V]=(N*Q+v*J+C)*q-x,I[T+V]=(G*Q+H*J+L)*
A-x,M[T+V]=Math.round(K[T+V]),U[T+V]=Math.round(I[T+V])}P+=6;N=n[P];v=n[P+1];C=n[P+2];G=n[P+3];H=n[P+4];L=n[P+5];for(P=0;P<r;P++)for(T=(W*r+P)*O+Z*b,J=(P+.5)/r,S=P;S<b;S++)Q=(S+.5)/b,K[T+S]=(N*Q+v*J+C)*q-x,I[T+S]=(G*Q+H*J+L)*A-x,M[T+S]=Math.round(K[T+S]),U[T+S]=Math.round(I[T+S])}return{offsets_x:K,offsets_y:I,offsets_xi:M,offsets_yi:U,gridWidth:O}}t.approximateTransform=function(b,h,n,r,x="nearest"){if(!D(b))return null;"majority"===x&&(b=a(b));const {pixels:q,mask:A,pixelType:E}=b,F=b.width;var w=
b.height;const v=B.getPixelArrayConstructor(E),C=q.length,{width:G,height:H}=h;b=!1;for(let U=0;U<n.length;U+=3)-1===n[U]&&-1===n[U+1]&&-1===n[U+2]&&(b=!0);const {offsets_x:L,offsets_y:O,offsets_xi:N,offsets_yi:K,gridWidth:I}=m({width:F,height:w},h,n,r,"majority"===x?0:.5);let M;h=(U,T,Q)=>{const J=U instanceof Float32Array||U instanceof Float64Array?0:.5;for(let P=0;P<H;P++){M=P*I;for(let S=0;S<G;S++){if(0>L[M]||0>O[M])U[P*G+S]=0;else if(Q)U[P*G+S]=T[N[M]+K[M]*F];else{const W=Math.floor(L[M]),Z=
Math.floor(O[M]),V=Math.ceil(L[M]),Y=Math.ceil(O[M]),X=L[M]-W,R=O[M]-Z;U[P*G+S]=!A||A[W+Z*F]&&A[W+Z*F]&&A[W+Y*F]&&A[V+Y*F]?(1-R)*((1-X)*T[W+Z*F]+X*T[V+Z*F])+R*((1-X)*T[W+Y*F]+X*T[V+Y*F])+J:T[N[M]+K[M]*F]}M++}}};n=[];for(w=0;w<C;w++)r=new v(G*H),h(r,q[w],"nearest"===x||"majority"===x),n.push(r);x=new B({width:G,height:H,pixelType:E,pixels:n});if(A)x.mask=new Uint8Array(G*H),h(x.mask,A,!0);else if(b)for(x.mask=new Uint8Array(G*H),b=0;b<G*H;b++)x.mask[b]=0>L[b]||0>O[b]?0:1;x.updateStatistics();return x};
t.clip=k;t.colorize=function(b,h){if(!D(b)||!h&&(h.indexedColormap||h.indexed2DColormap))return b;const n=b.clone();var r=n.pixels;let x=n.mask;const q=n.width*n.height;if(1!==r.length)return b;const {indexedColormap:A,indexed2DColormap:E,offset:F,alphaSpecified:w}=h;h=A.length-1;b=0;r=r[0];const v=new Uint8Array(r.length),C=new Uint8Array(r.length),G=new Uint8Array(r.length);let H=0;if(A)if(x)for(b=0;b<q;b++)x[b]&&(H=4*(r[b]-F),H<F||H>h?x[b]=0:(v[b]=A[H],C[b]=A[H+1],G[b]=A[H+2],x[b]=A[H+3]));else{x=
new Uint8Array(q);for(b=0;b<q;b++)H=4*(r[b]-F),H<F||H>h?x[b]=0:(v[b]=A[H],C[b]=A[H+1],G[b]=A[H+2],x[b]=A[H+3]);n.mask=x}else if(x)for(b=0;b<q;b++)x[b]&&(h=E[r[b]],v[b]=h[0],C[b]=h[1],G[b]=h[2],x[b]=h[3]);else{x=new Uint8Array(q);for(b=0;b<q;b++)h=E[r[b]],v[b]=h[0],C[b]=h[1],G[b]=h[2],x[b]=h[3];n.mask=x}n.pixels=[v,C,G];n.statistics=null;n.pixelType="u8";n.maskIsAlpha=w;return n};t.createColormapLUT=function(b){if(b){var h=b.colormap;if(h&&0!==h.length){h=h.sort((w,v)=>w[0]-v[0]);var n=0;0>h[0][0]&&
(n=h[0][0]);var r=Math.max(256,h[h.length-1][0]-n+1),x=new Uint8Array(4*r),q=[],A=0,E=0,F=5===h[0].length;if(65536<r)return h.forEach(w=>{q[w[0]-n]=F?w.slice(1):w.slice(1).concat([255])}),{indexed2DColormap:q,offset:n,alphaSpecified:F};if(b.fillUnspecified)for(b=h[E],A=b[0]-n;A<r;A++)x[4*A]=b[1],x[4*A+1]=b[2],x[4*A+2]=b[3],x[4*A+3]=F?b[4]:255,A===b[0]-n&&(b=E===h.length-1?b:h[++E]);else for(A=0;A<h.length;A++)b=h[A],E=4*(b[0]-n),x[E]=b[1],x[E+1]=b[2],x[E+2]=b[3],x[E+3]=F?b[4]:255;return{indexedColormap:x,
offset:n,alphaSpecified:F}}}};t.createContrastBrightnessLUT=z;t.createHistogramEqualizationLUT=function(b,h=256){h=Math.min(h,256);const {size:n,counts:r}=b;b=new Uint8Array(n);var x=r.reduce((w,v)=>w+v/h,0);let q=0;var A=0;let E=0,F=x;for(let w=0;w<n;w++)if(E+=r[w],!(w<n-1&&E+r[w+1]<F)){for(;q<h-1&&F<E;)q++,F+=x;for(;A<=w;A++)b[A]=q;A=w+1}for(x=A;x<n;x++)b[x]=h-1;return b};t.createStretchLUT=function(b){const {minCutOff:h,maxCutOff:n,gamma:r,pixelType:x}=b,q=b.outMin||0,A=b.outMax||255;if(-1===["u8",
"u16","s8","s16"].indexOf(x))return null;const E=h.length;let F;let w=0;"s8"===x?w=-127:"s16"===x&&(w=-32767);let v=256;-1<["u16","s16"].indexOf(x)&&(v=65536);const C=[],G=A-q;for(F=0;F<E;F++)C[F]=n[F]-h[F];var H=r&&r.length>=E;const L=[];if(H)for(F=0;F<E;F++)L[F]=1<r[F]?2<r[F]?6.5+(r[F]-2)**2.5:6.5+100*(2-r[F])**4:1;let O;const N=[];let K,I,M;if(H)for(F=0;F<E;F++){M=[];for(H=0;H<v;H++)K=H+w,O=(K-h[F])/C[F],I=1,1<r[F]&&(I-=(1/G)**(O*L[F])),M[H]=K<n[F]&&K>h[F]?Math.floor(I*G*O**(1/r[F]))+q:K>=n[F]?
A:q;N[F]=M}else for(F=0;F<E;F++){M=[];for(H=0;H<v;H++)K=H+w,M[H]=K<=h[F]?q:K>=n[F]?A:Math.floor((K-h[F])/C[F]*G)+q;N[F]=M}if(null!=b.contrastOffset)for(b=z(b.contrastOffset,b.brightnessOffset),F=0;F<E;F++)for(M=N[F],H=0;H<v;H++)M[H]=b[M[H]];return{lut:N,offset:w}};t.estimateStatisticsFromHistograms=function(b){const h=[];for(let q=0;q<b.length;q++){const {min:A,max:E,size:F,counts:w}=b[q];let v=0;var n=0;for(var r=0;r<F;r++)v+=w[r],n+=r*w[r];n/=v;r=0;for(var x=0;x<F;x++)r+=w[x]*(x-n)**2;x=(E-A)/F;
h.push({min:A,max:E,avg:(n+.5)*x+A,stddev:Math.sqrt(r/(v-1))*x})}return h};t.estimateStatisticsHistograms=function(b){if(!D(b))return null;b.statistics||b.updateStatistics();const {pixels:h,mask:n,pixelType:r,statistics:x}=b;b=b.width*b.height;const q=h.length;let A,E;let F;var w;const v=[],C=[];for(F=0;F<q;F++){var G=new Uint32Array(256);var H=h[F];if("u8"===r)if(A=-.5,E=255.5,n)for(w=0;w<b;w++)n[w]&&G[H[w]]++;else for(w=0;w<b;w++)G[H[w]]++;else{A=x[F].minValue;E=x[F].maxValue;var L=(E-A)/256;var O=
new Uint32Array(257);if(n)for(w=0;w<b;w++)n[w]&&O[Math.floor((H[w]-A)/L)]++;else for(w=0;w<b;w++)O[Math.floor((H[w]-A)/L)]++;for(w=0;255>w;w++)G[w]=O[w];G[255]=O[255]+O[256]}v.push({min:A,max:E,size:256,counts:G});for(w=H=O=L=0;256>w;w++)L+=G[w],O+=w*G[w];O/=L;for(w=0;256>w;w++)H+=G[w]*(w-O)**2;G=Math.sqrt(H/(L-1));L=(E-A)/256;w=(O+.5)*L+A;G*=L;C.push({min:A,max:E,avg:w,stddev:G})}return{statistics:C,histograms:v}};t.extractBands=function(b,h){if(null==h||!h.length||!D(b))return b;const n=b.pixels.length;
return h&&h.some(r=>r>=n)||1===n&&1===h.length&&0===h[0]||n===h.length&&!h.some((r,x)=>r!==x)?b:new B({pixelType:b.pixelType,width:b.width,height:b.height,mask:b.mask,validPixelCount:b.validPixelCount,maskIsAlpha:b.maskIsAlpha,pixels:h.map(r=>b.pixels[r]),statistics:b.statistics&&h.map(r=>b.statistics[r])})};t.getClipBounds=y;t.getLocalArithmeticNorthRotations=function(b,h){const {coefficients:n,spacing:r}=h,{offsets_x:x,offsets_y:q,gridWidth:A}=m(b,b,n,{rows:r[0],cols:r[1]},.5),{width:E,height:F}=
b;b=new Float32Array(E*F);h=180/Math.PI;for(let C=0;C<F;C++)for(let G=0;G<E;G++){var w=C*A+G,v=0===C?w:w-A;const H=C===F-1?w:w+A;w=x[v]-x[H];v=q[H]-q[v];isNaN(w)||isNaN(v)?b[C*E+G]=90:(v=Math.atan2(v,w)*h,v=(360+v)%360,b[C*E+G]=v)}return b};t.isValidPixelBlock=D;t.lookupPixels=function(b,h){if(!D(b))return null;const {pixels:n,mask:r}=b,x=b.width*b.height,q=n.length;let A=h.lut;({offset:h}=h);let E,F;A&&1===A[0].length&&(A=n.map(()=>A));const w=[];let v,C,G;if(h)if(null==r)for(E=0;E<q;E++){v=n[E];
C=A[E];G=new Uint8Array(x);for(F=0;F<x;F++)G[F]=C[v[F]-h];w.push(G)}else for(E=0;E<q;E++){v=n[E];C=A[E];G=new Uint8Array(x);for(F=0;F<x;F++)r[F]&&(G[F]=C[v[F]-h]);w.push(G)}else if(null==r)for(E=0;E<q;E++){v=n[E];C=A[E];G=new Uint8Array(x);for(F=0;F<x;F++)G[F]=C[v[F]];w.push(G)}else for(E=0;E<q;E++){v=n[E];C=A[E];G=new Uint8Array(x);for(F=0;F<x;F++)r[F]&&(G[F]=C[v[F]]);w.push(G)}b=new B({width:b.width,height:b.height,pixels:w,mask:r,pixelType:"u8"});b.updateStatistics();return b};t.mosaic=g;t.mosaicPixelData=
function(b,h){if(!b||0===b.length)return null;var n=b.find(C=>C.pixelBlock);if(!n||u.isNone(n.pixelBlock))return null;var r=(n.extent.xmax-n.extent.xmin)/n.pixelBlock.width;const x=(n.extent.ymax-n.extent.ymin)/n.pixelBlock.height,q=.01*Math.min(r,x),A=b.sort((C,G)=>Math.abs(C.extent.ymax-G.extent.ymax)>q?G.extent.ymax-C.extent.ymax:Math.abs(C.extent.xmin-G.extent.xmin)>q?C.extent.xmin-G.extent.xmin:0);var E=Math.min.apply(null,A.map(C=>C.extent.xmin));const F=Math.min.apply(null,A.map(C=>C.extent.ymin)),
w=Math.max.apply(null,A.map(C=>C.extent.xmax)),v=Math.max.apply(null,A.map(C=>C.extent.ymax));b={x:Math.round((h.xmin-E)/r),y:Math.round((v-h.ymax)/x)};E={width:Math.round((w-E)/r),height:Math.round((v-F)/x)};r={width:Math.round((h.xmax-h.xmin)/r),height:Math.round((h.ymax-h.ymin)/x)};if(Math.round(E.width/n.pixelBlock.width)*Math.round(E.height/n.pixelBlock.height)!==A.length||0>b.x||0>b.y||E.width<r.width||E.height<r.height)return null;n=A.map(C=>C.pixelBlock);n=g(n,E,{clipOffset:b,clipSize:r});
return{extent:h,pixelBlock:n}};t.remapColor=function(b,h){if(!D(b))return null;b=b.clone();var {pixels:n}=b;const r=b.width*b.height,x=h.length,q=Math.floor(x/2),A=h[Math.floor(q)];n=n[0];let E,F,w,v,C,G,H=!1;const L=new Uint8Array(r),O=new Uint8Array(r),N=new Uint8Array(r);let K=b.mask;const I=4===h[0].mappedColor.length;K||(K=new Uint8Array(r),K.fill(I?255:1),b.mask=K);for(C=0;C<r;C++)if(K[C]){E=n[C];H=!1;G=q;F=A;w=0;for(v=x-1;1<v-w;){if(E===F.value){H=!0;break}E>F.value?w=G:v=G;G=Math.floor((w+
v)/2);F=h[Math.floor(G)]}H||(E===h[w].value?(F=h[w],H=!0):E===h[v].value?(F=h[v],H=!0):E<h[w].value?(H=!1,F=null):E>h[w].value&&(E<h[v].value?(F=h[w],H=!0):v===x-1?(H=!1,F=null):(F=h[v],H=!0)));H?(L[C]=F.mappedColor[0],O[C]=F.mappedColor[1],N[C]=F.mappedColor[2],K[C]=F.mappedColor[3]):L[C]=O[C]=N[C]=K[C]=0}b.pixels=[L,O,N];b.mask=K;b.pixelType="u8";b.maskIsAlpha=I;return b};t.resampleByMajority=a;t.setValidBoundary=function(b,h,n){if(!D(b))return null;const {width:r,height:x}=b,q=h.x;h=h.y;const A=
n.width+q;n=n.height+h;if(0>q||0>h||A>r||n>x||0===q&&0===h&&A===r&&n===x)return b;b.mask||(b.mask=new Uint8Array(r*x));const E=b.mask;for(let F=0;F<x;F++){const w=F*r;for(let v=0;v<r;v++)E[w+v]=F<h||F>=n||v<q||v>=A?0:1}b.updateStatistics();return b};t.split=function(b,h,n){if(!D(b))return null;const {width:r,height:x}=h;let {width:q,height:A}=b;const E=new Map,F={x:0,y:0};n=null==n?1:1+n;for(let w=0;w<n;w++){const v=Math.ceil(q/r),C=Math.ceil(A/x);for(let G=0;G<C;G++){F.y=G*x;for(let H=0;H<v;H++){F.x=
H*r;const L=k(b,F,h);E.set(`${w}/${G}/${H}`,L)}}w<n-1&&(b=p(b));q=Math.round(q/2);A=Math.round(A/2)}return E};t.stretch=function(b,h){if(!D(b))return null;b=b.clone();const {pixels:n,mask:r}=b,{minCutOff:x,maxCutOff:q,gamma:A}=h,E=h.outMin||0;h=h.outMax||255;const F=b.width*b.height,w=n.length;let v;let C,G,H;const L=h-E,O=[];for(v=0;v<w;v++)O[v]=q[v]-x[v];var N=A&&A.length>=w;const K=[];if(N)for(v=0;v<w;v++)K[v]=1<A[v]?2<A[v]?6.5+(A[v]-2)**2.5:6.5+100*(2-A[v])**4:1;if(N)if(null!=r)for(N=0;N<F;N++){if(r[N])for(v=
0;v<w;v++)C=n[v][N],H=(C-x[v])/O[v],G=1,1<A[v]&&(G-=(1/L)**(H*K[v])),n[v][N]=C<q[v]&&C>x[v]?Math.floor(G*L*H**(1/A[v]))+E:C>=q[v]?h:E}else for(N=0;N<F;N++)for(v=0;v<w;v++)C=n[v][N],H=(C-x[v])/O[v],G=1,1<A[v]&&(G-=(1/L)**(H*K[v])),n[v][N]=C<q[v]&&C>x[v]?Math.floor(G*L*H**(1/A[v]))+E:C>=q[v]?h:E;else if(null!=r)for(N=0;N<F;N++){if(r[N])for(v=0;v<w;v++)C=n[v][N],n[v][N]=C<q[v]&&C>x[v]?Math.floor((C-x[v])/O[v]*L)+E:C>=q[v]?h:E}else for(N=0;N<F;N++)for(v=0;v<w;v++)C=n[v][N],n[v][N]=C<q[v]&&C>x[v]?Math.floor((C-
x[v])/O[v]*L)+E:C>=q[v]?h:E;b.pixelType="u8";b.updateStatistics();return b};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass".split(" "),function(t,
u,B,D,z,y,l,g,d,a,c){var e;const f=l.getLogger("esri.layers.support.PixelBlock");B=e=function(k){function p(b){b=k.call(this,b)||this;b.width=null;b.height=null;b.pixelType="f32";b.validPixelCount=null;b.mask=null;b.maskIsAlpha=!1;b.pixels=null;b.statistics=null;return b}t._inheritsLoose(p,k);p.createEmptyBand=function(b,h){return new (e.getPixelArrayConstructor(b))(h)};p.getPixelArrayConstructor=function(b){let h;switch(b){case "u1":case "u2":case "u4":case "u8":h=Uint8Array;break;case "u16":h=Uint16Array;
break;case "u32":h=Uint32Array;break;case "s8":h=Int8Array;break;case "s16":h=Int16Array;break;case "s32":h=Int32Array;break;case "f32":h=Float32Array;break;case "f64":h=Float64Array;break;case "c64":case "c128":case "unknown":h=Float32Array}return h};var m=p.prototype;m.castPixelType=function(b){if(!b)return"f32";b=b.toLowerCase();-1<["u1","u2","u4"].indexOf(b)?b="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(b)&&(b="f32");return b};m.getPlaneCount=function(){return this.pixels&&
this.pixels.length};m.addData=function(b){if(!b.pixels||b.pixels.length!==this.width*this.height)throw new D("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(b.pixels);this.statistics.push(b.statistics||{minValue:null,maxValue:null})};m.getAsRGBA=function(){const b=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(b);
break;default:this._fillFrom8Bit(b)}return new Uint8ClampedArray(b)};m.getAsRGBAFloat=function(){const b=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(b);return b};m.updateStatistics=function(){this.statistics=this.pixels.map(n=>this._calculateBandStatistics(n,this.mask));const b=this.mask;let h=0;if(b)for(let n=0;n<b.length;n++)b[n]&&h++;else h=this.width*this.height;this.validPixelCount=h};m.clamp=function(b){if(b&&"f64"!==b&&"f32"!==b){switch(b){case "u8":var h=[0,255];break;case "u16":h=
[0,65535];break;case "u32":h=[0,4294967295];break;case "s8":h=[-128,127];break;case "s16":h=[-32768,32767];break;case "s32":h=[-2147483648,2147483647];break;default:h=[-3.4*1E39,3.4*1E39]}var [n,r]=h;h=this.pixels;var x=this.width*this.height,q=h.length,A=[];for(let v=0;v<q;v++){var E=e.createEmptyBand(b,x);var F=h[v];for(let C=0;C<x;C++){var w=F[C];E[C]=w>r?r:w<n?n:w}A.push(E)}this.pixels=A;this.pixelType=b}};m.extractBands=function(b){if(g.isNone(b)||0===b.length||null==this.pixels||0===this.pixels.length)return this;
var h=this.pixels.length;const n=b.some(r=>r>=this.pixels.length);h=h===b.length&&!b.some((r,x)=>r!==x);return n||h?this:new e({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:b.map(r=>this.pixels[r]),statistics:this.statistics&&b.map(r=>this.statistics[r])})};m.clone=function(){const b=new e({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});
this.mask&&(b.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let h;const n=e.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){b.pixels=[];const r=this.pixels[0].slice;for(h=0;h<this.pixels.length;h++)b.pixels[h]=r?this.pixels[h].slice(0,this.pixels[h].length):new n(this.pixels[h])}if(this.statistics)for(b.statistics=[],h=0;h<this.statistics.length;h++)b.statistics[h]=y.clone(this.statistics[h]);return b};m._fillFrom8Bit=function(b){const {mask:h,
maskIsAlpha:n,pixels:r}=this;if(b&&r&&r.length){var x,q;var A=x=q=r[0];3<=r.length?(x=r[1],q=r[2]):2===r.length&&(x=r[1]);var E=new Uint32Array(b),F=this.width*this.height;if(A.length!==F)f.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(h&&h.length===F)if(n)for(b=0;b<F;b++)h[b]&&(E[b]=h[b]<<24|q[b]<<16|x[b]<<8|A[b]);else for(b=0;b<F;b++)h[b]&&(E[b]=-16777216|q[b]<<16|x[b]<<8|A[b]);else for(b=0;b<F;b++)E[b]=-16777216|q[b]<<16|x[b]<<8|A[b]}else f.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};m._fillFromNon8Bit=function(b){const {pixels:h,mask:n,statistics:r}=this;if(b&&h&&h.length){var x=this.pixelType,q=1,A=0;q=1;r&&0<r.length?(A=r.map(C=>C.minValue).reduce((C,G)=>Math.min(C,G)),q=r.map(C=>C.maxValue-C.minValue).reduce((C,G)=>Math.max(C,G)),q=255/q):(q=255,"s8"===x?(A=-128,q=127):"u16"===x?q=65535:"s16"===x?(A=-32768,q=32767):"u32"===x?q=4294967295:"s32"===x?(A=-2147483648,q=2147483647):"f32"===x?(A=-3.4*1E39,q=3.4*1E39):
"f64"===x&&(A=-Number.MAX_VALUE,q=Number.MAX_VALUE),q=255/(q-A));b=new Uint32Array(b);x=this.width*this.height;var E,F,w;var v=E=F=h[0];if(v.length!==x)return f.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=h.length)if(E=h[1],3<=h.length&&(F=h[2]),n&&n.length===x)for(w=0;w<x;w++)n[w]&&(b[w]=-16777216|(F[w]-A)*q<<16|(E[w]-A)*q<<8|(v[w]-A)*q);else for(w=0;w<x;w++)b[w]=-16777216|(F[w]-A)*q<<16|(E[w]-A)*q<<8|(v[w]-A)*q;else if(n&&n.length===x)for(w=0;w<x;w++)E=(v[w]-
A)*q,n[w]&&(b[w]=-16777216|E<<16|E<<8|E);else for(w=0;w<x;w++)E=(v[w]-A)*q,b[w]=-16777216|E<<16|E<<8|E}else f.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};m._fillFrom32Bit=function(b){const {pixels:h,mask:n}=this;if(!b||!h||!h.length)return f.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let r,x,q,A;r=x=q=h[0];3<=h.length?(x=h[1],q=h[2]):2===h.length&&(x=h[1]);const E=this.width*this.height;if(r.length!==E)return f.error("getAsRGBAFloat()",
"Unable to convert to RGBA. The pixelblock is invalid.");let F=0;if(n&&n.length===E)for(A=0;A<E;A++)b[F++]=r[A],b[F++]=x[A],b[F++]=q[A],b[F++]=n[A]&1;else for(A=0;A<E;A++)b[F++]=r[A],b[F++]=x[A],b[F++]=q[A],b[F++]=1};m._calculateBandStatistics=function(b,h){let n=Infinity,r=-Infinity;const x=b.length;let q,A=0;if(h)for(q=0;q<x;q++)h[q]&&(A=b[q],n=A<n?A:n,r=A>r?A:r);else for(q=0;q<x;q++)A=b[q],n=A<n?A:n,r=A>r?A:r;return{minValue:n,maxValue:r}};return p}(z.JSONSupport);u.__decorate([d.property({json:{write:!0}})],
B.prototype,"width",void 0);u.__decorate([d.property({json:{write:!0}})],B.prototype,"height",void 0);u.__decorate([d.property({json:{write:!0}})],B.prototype,"pixelType",void 0);u.__decorate([a.cast("pixelType")],B.prototype,"castPixelType",null);u.__decorate([d.property({json:{write:!0}})],B.prototype,"validPixelCount",void 0);u.__decorate([d.property({json:{write:!0}})],B.prototype,"mask",void 0);u.__decorate([d.property({json:{write:!0}})],B.prototype,"maskIsAlpha",void 0);u.__decorate([d.property({json:{write:!0}})],
B.prototype,"pixels",void 0);u.__decorate([d.property({json:{write:!0}})],B.prototype,"statistics",void 0);return B=e=u.__decorate([c.subclass("esri.layers.support.PixelBlock")],B)})},"esri/views/webgl/rasterUtils":function(){define(["exports","./context-util","./enums","./FramebufferObject","./Texture"],function(t,u,B,D,z){t.createColormapTexture=function(y,l){return new z.Texture(y,{width:l.length/4,height:1,target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,
dataType:B.PixelType.UNSIGNED_BYTE,samplingMode:B.TextureSamplingMode.NEAREST,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},l)};t.createFrameBuffer=function(y,l,g,d){d=new z.Texture(y,{width:l,height:g,target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,samplingMode:B.TextureSamplingMode.NEAREST,dataType:d?B.PixelType.UNSIGNED_BYTE:B.PixelType.FLOAT,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1});return new D.FramebufferObject(y,{colorTarget:B.TargetType.TEXTURE,
depthStencilTarget:B.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:l,height:g},d)};t.createRasterTexture=function(y,l,g="nearest",d=!1){var a;const c=(d=!(d&&"u8"===l.pixelType))?B.PixelType.FLOAT:B.PixelType.UNSIGNED_BYTE,e=null==l.pixels||0===l.pixels.length?null:d?l.getAsRGBAFloat():l.getAsRGBA(),f=null==(a=y.capabilities.textureFloat)?void 0:a.textureFloatLinear;return new z.Texture(y,{width:l.width,height:l.height,target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:y.type===
u.ContextType.WEBGL2&&d?B.SizedPixelFormat.RGBA32F:B.PixelFormat.RGBA,samplingMode:!f||"bilinear"!==g&&"cubic"!==g?B.TextureSamplingMode.NEAREST:B.TextureSamplingMode.LINEAR,dataType:c,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},e)};t.createTransformTexture=function(y,l){const {spacing:g,offsets:d,coefficients:a,size:[c,e]}=l;var f=1<g[0];l={width:f?4*c:c,height:e,target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:y.type===u.ContextType.WEBGL2?B.SizedPixelFormat.RGBA32F:
B.PixelFormat.RGBA,dataType:B.PixelType.FLOAT,samplingMode:B.TextureSamplingMode.NEAREST,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};const k=new Float32Array(f?c*e*16:2*d.length);if(f)for(let p=0,m=0;p<a.length;p++)k[m++]=a[p],2===p%3&&(k[m++]=1);else for(f=0;f<e;f++)for(let p=0;p<c;p++){const m=4*(f*c+p),b=2*(p*e+f);k[m]=d[b];k[m+1]=d[b+1];k[m+3]=-1===d[b]?0:1}return new z.Texture(y,l,k)};t.getBasicGridUniforms=function(y,l){return{u_scale:y,u_offset:l}};t.getColormapUniforms=function(y,
l){return{u_colormapOffset:l||0,u_colormapMaxIndex:y?y.length/4-1:null}};t.getCommonUniforms=function(y,l,g,d=1,a=!0,c=!1){return{u_flipY:a,u_isFloatTexture:c,u_applyTransform:y?!0:!1,u_opacity:d,u_transformSpacing:y?y.spacing:null,u_transformGridSize:y?y.size:null,u_targetImageSize:l,u_srcImageSize:g}};t.getShadedReliefUniforms=function(y){return{u_hillshadeType:y.hillshadeType,u_sinZcosAs:y.sinZcosAs,u_sinZsinAs:y.sinZsinAs,u_cosZs:y.cosZs,u_weights:y.weights,u_factor:y.factor,u_minValue:y.minValue,
u_maxValue:y.maxValue}};t.getStretchUniforms=function(y){return{u_bandCount:y.bandCount,u_minOutput:y.outMin,u_maxOutput:y.outMax,u_minCutOff:y.minCutOff,u_maxCutOff:y.maxCutOff,u_factor:y.factor,u_useGamma:y.useGamma,u_gamma:y.gamma,u_gammaCorrection:y.gammaCorrection}};t.getUniformLocationInfos=function(y,l){y=y.gl;l=l.glName;const g=y.getProgramParameter(l,y.ACTIVE_UNIFORMS),d=new Map;let a;for(let c=0;c<g;c++)(a=y.getActiveUniform(l,c))&&d.set(a.name,{location:y.getUniformLocation(l,a.name),info:a});
return d};t.setTextures=function(y,l,g,d){g.length===d.length&&(d.some(a=>null==a)||g.some(a=>null==a)||g.forEach((a,c)=>{l.setUniform1i(a,c);y.bindTexture(d[c],c)}))};t.setUniforms=function(y,l,g){Object.keys(g).forEach(d=>{var a=l.get(d)||l.get(d+"[0]");if(a){var c=g[d];if(null!==a&&null!=c)switch({info:a}=a,a.type){case B.UniformType.FLOAT:1<a.size?y.setUniform1fv(d,c):y.setUniform1f(d,c);break;case B.UniformType.FLOAT_VEC2:y.setUniform2fv(d,c);break;case B.UniformType.FLOAT_VEC3:y.setUniform3fv(d,
c);break;case B.UniformType.FLOAT_VEC4:y.setUniform4fv(d,c);break;case B.UniformType.FLOAT_MAT3:y.setUniformMatrix3fv(d,c);break;case B.UniformType.FLOAT_MAT4:y.setUniformMatrix4fv(d,c);break;case B.UniformType.INT:1<a.size?y.setUniform1iv(d,c):y.setUniform1i(d,c);break;case B.UniformType.BOOL:y.setUniform1i(d,c?1:0);break;case B.UniformType.INT_VEC2:case B.UniformType.BOOL_VEC2:y.setUniform2iv(d,c);break;case B.UniformType.INT_VEC3:case B.UniformType.BOOL_VEC3:y.setUniform3iv(d,c);break;case B.UniformType.INT_VEC4:case B.UniformType.BOOL_VEC4:y.setUniform4iv(d,
c)}}})};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject","../../../webgl/VertexElementDescriptor"],function(t,u,B,D){return function(){function z(l,g){this.rctx=l;this._vertexBuffer=t.BufferObject.createVertex(l,u.Usage.STATIC_DRAW,new Uint16Array(g));this._vao=new B.VertexArrayObject(l,new Map([["a_position",0]]),{geometry:[new D.VertexElementDescriptor("a_position",
2,u.DataType.SHORT,0,4)]},{geometry:this._vertexBuffer});this._count=g.length/2}var y=z.prototype;y.bind=function(){this._vao.bind()};y.unbind=function(){this._vao.unbind()};y.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};y.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(u.PrimitiveType.TRIANGLE_STRIP,0,this._count)};return z}()})},"esri/views/webgl/VertexElementDescriptor":function(){define(["exports"],function(t){t.VertexElementDescriptor=function(u,B,
D,z,y,l=!1,g=0){this.name=u;this.count=B;this.type=D;this.offset=z;this.stride=y;this.normalized=l;this.divisor=g};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/imagery/BrushVectorField":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(t,u,B,D){const z=new Float32Array([.27058823529411763,.4588235294117647,.7098039215686275,1,.396078431372549,.5372549019607843,.7215686274509804,
1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,.3176470588235294,1,.9098039215686274,.08235294117647059,.08235294117647059,1]),
y={beaufort_ft:z,beaufort_m:z,beaufort_km:z,beaufort_mi:z,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,1,.9803921568627451,.9803921568627451,.39215686274509803,1,.9882352941176471,.8352941176470589,
.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,.10196078431372549,.6,1,.7019607843137254,.10588235294117647,
.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.7019607843137254,
.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])};return function(l){function g(){var a=l.apply(this,arguments)||this;a._desc={magdir:{vsPath:"raster/magdir",fsPath:"raster/magdir",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])},scalar:{vsPath:"raster/scalar",fsPath:"raster/scalar",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])}};return a}t._inheritsLoose(g,
l);var d=g.prototype;d.dispose=function(){};d.prepareState=function({context:a},c){a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA,D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilOp(D.StencilOperation.KEEP,D.StencilOperation.KEEP,D.StencilOperation.REPLACE);a.setStencilFunction(D.CompareFunction.EQUAL,c.stencilRef,255)};d.draw=function(a,c){if(!u.isNone(c.source)&&
0!==c.source.validPixelCount){var {timeline:e}=a;e.begin(this.name);c.updateVectorFieldVAO(a);if("scalar"===a.renderPass){var f=c.vaoData.scalar;f&&this._drawScalars(a,c,f.vao,f.elementCount)}else(f=c.vaoData.magdir)&&this._drawTriangles(a,c,f.vao,f.elementCount);e.end(this.name)}};d._drawTriangles=function(a,c,e,f){const {context:k,painter:p}=a,{symbolizerParameters:m}=c;var b=m.dataRange?["dataRange"]:[];"geographic"===m.rotationType&&b.push("rotationGeographic");b=p.materialManager.getProgram(a,
this._desc.magdir,b);k.useProgram(b);const {coordScale:h,opacity:n,transforms:r}=c;b.setUniform2fv("u_coordScale",h);b.setUniform1f("u_opacity",n);b.setUniformMatrix3fv("u_dvsMat3",r.dvs);const {style:x,dataRange:q,rotation:A,symbolPercentRange:E}=m;b.setUniform4fv("u_colors",y[x]||y.single_arrow);b.setUniform2fv("u_dataRange",q);b.setUniform1f("u_rotation",A);b.setUniform2fv("u_symbolPercentRange",E);a=this._getSymbolSize(a,c);b.setUniform2fv("u_symbolSize",a);k.bindVAO(e);k.drawElements(D.PrimitiveType.TRIANGLES,
f,D.DataType.UNSIGNED_INT,0)};d._drawScalars=function(a,c,e,f){const {context:k,painter:p}=a,{symbolizerParameters:m}=c;var b=[];"wind_speed"===m.style?b.push("innerCircle"):m.dataRange&&b.push("dataRange");"geographic"===m.rotationType&&b.push("rotationGeographic");b=p.materialManager.getProgram(a,this._desc.scalar,b);k.useProgram(b);const {coordScale:h,opacity:n,transforms:r}=c;b.setUniform2fv("u_coordScale",h);b.setUniform1f("u_opacity",n);b.setUniformMatrix3fv("u_dvsMat3",r.dvs);const {dataRange:x,
symbolPercentRange:q}=m;b.setUniform2fv("u_dataRange",x);b.setUniform2fv("u_symbolPercentRange",q);a=this._getSymbolSize(a,c);b.setUniform2fv("u_symbolSize",a);k.bindVAO(e);k.drawElements(D.PrimitiveType.TRIANGLES,f,D.DataType.UNSIGNED_INT,0)};d._getSymbolSize=function(a,c){a=c.key?2**(a.displayLevel-c.key.level):c.resolution/a.state.resolution;const {symbolTileSize:e}=c.symbolizerParameters;return[e/(Math.round((c.width-c.offset[0])/e)*e)/a,e/(Math.round((c.height-c.offset[1])/e)*e)/a]};return g}(B)})},
"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../definitions","../VertexStream","./WGLBrush","../../../../webgl/enums"],function(t,u,B,D,z){const y={nearest:{defines:[],samplingMode:z.TextureSamplingMode.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:z.TextureSamplingMode.LINEAR,mips:!1},bicubic:{defines:["bicubic"],samplingMode:z.TextureSamplingMode.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:z.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,
mips:!0}};return function(l){function g(){var a=l.apply(this,arguments)||this;a._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_position",0],["a_texcoord",1]])};return a}t._inheritsLoose(g,l);var d=g.prototype;d.dispose=function(){this._quad&&this._quad.dispose()};d.prepareState=function({context:a},c){a.setBlendingEnabled(!0);"additive"===c.blendFunction?a.setBlendFunctionSeparate(z.BlendFactor.ONE,z.BlendFactor.ONE,z.BlendFactor.ONE,z.BlendFactor.ONE):a.setBlendFunctionSeparate(z.BlendFactor.ONE,
z.BlendFactor.ONE_MINUS_SRC_ALPHA,z.BlendFactor.ONE,z.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(z.CompareFunction.EQUAL,c.stencilRef,255)};d.draw=function(a,c){const {context:e,renderingOptions:f,painter:k}=a;if(c.source){a.timeline.begin(this.name);this._quad||(this._quad=new B(e,[0,0,1,0,0,1,1,1]));if("dynamic"===f.samplingMode){({state:b}=a);var p=c.resolution/c.pixelRatio/b.resolution,m=Math.round(a.pixelRatio)!==
a.pixelRatio;p=1.05<p||.95>p;var b=b.rotation||p||m||c.isSourceScaled||c.rotation?y.bilinear:y.nearest}else b=y[f.samplingMode];m=k.materialManager.getProgram(a,this._desc,b.defines);var {coordScale:h,computedOpacity:n,transforms:r}=c;c.setSamplingProfile(b);c.bind(a.context,u.TEXTURE_BINDING_BITMAP);e.useProgram(m);m.setUniformMatrix3fv("u_dvsMat3",r.dvs);m.setUniform1i("u_texture",u.TEXTURE_BINDING_BITMAP);m.setUniform2fv("u_coordScale",h);m.setUniform1f("u_opacity",n);this._quad.draw();a.timeline.end(this.name)}};
return g}(D)})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(t){t.ANGLE_FACTOR_256=256/360;t.ATTRIBUTE_DATA_ANIMATION=1;t.ATTRIBUTE_DATA_DD0=3;t.ATTRIBUTE_DATA_DD1=4;t.ATTRIBUTE_DATA_FILTER_FLAGS=0;t.ATTRIBUTE_DATA_GPGPU=2;t.ATTRIBUTE_DATA_VV=3;t.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;t.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};t.BITSET_GENERIC_LOCK_COLOR=2;t.BITSET_LINE_SCALE_DASH=4;t.BITSET_MARKER_ALIGNMENT_MAP=1;t.BITSET_MARKER_ALIGNMENT_SCREEN=
0;t.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE=4;t.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY=8;t.BITSET_TYPE_FILL_OUTLINE=1;t.BUFFER_DATA_MINIMUM_SIZE=128;t.BUFFER_DATA_POOL_SIZE=4;t.COLLISION_BOX_PADDING=16;t.COLLISION_BUCKET_SIZE=128;t.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;t.COLLISION_MAX_ZOOM_DELTA=1;t.COLLISION_PLACEMENT_PADDING=8;t.COLLISION_TILE_BOX_SIZE=4;t.DEBUG_LABELS=!1;t.DISPLAY_RECORD_INT_PER_ELEMENT=8;t.DOT_DENSITY_MAX_FIELDS=8;t.EFFECT_FLAG_0=4;t.ENABLE_EARLY_LABEL_DISCARD=!1;t.EXTRUDE_SCALE=
64;t.FILTER_FLAG_0=2;t.GLYPH_SIZE=24;t.HEURISTIC_GLYPHS_PER_FEATURE=10;t.HEURISTIC_GLYPHS_PER_LINE=50;t.HIGHLIGHT_FLAG=1;t.HITTEST_RADIUS=3;t.MAGIC_LABEL_LINE_HEIGHT=29;t.MAX_FILTERS=2;t.MAX_GPU_UPLOADS_PER_FRAME=2;t.MIN_MAX_ZOOM_PRECISION_FACTOR=10;t.NAN_MAGIC_NUMBER=1E-30;t.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;t.PICTURE_FILL_COLOR=4294967295;t.RASTER_TILE_SIZE=256;t.SPRITE_PADDING=2;t.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;t.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;t.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;t.TEXTURE_BINDING_ATTRIBUTE_DATA_3=
4;t.TEXTURE_BINDING_BITMAP=0;t.TEXTURE_BINDING_GLYPH_ATLAS=0;t.TEXTURE_BINDING_GPGPU=12;t.TEXTURE_BINDING_HIGHLIGHT_0=5;t.TEXTURE_BINDING_HIGHLIGHT_1=6;t.TEXTURE_BINDING_RENDERER_0=5;t.TEXTURE_BINDING_RENDERER_1=6;t.TEXTURE_BINDING_SPRITE_ATLAS=0;t.TEXT_PLACEMENT_PADDING=8;t.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;t.TILE_SIZE=512;t.VTL_HIGH_RES_CUTOFF=1.15;t.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;t.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;t.WEBGL_MAX_INNER_STOPS=6;t.WEBGL_MAX_STOPS=8;Object.defineProperty(t,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/enums ../../../../webgl/ProgramTemplate".split(" "),function(t,u,B,D,z,y,l,g){return function(d){function a(){var e=d.apply(this,arguments)||this;e._color=B.fromValues(0,1,0,1);return e}t._inheritsLoose(a,d);var c=a.prototype;c.dispose=function(){this._program&&
this._program.dispose()};c.prepareState=function({context:e}){e.setStencilTestEnabled(!0);e.setBlendingEnabled(!1);e.setFaceCullingEnabled(!1);e.setColorMask(!1,!1,!1,!1);e.setStencilOp(l.StencilOperation.KEEP,l.StencilOperation.KEEP,l.StencilOperation.REPLACE);e.setStencilWriteMask(255);e.setStencilFunction(l.CompareFunction.ALWAYS,0,255)};c.draw=function(e,f){const {context:k,state:p}=e;e=D.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT}]});f=f.getVAO(k,
p,e.attributes,e.bufferLayouts);u.isNone(f.indexBuffer)||(this._program||(this._program=g.createProgram(k,y.background)),k.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",p.displayMat3),k.bindVAO(f),k.drawElements(l.PrimitiveType.TRIANGLES,f.indexBuffer.size,l.DataType.UNSIGNED_INT,0),k.bindVAO())};return a}(z)})},"esri/chunks/vec4f32":function(){define(["exports"],function(t){function u(){return new Float32Array(4)}
function B(n){const r=new Float32Array(4);r[0]=n[0];r[1]=n[1];r[2]=n[2];r[3]=n[3];return r}function D(n,r,x,q){const A=new Float32Array(4);A[0]=n;A[1]=r;A[2]=x;A[3]=q;return A}function z(n,r){return new Float32Array(n,r,4)}function y(){return u()}function l(){return D(1,1,1,1)}function g(){return D(1,0,0,0)}function d(){return D(0,1,0,0)}function a(){return D(0,0,1,0)}function c(){return D(0,0,0,1)}const e=u(),f=l(),k=g(),p=d(),m=a(),b=c(),h=Object.freeze({__proto__:null,create:u,clone:B,fromValues:D,
createView:z,zeros:y,ones:l,unitX:g,unitY:d,unitZ:a,unitW:c,ZEROS:e,ONES:f,UNIT_X:k,UNIT_Y:p,UNIT_Z:m,UNIT_W:b});t.ONES=f;t.UNIT_W=b;t.UNIT_X=k;t.UNIT_Y=p;t.UNIT_Z=m;t.ZEROS=e;t.clone=B;t.create=u;t.createView=z;t.fromValues=D;t.ones=l;t.unitW=c;t.unitX=g;t.unitY=d;t.unitZ=a;t.vec4f32=h;t.zeros=y})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ./color ./enums ./SymbolProperties ../../../webgl/enums ../../../webgl/Texture ../../../webgl/VertexElementDescriptor".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e){function f(J){const P={};for(const S of J)P[S.name]=S.strideInBytes;return P}function k(J){switch(J){case g.WGLGeometryType.MARKER:return O;case g.WGLGeometryType.FILL:return N;case g.WGLGeometryType.LINE:return K;case g.WGLGeometryType.TEXT:return I;case g.WGLGeometryType.LABEL:return M}}function p(J){switch(J%4){case 0:case 2:return 4;case 1:case 3:return 1}}function m(J){switch(J){case a.DataType.BYTE:case a.DataType.UNSIGNED_BYTE:return 1;case a.DataType.SHORT:case a.DataType.UNSIGNED_SHORT:return 2;
case a.DataType.FLOAT:case a.DataType.INT:case a.DataType.UNSIGNED_INT:return 4}}function b(J){const P={};for(const S in J){let W=0;P[S]=J[S].map(Z=>{const V=new e.VertexElementDescriptor(Z.name,Z.count,Z.type,W,0,Z.normalized||!1);W+=Z.count*m(Z.type);return V});P[S].forEach(Z=>Z.stride=W)}return P}const h=B.getLogger("esri.views.2d.engine.webgl.Utils");B=[{name:"geometry",strideInBytes:36}];const n=[{name:"geometry",strideInBytes:32}],r=[{name:"geometry",strideInBytes:20}],x=[{name:"geometry",strideInBytes:12}],
q=[{name:"geometry",strideInBytes:40}],A=[{name:"geometry",strideInBytes:36}],E=[{name:"geometry",strideInBytes:36}],F=f(B),w=f(n),v=f(r),C=f(x),G=f(q),H=f(A),L=f(E),O=["geometry"],N=["geometry"],K=["geometry"],I=["geometry"],M=["geometry"],U={["geometry"]:a.Usage.STATIC_DRAW},T=new Map,Q=J=>{if(!J)return!1;J=J.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(J)&&/[\dz]$/i.test(J)&&4<J.length?!0:!1};t.C_FILL_STRIDE_SPEC=w;t.C_FILL_STRIDE_SPEC_DD=C;t.C_FILL_STRIDE_SPEC_SIMPLE=v;t.C_FILL_VERTEX_DEF=
n;t.C_FILL_VERTEX_DEF_DD=x;t.C_FILL_VERTEX_DEF_SIMPLE=r;t.C_ICON_STRIDE_SPEC=F;t.C_ICON_VERTEX_DEF=B;t.C_LABEL_STRIDE_SPEC=L;t.C_LABEL_VERTEX_DEF=E;t.C_LINE_STRIDE_SPEC=G;t.C_LINE_VERTEX_DEF=q;t.C_TEXT_STRIDE_SPEC=H;t.C_TEXT_VERTEX_DEF=A;t.C_VBO_GEOMETRY="geometry";t.C_VBO_INFO=U;t.C_VBO_PERINSTANCE="per_instance";t.C_VBO_PERINSTANCE_VV="per_instance_vv";t.allocateTypedArrayBuffer=function(J,P){switch(P%4){case 0:case 2:return new Uint32Array(Math.floor(J*P/4));case 1:case 3:return new Uint8Array(J*
P)}};t.allocateTypedArrayBufferwithData=function(J,P){switch(P%4){case 0:case 2:return new Uint32Array(J);case 1:case 3:return new Uint8Array(J)}};t.charCodes=function(J){const P=[];for(let S=0;S<J.length;S++)P.push(J.charCodeAt(S));return P};t.copyMeshData=function(J,P,S,W,Z,V,Y){for(const aa in V){var X=V[aa].stride,R=p(X);const ba=V[aa].data,ca=S[aa].data,da=X*Z.vertexCount/R,ea=X*J/R;X=X*Z.vertexFrom/R;for(R=0;R<da;++R)ca[R+ea]=ba[R+X]}S=Z.indexCount;for(V=0;V<S;++V)W[V+P]=Y[V+Z.indexFrom]-Z.vertexFrom+
J};t.createGeometryData=function(J,P){const S=[];for(let W=0;5>W;++W){const Z=k(W),V={};for(const Y of Z)V[Y]={data:P(W,Y)};S.push({data:J(W),buffers:V})}return S};t.createProgramDescriptor=(J,P)=>{if(!T.has(J)){const Z=b(P);var S=Z;var W={};for(const V in S){const Y=S[V];W[V]=Y.length?Y[0].stride:0}S=W;W=new Map;for(const V in P)for(const Y of P[V])W.set(Y.name,Y.location);P=W;T.set(J,{strides:S,bufferLayouts:Z,attributes:P})}return T.get(J)};t.createTextureFromTexelData=function(J,P){let S,W;D.isPowerOfTwo(P.width)&&
D.isPowerOfTwo(P.height)?(S=!0,W=a.TextureSamplingMode.LINEAR_MIPMAP_LINEAR):(S=!1,W=a.TextureSamplingMode.LINEAR);return new c.Texture(J,{target:a.TextureType.TEXTURE_2D,pixelFormat:a.PixelFormat.RGBA,internalFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,hasMipmap:S,samplingMode:W,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0},P)};t.forEachGeometryType=function(J){J(g.WGLGeometryType.FILL);J(g.WGLGeometryType.LINE);J(g.WGLGeometryType.MARKER);J(g.WGLGeometryType.TEXT);J(g.WGLGeometryType.LABEL)};
t.geometryToMappedGeometry=function(J){return{vertexFrom:void 0,vertexTo:void 0,geometry:J}};t.getBytes=m;t.getCapType=function(J){switch(J){case "butt":return y.CapType.BUTT;case "round":return y.CapType.ROUND;case "square":return y.CapType.SQUARE;default:return h.error(new u("mapview-invalid-type",`Cap type ${J} is not a valid option. Defaulting to round`)),y.CapType.ROUND}};t.getJoinType=function(J){switch(J){case "miter":return y.JoinType.MITER;case "bevel":return y.JoinType.BEVEL;case "round":return y.JoinType.ROUND;
default:return h.error(new u("mapview-invalid-type",`Join type ${J} is not a valid option. Defaulting to round`)),y.JoinType.ROUND}};t.getNamedBuffers=k;t.getPMSResourceSize=function(J){const P="maxVVSize"in J&&J.maxVVSize;J="width"in J&&J.width||"size"in J&&J.size||0;return P?P:J};t.getPixelArrayCtor=function(J){switch(J){case a.PixelType.UNSIGNED_BYTE:return Uint8Array;case a.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case a.PixelType.FLOAT:return Float32Array;default:h.error(new u("webgl-utils",
`Unable to handle type ${J}`))}};t.getPixelBytes=function(J){switch(J){case a.PixelType.UNSIGNED_BYTE:return 1;case a.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case a.PixelType.FLOAT:return 4;default:h.error(new u("webgl-utils",`Unable to handle type ${J}`))}};t.getStrides=function(J,{fill:P}){switch(J){case g.WGLGeometryType.MARKER:return F;case g.WGLGeometryType.FILL:return"dot-density"===P?C:"simple"===P?v:w;case g.WGLGeometryType.LINE:return G;case g.WGLGeometryType.TEXT:return H;case g.WGLGeometryType.LABEL:return L}};
t.getTextProperties=function(J){return d.TextProperties.pool.acquire(J.color?l.copyAndPremultiply(J.color):[255,255,255,255],J.haloColor?l.copyAndPremultiply(J.haloColor):[255,255,255,255],z.pt2px(J.haloSize),z.pt2px(J.font.size),J.angle*Math.PI/180,J.xoffset/J.font.size,J.yoffset/J.font.size,"left"===J.horizontalAlignment?0:"right"===J.horizontalAlignment?1:.5,"top"===J.verticalAlignment?0:"bottom"===J.verticalAlignment?1:.5)};t.getTransformParams=function(J){const {transform:P,hasZ:S,hasM:W}=J;
return{transform:P,hasZ:S,hasM:W}};t.getUrl=J=>"imageData"in J&&J.imageData&&"contentType"in J&&J.contentType?`data:${J.contentType};base64,${J.imageData}`:"url"in J?J.url:null;t.getVVType=function(J){switch(J){case "opacity":return g.VVType.OPACITY;case "color":return g.VVType.COLOR;case "rotation":return g.VVType.ROTATION;case "size":return g.VVType.SIZE;default:return h.error(`Cannot interpret unknown vv: ${J}`),null}};t.is3D=J=>J.type&&-1!==J.type.toLowerCase().indexOf("3d");t.isDefined=function(J){return null!=
J};t.isGIF=J=>"url"in J&&J.url&&J.url.includes(".gif")||"contentType"in J&&"image/gif"===J.contentType||"imageData"in J&&J.imageData.includes("data:image/gif");t.isImageResource=J=>"url"in J&&J.url||"imageData"in J&&J.imageData;t.isNumber=function(J){return"number"===typeof J};t.isPNG=J=>"url"in J&&J.url&&J.url.includes(".png")||"contentType"in J&&"image/png"===J.contentType||"imageData"in J&&J.imageData.includes("data:image/png");t.isSVGImage=J=>J.includes("data:image/svg+xml");t.isSVGResource=J=>
"path"in J&&Q(J.path);t.isSimple=function(J){switch(J.type){case "line":return"CIMSolidStroke"===J.cim.type&&!J.dashTemplate;case "fill":return"CIMSolidFill"===J.cim.type;case "esriSFS":return"esriSFSSolid"===J.style||"esriSFSNull"===J.style;case "esriSLS":return"esriSLSSolid"===J.style||"esriSLSNull"===J.style;default:return!1}};t.isValidSVG=Q;t.shouldRepeat=function(J){switch("cim"in J?J.cim.type:J.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;
default:return!0}};t.strideToPackingFactor=p;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/enums":function(){define(["exports"],function(t){t.CapType=void 0;(function(u){u[u.BUTT=0]="BUTT";u[u.ROUND=1]="ROUND";u[u.SQUARE=2]="SQUARE";u[u.UNKNOWN=4]="UNKNOWN"})(t.CapType||(t.CapType={}));t.JoinType=void 0;(function(u){u[u.BEVEL=0]="BEVEL";u[u.ROUND=1]="ROUND";u[u.MITER=2]="MITER";u[u.UNKNOWN=4]="UNKNOWN"})(t.JoinType||(t.JoinType={}));t.Alignment=void 0;(function(u){u[u.SCREEN=
0]="SCREEN";u[u.MAP=1]="MAP"})(t.Alignment||(t.Alignment={}));t.ExternalColorMixMode=void 0;(function(u){u[u.Tint=0]="Tint";u[u.Ignore=1]="Ignore";u[u.Multiply=99]="Multiply"})(t.ExternalColorMixMode||(t.ExternalColorMixMode={}));t.ExtremityPlacement=void 0;(function(u){u.Both="Both";u.JustBegin="JustBegin";u.JustEnd="JustEnd";u.None="None"})(t.ExtremityPlacement||(t.ExtremityPlacement={}));t.FillMode=void 0;(function(u){u[u.Mosaic=0]="Mosaic";u[u.Centered=1]="Centered"})(t.FillMode||(t.FillMode=
{}));t.FontEffects=void 0;(function(u){u[u.Normal=0]="Normal";u[u.Superscript=1]="Superscript";u[u.Subscript=2]="Subscript"})(t.FontEffects||(t.FontEffects={}));t.FontEncoding=void 0;(function(u){u[u.MSSymbol=0]="MSSymbol";u[u.Unicode=1]="Unicode"})(t.FontEncoding||(t.FontEncoding={}));t.FontType=void 0;(function(u){u[u.Unspecified=0]="Unspecified";u[u.TrueType=1]="TrueType";u[u.PSOpenType=2]="PSOpenType";u[u.TTOpenType=3]="TTOpenType";u[u.Type1=4]="Type1"})(t.FontType||(t.FontType={}));t.AngleAlignment=
void 0;(function(u){u[u.Display=0]="Display";u[u.Map=1]="Map"})(t.AngleAlignment||(t.AngleAlignment={}));t.DominantSizeAxis=void 0;(function(u){u[u.Z=0]="Z";u[u.X=1]="X";u[u.Y=2]="Y"})(t.DominantSizeAxis||(t.DominantSizeAxis={}));t.RotationOrder=void 0;(function(u){u[u.XYZ=0]="XYZ";u[u.ZXY=1]="ZXY";u[u.YXZ=2]="YXZ"})(t.RotationOrder||(t.RotationOrder={}));t.BalloonCalloutStyle=void 0;(function(u){u[u.Rectangle=0]="Rectangle";u[u.RoundedRectangle=1]="RoundedRectangle";u[u.Oval=2]="Oval"})(t.BalloonCalloutStyle||
(t.BalloonCalloutStyle={}));t.BlendingMode=void 0;(function(u){u[u.None=0]="None";u[u.Alpha=1]="Alpha";u[u.Screen=2]="Screen";u[u.Multiply=3]="Multiply";u[u.Add=4]="Add"})(t.BlendingMode||(t.BlendingMode={}));t.BlockProgression=void 0;(function(u){u[u.TTB=0]="TTB";u[u.RTL=1]="RTL";u[u.BTT=2]="BTT"})(t.BlockProgression||(t.BlockProgression={}));t.BillBoardMode=void 0;(function(u){u[u.None=0]="None";u[u.SignPost=1]="SignPost";u[u.FaceNearPlane=2]="FaceNearPlane"})(t.BillBoardMode||(t.BillBoardMode=
{}));t.CGAAttributeType=void 0;(function(u){u[u.Float=0]="Float";u[u.String=1]="String";u[u.Boolean=2]="Boolean"})(t.CGAAttributeType||(t.CGAAttributeType={}));t.ClippingType=void 0;(function(u){u[u.Intersect=0]="Intersect";u[u.Subtract=1]="Subtract"})(t.ClippingType||(t.ClippingType={}));t.GeometricEffectArrowType=void 0;(function(u){u.OpenEnded="OpenEnded";u.Block="Block";u.Crossed="Crossed"})(t.GeometricEffectArrowType||(t.GeometricEffectArrowType={}));t.GeometricEffectControlMeasureLineRule=void 0;
(function(u){u.FullGeometry="FullGeometry";u.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment";u.ReversedFirstSegment="ReversedFirstSegment";u.PerpendicularToSecondSegment="PerpendicularToSecondSegment";u.SecondSegmentWithTicks="SecondSegmentWithTicks";u.DoublePerpendicular="DoublePerpendicular";u.OppositeToFirstSegment="OppositeToFirstSegment";u.TriplePerpendicular="TriplePerpendicular";u.HalfCircleFirstSegment="HalfCircleFirstSegment";u.HalfCircleSecondSegment="HalfCircleSecondSegment";
u.HalfCircleExtended="HalfCircleExtended";u.OpenCircle="OpenCircle";u.CoverageEdgesWithTicks="CoverageEdgesWithTicks";u.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks";u.GapExtentMidline="GapExtentMidline";u.Chevron="Chevron";u.PerpendicularWithArc="PerpendicularWithArc";u.ClosedHalfCircle="ClosedHalfCircle";u.TripleParallelExtended="TripleParallelExtended";u.ParallelWithTicks="ParallelWithTicks";u.Parallel="Parallel";u.PerpendicularToFirstSegment="PerpendicularToFirstSegment";u.ParallelOffset=
"ParallelOffset";u.OffsetOpposite="OffsetOpposite";u.OffsetSame="OffsetSame";u.CircleWithArc="CircleWithArc";u.DoubleJog="DoubleJog";u.PerpendicularOffset="PerpendicularOffset";u.LineExcludingLastSegment="LineExcludingLastSegment";u.MultivertexArrow="MultivertexArrow";u.CrossedArrow="CrossedArrow";u.ChevronArrow="ChevronArrow";u.ChevronArrowOffset="ChevronArrowOffset";u.PartialFirstSegment="PartialFirstSegment";u.Arch="Arch";u.CurvedParallelTicks="CurvedParallelTicks";u.Arc90Degrees="Arc90Degrees"})(t.GeometricEffectControlMeasureLineRule||
(t.GeometricEffectControlMeasureLineRule={}));t.GeometricEffectDonutMethod=void 0;(function(u){u.Mitered="Mitered";u.Bevelled="Bevelled";u.Rounded="Rounded";u.Square="Square";u.TrueBuffer="TrueBuffer"})(t.GeometricEffectDonutMethod||(t.GeometricEffectDonutMethod={}));t.GeometricEffectEnclosingPolygonMethod=void 0;(function(u){u.ClosePath="ClosePath";u.ConvexHull="ConvexHull";u.RectangularBox="RectangularBox"})(t.GeometricEffectEnclosingPolygonMethod||(t.GeometricEffectEnclosingPolygonMethod={}));
t.GeometricEffectExtensionOrigin=void 0;(function(u){u.BeginningOfLine="BeginningOfLine";u.EndOfLine="EndOfLine"})(t.GeometricEffectExtensionOrigin||(t.GeometricEffectExtensionOrigin={}));t.GeometricEffectOffsetMethod=void 0;(function(u){u.Mitered="Mitered";u.Bevelled="Bevelled";u.Rounded="Rounded";u.Square="Square"})(t.GeometricEffectOffsetMethod||(t.GeometricEffectOffsetMethod={}));t.GeometricEffectOffsetOption=void 0;(function(u){u.Fast="Fast";u.Accurate="Accurate"})(t.GeometricEffectOffsetOption||
(t.GeometricEffectOffsetOption={}));t.GeometricEffectOffsetTangentMethod=void 0;(function(u){u.BeginningOfLine="BeginningOfLine";u.EndOfLine="EndOfLine"})(t.GeometricEffectOffsetTangentMethod||(t.GeometricEffectOffsetTangentMethod={}));t.GeometricEffectWaveform=void 0;(function(u){u.Sinus="Sinus";u.Square="Square";u.Triangle="Triangle";u.Random="Random"})(t.GeometricEffectWaveform||(t.GeometricEffectWaveform={}));t.GlyphHinting=void 0;(function(u){u[u.None=0]="None";u[u.Default=1]="Default";u[u.Force=
2]="Force"})(t.GlyphHinting||(t.GlyphHinting={}));t.GradientAlignment=void 0;(function(u){u[u.Buffered=0]="Buffered";u[u.Left=1]="Left";u[u.Right=2]="Right";u[u.AlongLine=3]="AlongLine"})(t.GradientAlignment||(t.GradientAlignment={}));t.GradientFillMethod=void 0;(function(u){u[u.Linear=0]="Linear";u[u.Rectangular=1]="Rectangular";u[u.Circular=2]="Circular";u[u.Buffered=3]="Buffered"})(t.GradientFillMethod||(t.GradientFillMethod={}));t.GradientStrokeType=void 0;(function(u){u[u.Discrete=0]="Discrete";
u[u.Continuous=1]="Continuous"})(t.GradientStrokeType||(t.GradientStrokeType={}));t.GradientStrokeMethod=void 0;(function(u){u[u.AcrossLine=0]="AcrossLine";u[u.AloneLine=1]="AloneLine"})(t.GradientStrokeMethod||(t.GradientStrokeMethod={}));t.HorizontalAlignment=void 0;(function(u){u[u.Left=0]="Left";u[u.Right=1]="Right";u[u.Center=2]="Center";u[u.Justify=3]="Justify"})(t.HorizontalAlignment||(t.HorizontalAlignment={}));t.LeaderLineStyle=void 0;(function(u){u[u.Base=0]="Base";u[u.MidPoint=1]="MidPoint";
u[u.ThreePoint=2]="ThreePoint";u[u.FourPoint=3]="FourPoint";u[u.Underline=4]="Underline";u[u.CircularCW=5]="CircularCW";u[u.CircularCCW=6]="CircularCCW"})(t.LeaderLineStyle||(t.LeaderLineStyle={}));t.LineCapStyle=void 0;(function(u){u.Butt="Butt";u.Round="Round";u.Square="Square"})(t.LineCapStyle||(t.LineCapStyle={}));t.LineDashEnding=void 0;(function(u){u.NoConstraint="NoConstraint";u.HalfPattern="HalfPattern";u.HalfGap="HalfGap";u.FullPattern="FullPattern";u.FullGap="FullGap";u.Custom="Custom"})(t.LineDashEnding||
(t.LineDashEnding={}));t.LineDecorationStyle=void 0;(function(u){u[u.None=-1]="None";u[u.Custom=0]="Custom";u[u.Circle=1]="Circle";u[u.OpenArrow=2]="OpenArrow";u[u.ClosedArrow=3]="ClosedArrow";u[u.Diamond=4]="Diamond"})(t.LineDecorationStyle||(t.LineDecorationStyle={}));t.LineGapType=void 0;(function(u){u[u.ExtraLeading=0]="ExtraLeading";u[u.Multiple=1]="Multiple";u[u.Exact=2]="Exact"})(t.LineGapType||(t.LineGapType={}));t.LineJoinStyle=void 0;(function(u){u.Bevel="Bevel";u.Round="Round";u.Miter=
"Miter"})(t.LineJoinStyle||(t.LineJoinStyle={}));t.ExpressionReturnType=void 0;(function(u){u[u.Default=0]="Default";u[u.String=1]="String";u[u.Numeric=2]="Numeric"})(t.ExpressionReturnType||(t.ExpressionReturnType={}));t.MarkerPlacementType=void 0;(function(u){u[u.InsidePolygon=0]="InsidePolygon";u[u.PolygonCenter=1]="PolygonCenter";u[u.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"})(t.MarkerPlacementType||(t.MarkerPlacementType={}));t.MaterialMode=void 0;(function(u){u[u.Tint=0]="Tint";u[u.Replace=
1]="Replace";u[u.Multiply=2]="Multiply"})(t.MaterialMode||(t.MaterialMode={}));t.PlacementClip=void 0;(function(u){u[u.ClipAtBoundary=0]="ClipAtBoundary";u[u.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary";u[u.DoNotTouchBoundary=2]="DoNotTouchBoundary";u[u.DoNotClip=3]="DoNotClip"})(t.PlacementClip||(t.PlacementClip={}));t.PlacementEndings=void 0;(function(u){u.NoConstraint="NoConstraint";u.WithMarkers="WithMarkers";u.WithFullGap="WithFullGap";u.WithHalfGap="WithHalfGap";u.Custom=
"Custom"})(t.PlacementEndings||(t.PlacementEndings={}));t.PlacementGridType=void 0;(function(u){u.Fixed="Fixed";u.Random="Random";u.RandomFixedQuantity="RandomFixedQuantity"})(t.PlacementGridType||(t.PlacementGridType={}));t.PlacementOnLineRelativeTo=void 0;(function(u){u.LineMiddle="LineMiddle";u.LineBeginning="LineBeginning";u.LineEnd="LineEnd";u.SegmentMidpoint="SegmentMidpoint"})(t.PlacementOnLineRelativeTo||(t.PlacementOnLineRelativeTo={}));t.PlacementPolygonCenterMethod=void 0;(function(u){u.OnPolygon=
"OnPolygon";u.CenterOfMass="CenterOfMass";u.BoundingBoxCenter="BoundingBoxCenter"})(t.PlacementPolygonCenterMethod||(t.PlacementPolygonCenterMethod={}));t.PlacementRandomlyAlongLineRandomization=void 0;(function(u){u[u.Low=0]="Low";u[u.Medium=1]="Medium";u[u.High=2]="High"})(t.PlacementRandomlyAlongLineRandomization||(t.PlacementRandomlyAlongLineRandomization={}));t.PlacementStepPosition=void 0;(function(u){u[u.MarkerCenter=0]="MarkerCenter";u[u.MarkerBounds=1]="MarkerBounds"})(t.PlacementStepPosition||
(t.PlacementStepPosition={}));t.PointSymbolCalloutScale=void 0;(function(u){u[u.None=0]="None";u[u.PropUniform=1]="PropUniform";u[u.PropNonuniform=2]="PropNonuniform";u[u.DifUniform=3]="DifUniform";u[u.DifNonuniform=4]="DifNonuniform"})(t.PointSymbolCalloutScale||(t.PointSymbolCalloutScale={}));t.Simple3DLineStyle=void 0;(function(u){u.Tube="Tube";u.Strip="Strip";u.Wall="Wall"})(t.Simple3DLineStyle||(t.Simple3DLineStyle={}));t.SizeVariationMethod=void 0;(function(u){u[u.Random=0]="Random";u[u.Increasing=
1]="Increasing";u[u.Decreasing=2]="Decreasing";u[u.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"})(t.SizeVariationMethod||(t.SizeVariationMethod={}));t.SymbolUnits=void 0;(function(u){u[u.Relative=0]="Relative";u[u.Absolute=1]="Absolute"})(t.SymbolUnits||(t.SymbolUnits={}));t.TextCase=void 0;(function(u){u[u.Normal=0]="Normal";u[u.LowerCase=1]="LowerCase";u[u.Allcaps=2]="Allcaps"})(t.TextCase||(t.TextCase={}));t.TextReadingDirection=void 0;(function(u){u[u.LTR=0]="LTR";u[u.RTL=1]="RTL"})(t.TextReadingDirection||
(t.TextReadingDirection={}));t.TextureFilter=void 0;(function(u){u.Draft="Draft";u.Picture="Picture";u.Text="Text"})(t.TextureFilter||(t.TextureFilter={}));t.VerticalAlignment=void 0;(function(u){u[u.Top=0]="Top";u[u.Center=1]="Center";u[u.Baseline=2]="Baseline";u[u.Bottom=3]="Bottom"})(t.VerticalAlignment||(t.VerticalAlignment={}));t.VerticalGlyphOrientation=void 0;(function(u){u[u.Right=0]="Right";u[u.Upright=1]="Upright"})(t.VerticalGlyphOrientation||(t.VerticalGlyphOrientation={}));t.WaterbodySize=
void 0;(function(u){u[u.Small=0]="Small";u[u.Medium=1]="Medium";u[u.Large=2]="Large"})(t.WaterbodySize||(t.WaterbodySize={}));t.WaveStrength=void 0;(function(u){u[u.Calm=0]="Calm";u[u.Rippled=1]="Rippled";u[u.Slight=2]="Slight";u[u.Moderate=3]="Moderate"})(t.WaveStrength||(t.WaveStrength={}));Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","./number"],function(t,u){function B(y,l){Array.isArray(l)?(y[0]=l[0],y[1]=l[1],y[2]=l[2],y[3]=
l[3]):(y[0]=l.r,y[1]=l.g,y[2]=l.b,y[3]=l.a);return y}function D(y,l=0,g=!1){const d=y[l+3];y[l+0]*=d;y[l+1]*=d;y[l+2]*=d;g||(y[l+3]*=255);return y}const z=[0,0,0,0];t.copyAndPremultiply=function(y){return D(B([],y))};t.premultiplyAlpha=D;t.premultiplyAlphaRGBA=function(y){if(!y)return 0;const {r:l,g,b:d,a}=y;return u.i8888to32(l*a,g*a,d*a,255*a)};t.premultiplyAlphaRGBAArray=function(y){if(!y)return 0;const [l,g,d,a]=y;return u.i8888to32(a/255*l,a/255*g,a/255*d,a)};t.premultiplyAlphaUint32=function(y){D(B(z,
y));return u.i8888to32(z[0],z[1],z[2],z[3])};t.white=[255,255,255,1];Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(t){function u(z,y,l){return Math.round(Math.max(Math.min(z,l),y))}const B=new Float32Array(1),D=new Uint32Array(B.buffer);t.i16=function(z){return u(z,-32768,32767)};t.i1616to32=function(z,y){return 65535&z|y<<16};t.i32=function(z){return u(z,-2147483648,2147483647)};t.i8=function(z){return u(z,-128,127)};
t.i8816to32=function(z,y,l){return z&255|(y&255)<<8|l<<16};t.i8888to32=function(z,y,l,g){return z&255|(y&255)<<8|(l&255)<<16|g<<24};t.numTo32=function(z){return z|0};t.toFloat32=function(z){D[0]=z;return B[0]};t.toUint32=function(z){B[0]=z;return D[0]};t.u16=function(z){return u(z,0,65535)};t.u32=function(z){return u(z,0,4294967295)};t.u32to4Xu8=function(z){return[z&255,(z&65280)>>>8,(z&16711680)>>>16,(z&4278190080)>>>24]};t.u4u4to8=function(z,y){return 15&z|(15&y)<<4};t.u8=function(z){return u(z,
0,255)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(t,u){let B=function(){function D(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var z=D.prototype;z.acquire=function(y,l,g,d,a,c,e,f,k){this.color=y;this.haloColor=l;this.haloSize=g;this.size=d;this.angle=a;this.offsetX=c;this.offsetY=
e;this.hAnchor=f;this.vAnchor=k};z.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return D}();B.pool=new u(B);t.TextProperties=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(t,u){u={shaders:{vertexShader:u.resolveIncludes("background/background.vert"),
fragmentShader:u.resolveIncludes("background/background.frag")},attributes:new Map([["a_pos",0]])};t.background=u;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(t,u,B){const D=new B.ShaderCompiler(function(z){let y=u;z.split("/").forEach(l=>{y&&(y=y[l])});return y});t.resolveIncludes=function(z){return D.resolveIncludes(z)};Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}",
"bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\nvividLight(Cb.g, Cs.g),\nvividLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},dot:{dot:{"dot.frag":"precision mediump float;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nuniform highp float u_tileZoomFactor;\nvoid main()\n{\nfloat dist \x3d length(gl_PointCoord - vec2(.5, .5)) * 2.;\nfloat alpha \x3d smoothstep(0., 1., v_invEdgeRatio * (dist - v_dotRatio) + 1.);\ngl_FragColor \x3d v_color * alpha;\n}",
"dot.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform sampler2D u_texture;\nuniform highp mat3 u_dvsMat3;\nuniform highp float u_tileZoomFactor;\nuniform highp float u_dotSize;\nuniform highp float u_pixelRatio;\nvarying vec2 v_pos;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nconst float EPSILON \x3d 0.000001;\nvoid main()\n{\nmat3 tileToTileTexture \x3d mat3(  1., 0., 0.,\n0., -1., 0.,\n0., 1., 1.  );\nvec3 texCoords \x3d tileToTileTexture * vec3(a_pos.xy / 512., 1.);\nv_color \x3d texture2D(u_texture, texCoords.xy);\nfloat smoothEdgeWidth \x3d max(u_dotSize / 2., 1.) ;\nfloat z \x3d 0.;\nz +\x3d 2.0 * step(v_color.a, EPSILON);\ngl_PointSize \x3d (smoothEdgeWidth + u_dotSize);\ngl_Position \x3d vec4((u_dvsMat3 * vec3(a_pos + .5, 1.)).xy, z, 1.);\nv_dotRatio \x3d u_dotSize / gl_PointSize;\nv_invEdgeRatio \x3d -1. / ( smoothEdgeWidth / gl_PointSize );\ngl_PointSize  *\x3d (u_pixelRatio * u_tileZoomFactor);\n}"}},
filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nvec4 color \x3d mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha \x3d floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor \x3d color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec2 getAttributeDataTextureCoords(in highp vec3 id) {\nreturn (getAttributeDataCoords(id) * 2.0) - 1.0 + (.5 / vec2(u_attributeTextureSize));\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.00001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR \x3d 1;\nconst int BITSET_MARKER_ALIGNMENT_MAP \x3d 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE \x3d 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY \x3d 3;\nconst int BITSET_TYPE_FILL_OUTLINE \x3d 0;\nconst int BITSET_LINE_SCALE_DASH \x3d 2;",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef OUTLINED_FILL\nvarying lowp float v_isOutline;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef OUTLINED_FILL\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\nlowp vec4 drawLine() {\nfloat v_lineWidth \x3d v_aux1.x;\nvec2  v_normal    \x3d v_aux1.yz;\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color \x3d vec4(0.);\n#ifdef HITTEST\nout_color \x3d vec4(1.0, 0.0, 0.0, 0.0);\n#elif defined(PATTERN)\nmediump vec4 v_tlbr \x3d v_aux1;\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\nout_color \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color \x3d preEffectColor;\n#else\nout_color \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a \x3d 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef OUTLINED_FILL\nif (v_isOutline \x3e 0.5) {\ngl_FragColor \x3d drawLine();\n} else {\ngl_FragColor \x3d drawFill();\n}\n#else\ngl_FragColor \x3d drawFill();\n#endif\n}",
"fill.vert":"#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SIMPLE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#include \x3cmaterials/fill/hittest.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef OUTLINED_FILL\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs \x3d buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      \x3d outputs.id;\nv_color   \x3d outputs.color;\nv_opacity \x3d outputs.opacity;\nv_aux1    \x3d vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color \x3d outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet \x3d a_bitset;\nv_color \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nout_color \x3d v_color;\n#ifdef DOT_DENSITY\nmat3 tileToTileNormalized \x3d mat3(  2. / 512.,  0.,  0.,\n0., -2. / 512.,  0.,\n-1.,  1.,  1.  );\nout_pos   \x3d tileToTileNormalized * vec3((a_pos * FILL_POSITION_PRECISION), 1.);\n#else\nout_pos   \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#endif\n#ifdef PATTERN\nvec4  a_tlbr   \x3d a_aux1;\nfloat a_width  \x3d a_aux2.x;\nfloat a_height \x3d a_aux2.y;\nvec2  a_offset \x3d a_aux2.zw;\nvec2  a_scale  \x3d a_aux3.xy;\nfloat a_angle  \x3d a_aux3.z;\nvec2 scale \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_scale;\nfloat width \x3d u_pixelRatio * u_zoomFactor * a_width * scale.x;\nfloat height \x3d u_pixelRatio * u_zoomFactor * a_height * scale.y;\nfloat angle \x3d C_256_TO_RAD * a_angle;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\n0,            0,             1);\nvec2 tileOffset \x3d vec2(u_tileOffset.x * cosA - u_tileOffset.y * sinA, u_tileOffset.x * sinA + u_tileOffset.y * cosA);\ntileOffset \x3d mod(tileOffset, vec2(a_aux2.x, a_aux2.y));\nvec2 symbolOffset \x3d (a_offset - tileOffset - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\n#ifdef HITTEST\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\n#ifdef OUTLINED_FILL\nif (getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE) \x3e 0.5) {\nout_pos \x3d vec3(0., 0., 2.);\nreturn;\n}\n#endif\nout_pos \x3d hittestFill();\ngl_PointSize \x3d 1.0;\n}\n#elif defined(OUTLINED_FILL)\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\nv_isOutline \x3d getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline \x3e 0.5) {\ndrawLine(out_color, out_pos);\n} else {\ndrawFill(out_color, out_pos);\n}\n}\n#else\n#define draw drawFill\n#endif\nvoid main()\n{\nINIT;\nlowp vec4 color \x3d vec4(0.);\nhighp vec3 pos  \x3d vec3(0.);\ndraw(color, pos);\ngl_Position \x3d vec4(clip(color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}",
"hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nconst float EPSILON_PARALLEL \x3d 0.05;\nbool hasSameSide(vec3 p0, vec3 p1, vec3 a, vec3 b) {\nvec3 cp0 \x3d cross(b - a, p0 - a);\nvec3 cp1 \x3d cross(b - a, p1 - a);\nreturn dot(cp0, cp1) \x3e\x3d 0.;\n}\nbool intersectPointTriangle(vec3 p, vec3 a, vec3 b, vec3 c) {\nreturn hasSameSide(p, a, b, c) \x26\x26 hasSameSide(p, b, a, c) \x26\x26 hasSameSide(p, c, a, b);\n}\nbool intersectCircleTriange(vec3 p, vec3 a, vec3 b, vec3 c, float radius) {\nvec2 ba \x3d b.xy - a.xy;\nvec2 ca \x3d c.xy - a.xy;\nfloat crossProduct \x3d ba.x * ca.y - ca.x * ba.y;\nbool isParallel \x3d crossProduct \x3c EPSILON_PARALLEL \x26\x26 crossProduct \x3e -EPSILON_PARALLEL;\nif (isParallel) {\nreturn false;\n}\nif (distance(p, a) \x3c\x3d radius) {\nreturn true;\n}\nif (distance(p, b) \x3c\x3d radius) {\nreturn true;\n}\nif (distance(p, c) \x3c\x3d radius) {\nreturn true;\n}\nvec3 p0 \x3d p - normalize(p - a) * radius;\nif (intersectPointTriangle(p0, a, b, c)) {\nreturn true;\n}\nvec3 p1 \x3d p - normalize(p - b) * radius;\nif (intersectPointTriangle(p1, a, b, c)) {\nreturn true;\n}\nvec3 p2 \x3d p - normalize(p - c) * radius;\nreturn intersectPointTriangle(p2, a, b, c);\n}\nvec3 hittestFill() {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * FILL_POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * FILL_POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * FILL_POSITION_PRECISION, 1.);\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3  hittestPos \x3d vec3(u_hittestPos, 1.);\nfloat hittestDist \x3d u_hittestDist;\nif (!intersectCircleTriange(hittestPos, pos, pos1, pos2, hittestDist)) {\noutTextureCoords.z +\x3d 2.0;\n}\nreturn outTextureCoords;\n}\n#endif"},
hittest:{"common.glsl":"#ifdef HITTEST\nuniform float u_hittestDist;\nuniform highp vec2 u_hittestPos;\n#endif"},icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif",
"hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nvec3 hittestMarker(vec2 size) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3  hittestPos \x3d vec3(u_hittestPos, 1.);\nfloat hittestDist \x3d u_hittestDist;\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat maxHalfSize \x3d max(size.x, size.y) / 2.;\nif (distance(pos, hittestPos) - maxHalfSize \x3e hittestDist) {\noutTextureCoords.z +\x3d 2.0;\n}\nreturn outTextureCoords;\n}\n#endif",
"icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn vec4(1.);\n}\n#elif defined(SDF)\nvec4 getColor() {\nvec2 v_size \x3d v_sizeTex.xy;\nvec2 v_tex  \x3d v_sizeTex.zw;\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\nreturn v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nreturn v_opacity * fillPixelColor;\n}\n#else\nvec4 getColor() {\nvec2 v_tex  \x3d v_sizeTex.zw;\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\nreturn v_opacity * texColor * v_color;\n}\n#endif\nvoid main()\n{\nvec4 color \x3d getColor();\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/icon/hittest.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\nvec2 outSize \x3d baseSize;\n#ifdef VV_SIZE\nfloat r \x3d getSize(referenceSize) / referenceSize;\noutSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn outSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nvec2 v_tex      \x3d a_texCoords / u_mosaicSize;\nv_color    \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_filters  \x3d getFilterFlags();\nv_pos      \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\nv_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\n#ifdef HITTEST\nvec3 pos \x3d hittestMarker(v_size.xy);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, pos, v_filters, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, v_filters, a_zoomRange), 1.0);\n#endif\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nv_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\ngl_Position \x3d vec4(v_pos, 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nbool intersectCircleLineInner(vec3 p, vec3 a, vec3 b, float radius) {\nvec3 v0 \x3d a - p;\nvec3 b2 \x3d b - p;\nvec3 v  \x3d b2 - v0;\nfloat D \x3d 4. * dot(v0, v) * dot(v0, v) - 4. * dot(v, v) * ( dot(v0, v0) - radius * radius );\nif (D \x3c 0.) {\nreturn false;\n}\nfloat sqrtD \x3d sqrt(D);\nfloat t0 \x3d (-2. * dot(v0, v) + sqrtD) / (2. * dot(v, v));\nfloat t1 \x3d (-2. * dot(v0, v) - sqrtD) / (2. * dot(v, v));\nreturn ((t0 \x3e\x3d 0. \x26\x26 t0 \x3c\x3d 1.) || (t1 \x3e\x3d 0. \x26\x26 t1 \x3c\x3d 1.));\n}\nbool intersectCircleLine(vec3 p, vec3 a, vec3 b, vec3 c, float radius) {\nreturn intersectCircleLineInner(p, a, b, radius) || intersectCircleLineInner(p, b, c, radius);\n}\nvec3 hittestLine(float halfWidth) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * POSITION_PRECISION, 1.);\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3  hittestPos \x3d vec3(u_hittestPos, 1.);\nfloat hittestDist \x3d u_hittestDist;\nif (!intersectCircleLine(hittestPos, pos, pos1, pos2, hittestDist + halfWidth)) {\noutTextureCoords.z +\x3d 2.0;\n}\nreturn outTextureCoords;\n}\n#endif",
"line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\n#ifdef HITTEST\nvoid main() {\ngl_FragColor \x3d vec4(1.);\n}\n#else\nvoid main() {\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor \x3d shadeLine(inputs);\n}\n#endif",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/line/hittest.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\n#ifdef HITTEST\nvoid draw() {\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat a_halfWidth \x3d a_accumulatedDistanceAndHalfWidth.y / 16.;\nfloat a_cimHalfWidth \x3d a_aux.x / 16. ;\nvec2  a_offset \x3d a_offsetAndNormal.xy / 16.;\nfloat baseWidth \x3d getBaseLineHalfWidth(a_halfWidth, a_cimHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\ngl_PointSize \x3d 1.;\nvec3 pos \x3d hittestLine(halfWidth);\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#else\nvoid draw()\n{\nhighp vec3 pos \x3d vec3(0.);\nLineData outputs \x3d buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              \x3d outputs.id;\nv_color           \x3d outputs.color;\nv_normal          \x3d outputs.normal;\nv_lineHalfWidth   \x3d outputs.lineHalfWidth;\nv_opacity         \x3d outputs.opacity;\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nv_tlbr          \x3d outputs.tlbr;\nv_patternSize   \x3d outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio \x3d outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position \x3d vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#endif\nvoid main() {\nINIT;\ndraw();\n}"},
shared:{line:{"common.glsl":"#if !defined(OUTLINED_FILL) \x26\x26 defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};","line.frag":"uniform lowp float u_blur;\n#if !defined(OUTLINED_FILL) \x26\x26 !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(OUTLINED_FILL)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX \x3d fract(u_pixelRatio * line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(OUTLINED_FILL)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth \x3d line.lineHalfWidth;\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * lineHalfWidth / line.patternSize.y;\nmediump float relativeTexX \x3d fract(u_pixelRatio * line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexY, relativeTexX));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(line.normal) * line.lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color \x3d getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a \x3d step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a \x3c 1.0 / 255.0) {\ndiscard;\n}\nout_color \x3d vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}",
"line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat refLineWidth \x3d 2.0 * referenceHalfWidth;\nreturn 0.5 * (lineHalfWidth / referenceHalfWidth) * getSize(refLineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat baseWidth \x3d getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(in_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef OUTLINED_FILL\nvec4  color     \x3d in_color;\nfloat opacity   \x3d 1.0;\n#else\nvec4  color     \x3d getColor(in_color, in_bitSet, 0);\nfloat opacity   \x3d getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH \x3d 15.5;\nfloat scaleDash \x3d getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio \x3d (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\nout_pos \x3d vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nvec3 hittestGlyph(in vec3 in_pos, in vec3 offset, in float fontSize) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * in_pos + u_tileMat3 * offset;\nvec3  hittestPos \x3d vec3(u_hittestPos, 1.);\nfloat hittestDist \x3d u_hittestDist;\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat halfFontSize \x3d fontSize / 2.;\nif (distance(pos, hittestPos) \x3e hittestDist + halfFontSize) {\noutTextureCoords.z +\x3d 2.0;\n}\nreturn outTextureCoords;\n}\n#endif",
"text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn vec4(1.);\n}\n#else\nvec4 getColor()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\nreturn alpha * v_color * v_opacity;\n}\n#endif\nvoid main()\n{\ngl_FragColor \x3d getColor();\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\n#include \x3cmaterials/text/hittest.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(referenceSize) / referenceSize;\nbaseSize *\x3d r;\noffset.xy *\x3d r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nv_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nv_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n#ifdef HITTEST\nvec3 pos \x3d hittestGlyph(in_pos, offset, fontSize);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n#else\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n#endif\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate \x3d getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /\x3d 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp mat3 u_tileMat3;\nuniform highp mat3 u_viewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\ngl_FragColor \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nuniform vec2 u_shadowOffset;\nuniform highp mat3 u_displayViewMat3;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_shadowOffset, 0.0);\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv - offset.xy / 2.0);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"}},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\nfloat alpha \x3d u_opacity * color.a;\ngl_FragColor \x3d vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n#ifdef LOOKUP_PROJECTION\nvec4 pv \x3d texture2D(u_transformGrid, coords);\nreturn vec2(pv.r, pv.g);\n#endif\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
flow:{"flow.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_lineColor;\nvarying float v_lineRenderWidth;\nuniform float u_time;\nuniform float u_fadeDuration;\nuniform float u_lineSpeed;\nvoid main(void) {\nvec4 color \x3d v_lineColor;\nfloat edgeWidth \x3d min(2.0 * v_lineRenderWidth - 1.0, 1.0);\nfloat edgeStart \x3d (v_lineRenderWidth - edgeWidth) / v_lineRenderWidth;\nif (edgeStart \x3c 0.95) {\nfloat s \x3d step(edgeStart, abs(v_side));\ncolor.a *\x3d (1.0 - s) + s * (1.0 - (abs(v_side) - edgeStart) / (1.0 - edgeStart));\n}\nfloat t \x3d mod(v_timeSeed * (v_totalTime + u_fadeDuration) + u_time * u_lineSpeed, v_totalTime + u_fadeDuration) - v_time;\ncolor.a *\x3d step(0.0, t) * exp(-2.3 * t / u_fadeDuration);\ncolor.rgb *\x3d color.a;\ngl_FragColor \x3d color;\n}",
"flow.vert":"precision highp float;\nattribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nattribute float a_speed;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_lineColor;\nvarying float v_lineRenderWidth;\n#define MAX_STOPS 8\n#ifdef VV_LINE_COLOR\nuniform float u_lineColor_stops[MAX_STOPS];\nuniform vec4 u_lineColor_values[MAX_STOPS];\nuniform int u_lineColor_count;\n#else\nuniform vec4 u_lineColor;\n#endif\n#ifdef VV_LINE_OPACITY\nuniform float u_lineOpacity_stops[MAX_STOPS];\nuniform float u_lineOpacity_values[MAX_STOPS];\nuniform int u_lineOpacity_count;\n#else\nuniform float u_lineOpacity;\n#endif\n#ifdef VV_LINE_RENDER_WIDTH\nuniform float u_lineRenderWidth_stops[MAX_STOPS];\nuniform float u_lineRenderWidth_values[MAX_STOPS];\nuniform int u_lineRenderWidth_count;\n#else\nuniform float u_lineRenderWidth;\n#endif\nvoid main(void) {\nfloat x \x3d a_speed;\n#ifdef VV_LINE_COLOR\nvec4 lineColor \x3d u_lineColor_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_lineColor_count) {\nbreak;\n}\nfloat x1 \x3d u_lineColor_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_lineColor_stops[i];\nvec4 y2 \x3d u_lineColor_values[i];\nif (x \x3c x2) {\nvec4 y1 \x3d u_lineColor_values[i - 1];\nlineColor \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nlineColor \x3d y2;\n}\n}\n}\n#else\nvec4 lineColor \x3d u_lineColor;\n#endif\n#ifdef VV_LINE_OPACITY\nfloat lineOpacity \x3d u_lineOpacity_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_lineOpacity_count) {\nbreak;\n}\nfloat x1 \x3d u_lineOpacity_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_lineOpacity_stops[i];\nfloat y2 \x3d u_lineOpacity_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_lineOpacity_values[i - 1];\nlineOpacity \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nlineOpacity \x3d y2;\n}\n}\n}\n#else\nfloat lineOpacity \x3d u_lineOpacity;\n#endif\n#ifdef VV_LINE_RENDER_WIDTH\nfloat lineRenderWidth \x3d u_lineRenderWidth_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_lineRenderWidth_count) {\nbreak;\n}\nfloat x1 \x3d u_lineRenderWidth_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_lineRenderWidth_stops[i];\nfloat y2 \x3d u_lineRenderWidth_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_lineRenderWidth_values[i - 1];\nlineRenderWidth \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nlineRenderWidth \x3d y2;\n}\n}\n}\n#else\nfloat lineRenderWidth \x3d u_lineRenderWidth;\n#endif\nvec2 position \x3d a_positionAndSide.xy;\nfloat side \x3d a_positionAndSide.z;\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * lineRenderWidth, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_side \x3d side;\nv_time \x3d a_timeInfo.x;\nv_totalTime \x3d a_timeInfo.y;\nv_timeSeed \x3d a_timeInfo.z;\nv_lineColor \x3d vec4(lineColor.rgb, lineColor.a * lineOpacity);\nv_lineRenderWidth \x3d lineRenderWidth;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor \x3d v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle \x3d a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle \x3d 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset \x3d vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos \x3d a_pos + offset * sizePercentage * u_symbolSize;\nv_color \x3d u_colors[int(a_vv.x)];\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_position;\ngl_Position \x3d vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},
scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor \x3d vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize \x3d 0.02;\nconst float innerRadius \x3d 0.25;\nconst float outerRadius \x3d 0.42;\nconst float innerSquareLength \x3d 0.15;\nvoid main() {\nmediump float dist \x3d length(v_pos);\nmediump float fillalpha1 \x3d smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *\x3d (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 \x3d smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *\x3d (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 \x3d (abs(v_pos.x) \x3c innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) \x3c innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor \x3d (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}",
"scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size \x3d u_symbolSize * sizePercentage;\nvec2 pos \x3d a_pos + a_offset * size;\nv_pos \x3d a_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c){return function(e){function f(){var p=e.apply(this,arguments)||this;p._color=u.fromValues(1,0,0,1);return p}t._inheritsLoose(f,e);var k=f.prototype;k.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};k.prepareState=function({context:p}){p.setBlendingEnabled(!0);p.setBlendFunctionSeparate(g.BlendFactor.ONE,g.BlendFactor.ONE_MINUS_SRC_ALPHA,g.BlendFactor.ONE,g.BlendFactor.ONE_MINUS_SRC_ALPHA);p.setColorMask(!0,!0,!0,!0);p.setStencilWriteMask(0);p.setStencilTestEnabled(!1)};k.draw=function(p,m){({context:p}=p);if(m.isReady){this._loadWGLResources(p);p.bindVAO(this._outlineVertexArrayObject);p.useProgram(this._outlineProgram);
this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",m.rangeX,m.rangeY);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);p.drawArrays(g.PrimitiveType.LINE_STRIP,0,4);var b=this._getTexture(p,m);b&&(p.bindVAO(this._tileInfoVertexArrayObject),p.useProgram(this._tileInfoProgram),p.bindTexture(b,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",
0),this._tileInfoProgram.setUniform2f("u_coord_ratio",m.rangeX/m.width,m.rangeY/m.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",b.descriptor.width,b.descriptor.height),p.drawArrays(g.PrimitiveType.TRIANGLE_STRIP,0,4));p.bindVAO()}};k._loadWGLResources=function(p){if(!this._outlineProgram||!this._tileInfoProgram){var m=d.createProgram(p,z.background),b=d.createProgram(p,y.tileInfo),h=new Int8Array([0,0,1,0,1,1,0,1]);h=l.BufferObject.createVertex(p,
g.Usage.STATIC_DRAW,h);h=new c.VertexArrayObject(p,z.background.attributes,B.Pos2b,{geometry:h});var n=new Int8Array([0,0,1,0,0,1,1,1]);n=l.BufferObject.createVertex(p,g.Usage.STATIC_DRAW,n);p=new c.VertexArrayObject(p,y.tileInfo.attributes,B.Pos2b,{geometry:n});this._outlineProgram=m;this._tileInfoProgram=b;this._outlineVertexArrayObject=h;this._tileInfoVertexArrayObject=p}};k._getTexture=function(p,m){if(m.texture&&m.triangleCountReportedInDebug===m.triangleCount)return m.texture;m.triangleCountReportedInDebug=
m.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const b=m.triangleCount;let h=m.key.id;0<m.triangleCount&&(h+=`, ${b}`);const n=this._canvas,r=n.getContext("2d");r.font="24px sans-serif";r.textAlign="left";r.textBaseline="top";r.clearRect(0,0,300,32);1E5<b?(r.fillStyle="red",r.fillRect(0,0,300,32),
r.fillStyle="black"):(r.clearRect(0,0,300,32),r.fillStyle="blue");r.fillText(h,0,0);m.texture=new a.Texture(p,{target:g.TextureType.TEXTURE_2D,pixelFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,samplingMode:g.TextureSamplingMode.NEAREST,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE},n);return m.texture};return f}(D)})},"esri/views/2d/engine/webgl/DefaultVertexAttributeLayouts":function(){define(["exports","../../../webgl/enums","../../../webgl/VertexElementDescriptor"],function(t,u,B){const D=
{geometry:[new B.VertexElementDescriptor("a_pos",2,u.DataType.BYTE,0,2)]},z={geometry:[new B.VertexElementDescriptor("a_pos",2,u.DataType.BYTE,0,4),new B.VertexElementDescriptor("a_tex",2,u.DataType.BYTE,2,4)]};u={geometry:[new B.VertexElementDescriptor("a_pos",2,u.DataType.UNSIGNED_SHORT,0,4)]};t.Pos2b=D;t.Pos2us=u;t.PosTex2b=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(t,u){u=
{shaders:{vertexShader:u.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:u.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};t.tileInfo=u;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/VertexArrayObject".split(" "),
function(t,u,B,D,z,y,l,g,d){return function(a){function c(){var f=a.apply(this,arguments)||this;f._color=u.fromValues(1,0,0,1);f._initialized=!1;return f}t._inheritsLoose(c,a);var e=c.prototype;e.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};e.prepareState=function({context:f},k){f.setDepthWriteEnabled(!1);f.setDepthTestEnabled(!1);f.setStencilTestEnabled(!0);
f.setBlendingEnabled(!1);f.setColorMask(!1,!1,!1,!1);f.setStencilOp(l.StencilOperation.KEEP,l.StencilOperation.KEEP,l.StencilOperation.REPLACE);f.setStencilWriteMask(255);f.setStencilFunctionSeparate(l.Face.FRONT_AND_BACK,l.CompareFunction.GREATER,k.stencilRef,255)};e.draw=function(f,k){({context:f}=f);this._initialized||this._initialize(f);f.bindVAO(this._solidVertexArrayObject);f.useProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",k.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",
[k.rangeX,k.rangeY]);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);f.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,4);f.bindVAO()};e._initialize=function(f){if(this._initialized)return!0;const k=g.createProgram(f,z.background);if(!k)return!1;var p=new Int8Array([0,0,1,0,0,1,1,1]);p=y.BufferObject.createVertex(f,l.Usage.STATIC_DRAW,p);f=new d.VertexArrayObject(f,z.background.attributes,B.Pos2b,{geometry:p});this._solidProgram=k;this._solidVertexArrayObject=
f;return this._initialized=!0};return c}(D)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../definitions ../enums ../number ./WGLBrush ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject".split(" "),function(t,u,B,D,z,y,l,g,d,a,c,e,f){a=function(k){function p(){var b=
k.apply(this,arguments)||this;b._color=y.fromValues(1,0,0,1);b._patternMatrix=z.create();b._programOptions={id:!1,pattern:!1};return b}u._inheritsLoose(p,k);var m=p.prototype;m.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};m.drawMany=function(b,h){const {context:n,painter:r,styleLayerUID:x}=b;this._loadWGLResources(b);const q=b.displayLevel;var A=b.styleLayer,E=A.backgroundMaterial;const F=r.vectorTilesMaterialManager;var w=A.getPaintValue("background-color",q);const v=A.getPaintValue("background-opacity",
q),C=A.getPaintValue("background-pattern",q),G=void 0!==C,H=w[3]*v,L=b.spriteMosaic;let O,N;const K=(window.devicePixelRatio|1)>l.VTL_HIGH_RES_CUTOFF?2:1;b=b.drawPhase===g.WGLDrawPhase.HITTEST;const I=this._programOptions;I.id=b;I.pattern=G;E=F.getMaterialProgram(n,E,I);n.bindVAO(this._vao);n.useProgram(E);if(G){w=L.getMosaicItemPosition(C,!0);if(D.isSome(w)){const {tl:M,br:U,page:T}=w;O=U[0]-M[0];N=U[1]-M[1];w=L.getPageSize(T);D.isSome(w)&&(L.bind(n,e.TextureSamplingMode.LINEAR,T,l.VTL_TEXTURE_BINDING_UNIT_SPRITES),
E.setUniform4f("u_tlbr",M[0],M[1],U[0],U[1]),E.setUniform2fv("u_mosaicSize",w),E.setUniform1i("u_texture",l.VTL_TEXTURE_BINDING_UNIT_SPRITES))}E.setUniform1f("u_opacity",v)}else this._color[0]=H*w[0],this._color[1]=H*w[1],this._color[2]=H*w[2],this._color[3]=H,E.setUniform4fv("u_color",this._color);E.setUniform1f("u_depth",A.z||0);b&&(A=d.u32to4Xu8(x+1),E.setUniform4fv("u_id",A));for(const M of h)E.setUniform1f("u_coord_range",M.rangeX),E.setUniformMatrix3fv("u_dvsMat3",M.transforms.dvs),G&&(A=K*
M.width*Math.max(2**(Math.round(q)-M.key.level),1),h=A/B.nextPowerOfTwo(O),A/=B.nextPowerOfTwo(N),this._patternMatrix[0]=h,this._patternMatrix[4]=A,E.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),n.setStencilFunction(e.CompareFunction.EQUAL,M.stencilRef,255),n.drawArrays(e.PrimitiveType.TRIANGLE_STRIP,0,4)};m._loadWGLResources=function(b){if(!this._vao){var {context:h,styleLayer:n}=b;b=n.backgroundMaterial;var r=new Int8Array([0,0,1,0,0,1,1,1]);r=c.BufferObject.createVertex(h,e.Usage.STATIC_DRAW,
r);this._vao=new f.VertexArrayObject(h,b.getAttributeLocations(),b.getLayoutInfo(),{geometry:r})}};return p}(a);t.WGLBrushVTLBackground=a;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),function(t,u,B,D,z,y,l,g){l=function(d){function a(){var e=
d.apply(this,arguments)||this;e._programOptions={id:!1};return e}u._inheritsLoose(a,d);var c=a.prototype;c.dispose=function(){};c.drawMany=function(e,f){const {context:k,displayLevel:p,requiredLevel:m,state:b,drawPhase:h,painter:n,spriteMosaic:r,styleLayerUID:x}=e;if(f.some(C=>{var G,H;return null!=(G=null==(H=C.layerData.get(x))?void 0:H.circleIndexCount)?G:!1})){e=e.styleLayer;var q=e.circleMaterial,A=n.vectorTilesMaterialManager,E=e.getPaintValue("circle-translate",p),F=e.getPaintValue("circle-translate-anchor",
p),w=h===z.WGLDrawPhase.HITTEST,v=this._programOptions;v.id=w;A=A.getMaterialProgram(k,q,v);k.useProgram(A);A.setUniformMatrix3fv("u_displayMat3",F===D.TranslateAnchor.VIEWPORT?b.displayMat3:b.displayViewMat3);A.setUniform2fv("u_circleTranslation",E);A.setUniform1f("u_depth",e.z);A.setUniform1f("u_antialiasingWidth",1.2);E=-1;w&&(w=y.u32to4Xu8(x+1),A.setUniform4fv("u_id",w));for(const C of f)C.layerData.has(x)&&(C.key.level!==E&&(E=C.key.level,q.setDataUniforms(A,p,e,E,r)),f=C.layerData.get(x),f.circleIndexCount&&
(f.prepareForRendering(k),w=f.circleVertexArrayObject,B.isNone(w)||(k.bindVAO(w),A.setUniformMatrix3fv("u_dvsMat3",C.transforms.dvs),m!==C.key.level?k.setStencilFunction(g.CompareFunction.EQUAL,C.stencilRef,255):k.setStencilFunction(g.CompareFunction.GREATER,255,255),k.drawElements(g.PrimitiveType.TRIANGLES,f.circleIndexCount,g.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*f.circleIndexStart),C.triangleCount+=f.circleIndexCount/3)))}};return a}(l);t.WGLBrushVTLCircle=l;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports","../../../../../symbols/cim/enums"],function(t,u){t.StyleLayerType=void 0;(function(D){D[D.BACKGROUND=0]="BACKGROUND";D[D.FILL=1]="FILL";D[D.LINE=2]="LINE";D[D.SYMBOL=3]="SYMBOL";D[D.CIRCLE=4]="CIRCLE"})(t.StyleLayerType||(t.StyleLayerType={}));t.Visibility=void 0;(function(D){D[D.VISIBLE=0]="VISIBLE";D[D.NONE=1]="NONE"})(t.Visibility||(t.Visibility={}));t.SymbolPlacement=void 0;(function(D){D[D.POINT=
0]="POINT";D[D.LINE=1]="LINE";D[D.LINE_CENTER=2]="LINE_CENTER"})(t.SymbolPlacement||(t.SymbolPlacement={}));t.RotationAlignment=void 0;(function(D){D[D.MAP=0]="MAP";D[D.VIEWPORT=1]="VIEWPORT";D[D.AUTO=2]="AUTO"})(t.RotationAlignment||(t.RotationAlignment={}));t.TextJustification=void 0;(function(D){D[D.AUTO=0]="AUTO";D[D.LEFT=1]="LEFT";D[D.CENTER=2]="CENTER";D[D.RIGHT=3]="RIGHT"})(t.TextJustification||(t.TextJustification={}));t.SymbolAnchor=void 0;(function(D){D[D.CENTER=0]="CENTER";D[D.LEFT=1]=
"LEFT";D[D.RIGHT=2]="RIGHT";D[D.TOP=3]="TOP";D[D.BOTTOM=4]="BOTTOM";D[D.TOP_LEFT=5]="TOP_LEFT";D[D.TOP_RIGHT=6]="TOP_RIGHT";D[D.BOTTOM_LEFT=7]="BOTTOM_LEFT";D[D.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(t.SymbolAnchor||(t.SymbolAnchor={}));t.TextTransform=void 0;(function(D){D[D.NONE=0]="NONE";D[D.UPPERCASE=1]="UPPERCASE";D[D.LOWERCASE=2]="LOWERCASE"})(t.TextTransform||(t.TextTransform={}));t.TranslateAnchor=void 0;(function(D){D[D.MAP=0]="MAP";D[D.VIEWPORT=1]="VIEWPORT"})(t.TranslateAnchor||(t.TranslateAnchor=
{}));t.TextWritingMode=void 0;(function(D){D[D.HORIZONTAL=0]="HORIZONTAL";D[D.VERTICAL=1]="VERTICAL"})(t.TextWritingMode||(t.TextWritingMode={}));let B=function(){};B.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:t.Visibility.VISIBLE}};B.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:t.Visibility.VISIBLE}};B.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:t.Visibility.VISIBLE},"line-cap":{type:"enum",
values:["butt","round","square"],default:u.CapType.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:u.JoinType.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};B.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:t.Visibility.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:t.SymbolPlacement.POINT},"symbol-sort-key":{type:"number",
default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:t.SymbolAnchor.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},
"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:t.RotationAlignment.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:t.SymbolAnchor.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",
default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:t.TextJustification.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",
length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:t.RotationAlignment.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:t.TextTransform.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[t.TextWritingMode.HORIZONTAL]}};
B.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:t.Visibility.VISIBLE}};B.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};B.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",
default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:t.TranslateAnchor.MAP}};B.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",
minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:t.TranslateAnchor.MAP},"line-width":{type:"number",minimum:0,default:1}};B.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},
"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:t.TranslateAnchor.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",
value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:t.TranslateAnchor.MAP}};B.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",
minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};B.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,
default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:t.TranslateAnchor.MAP}};t.StyleDefinition=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(t,u,B,D,z,y,l,g,d){const a=1/65536;g=function(c){function e(){var k=c.apply(this,arguments)||this;k._fillProgramOptions={id:!1,pattern:!1};k._outlineProgramOptions={id:!1};return k}u._inheritsLoose(e,c);var f=e.prototype;f.dispose=function(){};f.drawMany=function(k,p){const {displayLevel:m,drawPhase:b,renderPass:h,spriteMosaic:n,styleLayerUID:r}=k;var x=!1;for(var q of p)if(q.layerData.has(r)){var A=q.layerData.get(r);if(0<A.fillIndexCount||0<A.outlineIndexCount){x=!0;break}}if(x){x=k.styleLayer;
var E=x.getPaintProperty("fill-pattern");A=(q=void 0!==E)&&E.isDataDriven;if(q&&!A){var F=E.getValue(m);F=n.getMosaicItemPosition(F,!0)}E=!q&&x.getPaintValue("fill-antialias",m);var w=!0,v=1;if(!q){var C=x.getPaintProperty("fill-color"),G=x.getPaintProperty("fill-opacity");null!=C&&C.isDataDriven||null!=G&&G.isDataDriven||(v=x.getPaintValue("fill-color",m),v=x.getPaintValue("fill-opacity",m)*v[3],1<=v&&(w=!1))}if(!w||"opaque"!==h){var H;b===y.WGLDrawPhase.HITTEST&&(H=l.u32to4Xu8(r+1));C=x.getPaintValue("fill-translate",
m);G=x.getPaintValue("fill-translate-anchor",m);(w||"translucent"!==h)&&this._drawFill(k,r,x,p,C,G,q,F,A,H);F=!x.hasDataDrivenOutlineColor&&x.outlineUsesFillColor&&1>v;E&&"opaque"!==h&&!F&&this._drawOutline(k,r,x,p,C,G,H)}}};f._drawFill=function(k,p,m,b,h,n,r,x,q,A){if(!r||q||!B.isNone(x)){var {context:E,displayLevel:F,state:w,drawPhase:v,painter:C,pixelRatio:G,spriteMosaic:H}=k;k=m.fillMaterial;var L=C.vectorTilesMaterialManager,O=G>z.VTL_HIGH_RES_CUTOFF?2:1,N=v===y.WGLDrawPhase.HITTEST,K=this._fillProgramOptions;
K.id=N;K.pattern=r;L=L.getMaterialProgram(E,k,K);E.useProgram(L);B.isSome(x)&&({page:x}=x,K=H.getPageSize(x),B.isSome(K)&&(H.bind(E,d.TextureSamplingMode.LINEAR,x,z.VTL_TEXTURE_BINDING_UNIT_SPRITES),L.setUniform2fv("u_mosaicSize",K),L.setUniform1i("u_texture",z.VTL_TEXTURE_BINDING_UNIT_SPRITES)));L.setUniformMatrix3fv("u_displayMat3",n===D.TranslateAnchor.VIEWPORT?w.displayMat3:w.displayViewMat3);L.setUniform2fv("u_fillTranslation",h);L.setUniform1f("u_depth",m.z+a);N&&L.setUniform4fv("u_id",A);h=
-1;for(const I of b)if(I.layerData.has(p)&&(I.key.level!==h&&(h=I.key.level,k.setDataUniforms(L,F,m,h,H)),b=I.layerData.get(p),b.fillIndexCount&&(b.prepareForRendering(E),n=b.fillVertexArrayObject,!B.isNone(n)))){E.bindVAO(n);L.setUniformMatrix3fv("u_dvsMat3",I.transforms.dvs);E.setStencilFunction(d.CompareFunction.EQUAL,I.stencilRef,255);r&&L.setUniform1f("u_patternFactor",I.rangeX/(O*I.width*Math.max(2**(Math.round(F)-I.key.level),1)));if(q){n=b.patternMap;if(!n)continue;for(const [M,U]of n)n=H.getPageSize(M),
B.isSome(n)&&(H.bind(E,d.TextureSamplingMode.LINEAR,M,z.VTL_TEXTURE_BINDING_UNIT_SPRITES),L.setUniform2fv("u_mosaicSize",n),L.setUniform1i("u_texture",z.VTL_TEXTURE_BINDING_UNIT_SPRITES),E.drawElements(d.PrimitiveType.TRIANGLES,U[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*U[0]))}else E.drawElements(d.PrimitiveType.TRIANGLES,b.fillIndexCount,d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*b.fillIndexStart);I.triangleCount+=b.fillIndexCount/3}}};f._drawOutline=function(k,p,m,b,h,
n,r){const {context:x,displayLevel:q,state:A,drawPhase:E,painter:F,pixelRatio:w,spriteMosaic:v}=k;k=m.outlineMaterial;var C=F.vectorTilesMaterialManager;const G=.75/w,H=E===y.WGLDrawPhase.HITTEST,L=this._outlineProgramOptions;L.id=H;C=C.getMaterialProgram(x,k,L);x.useProgram(C);C.setUniformMatrix3fv("u_displayMat3",n===D.TranslateAnchor.VIEWPORT?A.displayMat3:A.displayViewMat3);C.setUniform2fv("u_fillTranslation",h);C.setUniform1f("u_depth",m.z+a);C.setUniform1f("u_outline_width",G);H&&C.setUniform4fv("u_id",
r);h=-1;for(const O of b)O.layerData.has(p)&&(O.key.level!==h&&(h=O.key.level,k.setDataUniforms(C,q,m,h,v)),b=O.layerData.get(p),b.prepareForRendering(x),b.outlineIndexCount&&(n=b.outlineVertexArrayObject,B.isNone(n)||(x.bindVAO(n),C.setUniformMatrix3fv("u_dvsMat3",O.transforms.dvs),x.setStencilFunction(d.CompareFunction.EQUAL,O.stencilRef,255),x.drawElements(d.PrimitiveType.TRIANGLES,b.outlineIndexCount,d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*b.outlineIndexStart),O.triangleCount+=b.outlineIndexCount/
3)))};return e}(g);t.WGLBrushVTLFill=g;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),function(t,u,B,D,z,y,l,g,d){g=function(a){function c(){var f=a.apply(this,arguments)||this;f._programOptions={id:!1,pattern:!1,sdf:!1};
return f}u._inheritsLoose(c,a);var e=c.prototype;e.dispose=function(){};e.drawMany=function(f,k){const {context:p,displayLevel:m,state:b,drawPhase:h,painter:n,pixelRatio:r,spriteMosaic:x,styleLayerUID:q}=f;if(k.some(I=>{var M,U;return null!=(M=null==(U=I.layerData.get(q))?void 0:U.lineIndexCount)?M:!1})){f=f.styleLayer;var A=f.lineMaterial,E=n.vectorTilesMaterialManager,F=f.getPaintValue("line-translate",m),w=f.getPaintValue("line-translate-anchor",m),v=f.getPaintProperty("line-pattern"),C=void 0!==
v,G=C&&v.isDataDriven;if(C&&!G){v=v.getValue(m);var H=x.getMosaicItemPosition(v)}var L;v=!1;if(!C){var O=f.getPaintProperty("line-dasharray");v=(L=void 0!==O)&&O.isDataDriven;L&&!v&&(H=O.getValue(m),H=f.getDashKey(H,f.getLayoutValue("line-cap",m)),H=x.getMosaicItemPosition(H))}O=1/r;var N=h===y.WGLDrawPhase.HITTEST,K=this._programOptions;K.id=N;K.pattern=C;K.sdf=L;L=E.getMaterialProgram(p,A,K);p.useProgram(L);L.setUniformMatrix3fv("u_displayViewMat3",b.displayViewMat3);L.setUniformMatrix3fv("u_displayMat3",
w===D.TranslateAnchor.VIEWPORT?b.displayMat3:b.displayViewMat3);L.setUniform2fv("u_lineTranslation",F);L.setUniform1f("u_depth",f.z);L.setUniform1f("u_antialiasing",O);N&&(F=l.u32to4Xu8(q+1),L.setUniform4fv("u_id",F));H&&B.isSome(H)&&({page:F}=H,w=x.getPageSize(F),B.isSome(w)&&(x.bind(p,d.TextureSamplingMode.LINEAR,F,z.VTL_TEXTURE_BINDING_UNIT_SPRITES),L.setUniform2fv("u_mosaicSize",w),L.setUniform1i("u_texture",z.VTL_TEXTURE_BINDING_UNIT_SPRITES)));F=-1;for(const I of k)if(I.layerData.has(q)&&(I.key.level!==
F&&(F=I.key.level,A.setDataUniforms(L,m,f,F,x)),L.setUniform1f("u_zoomFactor",2**(m-F)/r),k=I.layerData.get(q),k.lineIndexCount&&(k.prepareForRendering(p),w=k.lineVertexArrayObject,!B.isNone(w)))){p.bindVAO(w);L.setUniformMatrix3fv("u_dvsMat3",I.transforms.dvs);p.setStencilFunction(d.CompareFunction.EQUAL,I.stencilRef,255);if(G||v){w=k.patternMap;if(!w)continue;for(const [M,U]of w)w=x.getPageSize(M),B.isSome(w)&&(x.bind(p,d.TextureSamplingMode.LINEAR,M,z.VTL_TEXTURE_BINDING_UNIT_SPRITES),L.setUniform2fv("u_mosaicSize",
w),L.setUniform1i("u_texture",z.VTL_TEXTURE_BINDING_UNIT_SPRITES),p.drawElements(d.PrimitiveType.TRIANGLES,U[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*U[0]))}else p.drawElements(d.PrimitiveType.TRIANGLES,k.lineIndexCount,d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*k.lineIndexStart);I.triangleCount+=k.lineIndexCount/3}}};return c}(g);t.WGLBrushVTLLine=g;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../GeometryUtils ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e){const f=1/65536;c=function(k){function p(){var b=k.apply(this,arguments)||this;b._iconProgramOptions={id:!1,sdf:!1};b._sdfProgramOptions={id:!1};b._spritesTextureSize=D.create();return b}u._inheritsLoose(p,k);var m=p.prototype;m.dispose=function(){};m.drawMany=function(b,h){const {drawPhase:n,styleLayerUID:r}=b,x=b.styleLayer;let q;n===g.WGLDrawPhase.HITTEST&&(q=a.u32to4Xu8(r+1));this._drawIcons(b,x,h,q);this._drawText(b,x,h,q)};m._drawIcons=function(b,h,n,r){const {context:x,
displayLevel:q,drawPhase:A,painter:E,spriteMosaic:F,state:w,styleLayerUID:v}=b,C=h.iconMaterial;var G=E.vectorTilesMaterialManager,H=!1;for(var L of n)if(L.layerData.has(v)){var O=L.layerData.get(v);if(0<O.iconPerPageElementsMap.size){H=!0;break}}if(H){H=h.getPaintValue("icon-translate",q);L=h.getPaintValue("icon-translate-anchor",q);var N=h.getLayoutValue("icon-rotation-alignment",q);N===y.RotationAlignment.AUTO&&(N=h.getLayoutValue("symbol-placement",q)===y.SymbolPlacement.POINT?y.RotationAlignment.VIEWPORT:
y.RotationAlignment.MAP);var K=N===y.RotationAlignment.MAP;K=h.getLayoutValue("icon-keep-upright",q)&&K;var I=O.isIconSDF;O=A===g.WGLDrawPhase.HITTEST;var M=this._iconProgramOptions;M.id=O;M.sdf=I;G=G.getMaterialProgram(x,C,M);x.useProgram(G);G.setUniformMatrix3fv("u_displayViewMat3",N===y.RotationAlignment.MAP?w.displayViewMat3:w.displayMat3);G.setUniformMatrix3fv("u_displayMat3",L===y.TranslateAnchor.VIEWPORT?w.displayMat3:w.displayViewMat3);G.setUniform2fv("u_iconTranslation",H);G.setUniform1f("u_depth",
h.z);G.setUniform1f("u_mapRotation",d.degToByte(w.rotation));G.setUniform1f("u_keepUpright",K?1:0);G.setUniform1f("u_level",10*q);G.setUniform1i("u_texture",l.VTL_TEXTURE_BINDING_UNIT_SPRITES);G.setUniform1f("u_fadeDuration",z.FADE_DURATION/1E3);O&&G.setUniform4fv("u_id",r);r=-1;for(const U of n)if(U.layerData.has(v)&&(U.key.level!==r&&(r=U.key.level,C.setDataUniforms(G,q,h,r,F)),O=U.layerData.get(v),0!==O.iconPerPageElementsMap.size&&(O.prepareForRendering(x),O.updateOpacityInfo(),n=O.iconVertexArrayObject,
!B.isNone(n)))){x.bindVAO(n);G.setUniformMatrix3fv("u_dvsMat3",U.transforms.dvs);G.setUniform1f("u_time",(performance.now()-O.lastOpacityUpdate)/1E3);for(const [T,Q]of O.iconPerPageElementsMap)this._renderIconRange(b,G,Q,T,U)}}};m._renderIconRange=function(b,h,n,r,x){const {context:q,spriteMosaic:A}=b;this._spritesTextureSize[0]=A.getWidth(r)/4;this._spritesTextureSize[1]=A.getHeight(r)/4;h.setUniform2fv("u_mosaicSize",this._spritesTextureSize);A.bind(q,e.TextureSamplingMode.LINEAR,r,l.VTL_TEXTURE_BINDING_UNIT_SPRITES);
q.setStencilTestEnabled(!0);q.setStencilFunction(e.CompareFunction.GREATER,255,255);q.setStencilWriteMask(0);q.drawElements(e.PrimitiveType.TRIANGLES,n[1],e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*n[0]);x.triangleCount+=n[1]/3};m._drawText=function(b,h,n,r){const {context:x,displayLevel:q,drawPhase:A,glyphMosaic:E,painter:F,pixelRatio:w,spriteMosaic:v,state:C,styleLayerUID:G}=b;b=h.textMaterial;const H=F.vectorTilesMaterialManager;var L=!1;for(var O of n)if(O.layerData.has(G)){var N=O.layerData.get(G);
if(0<N.glyphPerPageElementsMap.size){L=!0;break}}if(L&&(N=h.getPaintProperty("text-opacity"),!N||N.isDataDriven||0!==N.getValue(q))){N=h.getPaintProperty("text-color");var K=!N||N.isDataDriven||0<N.getValue(q)[3];N=h.getPaintProperty("text-halo-width");O=h.getPaintProperty("text-halo-color");var I=(!N||N.isDataDriven||0<N.getValue(q))&&(!O||O.isDataDriven||0<O.getValue(q)[3]);if(K||I){N=h.getLayoutValue("text-rotation-alignment",q);N===y.RotationAlignment.AUTO&&(N=h.getLayoutValue("symbol-placement",
q)===y.SymbolPlacement.POINT?y.RotationAlignment.VIEWPORT:y.RotationAlignment.MAP);O=N===y.RotationAlignment.MAP;O=h.getLayoutValue("text-keep-upright",q)&&O;L=A===g.WGLDrawPhase.HITTEST;var M=.8*3/w;this._glyphTextureSize||(this._glyphTextureSize=D.fromValues(E.width/4,E.height/4));var U=h.getPaintValue("text-translate",q),T=h.getPaintValue("text-translate-anchor",q),Q=this._sdfProgramOptions;Q.id=L;var J=H.getMaterialProgram(x,b,Q);x.useProgram(J);J.setUniformMatrix3fv("u_displayViewMat3",N===y.RotationAlignment.MAP?
C.displayViewMat3:C.displayMat3);J.setUniformMatrix3fv("u_displayMat3",T===y.TranslateAnchor.VIEWPORT?C.displayMat3:C.displayViewMat3);J.setUniform2fv("u_textTranslation",U);J.setUniform1f("u_depth",h.z+f);J.setUniform2fv("u_mosaicSize",this._glyphTextureSize);J.setUniform1f("u_mapRotation",d.degToByte(C.rotation));J.setUniform1f("u_keepUpright",O?1:0);J.setUniform1f("u_level",10*q);J.setUniform1i("u_texture",l.VTL_TEXTURE_BINDING_UNIT_GLYPHS);J.setUniform1f("u_antialiasingWidth",M);J.setUniform1f("u_fadeDuration",
z.FADE_DURATION/1E3);L&&J.setUniform4fv("u_id",r);r=-1;for(const P of n)P.layerData.has(G)&&(P.key.level!==r&&(r=P.key.level,b.setDataUniforms(J,q,h,r,v)),N=P.layerData.get(G),0!==N.glyphPerPageElementsMap.size&&(N.prepareForRendering(x),N.updateOpacityInfo(),n=N.textVertexArrayObject,B.isNone(n)||(x.bindVAO(n),J.setUniformMatrix3fv("u_dvsMat3",P.transforms.dvs),x.setStencilTestEnabled(!0),x.setStencilFunction(e.CompareFunction.GREATER,255,255),x.setStencilWriteMask(0),n=(performance.now()-N.lastOpacityUpdate)/
1E3,J.setUniform1f("u_time",n),N.glyphPerPageElementsMap.forEach((S,W)=>{this._renderGlyphRange(x,S,W,E,J,I,K,P)}))))}}};m._renderGlyphRange=function(b,h,n,r,x,q,A,E){r.bind(b,e.TextureSamplingMode.LINEAR,n,l.VTL_TEXTURE_BINDING_UNIT_GLYPHS);q&&(x.setUniform1f("u_halo",1),b.drawElements(e.PrimitiveType.TRIANGLES,h[1],e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*h[0]),E.triangleCount+=h[1]/3);A&&(x.setUniform1f("u_halo",0),b.drawElements(e.PrimitiveType.TRIANGLES,h[1],e.DataType.UNSIGNED_INT,
Uint32Array.BYTES_PER_ELEMENT*h[0]),E.triangleCount+=h[1]/3)};return p}(c);t.WGLBrushVTLSymbol=c;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(t){t.COLLISION_GRID_CELL_SIZE=32;t.DECLUTTER_BUDGET=1.5;t.DECLUTTER_TILES=!0;t.FADE_DURATION=200;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(t){function u(g,d){g%=d;return 0<=
g?g:g+d}const B=Number.POSITIVE_INFINITY,D=Math.PI,z=128/D,y=256/360,l=1/Math.LN2;t.C_256_TO_RAD=D/128;t.C_2PI=2*D;t.C_DEG_TO_256=y;t.C_DEG_TO_RAD=D/180;t.C_INFINITY=B;t.C_PI=D;t.C_PI_BY_2=D/2;t.C_RAD_TO_256=z;t.C_SQRT2=1.414213562;t.C_SQRT2_INV=1/1.414213562;t.between=function(g,d,a){return g>=d&&g<=a||g>=a&&g<=d};t.degToByte=function(g){return u(g*y,256)};t.interpolate=function(g,d,a){return g*(1-a)+d*a};t.log2=function(g){return Math.log(g)*l};t.positiveMod=u;t.radToByte=function(g){return u(g*
z,256)};t.sqr=function(g){return g*g};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../core/RandomLCG ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/Renderbuffer ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k){return function(p){function m(){var h=p.apply(this,arguments)||this;h._dotTextureSize=0;h._dotTextures=null;h._dotSamplers=new Int32Array([D.TEXTURE_BINDING_RENDERER_0,D.TEXTURE_BINDING_RENDERER_1]);h._dotVAO=null;h._dotDesc={vsPath:"dot/dot",fsPath:"dot/dot",attributes:new Map([["a_pos",0]])};return h}t._inheritsLoose(m,p);var b=m.prototype;b.dispose=function(){this._disposeTextures();this._dotFBO=u.disposeMaybe(this._dotFBO);this._dotVAO=u.disposeMaybe(this._dotVAO)};
b.getGeometryType=function(){return z.WGLGeometryType.FILL};b.drawGeometry=function(h,n,r,x){const {context:q,painter:A,rendererInfo:E,requiredLevel:F,passOptions:w}=h;var v=g.FillMaterialKey.load(r.materialKey),C=A.materialManager;let G=a.PrimitiveType.TRIANGLES;var H={geometry:[{location:0,name:"a_pos",count:2,type:a.DataType.SHORT},{location:1,name:"a_id",count:3,type:a.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:a.DataType.UNSIGNED_BYTE}]};v.dotDensity?H.geometry.push({location:3,
name:"a_inverseArea",count:1,type:a.DataType.FLOAT}):(H.geometry.push({location:3,name:"a_color",count:4,type:a.DataType.UNSIGNED_BYTE,normalized:!0}),v.simple||H.geometry.push({location:4,name:"a_aux1",count:4,type:a.DataType.UNSIGNED_SHORT}),H.geometry.push({location:5,name:"a_aux2",count:4,type:a.DataType.UNSIGNED_BYTE},{location:6,name:"a_aux3",count:4,type:a.DataType.UNSIGNED_BYTE}),v.simple||H.geometry.push({location:7,name:"a_zoomRange",count:2,type:a.DataType.UNSIGNED_SHORT}));H=y.createProgramDescriptor(v.data,
H);u.isSome(w)&&"hittest"===w.type&&(H=this._getTriangleDesc(r.materialKey,H),G=a.PrimitiveType.POINTS);const {attributes:L,bufferLayouts:O}=H;x=C.getMaterialProgram(h,v,"materials/fill",L,x);q.useProgram(x);this._setSharedUniforms(x,h,n);x.setUniform2f("u_tileOffset",512*n.key.col,512*n.key.row);v.textureBinding&&(A.textureManager.bindTextures(q,x,v),x.setUniform1f("u_zoomFactor",1/2**(F-n.key.level)/h.pixelRatio));C=1/h.pixelRatio;x.setUniform1f("u_blur",C);x.setUniform1f("u_antialiasing",C);this._setSizeVVUniforms(v,
x,E,n);this._setColorAndOpacityVVUniforms(v,x,E);C=u.isSome(w)&&"hittest"===w.type;H=r.target.getVAO(q,O,L,C);let N=r.indexCount;r=r.indexFrom*Uint32Array.BYTES_PER_ELEMENT;C&&(N/=3,r/=3);q.bindVAO(H);v.dotDensity&&!C?(v=this._drawDotLocations(h,n,x,N,r),this._drawDotDensity(h,n,v)):q.drawElements(G,N,a.DataType.UNSIGNED_INT,r)};b._drawDotDensity=function(h,n,r){const {context:x,painter:q,rendererInfo:A}=h,E=q.materialManager.getProgram(h,this._dotDesc),F=this._createDotDensityMesh(x,this._dotDesc.attributes,
{geometry:[{name:"a_pos",count:2,type:a.DataType.SHORT,divisor:0,normalized:!1,offset:0,stride:4}]});x.setStencilTestEnabled(!0);x.useProgram(E);E.setUniform1f("u_tileZoomFactor",1);E.setUniform1i("u_texture",this._dotSamplers[0]);E.setUniform1f("u_dotSize",Math.max(A.ddDotSize,1));E.setUniform1f("u_pixelRatio",window.devicePixelRatio);this._setSharedUniforms(E,h,n);x.bindTexture(r,this._dotSamplers[0]);x.bindVAO(F);x.drawArrays(a.PrimitiveType.POINTS,0,262144)};b._drawDotLocations=function(h,n,r,
x,q){const {context:A,rendererInfo:E,requiredLevel:F}=h,w=A.getViewport();A.setViewport(0,0,512,512);const v=A.getBoundFramebufferObject(),C=this._createFBO(A);A.bindFramebuffer(C);A.setClearColor(0,0,0,0);A.clear(A.gl.COLOR_BUFFER_BIT|A.gl.STENCIL_BUFFER_BIT);A.setStencilTestEnabled(!1);n=1/2**(F-n.key.level);const G=D.TILE_SIZE,H=G*window.devicePixelRatio*G*window.devicePixelRatio,L=1/n*(1/n);h=E.ddDotScale?h.state.scale/E.ddDotScale:1;r.setUniform1f("u_tileZoomFactor",n);r.setUniform1f("u_tileDotsOverArea",
H/(D.TILE_SIZE*window.devicePixelRatio*D.TILE_SIZE*window.devicePixelRatio));r.setUniformMatrix4fv("u_dotColors",E.ddColors);r.setUniform4fv("u_isActive",E.ddActiveDots);r.setUniform4fv("u_dotBackgroundColor",E.ddBackgroundColor);r.setUniform1f("u_dotValue",Math.max(1,E.ddDotValue*h*L));this._bindDotDensityTextures(A,r,E,G);A.drawElements(a.PrimitiveType.TRIANGLES,x,a.DataType.UNSIGNED_INT,q);A.setViewport(w.x,w.y,w.width,w.height);A.bindFramebuffer(v);return C.colorTexture};b._createFBO=function(h){if(u.isNone(this._dotFBO)){const n=
{target:a.TextureType.TEXTURE_2D,pixelFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,samplingMode:a.TextureSamplingMode.NEAREST,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,width:512,height:512},r={colorTarget:a.TargetType.TEXTURE,depthStencilTarget:a.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},x=new e.Renderbuffer(h,{width:512,height:512,internalFormat:a.RenderbufferFormat.DEPTH_STENCIL});this._dotFBO=new c.FramebufferObject(h,r,n,x)}return this._dotFBO};b._disposeTextures=function(){if(this._dotTextures){for(let h=
0;h<this._dotTextures.length;h++)this._dotTextures[h].dispose();this._dotTextures=null}};b._bindDotDensityTextures=function(h,n,r,x){r=this._createDotDensityTextures(h,x,r.ddSeed);n.setUniform1iv("u_dotTextures",this._dotSamplers);for(n=0;n<r.length;n++)h.bindTexture(r[n],this._dotSamplers[n])};b._createDotDensityMesh=function(h,n,r){if(u.isNone(this._dotVAO)){var x=new Int16Array(524288);for(let q=0;512>q;q++)for(let A=0;512>A;A++)x[2*(A+512*q)]=A,x[2*(A+512*q)+1]=q;x=d.BufferObject.createVertex(h,
a.Usage.STATIC_DRAW,x);this._dotVAO=new k.VertexArrayObject(h,n,r,{geometry:x},null)}return this._dotVAO};b._createDotDensityTextures=function(h,n,r){if(this._dotTextureSize!==n||this._seed!==r)this._disposeTextures(),this._dotTextureSize=n,this._seed=r;null===this._dotTextures&&(r=new B(r),this._dotTextures=[this._allocDotDensityTexture(h,n,r),this._allocDotDensityTexture(h,n,r)]);return this._dotTextures};b._allocDotDensityTexture=function(h,n,r){const x=new Float32Array(n*n*4);for(let q=0;q<x.length;q++)x[q]=
r.getFloat();return new f.Texture(h,{wrapMode:a.TextureWrapMode.REPEAT,pixelFormat:a.PixelFormat.RGBA,dataType:a.PixelType.FLOAT,samplingMode:a.TextureSamplingMode.NEAREST,width:n,height:n},x)};return m}(l)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions","./WGLBrush","../../../../webgl/enums"],function(t,u,B,D,z){return function(y){function l(){var d=y.apply(this,arguments)||
this;d._computeDesc=new Map;return d}t._inheritsLoose(l,y);var g=l.prototype;g.prepareState=function({context:d},a,c){c=c&&-1!==c.indexOf("hittest");d.setBlendingEnabled(!c);d.setBlendFunctionSeparate(z.BlendFactor.ONE,z.BlendFactor.ONE_MINUS_SRC_ALPHA,z.BlendFactor.ONE,z.BlendFactor.ONE_MINUS_SRC_ALPHA);d.setColorMask(!0,!0,!0,!0);d.setStencilWriteMask(0);d.setStencilTestEnabled(!0);d.setStencilFunction(z.CompareFunction.EQUAL,a.stencilRef,255)};g.draw=function(d,a,c){var e=this.getGeometryType();
a.commit(d);e=a.getGeometry(e);u.isNone(e)||(d.timeline.begin(this.name),d.attributeView.bindTextures(d.context),e.forEachCommand(f=>this.drawGeometry(d,a,f,c)))};g._setSharedUniforms=function(d,a,c){const {displayLevel:e,pixelRatio:f,state:k,passOptions:p}=a;u.isSome(p)&&"hittest"===p.type&&(d.setUniform2fv("u_hittestPos",p.position),d.setUniform1f("u_hittestDist",p.distance));d.setUniform1f("u_pixelRatio",f);d.setUniformMatrix3fv("u_tileMat3",c.transforms.tileMat3);d.setUniformMatrix3fv("u_viewMat3",
k.viewMat3);d.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);d.setUniformMatrix3fv("u_displayViewMat3",k.displayViewMat3);d.setUniform1f("u_currentZoom",Math.round(e*B.MIN_MAX_ZOOM_PRECISION_FACTOR));d.setUniform1i("u_attributeTextureSize",a.attributeView.size);d.setUniform1i("u_attributeData0",B.TEXTURE_BINDING_ATTRIBUTE_DATA_0);d.setUniform1i("u_attributeData1",B.TEXTURE_BINDING_ATTRIBUTE_DATA_1);d.setUniform1i("u_attributeData2",B.TEXTURE_BINDING_ATTRIBUTE_DATA_2);d.setUniform1i("u_attributeData3",
B.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};g._setSizeVVUniforms=function(d,a,c,e){d.vvSizeMinMaxValue&&a.setUniform4fv("u_vvSizeMinMaxValue",c.vvSizeMinMaxValue);d.vvSizeScaleStops&&a.setUniform1f("u_vvSizeScaleStopsValue",c.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(e=c.getSizeVVFieldStops(e.key.level),a.setUniform1fv("u_vvSizeFieldStopsValues",e.values),a.setUniform1fv("u_vvSizeFieldStopsSizes",e.sizes));d.vvSizeUnitValue&&a.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",c.vvSizeUnitValueToPixelsRatio)};
g._setColorAndOpacityVVUniforms=function(d,a,c){d.vvColor&&(a.setUniform1fv("u_vvColorValues",c.vvColorValues),a.setUniform4fv("u_vvColors",c.vvColors));d.vvOpacity&&(a.setUniform1fv("u_vvOpacityValues",c.vvOpacityValues),a.setUniform1fv("u_vvOpacities",c.vvOpacities))};g._setRotationVVUniforms=function(d,a,c){d.vvRotation&&a.setUniform1f("u_vvRotationType","geographic"===c.vvMaterialParameters.vvRotationType?0:1)};g._getTriangleDesc=function(d,a){var c=this._computeDesc.get(d);if(!c){c=a.strides;
const f=a.strides.geometry,k=new Map(a.attributes);var e=a.bufferLayouts.geometry.map(p=>({...p}));a=Math.max(...a.attributes.values());e={geometry:e};e.geometry.push({count:2,name:"a_pos1",divisor:0,normalized:!1,offset:f,stride:f,type:z.DataType.SHORT});e.geometry.push({count:2,name:"a_pos2",divisor:0,normalized:!1,offset:2*f,stride:f,type:z.DataType.SHORT});k.set("a_pos1",a+1);k.set("a_pos2",a+2);c={bufferLayouts:e,attributes:k,strides:c};this._computeDesc.set(d,c)}return c};return l}(D)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],function(t,u,B,D,z){function y(b,h){const n=z.WGLVVFlag.SIZE_FIELD_STOPS|z.WGLVVFlag.SIZE_MINMAX_VALUE|z.WGLVVFlag.SIZE_SCALE_STOPS|z.WGLVVFlag.SIZE_UNIT_VALUE;b=(b&(z.WGLVVTarget.FIELD_TARGETS_OUTLINE|z.WGLVVTarget.MINMAX_TARGETS_OUTLINE|z.WGLVVTarget.SCALE_TARGETS_OUTLINE|z.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return h.isOutline||h.isOutlinedFill?n&b:n&~b}let l=function(){function b(n){this._data=
0;this._data=n}b.load=function(n){const r=this.shared;r.data=n;return r};var h=b.prototype;h.setBit=function(n,r){n=1<<n;this._data=r?this._data|n:this._data&~n};h.bit=function(n){return(this._data&1<<n)>>n};h.setBits=function(n,r,x){for(let q=r,A=0;q<x;q++,A++)this.setBit(q,0!==(n&1<<A))};h.bits=function(n,r){let x=0;for(let q=n,A=0;q<r;q++,A++)x|=this.bit(q)<<A;return x};h.hasVV=function(){return!1};h.setVV=function(n,r){};h.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,
sdf:this.sdf}};h.getVariationHash=function(){return this._data&~(7&this.textureBinding)};u._createClass(b,[{key:"data",get:function(){return this._data},set:function(n){this._data=n}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(n){this.setBits(n,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(n){this.setBit(20,n)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(n){this.setBit(11,n)}},{key:"pattern",get:function(){return!!this.bit(12)},
set:function(n){this.setBit(12,n)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(n){this.setBits(n,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case z.WGLGeometryType.FILL:return"fill";case z.WGLGeometryType.MARKER:return"marker";case z.WGLGeometryType.LINE:return"line";case z.WGLGeometryType.TEXT:return"text";case z.WGLGeometryType.LABEL:return"label";default:throw new B(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);
return b}();l.shared=new l(0);const g=b=>function(h){function n(){return h.apply(this,arguments)||this}u._inheritsLoose(n,h);var r=n.prototype;r.hasVV=function(){return h.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};r.setVV=function(x,q){h.prototype.setVV.call(this,x,q);x&=y(x,q);this.vvSizeMinMaxValue=!!(x&z.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(x&z.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(x&z.WGLVVFlag.SIZE_UNIT_VALUE);
this.vvSizeScaleStops=!!(x&z.WGLVVFlag.SIZE_SCALE_STOPS)};u._createClass(n,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(x){this.setBit(16,x)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(x){this.setBit(17,x)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(x){this.setBit(18,x)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(x){this.setBit(19,x)}}]);return n}(b),d=b=>function(h){function n(){return h.apply(this,
arguments)||this}u._inheritsLoose(n,h);var r=n.prototype;r.hasVV=function(){return h.prototype.hasVV.call(this)||this.vvRotation};r.setVV=function(x,q){h.prototype.setVV.call(this,x,q);this.vvRotation=!q.isOutline&&!!(x&z.WGLVVFlag.ROTATION)};u._createClass(n,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(x){this.setBit(15,x)}}]);return n}(b),a=b=>function(h){function n(){return h.apply(this,arguments)||this}u._inheritsLoose(n,h);var r=n.prototype;r.hasVV=function(){return h.prototype.hasVV.call(this)||
this.vvColor};r.setVV=function(x,q){h.prototype.setVV.call(this,x,q);this.vvColor=!q.isOutline&&!!(x&z.WGLVVFlag.COLOR)};u._createClass(n,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(x){this.setBit(13,x)}}]);return n}(b),c=b=>function(h){function n(){return h.apply(this,arguments)||this}u._inheritsLoose(n,h);var r=n.prototype;r.hasVV=function(){return h.prototype.hasVV.call(this)||this.vvOpacity};r.setVV=function(x,q){h.prototype.setVV.call(this,x,q);this.vvOpacity=!q.isOutline&&
!!(x&z.WGLVVFlag.OPACITY)};u._createClass(n,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(x){this.setBit(14,x)}}]);return n}(b);let e=function(b){function h(){return b.apply(this,arguments)||this}u._inheritsLoose(h,b);h.load=function(n){const r=this.shared;r.data=n;return r};h.from=function(n){const r=this.load(0);r.geometryType=z.WGLGeometryType.FILL;r.dotDensity="dot-density"===n.stride.fill;r.simple="simple"===n.stride.fill;r.outlinedFill=n.isOutlinedFill;r.dotDensity||
r.setVV(n.vvFlags,n);return r.data};h.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),dotDensity:this.dotDensity,outlinedFill:this.outlinedFill,simple:this.simple,vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};u._createClass(h,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(n){this.setBit(15,
n)}},{key:"simple",get:function(){return!!this.bit(22)},set:function(n){this.setBit(22,n)}},{key:"outlinedFill",get:function(){return!!this.bit(21)},set:function(n){this.setBit(21,n)}}]);return h}(a(c(g(l))));e.shared=new e(0);let f=function(b){function h(){return b.apply(this,arguments)||this}u._inheritsLoose(h,b);h.load=function(n){const r=this.shared;r.data=n;return r};h.from=function(n){const r=this.load(0);r.geometryType=z.WGLGeometryType.MARKER;r.setVV(n.vvFlags,n);return r.data};h.prototype.getVariation=
function(){return{...b.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return h}(a(c(d(g(l)))));f.shared=new f(0);let k=function(b){function h(){return b.apply(this,arguments)||this}u._inheritsLoose(h,b);h.load=function(n){const r=this.shared;r.data=n;return r};h.from=function(n){const r=
this.load(0);r.geometryType=z.WGLGeometryType.LINE;r.setVV(n.vvFlags,n);return r.data};h.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return h}(a(c(g(l))));k.shared=new k(0);let p=function(b){function h(){return b.apply(this,arguments)||this}u._inheritsLoose(h,b);
h.load=function(n){const r=this.shared;r.data=n;return r};h.from=function(n){const r=this.load(0);r.geometryType=z.WGLGeometryType.TEXT;r.setVV(n.vvFlags,n);return r.data};h.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return h}(a(c(d(g(l)))));
p.shared=new p(0);let m=function(b){function h(){return b.apply(this,arguments)||this}u._inheritsLoose(h,b);h.load=function(n){const r=this.shared;r.data=n;return r};h.from=function(n){const r=this.load(0);r.geometryType=z.WGLGeometryType.LABEL;r.setVV(n.vvFlags,n);r.mapAligned=D.isMapAligned(n.placement);return r.data};h.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,
vvSizeUnitValue:this.vvSizeUnitValue}};return h}(g(l));m.shared=new m(0);t.FillMaterialKey=e;t.LabelMaterialKey=m;t.LineMaterialKey=k;t.MarkerMaterialKey=f;t.MaterialKeyBase=l;t.TextMaterialKey=p;t.createMaterialKey=function(b,h){switch(b){case z.WGLGeometryType.FILL:return e.from(h);case z.WGLGeometryType.LINE:return k.from(h);case z.WGLGeometryType.MARKER:return f.from(h);case z.WGLGeometryType.TEXT:return p.from(h);case z.WGLGeometryType.LABEL:return m.from(h);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${b}`);
}};t.getSizeFlagsMask=y;t.hydrateMaterialKey=function(b){switch(l.load(b).geometryType){case z.WGLGeometryType.MARKER:return new f(b);case z.WGLGeometryType.FILL:return new e(b);case z.WGLGeometryType.LINE:return new k(b);case z.WGLGeometryType.TEXT:return new p(b);case z.WGLGeometryType.LABEL:return new m(b)}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(t){t.HAlign=void 0;(function(u){u[u.Left=-1]="Left";u[u.Center=
0]="Center";u[u.Right=1]="Right"})(t.HAlign||(t.HAlign={}));t.VAlign=void 0;(function(u){u[u.Top=1]="Top";u[u.Center=0]="Center";u[u.Bottom=-1]="Bottom";u[u.Baseline=2]="Baseline"})(t.VAlign||(t.VAlign={}));t.getAlignmentFromPlacement=function(u){switch(u){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[t.HAlign.Right,t.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[t.HAlign.Center,
t.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[t.HAlign.Left,t.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[t.HAlign.Right,t.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[t.HAlign.Center,t.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[t.HAlign.Left,t.VAlign.Center];
case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[t.HAlign.Right,t.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[t.HAlign.Center,t.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[t.HAlign.Left,t.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[t.HAlign.Center,t.VAlign.Center];default:return console.debug(`Found invalid placement type ${u}`),
[t.HAlign.Center,t.VAlign.Center]}};t.getJustification=function(u){switch(u){case "left":return t.HAlign.Left;case "right":return t.HAlign.Right;case "center":case "justify":return t.HAlign.Center}};t.getXAnchorDirection=function(u){switch(u){case "left":return t.HAlign.Left;case "right":return t.HAlign.Right;case "center":case "justify":return t.HAlign.Center}};t.getXDirection=function(u){switch(u){case t.HAlign.Right:return-1;case t.HAlign.Center:return 0;case t.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${u}`),
0}};t.getYAnchorDirection=function(u){switch(u){case "top":return t.VAlign.Top;case "middle":return t.VAlign.Center;case "baseline":return t.VAlign.Baseline;case "bottom":return t.VAlign.Bottom}};t.getYDirection=function(u){switch(u){case t.VAlign.Top:return 1;case t.VAlign.Center:return 0;case t.VAlign.Bottom:case t.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${u}`),0}};t.isMapAligned=function(u){switch(u){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;
default:return!1}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(t,u,B,D,z,y){return function(l){function g(){return l.apply(this,arguments)||this}t._inheritsLoose(g,l);var d=g.prototype;d.dispose=function(){};d.getGeometryType=function(){return u.WGLGeometryType.LABEL};
d.drawGeometry=function(a,c,e,f){const {context:k,painter:p,state:m,rendererInfo:b}=a,h=z.LabelMaterialKey.load(e.materialKey),n=h.mapAligned?1:0;if(n||!(1<=Math.abs(c.key.level-Math.round(100*a.displayLevel)/100))){var {bufferLayouts:r,attributes:x}=B.createProgramDescriptor(h.data,{geometry:[{location:0,name:"a_pos",count:2,type:y.DataType.SHORT},{location:1,name:"a_id",count:4,type:y.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:y.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,
name:"a_haloColor",count:4,type:y.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:y.DataType.UNSIGNED_BYTE},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:y.DataType.UNSIGNED_BYTE},{location:6,name:"a_glyphData",count:4,type:y.DataType.UNSIGNED_BYTE},{location:7,name:"a_vertexOffset",count:2,type:y.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:y.DataType.UNSIGNED_SHORT}]});f=p.materialManager.getMaterialProgram(a,h,"materials/label",
x,f);a.context.setStencilFunction(y.CompareFunction.EQUAL,0,255);k.useProgram(f);this._setSharedUniforms(f,a,c);p.textureManager.bindTextures(k,f,h);var q=1===n?m.displayViewMat3:m.displayMat3;this._setSizeVVUniforms(h,f,b,c);f.setUniform1f("u_mapRotation",Math.floor(m.rotation/360*254));f.setUniform1f("u_mapAligned",n);f.setUniformMatrix3fv("u_displayMat3",q);f.setUniform1f("u_opacity",1);f.setUniform2fv("u_screenSize",a.state.size);f.setUniform1f("u_isHalo",1);a=e.target.getVAO(k,r,x);c=e.indexFrom*
Uint32Array.BYTES_PER_ELEMENT;k.bindVAO(a);k.drawElements(y.PrimitiveType.TRIANGLES,e.indexCount,y.DataType.UNSIGNED_INT,c);f.setUniform1f("u_isHalo",0);k.drawElements(y.PrimitiveType.TRIANGLES,e.indexCount,y.DataType.UNSIGNED_INT,c);k.setStencilTestEnabled(!0);k.setBlendingEnabled(!0)}};return g}(D)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(t,u,B,D,z,y,l){return function(g){function d(){return g.apply(this,arguments)||this}t._inheritsLoose(d,g);var a=d.prototype;a.dispose=function(){};a.getGeometryType=function(){return B.WGLGeometryType.LINE};a.drawGeometry=function(c,e,f,k){const {context:p,painter:m,rendererInfo:b,displayLevel:h,passOptions:n}=c;var r=y.LineMaterialKey.load(f.materialKey),x=D.createProgramDescriptor(r.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},{location:1,name:"a_id",count:4,
type:l.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:l.DataType.BYTE},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:l.DataType.UNSIGNED_SHORT},{location:5,name:"a_tlbr",count:4,type:l.DataType.UNSIGNED_SHORT},{location:6,name:"a_segmentDirection",count:4,type:l.DataType.BYTE},{location:7,name:"a_aux",count:2,type:l.DataType.UNSIGNED_SHORT},{location:8,name:"a_zoomRange",
count:2,type:l.DataType.UNSIGNED_SHORT}]});let q=l.PrimitiveType.TRIANGLES;u.isSome(n)&&"hittest"===n.type&&(x=this._getTriangleDesc(f.materialKey,x),q=l.PrimitiveType.POINTS);const {attributes:A,bufferLayouts:E}=x;k=m.materialManager.getMaterialProgram(c,r,"materials/line",A,k);x=1/c.pixelRatio;p.useProgram(k);this._setSharedUniforms(k,c,e);r.textureBinding&&m.textureManager.bindTextures(p,k,r);k.setUniform1f("u_zoomFactor",2**(h-e.key.level)/c.pixelRatio);k.setUniform1f("u_blur",0+x);k.setUniform1f("u_antialiasing",
x);this._setSizeVVUniforms(r,k,b,e);this._setColorAndOpacityVVUniforms(r,k,b);p.setFaceCullingEnabled(!1);c=u.isSome(n)&&"hittest"===n.type;e=f.target.getVAO(p,E,A,c);r=f.indexCount;f=f.indexFrom*Uint32Array.BYTES_PER_ELEMENT;c&&(r/=3,f/=3);p.bindVAO(e);p.drawElements(q,r,l.DataType.UNSIGNED_INT,f)};return d}(z)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(t,u,B,D,z,y,l){return function(g){function d(){return g.apply(this,arguments)||this}t._inheritsLoose(d,g);var a=d.prototype;a.dispose=function(){};a.getGeometryType=function(){return B.WGLGeometryType.MARKER};a.drawGeometry=function(c,e,f,k){const {context:p,painter:m,rendererInfo:b,state:h,passOptions:n}=c,r=y.MarkerMaterialKey.load(f.materialKey),{bufferLayouts:x,attributes:q}=D.createProgramDescriptor(r.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},{location:1,
name:"a_vertexOffset",count:2,type:l.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:l.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:l.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:l.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:l.DataType.UNSIGNED_BYTE},
{location:8,name:"a_zoomRange",count:2,type:l.DataType.UNSIGNED_SHORT}]}),A=m.materialManager.getMaterialProgram(c,r,"materials/icon",q,k);p.useProgram(A);r.textureBinding&&m.textureManager.bindTextures(p,A,r,!0);k=l.PrimitiveType.TRIANGLES;u.isSome(n)&&"hittest"===n.type&&(k=l.PrimitiveType.POINTS);this._setSharedUniforms(A,c,e);A.setUniformMatrix3fv("u_displayMat3",r.vvRotation?h.displayViewMat3:h.displayMat3);this._setSizeVVUniforms(r,A,b,e);this._setColorAndOpacityVVUniforms(r,A,b);this._setRotationVVUniforms(r,
A,b);c=f.target.getVAO(p,x,q);e=f.indexFrom*Uint32Array.BYTES_PER_ELEMENT;p.bindVAO(c);p.drawElements(k,f.indexCount,l.DataType.UNSIGNED_INT,e)};return d}(z)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(t,u,B,D,z,y,l){return function(g){function d(){return g.apply(this,arguments)||this}
t._inheritsLoose(d,g);var a=d.prototype;a.dispose=function(){};a.getGeometryType=function(){return B.WGLGeometryType.TEXT};a.drawGeometry=function(c,e,f,k){const {context:p,painter:m,rendererInfo:b,state:h,passOptions:n}=c,r=y.TextMaterialKey.load(f.materialKey),{bufferLayouts:x,attributes:q}=D.createProgramDescriptor(r.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},{location:1,name:"a_id",count:4,type:l.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,
normalized:!0},{location:3,name:"a_haloColor",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:l.DataType.UNSIGNED_BYTE},{location:5,name:"a_aux",count:4,type:l.DataType.BYTE},{location:6,name:"a_zoomRange",count:2,type:l.DataType.UNSIGNED_SHORT},{location:7,name:"a_vertexOffset",count:2,type:l.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:l.DataType.UNSIGNED_SHORT}]});k=m.materialManager.getMaterialProgram(c,r,"materials/text",q,k);
p.useProgram(k);let A=l.PrimitiveType.TRIANGLES;u.isSome(n)&&"hittest"===n.type&&(A=l.PrimitiveType.POINTS);this._setSharedUniforms(k,c,e);m.textureManager.bindTextures(p,k,r);k.setUniformMatrix3fv("u_displayMat3",h.displayMat3);k.setUniformMatrix3fv("u_displayViewMat3",h.displayViewMat3);this._setSizeVVUniforms(r,k,b,e);this._setColorAndOpacityVVUniforms(r,k,b);this._setRotationVVUniforms(r,k,b);k.setUniform1f("u_isHalo",1);c=f.target.getVAO(p,x,q);e=f.indexFrom*Uint32Array.BYTES_PER_ELEMENT;p.bindVAO(c);
p.drawElements(l.PrimitiveType.TRIANGLES,f.indexCount,l.DataType.UNSIGNED_INT,e);k.setUniform1f("u_isHalo",0);p.drawElements(A,f.indexCount,l.DataType.UNSIGNED_INT,e)};return d}(z)})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define(["../enums","./Programs"],function(t,u){return function(){function B(){this._programByKey=new Map}var D=B.prototype;D.dispose=function(){this._programByKey.forEach(z=>z.dispose());this._programByKey.clear()};D.getMaterialProgram=function(z,
y,l){const g=y.key<<3|this._getMaterialOptionsValue(y.type,l);if(this._programByKey.has(g))return this._programByKey.get(g);var d=this._getProgramTemplate(y.type);({shaders:d}=d);const {vertexShader:a,fragmentShader:c}=d(l);l=y.getShaderHeader();d=y.getShaderMain();l=a.replace("#pragma header",l).replace("#pragma main",d);z=z.programCache.acquire(l,c,y.getAttributeLocations());this._programByKey.set(g,z);return z};D._getMaterialOptionsValue=function(z,y){switch(z){case t.ShaderProgramType.BACKGROUND:return(y.pattern?
1:0)<<1|(y.id?1:0);case t.ShaderProgramType.FILL:return(y.pattern?1:0)<<1|(y.id?1:0);case t.ShaderProgramType.OUTLINE:return y.id?1:0;case t.ShaderProgramType.LINE:return(y.sdf?1:0)<<2|(y.pattern?1:0)<<1|(y.id?1:0);case t.ShaderProgramType.ICON:return(y.sdf?1:0)<<1|(y.id?1:0);case t.ShaderProgramType.CIRCLE:return y.id?1:0;case t.ShaderProgramType.TEXT:return y.id?1:0;default:return 0}};D._getProgramTemplate=function(z){switch(z){case t.ShaderProgramType.BACKGROUND:return u.background;case t.ShaderProgramType.CIRCLE:return u.circle;
case t.ShaderProgramType.FILL:return u.fill;case t.ShaderProgramType.ICON:return u.icon;case t.ShaderProgramType.LINE:return u.line;case t.ShaderProgramType.OUTLINE:return u.outline;case t.ShaderProgramType.TEXT:return u.text;default:return null}};return B}()})},"esri/views/2d/engine/vectorTiles/enums":function(){define(["exports"],function(t){t.MemoryBufferType=void 0;(function(u){u[u.UNKNOWN=0]="UNKNOWN";u[u.FILL_VERTEX=1]="FILL_VERTEX";u[u.FILL_DD_VERTEX=2]="FILL_DD_VERTEX";u[u.FILL_INDEX=3]="FILL_INDEX";
u[u.OUTLINE_VERTEX=4]="OUTLINE_VERTEX";u[u.OUTLINE_DD_VERTEX=5]="OUTLINE_DD_VERTEX";u[u.OUTLINE_INDEX=6]="OUTLINE_INDEX";u[u.LINE_VERTEX=7]="LINE_VERTEX";u[u.LINE_DD_VERTEX=8]="LINE_DD_VERTEX";u[u.LINE_INDEX=9]="LINE_INDEX";u[u.ICON_VERTEX=10]="ICON_VERTEX";u[u.ICON_DD_VERTEX=11]="ICON_DD_VERTEX";u[u.ICON_INDEX=12]="ICON_INDEX";u[u.TEXT_VERTEX=13]="TEXT_VERTEX";u[u.TEXT_DD_VERTEX=14]="TEXT_DD_VERTEX";u[u.TEXT_INDEX=15]="TEXT_INDEX";u[u.CIRCLE_VERTEX=16]="CIRCLE_VERTEX";u[u.CIRCLE_INDEX=17]="CIRCLE_INDEX"})(t.MemoryBufferType||
(t.MemoryBufferType={}));t.BucketType=void 0;(function(u){u[u.FILL=1]="FILL";u[u.LINE=2]="LINE";u[u.SYMBOL=3]="SYMBOL";u[u.CIRCLE=4]="CIRCLE"})(t.BucketType||(t.BucketType={}));t.DrawPhase=void 0;(function(u){u[u.BACKGROUND=0]="BACKGROUND";u[u.OPAQUE=1]="OPAQUE";u[u.TRANSLUCENT=2]="TRANSLUCENT";u[u.SYMBOLS=3]="SYMBOLS";u[u.HITTEST=4]="HITTEST"})(t.DrawPhase||(t.DrawPhase={}));t.ShaderProgramType=void 0;(function(u){u[u.BACKGROUND=0]="BACKGROUND";u[u.FILL=1]="FILL";u[u.OUTLINE=2]="OUTLINE";u[u.LINE=
3]="LINE";u[u.ICON=4]="ICON";u[u.CIRCLE=5]="CIRCLE";u[u.TEXT=6]="TEXT";u[u.TILEINFO=7]="TILEINFO"})(t.ShaderProgramType||(t.ShaderProgramType={}));t.StyleUpdateType=void 0;(function(u){u[u.PAINTER_CHANGED=0]="PAINTER_CHANGED";u[u.LAYOUT_CHANGED=1]="LAYOUT_CHANGED";u[u.LAYER_CHANGED=2]="LAYER_CHANGED";u[u.LAYER_REMOVED=3]="LAYER_REMOVED";u[u.SPRITES_CHANGED=4]="SPRITES_CHANGED"})(t.StyleUpdateType||(t.StyleUpdateType={}));Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["exports",
"./sources/resolver","../../../../webgl/programUtils"],function(t,u,B){t.background={shaders:D=>({vertexShader:B.glslifyDefineMap({ID:D.id,PATTERN:D.pattern})+u.resolveIncludes("background/background.vert"),fragmentShader:B.glslifyDefineMap({ID:D.id,PATTERN:D.pattern})+u.resolveIncludes("background/background.frag")})};t.circle={shaders:D=>({vertexShader:B.glslifyDefineMap({ID:D.id})+u.resolveIncludes("circle/circle.vert"),fragmentShader:B.glslifyDefineMap({ID:D.id})+u.resolveIncludes("circle/circle.frag")})};
t.fill={shaders:D=>({vertexShader:B.glslifyDefineMap({ID:D.id,PATTERN:D.pattern})+u.resolveIncludes("fill/fill.vert"),fragmentShader:B.glslifyDefineMap({ID:D.id,PATTERN:D.pattern})+u.resolveIncludes("fill/fill.frag")})};t.icon={shaders:D=>({vertexShader:B.glslifyDefineMap({ID:D.id,SDF:D.sdf})+u.resolveIncludes("icon/icon.vert"),fragmentShader:B.glslifyDefineMap({ID:D.id,SDF:D.sdf})+u.resolveIncludes("icon/icon.frag")})};t.line={shaders:D=>({vertexShader:B.glslifyDefineMap({ID:D.id,PATTERN:D.pattern,
SDF:D.sdf})+u.resolveIncludes("line/line.vert"),fragmentShader:B.glslifyDefineMap({ID:D.id,PATTERN:D.pattern,SDF:D.sdf})+u.resolveIncludes("line/line.frag")})};t.outline={shaders:D=>({vertexShader:B.glslifyDefineMap({ID:D.id})+u.resolveIncludes("outline/outline.vert"),fragmentShader:B.glslifyDefineMap({ID:D.id})+u.resolveIncludes("outline/outline.frag")})};t.text={shaders:D=>({vertexShader:B.glslifyDefineMap({ID:D.id})+u.resolveIncludes("text/text.vert"),fragmentShader:B.glslifyDefineMap({ID:D.id})+
u.resolveIncludes("text/text.frag")})};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(t,u,B){const D=new B.ShaderCompiler(function(z){let y=u;z.split("/").forEach(l=>{y&&(y=y[l])});return y});t.resolveIncludes=function(z){return D.resolveIncludes(z)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX \x3d fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * (v_lineHalfWidth + u_antialiasing / 2.0);\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio \x3d width / v_patternSize.y;\n#else\nv_widthRatio \x3d width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../../core/maybe ./DefaultVertexAttributeLayouts ./shaders/BitBlitPrograms ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/ProgramTemplate ../../../webgl/VertexArrayObject".split(" "),
function(t,u,B,D,z,y,l,g){let d=function(){function a(){this._initialized=!1}var c=a.prototype;c.dispose=function(){this._program=u.disposeMaybe(this._program);this._vertexArrayObject=u.disposeMaybe(this._vertexArrayObject)};c.render=function(e,f,k,p){e&&(this._initialized||this._initialize(e),e.setBlendFunctionSeparate(y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA,y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA),e.bindVAO(this._vertexArrayObject),e.useProgram(this._program),f.setSamplingMode(k),
e.bindTexture(f,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",p),e.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,4),e.bindTexture(null,0),e.bindVAO())};c._initialize=function(e){if(this._initialized)return!0;const f=l.createProgram(e,D.bitBlit);if(!f)return!1;const k=new Int8Array(16);k[0]=-1;k[1]=-1;k[2]=0;k[3]=0;k[4]=1;k[5]=-1;k[6]=1;k[7]=0;k[8]=-1;k[9]=1;k[10]=0;k[11]=1;k[12]=1;k[13]=1;k[14]=1;k[15]=1;e=new g.VertexArrayObject(e,D.bitBlit.attributes,B.PosTex2b,{geometry:z.BufferObject.createVertex(e,
y.Usage.STATIC_DRAW,k)});this._program=f;this._vertexArrayObject=e;return this._initialized=!0};return a}();t.BitBlitRenderer=d;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(t,u){u={shaders:{vertexShader:u.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:u.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",0],["a_tex",1]])};t.bitBlit=u;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define(["../../../../core/maybe","./enums","./shaders/MaterialPrograms"],function(t,u,B){const D=l=>l===u.WGLDrawPhase.HITTEST||l===u.WGLDrawPhase.LABEL_ALPHA,z=({rendererInfo:l,drawPhase:g},d,a,c)=>{d=d.getVariationHash();c=c.join(".");g=(D(g)?1:0)|(g===u.WGLDrawPhase.HIGHLIGHT?2:0);return`${d}-${c}-${g}-${l.getVariationHash()}-${t.isSome(a)&&a.join(".")}`},y=(l,g,d,a)=>{a=a.reduce((c,e)=>({...c,[e]:l.context.driverTest[e]}),
{});g={...g.getVariation(),...l.rendererInfo.getVariation(),highlight:l.drawPhase===u.WGLDrawPhase.HIGHLIGHT,id:D(l.drawPhase),...a};if(t.isSome(d))for(const c of d)g[c]=!0;return g};return function(){function l(d){this._rctx=d;this._programByKey=new Map}var g=l.prototype;g.dispose=function(){this._programByKey.forEach(d=>d.dispose());this._programByKey.clear()};g.getProgram=function(d,a,c=[],e=[]){const f=a.vsPath+"."+a.fsPath+JSON.stringify(c)+e.join(".");if(this._programByKey.has(f))return this._programByKey.get(f);
e=e.reduce((b,h)=>({...b,[h]:d.context.driverTest[h]}),{});c={...c.map(b=>"string"===typeof b?{name:b,value:!0}:b).reduce((b,h)=>({...b,[h.name]:h.value}),{}),...e};const {vsPath:k,fsPath:p,attributes:m}=a;a=B.createProgramTemplate(k,p,m,c);a=this._rctx.programCache.acquire(a.shaders.vertexShader,a.shaders.fragmentShader,a.attributes);if(!a)throw Error("Unable to get program for key: ${key}");this._programByKey.set(f,a);return a};g.getMaterialProgram=function(d,a,c,e,f,k=["ignoresSamplerPrecision"]){const p=
z(d,a,f,k);if(this._programByKey.has(p))return this._programByKey.get(p);d=y(d,a,f,k);c=B.createProgramTemplate(c,c,e,d);c=this._rctx.programCache.acquire(c.shaders.vertexShader,c.shaders.fragmentShader,c.attributes);if(!c)throw Error("Unable to get program for key: ${key}");this._programByKey.set(p,c);return c};return l}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(t,u,B){const D=z=>{const y=
{};for(const g in z){{let d=void 0;var l=g;d=""+l[0].toUpperCase();for(let a=1;a<l.length;a++){const c=l[a];c===c.toUpperCase()?(d+="_",d+=c):d+=c.toUpperCase()}l=d}y[l]=z[g]}return B.glslifyDefineMap(y)};t.createProgramTemplate=(z,y,l,g)=>{z+=z.substring(z.lastIndexOf("/"));y+=y.substring(y.lastIndexOf("/"));return{attributes:l,shaders:{vertexShader:D(g)+u.resolveIncludes(`${z}.vert`),fragmentShader:D(g)+u.resolveIncludes(`${y}.frag`)}}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/BidiText ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./Utils ./animatedFormats/apng ./animatedFormats/gif ./util/Result ./util/symbolUtils ../../../support/QueueProcessor ../../../webgl/enums".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h,n,r,x,q,A,E,F,w){function v(N,K){return C.apply(this,arguments)}function C(){C=t._asyncToGenerator(function*(N,K){N=r.getUrl(N);var I;if(N.includes(";base64,")){K=N.indexOf(";base64,")+8;K=N.substring(K);K=atob(K);N=new Uint8Array(K.length);for(I=0;I<K.length;I++)N[I]=K.charCodeAt(I);I=N.buffer}else try{const {data:M}=yield B(N,{responseType:"array-buffer",...K});I=M}catch(M){if(!g.isAbortError(M))return new z("mapview-invalid-resource",`Could not fetch requested resource at ${N}`)}return I});
return C.apply(this,arguments)}function G(N,K){K=Math.round(d.pt2px(K)*window.devicePixelRatio);return Math.min(N,K*(128<=K?2:4))}const H=c.create(),L=y.getLogger("esri.views.2d.engine.webgl.TextureManager");let O=function(){function N(K,I,M){this.mosaicType=K;this.page=I;this.sdf=M}N.fromMosaic=function(K,I){return new N(K,I.page,I.sdf)};return N}();return function(){function N(I,M){this.resourceManager=M;this._invalidFontsMap=new Map;this._sdfConverter=new h(126);this._bindingInfos=[];this._hashToBindingIndex=
new Map;this._ongoingRasterizations=new Map;this._imageRequestQueue=new F.QueueProcessor({concurrency:10,process:function(){var U=t._asyncToGenerator(function*(T,Q){g.throwIfAborted(Q);try{return yield B(T,{responseType:"image",signal:Q})}catch(J){if(!g.isAbortError(J))throw new z("mapview-invalid-resource",`Could not fetch requested resource at ${T}`,J);throw J;}});return function(T,Q){return U.apply(this,arguments)}}()});this._spriteMosaic=new n(I,2048,2048,500);this._glyphSource=new b(`${u.fontsUrl}/{fontstack}/{range}.pbf`);
this._glyphMosaic=new m(1024,1024,this._glyphSource);this._rasterizer=new e(M)}var K=N.prototype;K.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=null;this._imageRequestQueue.clear();this._imageRequestQueue=null};
K.rasterizeItem=function(){var I=t._asyncToGenerator(function*(M,U,T,Q){if(l.isNone(M))return L.error(new z("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(M.type){case "text":case "esriTS":return M=yield this._rasterizeText(M,T,Q),M.forEach(J=>this._setTextureBinding(k.MosaicType.GLYPH,J)),{glyphMosaicItems:M};default:if(r.is3D(M))return L.error(new z("mapview-invalid-type",`MapView does not support symbol type: ${M.type}`,M)),null;M=yield this._rasterizeSpriteSymbol(M,
U,Q);A.ok(M)&&M&&this._setTextureBinding(k.MosaicType.SPRITE,M);return{spriteMosaicItem:M}}});return function(M,U,T,Q){return I.apply(this,arguments)}}();K.bindTextures=function(I,M,U,T=!1){if(0!==U.textureBinding){var Q=this._bindingInfos[U.textureBinding-1];U=Q.page;T=T?w.TextureSamplingMode.LINEAR_MIPMAP_LINEAR:w.TextureSamplingMode.LINEAR;switch(Q.mosaicType){case k.MosaicType.SPRITE:{Q=this.sprites.getWidth(U);const J=this.sprites.getHeight(U);Q=a.set(H,Q,J);this._spriteMosaic.bind(I,T,U,f.TEXTURE_BINDING_SPRITE_ATLAS);
M.setUniform1i("u_texture",f.TEXTURE_BINDING_SPRITE_ATLAS);M.setUniform2fv("u_mosaicSize",Q);break}case k.MosaicType.GLYPH:Q=a.set(H,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(I,T,U,f.TEXTURE_BINDING_GLYPH_ATLAS);M.setUniform1i("u_texture",f.TEXTURE_BINDING_GLYPH_ATLAS);M.setUniform2fv("u_mosaicSize",Q);break;default:L.error("mapview-texture-manager",`Cannot handle unknown type ${Q.mosaicType}`)}}};K._hashMosaic=function(I,M){return 1|I<<1|(M.sdf?1:0)<<2|M.page<<3};K._setTextureBinding=
function(I,M){const U=this._hashMosaic(I,M);this._hashToBindingIndex.has(U)||(I=O.fromMosaic(I,M),this._hashToBindingIndex.set(U,this._bindingInfos.length+1),this._bindingInfos.push(I));M.textureBinding=this._hashToBindingIndex.get(U)};K._rasterizeText=function(){var I=t._asyncToGenerator(function*(M,U,T){let Q,J;Q="cim"in M?M.fontName:p.getFullyQualifiedFontName(M.font);J=M.text;M=this._invalidFontsMap.has(Q);U=U?U:r.charCodes(D.bidiText(J)[0]);try{return yield this._glyphMosaic.getGlyphItems(M?
"arial-unicode-ms-regular":Q,U,T)}catch(P){return L.error(new z("mapview-invalid-resource",`Couldn't find font ${Q}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(Q,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",U,T)}});return function(M,U,T){return I.apply(this,arguments)}}();K._rasterizeSpriteSymbol=function(){var I=t._asyncToGenerator(function*(M,U,T){if(r.isSimple(M))return null;U=E.keyFromSymbol(M);if(this._spriteMosaic.has(U))return this._spriteMosaic.getSpriteItem(U);
if(r.isSVGResource(M)||r.isImageResource(M))return this._handleAsyncResource(U,M,T);if(T=this._rasterizer.rasterizeJSONResource(M,1)){const {size:Q,image:J,sdf:P,simplePattern:S}=T;return this._addItemToMosaic(U,Q,{type:"static",data:J},r.shouldRepeat(M),P,S)}return new z("TextureManager","unrecognized or null rasterized image")});return function(M,U,T){return I.apply(this,arguments)}}();K._handleAsyncResource=function(){var I=t._asyncToGenerator(function*(M,U,T){if(this._ongoingRasterizations.has(M))return this._ongoingRasterizations.get(M);
U=r.isSVGResource(U)?this._handleSVG(U,M,T):this._handleImage(U,M,T);this._ongoingRasterizations.set(M,U);try{yield U,this._ongoingRasterizations.delete(M)}catch{this._ongoingRasterizations.delete(M)}return U});return function(M,U,T){return I.apply(this,arguments)}}();K._handleSVG=function(){var I=t._asyncToGenerator(function*(M,U,T){M=yield this._sdfConverter.draw(M.path,T);return this._addItemToMosaic(U,[126,126],{type:"static",data:new Uint32Array(M.buffer)},!1,!0,!0)});return function(M,U,T){return I.apply(this,
arguments)}}();K._handleGIFOrPNG=function(){var I=t._asyncToGenerator(function*(M,U,T){var Q=yield v(M,T);if(A.ok(Q)){var J=q.isGIF(Q);const P=x.isPNG(Q);if(!J&&!P)return new z("mapview-invalid-resource","Image data is neither GIF nor PNG!");let S;try{J&&q.isAnimatedGIF(Q)?S=yield q.default.create(Q,T):P&&x.isAnimatedPNG(Q)&&(S=yield x.default.create(Q,T))}catch(W){if(!g.isAbortError(W))return new z("mapview-invalid-resource","Could not fetch requested resource!")}if(S&&A.ok(S))return this._addItemToMosaic(U,
[S.width,S.height],{type:"animated",data:S},r.shouldRepeat(M),!1,!1);T=new Blob([Q],{type:J?"image/gif":"image/png"});if((T=yield this._imageFromBlob(T))&&T instanceof HTMLImageElement){Q=T.width;J=T.height;"esriPMS"===M.type&&(Q=Math.round(G(T.width,r.getPMSResourceSize(M))),J=Math.round(Q/T.width*T.height));const {size:W,sdf:Z,image:V}=this._rasterizer.rasterizeImageResource(Q,J,T,"cim"in M?M.cim.colorSubstitutions:void 0);return this._addItemToMosaic(U,W,{type:"static",data:V},r.shouldRepeat(M),
Z,!1)}}return new z("mapview-invalid-resource","Could not handle resource!")});return function(M,U,T){return I.apply(this,arguments)}}();K._handleImage=function(){var I=t._asyncToGenerator(function*(M,U,T){if(r.isGIF(M)||r.isPNG(M))return this._handleGIFOrPNG(M,U,T);const Q=r.getUrl(M);try{let P;const S=this.resourceManager.getResource(Q);if(l.isSome(S))P=S;else{const {data:R}=yield this._imageRequestQueue.push(Q,{...T});P=R}if(r.isSVGImage(Q))if("width"in M&&"height"in M)P.width=d.pt2px(M.width),
P.height=d.pt2px(M.height);else if("cim"in M){var J;const R=M.cim;P.width=d.pt2px(null!=(J=R.width)?J:R.scaleX*R.size);P.height=d.pt2px(R.size)}if(!P.width||!P.height)return null;let W=P.width,Z=P.height;"esriPMS"===M.type&&(W=Math.round(G(P.width,r.getPMSResourceSize(M))),Z=Math.round(W/P.width*P.height));const {size:V,sdf:Y,image:X}=this._rasterizer.rasterizeImageResource(W,Z,P,"cim"in M?M.cim.colorSubstitutions:void 0);return this._addItemToMosaic(U,V,{type:"static",data:X},r.shouldRepeat(M),Y,
!1)}catch(P){if(!g.isAbortError(P))return new z("mapview-invalid-resource",`Could not fetch requested resource at ${Q}. ${P.message}`)}});return function(M,U,T){return I.apply(this,arguments)}}();K._imageFromBlob=function(){var I=t._asyncToGenerator(function*(M){M=window.URL.createObjectURL(M);try{const {data:U}=yield this._imageRequestQueue.push(M);window.URL.revokeObjectURL(M);return U}catch(U){window.URL.revokeObjectURL(M);if(!g.isAbortError(U))return new z("mapview-invalid-resource",`Could not fetch requested resource at ${M}`);
throw U;}});return function(M){return I.apply(this,arguments)}}();K._addItemToMosaic=function(I,M,U,T,Q,J){return this._spriteMosaic.addSpriteItem(I,M,U,T,Q,J)};t._createClass(N,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return N}()})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],function(t,u){const B=new u;t.bidiText=function(D){if(!B.hasBidiChar(D))return[D,!1];let z;z="rtl"===B.checkContextual(D)?"IDNNN":
"ICNNN";return[B.bidiTransform(D,z,"VLYSN"),!0]};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],function(t){function u(q,A,E,F,w){var v=q;void 0===A&&(A=w.defInFormat);void 0===E&&(E=w.defOutFormat);void 0===F&&(F=w.defSwap);if(A!==E){var C=A.substring(0,1),G=E.substring(0,1);var H=A.substring(1,4);var L=E.substring(1,4);"C"===H.charAt(0)&&(H=B(v),H="ltr"===H||"rtl"===H?H.toUpperCase():"L"===A.charAt(2)?"LTR":"RTL",A=C+H);"C"===
L.charAt(0)&&(H=B(v),"rtl"===H?L="RTL":"ltr"===H?(v=v.split(""),v.reverse(),H=B(v.join("")),L=H.toUpperCase()):L="L"===E.charAt(2)?"LTR":"RTL",E=G+L)}if(A===E)return q;G=A.substring(0,1);v=A.substring(1,4);C=E.substring(0,1);L=E.substring(1,4);w.inFormat=A;w.outFormat=E;w.swap=F;if("L"===G&&"VLTR"===E){if("LTR"===v)return w.dir=0,D(q,w);if("RTL"===v)return w.dir=1,D(q,w)}if("V"===G&&"V"===C)return w.dir="RTL"===v?1:0,y(q,w);if("L"===G&&"VRTL"===E)return w.dir="LTR"===v?0:1,q=D(q,w),y(q);if("VLTR"===
A&&"LLTR"===E)return w.dir=0,D(q,w);if("V"===G&&"L"===C&&v!==L)return q=y(q),"RTL"===v?u(q,"LLTR","VLTR",F,w):u(q,"LRTL","VRTL",F,w);if("VRTL"===A&&"LRTL"===E)return u(q,"LRTL","VRTL",F,w);"L"===G&&"L"===C&&(A=w.swap,w.swap=A.substr(0,1)+"N","RTL"===v?(w.dir=1,q=D(q,w),w.swap="N"+A.substr(1,2),w.dir=0,q=D(q,w)):(w.dir=0,q=D(q,w),w.swap="N"+A.substr(1,2),q=u(q,"VLTR","LRTL",w.swap,w)));return q}function B(q){return(q=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(q))?
"z">=q[0]?"ltr":"rtl":""}function D(q,A){q=q.split("");const E=[];z(q,E,A);if(0!==A.hiLevel&&A.swap.substr(0,1)!==A.swap.substr(1,2))for(let v=0;v<q.length;v++)if(1===E[v]){var F=v;b:{let C=void 0;var w=q[v];let G=0,H=t.SwapTable.length-1;for(;G<=H;)if(C=Math.floor((G+H)/2),w<t.SwapTable[C][0])H=C-1;else if(w>t.SwapTable[C][0])G=C+1;else{w=t.SwapTable[C][1];break b}}q[F]=w}d(2,q,E,A);d(1,q,E,A);h=E;return q.join("")}function z(q,A,E){const F=q.length;var w=E.dir?t.impTabRtl:t.impTabLtr,v=0,C=-1;const G=
[],H=[];E.hiLevel=E.dir;E.lastArabic=!1;E.hasUbatAl=!1;E.hasUbatB=!1;E.hasUbatS=!1;for(var L=0;L<F;L++){var O=L;{var N=q[L].charCodeAt(0);const K=t.PrimaryTable[N>>8];N=K<t.TBBASE?K:t.UnicodeTable[K-t.TBBASE][N&255]}G[O]=N}for(O=0;O<F;O++){L=a(q,G,H,O,E);H[O]=L;v=w[v][L];N=v&240;v&=15;L=w[v][5];A[O]=L;if(0<N){if(16===N)for(;C<O;C++)A[C]=1;C=-1}if(w[v][6])-1===C&&(C=O);else if(-1<C){for(;C<O;C++)A[C]=L;C=-1}G[O]===t.UBAT_B&&(A[O]=0);E.hiLevel|=L}if(E.hasUbatS)for(q=0;q<F;q++)if(G[q]===t.UBAT_S)for(A[q]=
E.dir,w=q-1;0<=w;w--)if(G[w]===t.UBAT_WS)A[w]=E.dir;else break}function y(q,A){q=q.split("");if(A){const E=[];z(q,E,A);h=E}q.reverse();m.reverse();return q.join("")}function l(q){for(let A=0;A<t.ArabicAlefBetIntervalsBegine.length;A++)if(q>=t.ArabicAlefBetIntervalsBegine[A]&&q<=t.ArabicAlefBetIntervalsEnd[A])return!0;return!1}function g(q,A,E,F){for(;A*E<F&&e(q[A]);)A+=E;return A*E<F&&l(q[A])?!0:!1}function d(q,A,E,F){if(!(F.hiLevel<q))if(1!==q||1!==F.dir||F.hasUbatB){F=A.length;for(var w=0,v,C,G;w<
F;){if(E[w]>=q){for(v=w+1;v<F&&E[v]>=q;)v++;for(C=v-1;w<C;w++,C--)G=A[w],A[w]=A[C],A[C]=G,G=m[w],m[w]=m[C],m[C]=G;w=v}w++}}else A.reverse(),m.reverse()}function a(q,A,E,F,w){return{UBAT_L:()=>{w.lastArabic=!1;return t.UBAT_L},UBAT_R:()=>{w.lastArabic=!1;return t.UBAT_R},UBAT_ON:()=>t.UBAT_ON,UBAT_AN:()=>t.UBAT_AN,UBAT_EN:()=>w.lastArabic?t.UBAT_AN:t.UBAT_EN,UBAT_AL:()=>{w.lastArabic=!0;w.hasUbatAl=!0;return t.UBAT_R},UBAT_WS:()=>t.UBAT_ON,UBAT_CS:()=>{let v,C;if(1>F||F+1>=A.length||(v=E[F-1])!==t.UBAT_EN&&
v!==t.UBAT_AN||(C=A[F+1])!==t.UBAT_EN&&C!==t.UBAT_AN)return t.UBAT_ON;w.lastArabic&&(C=t.UBAT_AN);return C===v?C:t.UBAT_ON},UBAT_ES:()=>(0<F?E[F-1]:t.UBAT_B)===t.UBAT_EN&&F+1<A.length&&A[F+1]===t.UBAT_EN?t.UBAT_EN:t.UBAT_ON,UBAT_ET:()=>{if(0<F&&E[F-1]===t.UBAT_EN)return t.UBAT_EN;if(w.lastArabic)return t.UBAT_ON;let v=F+1;const C=A.length;for(;v<C&&A[v]===t.UBAT_ET;)v++;return v<C&&A[v]===t.UBAT_EN?t.UBAT_EN:t.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===w.inFormat){for(var v=A.length,C=F+1;C<v&&A[C]===t.UBAT_NSM;)C++;
if(C<v&&(v=q[F].charCodeAt[0],C=A[C],(1425<=v&&2303>=v||64286===v)&&(C===t.UBAT_R||C===t.UBAT_AL)))return t.UBAT_R}return 1>F||A[F-1]===t.UBAT_B?t.UBAT_ON:E[F-1]},UBAT_B:()=>{w.lastArabic=!0;w.hasUbatB=!0;return w.dir},UBAT_S:()=>{w.hasUbatS=!0;return t.UBAT_ON},UBAT_LRE:()=>{w.lastArabic=!1;return t.UBAT_ON},UBAT_RLE:()=>{w.lastArabic=!1;return t.UBAT_ON},UBAT_LRO:()=>{w.lastArabic=!1;return t.UBAT_ON},UBAT_RLO:()=>{w.lastArabic=!1;return t.UBAT_ON},UBAT_PDF:()=>{w.lastArabic=!1;return t.UBAT_ON},
UBAT_BN:()=>t.UBAT_ON}[t.TYPES_NAMES[A[F]]]()}function c(q,A){for(let E=0;E<t.BaseForm.length;E++)if(q===t.BaseForm[E])return A[E];return q}function e(q){return"\u064b"<=q&&"\u0655">=q?!0:!1}function f(q){return"L"===q?"LTR":"R"===q?"RTL":"C"===q?"CLR":"D"===q?"CRL":""}function k(q,A){for(let E=0;E<t.AlefTable.length;E++)if(q===t.AlefTable[E])return A[E];return q}function p(q,A,E,F){for(let w=0;w<q.length;w++)if(q[w]>A||!E&&q[w]===A)q[w]+=F}let m=[],b=[],h=[];const n={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",
defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},r=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,x=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function q(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}var A=q.prototype;A.bidiTransform=function(E,F,w){this.sourceToTarget=[];this.targetToSource=[];if(!E)return"";var v=this.sourceToTarget,C=this.targetToSource,
G=E.length;m=[];h=[];for(var H=0;H<G;H++)v[H]=H,C[H]=H,m[H]=H;if(!this.checkParameters(F,w))return E;F=this.inputFormat;w=this.outputFormat;v=E;G=f(F.charAt(1));v=f(w.charAt(1));H="I"===F.charAt(0)?"L":F.charAt(0);C="I"===w.charAt(0)?"L":w.charAt(0);G=H+G;v=C+v;C=F.charAt(2)+w.charAt(2);n.defInFormat=G;n.defOutFormat=v;n.defSwap=C;E=u(E,G,v,C,n);v=!1;if("R"===w.charAt(1))v=!0;else if("C"===w.charAt(1)||"D"===w.charAt(1))v="rtl"===this.checkContextual(E);C=this.sourceToTarget=m;G=Array(C.length);for(H=
0;H<C.length;H++)G[C[H]]=H;b=this.targetToSource=C=G;if(F.charAt(3)===w.charAt(3))v=E;else if("S"===w.charAt(3))if(F=v,w=!0,0===E.length)v="";else{void 0===F&&(F=!0);void 0===w&&(w=!0);E=String(E);E=E.split("");G=0;v=1;C=E.length;F||(G=E.length-1,v=-1,C=1);var L=G;G=w;var O=0;H=[];for(var N=0;L*v<C;L+=v)if(l(E[L])||e(E[L])){var K;if(K="\u0644"===E[L])b:{for(var I=E,M=L+v,U=v,T=C;M*U<T&&e(I[M]);)M+=U;K=" ";if(M*U<T)for(K=I[M],I=0;I<t.AlefTable.length;I++)if(t.AlefTable[I]===K){K=!0;break b}K=!1}if(K){E[L]=
0===O?k(E[L+v],t.LamAlefInialTableFE):k(E[L+v],t.LamAlefMedialTableFE);L+=v;O=E;K=L;I=v;for(M=C;K*I<M&&e(O[K]);)K+=I;K*I<M&&(O[K]=" ");G&&(H[N]=L,N++);O=0}else{K=E[L];if(1===O){I=L;if(g(E,L+v,v,C))b:for(M=E[L],U=0;U<t.BaseForm.length;U++){if(M===t.BaseForm[U]){M=t.MedialForm[U];break b}}else M=c(E[L],t.FinalForm);E[I]=M}else!0===g(E,L+v,v,C)?E[L]=c(E[L],t.InitialForm):E[L]=c(E[L],t.IsolatedForm);e(K)||(O=1);b:{for(I=0;I<t.StandAlonForm.length;I++)if(t.StandAlonForm[I]===K){K=!0;break b}K=!1}!0===
K&&(O=0)}}else O=0;v=H;C="";for(G=0;G<E.length;G++){if(H=w){b:{for(H=0;H<v.length;H++)if(v[H]===G)break b;H=-1}H=-1<H}H?(p(b,G,!F,-1),m.splice(G,1)):C+=E[G]}v=C}else if(F=E,w=v,E=!0,0===F.length)v="";else for(void 0===E&&(E=!0),void 0===w&&(w=!0),F=String(F),v="",C=F.split(""),G=0;G<F.length;G++)H=!1,"\ufe70"<=C[G]&&"\ufeff">C[G]?(N=F.charCodeAt(G),"\ufef5"<=C[G]&&"\ufefc">=C[G]?(w?(0<G&&E&&" "===C[G-1]?v=v.substring(0,v.length-1)+"\u0644":(v+="\u0644",H=!0),v+=t.AlefTable[(N-65269)/2]):(v+=t.AlefTable[(N-
65269)/2],v+="\u0644",G+1<F.length&&E&&" "===C[G+1]?G++:H=!0),H&&(p(b,G,!0,1),m.splice(G,0,m[G]))):v+=t.FETo06Table[N-65136]):v+=C[G];this.sourceToTarget=m;this.targetToSource=b;this.levels=h;return v};A._inputFormatSetter=function(E){if(!r.test(E))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=E};A._outputFormatSetter=function(E){if(!r.test(E))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=E};A.checkParameters=
function(E,F){E?this._inputFormatSetter(E):E=this.inputFormat;F?this._outputFormatSetter(F):F=this.outputFormat;return E===F?!1:!0};A.checkContextual=function(E){E=B(E);if("ltr"!==E&&"rtl"!==E){try{E=document.dir.toLowerCase()}catch(F){}"ltr"!==E&&"rtl"!==E&&(E="ltr")}return E};A.hasBidiChar=function(E){return x.test(E)};return q}()})},"esri/core/bidiEngineTables":function(){define(["exports"],function(t){t.AlefTable=["\u0622","\u0623","\u0625","\u0627"];t.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];
t.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];t.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");t.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
t.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");t.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
t.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");t.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];t.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];t.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
t.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];t.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");t.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];t.TBBASE=100;t.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");t.UBAT_AL=7;t.UBAT_AN=3;t.UBAT_B=5;t.UBAT_BN=18;t.UBAT_CS=9;t.UBAT_EN=2;t.UBAT_ES=10;t.UBAT_ET=11;t.UBAT_L=0;t.UBAT_LRE=13;t.UBAT_LRO=16;t.UBAT_NSM=12;t.UBAT_ON=
4;t.UBAT_PDF=15;t.UBAT_R=1;t.UBAT_RLE=14;t.UBAT_RLO=17;t.UBAT_S=6;t.UBAT_WS=8;t.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];t.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];t.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/Rasterizer":function(){define(["./CIMSymbolHelper","./Rect","./SDFHelper","./utils"],function(t,u,B,D){return function(){function z(l){this._resourceManager=l}var y=z.prototype;y.dispose=function(){this._rasterizationCanvas=
null};y.rasterizeJSONResource=function(l,g,d){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===l.type||"esriSFS"===l.type){const [b,h,n]=t.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,l.style,g);return{size:[h,n],image:new Uint32Array(b.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===l.type||"esriSLS"===l.type||"line"===l.type&&l.dashTemplate){if("simple-line"===l.type||"esriSLS"===l.type)switch(d=t.slsDashToTemplateArray(l.style,
l.cap),l.cap){case "butt":l="Butt";break;case "square":l="Square";break;default:l="Round"}else d=l.dashTemplate,l=l.cim.capStyle;const [b,h,n]=t.SymbolHelper.rasterizeSimpleLine(d,l);return{size:[h,n],image:new Uint32Array(b.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,c;"simple-marker"===l.type||"esriSMS"===l.type||"line-marker"===l.type?(l=t.CIMSymbolHelper.fromSimpleMarker(l),c=B.getSDFInfo(l)):l.cim&&"CIMHatchFill"===l.cim.type?(l=t.CIMSymbolHelper.fromCIMHatchFill(l.cim),a=new u(l.frame.xmin,
-l.frame.ymax,l.frame.xmax-l.frame.xmin,l.frame.ymax-l.frame.ymin)):l.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===l.cim.markerPlacement.type?(l=t.CIMSymbolHelper.fromCIMInsidePolygon(l.cim),a=new u(l.frame.xmin,-l.frame.ymax,l.frame.xmax-l.frame.xmin,l.frame.ymax-l.frame.ymin)):(l=l.cim,c=B.getSDFInfo(l));if(c&&!d){const [b,h,n]=B.buildSDF(c);return b?{size:[h,n],image:new Uint32Array(b.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const [e,f,k,p,m]=t.CIMSymbolHelper.rasterize(this._rasterizationCanvas,
l,a,this._resourceManager,!d);return e?{size:[f,k],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!1,anchorX:p,anchorY:m}:null};y.rasterizeImageResource=function(l,g,d,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=l;this._rasterizationCanvas.height=g;var c=this._rasterizationCanvas.getContext("2d");d instanceof ImageData?c.putImageData(d,0,0):(d.setAttribute("width",`${l}px`),d.setAttribute("height",`${g}px`),c.drawImage(d,
0,0,l,g));d=c.getImageData(0,0,l,g);d=new Uint8Array(d.data);if(a)for(var e of a)if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){const [f,k,p,m]=e.oldColor,[b,h,n,r]=e.newColor;if(f!==b||k!==h||p!==n||m!==r)for(a=0;a<d.length;a+=4)f===d[a]&&k===d[a+1]&&p===d[a+2]&&m===d[a+3]&&(d[a]=b,d[a+1]=h,d[a+2]=n,d[a+3]=r)}for(a=0;a<d.length;a+=4)e=d[a+3]/255,d[a]*=e,d[a+1]*=e,d[a+2]*=e;c=d;e=l;a=g;if(512<=e||512<=a){c=e/a;1<c?(e=512,a=Math.round(512/c)):(a=512,e=Math.round(512*c));
c=new Uint8Array(4*e*a);const f=new Uint8ClampedArray(c.buffer);D.resampleHermite(d,l,g,f,e,a,!1)}return{size:[e,a],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return z}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/BidiText ../../core/floatRGBA ../../core/lang ../../core/Logger ../../core/mathUtils ../../core/maybe ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h){function n(Q,J){switch(J.type){case "CIMSymbolReference":return n(Q,J.symbol);case "CIMPointSymbol":Q.drawSymbol(J,{x:0,y:0});break;case "CIMLineSymbol":Q.drawSymbol(J,{paths:[[[0,0],[0,1]]]});break;case "CIMPolygonSymbol":Q.drawSymbol(J,{rings:[[[0,0],[0,1],[0,0]]]});break;case "CIMTextSymbol":Q.drawSymbol(J,{x:0,y:0});break;case "CIMVectorMarker":{const P=new e.Placement;Q.drawMarker(J,P)}}return Q.envelope()}function r(Q){if(!Q)return 0;switch(Q.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(Q.offset);
case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(Q.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(Q.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(Q.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(Q.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(Q.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(Q.offset);case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}
function x(Q){if(!Q)return 0;switch(Q.type){case "CIMGeometricEffectArrow":return Math.abs(.5*Q.width);case "CIMGeometricEffectBuffer":return Math.abs(Q.size);case "CIMGeometricEffectExtension":return Math.abs(Q.length);case "CIMGeometricEffectJog":return Math.abs(.5*Q.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(p.getValue(Q.offsetX)),Math.abs(p.getValue(Q.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(Q.offset);case "CIMGeometricEffectOffsetTangent":return Math.abs(Q.offset);
case "CIMGeometricEffectRadial":return Math.abs(Q.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(Q.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(Q.fromWidth),Math.abs(Q.toWidth));case "CIMGeometricEffectWave":return Math.abs(Q.amplitude);default:return 0}}function q(Q){if(!Q)return 0;let J=0;for(const P of Q)J+=x(P);return J}const A=Math.PI,E=A/2,F=96/72,w=Math.PI/180,v=y.getLogger("esri.symbols.cim.CIMSymbolHelper");
y=function(){function Q(){}var J=Q.prototype;J.getSymbolInflateSize=function(P,S,W,Z,V){P||(P=[0,0,0,0]);return S?this._getInflateSize(P,S,W,Z,V):P};Q.safeSize=function(P){const S=Math.max(Math.abs(P[0]),Math.abs(P[2]));P=Math.max(Math.abs(P[1]),Math.abs(P[3]));return Math.sqrt(S*S+P*P)};J._vectorMarkerBounds=function(P,S,W,Z){let V=!0;const Y=a.create();if(S&&S.markerGraphics)for(const X of S.markerGraphics)S=[0,0,0,0],X.geometry&&(c.getBoundsXY(Y,X.geometry),S[0]=0,S[1]=0,S[2]=0,S[3]=0,this.getSymbolInflateSize(S,
X.symbol,W,0,Z),Y[0]+=S[0],Y[1]+=S[1],Y[2]+=S[2],Y[3]+=S[3],V?(P[0]=Y[0],P[1]=Y[1],P[2]=Y[2],P[3]=Y[3],V=!1):(P[0]=Math.min(P[0],Y[0]),P[1]=Math.min(P[1],Y[1]),P[2]=Math.max(P[2],Y[2]),P[3]=Math.max(P[3],Y[3])));return P};J._getInflateSize=function(P,S,W,Z,V){return void 0!==S.symbolLayers?(P=this._getLayersInflateSize(P,S.symbolLayers,W,Z,V),S=q(S.effects),0<S&&(P[0]-=S,P[1]-=S,P[2]+=S,P[3]+=S),P):this._getTextInflatedSize(P,S,V)};J._getLayersInflateSize=function(P,S,W,Z,V){let Y=!0;if(!S)return P;
for(const da of S)if(da){var X=[0,0,0,0];switch(da.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":S=da;var R=S.width;R=S.capStyle===k.LineCapStyle.Square||S.joinStyle===k.LineJoinStyle.Miter?R/1.4142135623730951:R/2;X[0]=-R;X[1]=-R;X[2]=R;X[3]=R;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":S=da;if("CIMVectorMarker"===da.type){if(R=da,X=this._vectorMarkerBounds(X,R,W,V),R.frame){var aa=(R.frame.xmin+R.frame.xmax)/2,ba=(R.frame.ymin+R.frame.ymax)/
2;X[0]-=aa;X[1]-=ba;X[2]-=aa;X[3]-=ba;R=R.size/(R.frame.ymax-R.frame.ymin);X[0]*=R;X[1]*=R;X[2]*=R;X[3]*=R}}else"CIMPictureMarker"===da.type?(X=da,aa=W.getResource(X.url),R=1,g.isSome(aa)&&aa.height&&(R=aa.width/aa.height),aa=S.size/2,X=S.size*R*X.scaleX/2,X=[-X,-aa,X,aa]):(X=S.size/2,X=[-X,-X,X,X]);S.anchorPoint&&("Absolute"===S.anchorPointUnits?(R=S.anchorPoint.x,aa=S.anchorPoint.y):(R=S.anchorPoint.x*(X[2]-X[0]),aa=S.anchorPoint.y*(X[3]-X[1])),X[0]-=R,X[1]-=aa,X[2]-=R,X[3]-=aa);R=p.getValue(S.rotation);
S.rotateClockwise&&(R=-R);Z&&(R-=Z);R&&(aa=w*R,R=Math.cos(aa),aa=Math.sin(aa),ba=a.create([m.C_INFINITY,m.C_INFINITY,-m.C_INFINITY,-m.C_INFINITY]),a.expandPointInPlace(ba,[X[0]*R-X[1]*aa,X[0]*aa+X[1]*R]),a.expandPointInPlace(ba,[X[0]*R-X[3]*aa,X[0]*aa+X[3]*R]),a.expandPointInPlace(ba,[X[2]*R-X[1]*aa,X[2]*aa+X[1]*R]),a.expandPointInPlace(ba,[X[2]*R-X[3]*aa,X[2]*aa+X[3]*R]),X=ba);R=p.getValue(S.offsetX);aa=p.getValue(S.offsetY);if(Z){var ca=w*Z;ba=Math.cos(ca);ca=Math.sin(ca);const ea=R*ca+aa*ba;R=
R*ba-aa*ca;aa=ea}X[0]+=R;X[1]+=aa;X[2]+=R;X[3]+=aa;S=r(S.markerPlacement);0<S&&(X[0]-=S,X[1]-=S,X[2]+=S,X[3]+=S)}S=q(da.effects);0<S&&(X[0]-=S,X[1]-=S,X[2]+=S,X[3]+=S);Y?(P[0]=X[0],P[1]=X[1],P[2]=X[2],P[3]=X[3],Y=!1):(P[0]=Math.min(P[0],X[0]),P[1]=Math.min(P[1],X[1]),P[2]=Math.max(P[2],X[2]),P[3]=Math.max(P[3],X[3]))}return P};J._getTextInflatedSize=function(P,S,W){var Z,V;const Y=null!=(Z=S.height)?Z:10;P[0]=-Y/2;P[1]=-Y/2;P[2]=Y/2;P[3]=Y/2;if(!W)return P;W=W.get(S);if(!W)return P;const {text:X,
mosaicItem:R}=W;if(!R||0===R.glyphMosaicItems.length)return P;W=f.lineGapType2LineHeight(S.lineGapType,null!=(V=S.lineGap)?V:0,Y);V=B.bidiText(X)[1];S=h.shapeGlyphs(R.glyphMosaicItems,V,{scale:Y/b.GLYPH_SIZE,angle:p.getValue(S.angle),xOffset:p.getValue(S.offsetX),yOffset:p.getValue(S.offsetY),hAlign:f.horizontalAlignment2HAlign(S.horizontalAlignment),vAlign:f.verticalAlignment2VAlign(S.verticalAlignment),maxLineWidth:512,lineHeight:b.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(W||1,4)),decoration:S.font.decoration||
"none",isCIM:!0}).boundsT;P[0]=S.x-S.halfWidth;P[1]=-S.y-S.halfHeight;P[2]=S.x+S.halfWidth;P[3]=-S.y+S.halfHeight;return P};return Q}();let C=function(){function Q(){}Q.getEnvelope=function(J,P){P=new f.EnvDrawHelper(P);if(Array.isArray(J)){let S;for(const W of J)S?S.union(n(P,W)):S=n(P,W);return S}return n(P,J)};Q.getTextureAnchor=function(J,P){J=this.getEnvelope(J,P);if(!J)return[0,0,0];P=J.height*F+2;return[(J.x+.5*J.width)*F/(J.width*F+2),-(J.y+.5*J.height)*F/P,P]};Q.rasterize=function(J,P,S,
W,Z=!0){var V=S||this.getEnvelope(P,W);if(!V)return[null,0,0,0,0];const Y=(V.x+.5*V.width)*F,X=(V.y+.5*V.height)*F;J.width=V.width*F;J.height=V.height*F;S||(J.width+=2,J.height+=2);S=J.getContext("2d");V=f.Transformation.createScale(F,-F);V.translate(.5*J.width-Y,.5*J.height+X);W=new f.CanvasDrawHelper(S,W,V);switch(P.type){case "CIMPointSymbol":W.drawSymbol(P,{type:"point",x:0,y:0});break;case "CIMVectorMarker":V=new e.Placement,W.drawMarker(P,V)}P=S.getImageData(0,0,J.width,J.height);P=new Uint8Array(P.data);
if(Z)for(W=0;W<P.length;W+=4)Z=P[W+3]/255,P[W]*=Z,P[W+1]*=Z,P[W+2]*=Z;return[P,J.width,J.height,-Y/J.width,-X/J.height]};Q.fromTextSymbol=function(J){const {angle:P,color:S,font:W,haloColor:Z,haloSize:V,horizontalAlignment:Y,kerning:X,text:R,verticalAlignment:aa,xoffset:ba,yoffset:ca}=J;let da,ea;if(W){var ia=W.family;var ha=W.style;var fa=W.weight;da=W.size;ea=W.decoration}J=!1;R&&(J=B.bidiText(R)[1]);var ka=k.BlockProgression.BTT,la=k.FontEffects.Normal,pa=k.FontEncoding.Unicode;ia=ia||"Arial";
b:{if(fa)switch(fa.toLowerCase()){case "bold":case "bolder":fa="bold";break b}fa=""}b:{if(ha)switch(ha.toLowerCase()){case "italic":case "oblique":ha="italic";break b}ha=""}fa=fa&&ha?`${fa}-${ha}`:`${fa}${ha}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",
angle:P,blockProgression:ka,depth3D:1,extrapolateBaselines:!0,fontEffects:la,fontEncoding:pa,fontFamilyName:ia,fontStyleName:fa,fontType:k.FontType.Unspecified,haloSize:V,height:da,hinting:k.GlyphHinting.Default,horizontalAlignment:N(null!=Y?Y:"center"),kerning:X,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:p.getValue(ba),offsetY:p.getValue(ca),strikethrough:"line-through"===ea,underline:"underline"===ea,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:I(S)}]},
haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:I(Z)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:J?k.TextReadingDirection.RTL:k.TextReadingDirection.LTR,verticalAlignment:K(null!=aa?aa:"baseline"),verticalGlyphOrientation:k.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:k.BillBoardMode.FaceNearPlane},textString:R}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};
Q.fromPictureFillSymbol=function(J){const {height:P,outline:S,width:W,xoffset:Z,xscale:V,yoffset:Y,yscale:X}=J,R=[],aa={type:"CIMPolygonSymbol",symbolLayers:R};if(S){const {cap:ca,join:da,miterLimit:ea,width:ia}=S;R.push({type:"CIMSolidStroke",color:I(S.color),capStyle:L(ca),joinStyle:O(da),miterLimit:ea,width:ia})}let ba=J.url;"esriPFS"===J.type&&J.imageData&&(ba=J.imageData);J="angle"in J?J.angle:0;R.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:k.TextureFilter.Picture,
tintColor:null,url:ba,height:P*(X||1),width:W*(V||1),offsetX:p.getValue(Z),offsetY:p.getValue(Y),rotation:p.getValue(-J),colorSubstitutions:null});return aa};Q.fromSimpleFillSymbol=function(J){const {color:P,style:S,outline:W}=J;J=[];const Z={type:"CIMPolygonSymbol",symbolLayers:J};var V=null;if(W){const {cap:X,join:R,style:aa}=W;"solid"!==aa&&"none"!==aa&&"esriSLSSolid"!==aa&&"esriSLSNull"!==aa&&(V=[{type:"CIMGeometricEffectDashes",dashTemplate:M(aa,X),lineDashEnding:"NoConstraint",scaleDash:!0,
offsetAlongLine:null}]);J.push({type:"CIMSolidStroke",color:I(W.color),capStyle:L(X),joinStyle:O(R),miterLimit:W.miterLimit,width:W.width,effects:V})}if(S&&"solid"!==S&&"none"!==S&&"esriSFSSolid"!==S&&"esriSFSNull"!==S){V={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:I(P),capStyle:k.LineCapStyle.Butt,joinStyle:k.LineJoinStyle.Miter,width:.75}]};let X=0;var Y=l.nextPowerOfTwo(Math.ceil(window.devicePixelRatio));Y=T(S)?8*Y:10*Y;switch(S){case "vertical":case "esriSFSVertical":X=90;
break;case "forward-diagonal":case "esriSFSForwardDiagonal":X=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":X=45;break;case "cross":case "esriSFSCross":X=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":X=-45}J.push({type:"CIMHatchFill",lineSymbol:V,offsetX:0,offsetY:0,rotation:X,separation:Y});"cross"===S||"esriSFSCross"===S?J.push({type:"CIMHatchFill",lineSymbol:z.clone(V),offsetX:0,offsetY:0,rotation:90,separation:Y}):("diagonal-cross"===S||"esriSFSDiagonalCross"===
S)&&J.push({type:"CIMHatchFill",lineSymbol:z.clone(V),offsetX:0,offsetY:0,rotation:45,separation:Y})}else!S||"solid"!==S&&"esriSFSSolid"!==S||J.push({type:"CIMSolidFill",enable:!0,color:I(P)});return Z};Q.fromSimpleLineSymbol=function(J){const {cap:P,color:S,join:W,marker:Z,miterLimit:V,style:Y,width:X}=J;J=null;"solid"!==Y&&"none"!==Y&&"esriSLSSolid"!==Y&&"esriSLSNull"!==Y&&(J=[{type:"CIMGeometricEffectDashes",dashTemplate:M(Y,P),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);
const R=[];if(Z){let aa;switch(Z.placement){case "begin-end":aa=k.ExtremityPlacement.Both;break;case "begin":aa=k.ExtremityPlacement.JustBegin;break;case "end":aa=k.ExtremityPlacement.JustEnd;break;default:aa=k.ExtremityPlacement.None}const ba=Q.fromSimpleMarker(Z,X,S).symbolLayers[0];ba.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:aa,offsetAlongLine:0};R.push(ba)}"none"!==Y&&"esriSLSNull"!==Y&&R.push({type:"CIMSolidStroke",color:I(S),capStyle:L(P),
joinStyle:O(W),miterLimit:V,width:X,effects:J});return{type:"CIMLineSymbol",symbolLayers:R}};Q.fromPictureMarker=function(J){const {angle:P,height:S,width:W,xoffset:Z,yoffset:V}=J;let Y=J.url;"esriPMS"===J.type&&J.imageData&&(Y=J.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:k.TextureFilter.Picture,tintColor:null,url:Y,size:S,width:W,offsetX:p.getValue(Z),offsetY:p.getValue(V),rotation:p.getValue(-P)}]}};Q.fromSimpleMarker=
function(J,P,S){var W,{style:Z}=J;S=null!=(W=J.color)?W:S;if("path"===Z){P=[];"outline"in J&&J.outline&&(W=J.outline,P.push({type:"CIMSolidStroke",enable:!0,width:d.pt2px(Math.round(d.px2pt(W.width))),color:I(W.color)}));P.push({type:"CIMSolidFill",enable:!0,color:I(S),path:J.path});const [R,aa]=U("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:p.getValue(-J.angle),size:p.getValue(J.size||6),offsetX:p.getValue(J.xoffset),offsetY:p.getValue(J.yoffset),
frame:R,markerGraphics:[{type:"CIMMarkerGraphic",geometry:aa,symbol:{type:"CIMPolygonSymbol",symbolLayers:P}}]}]}}const [V,Y]=U(Z);let X;Y&&V&&(W=[],"outline"in J&&J.outline?(Z=J.outline,W.push({type:"CIMSolidStroke",enable:!0,width:.667<Z.width?d.pt2px(Math.round(d.px2pt(Z.width))):Z.width,color:I(Z.color)})):!P||"line-marker"!==J.type||"cross"!==J.style&&"x"!==J.style||W.push({type:"CIMSolidStroke",enable:!0,width:P,color:I(S)}),W.push({type:"CIMSolidFill",enable:!0,color:I(S)}),S={type:"CIMPolygonSymbol",
symbolLayers:W},X={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:p.getValue(-J.angle),size:p.getValue(J.size||6*P),offsetX:p.getValue(J.xoffset),offsetY:p.getValue(J.yoffset),frame:V,markerGraphics:[{type:"CIMMarkerGraphic",geometry:Y,symbol:S}]}]});return X};Q.fromCIMHatchFill=function(J){var P;const S=null!=(P=J.separation)?P:4;P=S/2;for(var W=this._getLineSymbolPeriod(J.lineSymbol)||4;4>W;)W*=2;W/=2;return{type:"CIMVectorMarker",frame:{xmin:-W,xmax:W,ymin:-P,ymax:P},
markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-W,0],[W,0]]]},symbol:J.lineSymbol}],size:S}};Q._getLineSymbolPeriod=function(J){if(J){const P=this._getEffectsRepeat(J.effects);if(P)return P;if(J.symbolLayers)for(const S of J.symbolLayers)if((J=this._getEffectsRepeat(S.effects))||S&&(J=this._getPlacementRepeat(S.markerPlacement)))return J}return 0};Q._getEffectsRepeat=function(J){if(J)for(var P of J)if(P)switch(P.type){case "CIMGeometricEffectDashes":if((J=P.dashTemplate)&&J.length){P=
0;for(const S of J)P+=S;J.length&1&&(P*=2);return P}break;case "CIMGeometricEffectWave":return P.period;default:v.error(`unsupported geometric effect type ${P.type}`)}return 0};Q._getPlacementRepeat=function(J){if(J)switch(J.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((J=J.placementTemplate)&&J.length){let P=0;for(const S of J)P+=S;J.length&1&&(P*=2);return P}}return 0};Q.fromCIMInsidePolygon=function(J){var P=
J.markerPlacement;const S={type:J.type,...J,markerPlacement:null,anchorPoint:null};let W,Z;!0===P.shiftOddRows?(J=P.stepX/2,W=P.stepY,Z=2*P.stepY,P=[{x:-J,y:0},{x:J,y:0},{x:0,y:W},{x:0,y:-W}].map(V=>({type:"CIMMarkerGraphic",geometry:V,symbol:{type:"CIMPointSymbol",symbolLayers:[S]}}))):(J=P.stepX/2,W=P.stepY/2,Z=P.stepY,P=[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[S]}}]);return{type:"CIMVectorMarker",frame:{xmin:-J,xmax:J,ymin:-W,ymax:W},markerGraphics:P,
size:Z}};Q.getFillColor=function(J){if(!J)return null;switch(J.type){case "CIMPolygonSymbol":if(J.symbolLayers)for(const P of J.symbolLayers)if(J=Q.getFillColor(P),null!=J)return J;break;case "CIMTextSymbol":return Q.getFillColor(J.symbol);case "CIMSolidFill":return J.color}};Q.getStrokeColor=function(J){if(J)switch(J.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(J.symbolLayers)for(const P of J.symbolLayers)if(J=Q.getStrokeColor(P),void 0!==J)return J;break;case "CIMTextSymbol":return Q.getStrokeColor(J.symbol);
case "CIMSolidStroke":return J.color}};Q.getStrokeWidth=function(J){if(J)switch(J.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(J.symbolLayers)for(const P of J.symbolLayers)if(J=Q.getStrokeWidth(P),void 0!==J)return J;break;case "CIMTextSymbol":return Q.getStrokeWidth(J.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return J.width}};Q.getSize=function(J){if(J)switch(J.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":{let P=0;if(J.symbolLayers)for(const S of J.symbolLayers)J=
Q.getSize(S),J>P&&(P=J);return P}case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return J.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return J.size}};Q.getMarkerScaleRatio=function(J){if(J)switch(J.type){case "CIMVectorMarker":if(!1!==J.scaleSymbolsProportionally&&J.frame)return J.size/(J.frame.ymax-J.frame.ymin)}return 1};return Q}(),G=function(){function Q(){}Q.rasterizeSimpleFill=function(J,P,S){"solid"!==P&&"none"!==P&&"esriSFSSolid"!==
P&&"esriSFSNull"!==P||console.error("Unexpected: style does not require rasterization");S=l.nextPowerOfTwo(Math.ceil(S));var W=T(P)?8*S:16*S;const Z=2*S;J.width=W;J.height=W;const V=J.getContext("2d");V.strokeStyle="#FFFFFF";V.lineWidth=S;V.beginPath();if("vertical"===P||"cross"===P||"esriSFSCross"===P||"esriSFSVertical"===P)V.moveTo(W/2,-Z),V.lineTo(W/2,W+Z);if("horizontal"===P||"cross"===P||"esriSFSCross"===P||"esriSFSHorizontal"===P)V.moveTo(-Z,W/2),V.lineTo(W+Z,W/2);if("forward-diagonal"===P||
"diagonal-cross"===P||"esriSFSDiagonalCross"===P||"esriSFSForwardDiagonal"===P)V.moveTo(-Z,-Z),V.lineTo(W+Z,W+Z),V.moveTo(W-Z,-Z),V.lineTo(W+Z,Z),V.moveTo(-Z,W-Z),V.lineTo(Z,W+Z);if("backward-diagonal"===P||"diagonal-cross"===P||"esriSFSBackwardDiagonal"===P||"esriSFSDiagonalCross"===P)V.moveTo(W+Z,-Z),V.lineTo(-Z,W+Z),V.moveTo(Z,-Z),V.lineTo(-Z,Z),V.moveTo(W+Z,W-Z),V.lineTo(W-Z,W+Z);V.stroke();P=V.getImageData(0,0,J.width,J.height);P=new Uint8Array(P.data);for(W=0;W<P.length;W+=4)S=P[W+3]/255,P[W]*=
S,P[W+1]*=S,P[W+2]*=S;return[P,J.width,J.height]};Q.rasterizeSimpleLine=function(J,P){return this.rasterizeDash(J,P)};Q.rasterizeDash=function(J,P){var S="Butt"===P,W="Square"===P;P=!S&&!W;1===J.length%2&&(J=[...J,...J]);var Z=0;for(var V of J)Z+=V;V=Math.round(15.5*Z);Z=new Float32Array(31*V);let Y=0,X=0,R=.5,aa=!0;for(var ba of J){Y=X;for(X+=15.5*ba;R<=X;){for(J=.5;31>J;){const ca=P?(J-15.5)*(J-15.5):Math.abs(J-15.5);Z[(J-.5)*V+R-.5]=aa?S?Math.max(Math.max(Y+7.75-R,ca),Math.max(R-X+7.75,ca)):ca:
P?Math.min((R-Y)*(R-Y)+ca,(R-X)*(R-X)+ca):W?Math.min(Math.max(R-Y,ca),Math.max(X-R,ca)):Math.min(Math.max(R-Y+7.75,ca),Math.max(X+7.75-R,ca));J++}R++}aa=!aa}S=Z.length;ba=new Uint8Array(4*S);for(W=0;W<S;++W)D.packFloatRGBA((P?Math.sqrt(Z[W]):Z[W])/15.5,ba,4*W);return[ba,V,31]};return Q}(),H=function(){function Q(){}Q.findApplicableOverrides=function(J,P,S){if(J&&P){if(J.primitiveName){let W=!1;for(const Z of S)if(Z.primitiveName===J.primitiveName){W=!0;break}if(!W)for(const Z of P)Z.primitiveName===
J.primitiveName&&S.push(Z)}switch(J.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(J.effects)for(const W of J.effects)Q.findApplicableOverrides(W,P,S);if(J.symbolLayers)for(const W of J.symbolLayers)Q.findApplicableOverrides(W,P,S);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(J.effects)for(const W of J.effects)Q.findApplicableOverrides(W,
P,S);J.markerPlacement&&Q.findApplicableOverrides(J.markerPlacement,P,S);if("CIMVectorMarker"===J.type){if(J.markerGraphics)for(const W of J.markerGraphics)Q.findApplicableOverrides(W,P,S),Q.findApplicableOverrides(W.symbol,P,S)}else"CIMCharacterMarker"===J.type?Q.findApplicableOverrides(J.symbol,P,S):"CIMHatchFill"===J.type&&Q.findApplicableOverrides(J.lineSymbol,P,S)}}};Q.findEffectOverrides=function(J,P,S){if(P&&J){var W=J.length;for(let V=0;V<W;V++){var Z=J[V];if(Z=null==Z?void 0:Z.primitiveName){let Y=
!1;for(const X of S)if(X.primitiveName===Z){Y=!0;break}if(!Y)for(const X of P)X.primitiveName===Z&&S.push(X)}}}};Q.applyOverrides=function(J,P,S,W){if(P){if(J.primitiveName)for(const V of P)if(V.primitiveName===J.primitiveName){var Z=(Z=V.propertyName)?Z.charAt(0).toLowerCase()+Z.substr(1):Z;W&&W.push({cim:J,nocapPropertyName:Z,value:J[Z]});V.expression&&(V.value=Q.toValue(V.propertyName,V.expression));if(S){let Y=!1;for(const X of S)X.primitiveName===J.primitiveName&&(Y=!0);Y||S.push(V)}J[Z]=V.value}switch(J.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(J.effects)for(const V of J.effects)Q.applyOverrides(V,
P,S,W);if(J.symbolLayers)for(const V of J.symbolLayers)Q.applyOverrides(V,P,S,W);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(J.effects)for(const V of J.effects)Q.applyOverrides(V,P,S,W);if("CIMVectorMarker"===J.type&&J.markerGraphics)for(const V of J.markerGraphics)Q.applyOverrides(V,P,S,W),Q.applyOverrides(V.symbol,P,S,W)}}};Q.restoreOverrides=function(J){for(const P of J)P.cim[P.nocapPropertyName]=P.value};Q.buildOverrideKey=function(J){let P="";for(const S of J)void 0!==
S.value&&(P+=`${S.primitiveName}${S.propertyName}${JSON.stringify(S.value)}`);return P};Q.toValue=function(J,P){return"DashTemplate"===J?P.split(" ").map(S=>Number(S)):"Color"===J?(J=(new u(P)).toRgba(),J[3]*=255,J):P};return Q}();const L=Q=>{if(!Q)return k.LineCapStyle.Butt;switch(Q){case "butt":return k.LineCapStyle.Butt;case "square":return k.LineCapStyle.Square;case "round":return k.LineCapStyle.Round}},O=Q=>{if(!Q)return k.LineJoinStyle.Miter;switch(Q){case "miter":return k.LineJoinStyle.Miter;
case "round":return k.LineJoinStyle.Round;case "bevel":return k.LineJoinStyle.Bevel}},N=Q=>{if(!Q)return"Center";switch(Q){case "left":return"Left";case "right":return"Right";case "center":return"Center";case "justify":return"Justify"}},K=Q=>{if(!Q)return"Center";switch(Q){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},I=Q=>{if(!Q)return[0,0,0,0];const {r:J,g:P,b:S,a:W}=Q;return[J,P,S,255*W]},M=(Q,J)=>{J="butt"===J;switch(Q){case "dash":case "esriSLSDash":return J?
[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return J?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return J?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return J?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return J?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return J?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return J?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return J?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return J?
[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return J?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return v.error("Unexpected: style does not require rasterization"),[0,0];default:return v.error(`Tried to rasterize SLS, but found an unexpected style: ${Q}!`),[0,0]}},U=Q=>{if("circle"===Q||"esriSMSCircle"===Q){var J=Math.acos(.995);Q=Math.ceil(A/J/4);0===Q&&(Q=1);J=E/Q;Q*=4;var P=[];P.push([50,0]);for(let S=1;S<Q;S++)P.push([50*Math.cos(S*J),-50*Math.sin(S*J)]);P.push([50,
0]);J={rings:[P]};P={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===Q||"esriSMSCross"===Q?(J={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===Q||"esriSMSDiamond"===Q?(J={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===Q||"esriSMSSquare"===Q?(J={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50}):
"x"===Q||"esriSMSX"===Q?(J={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===Q||"esriSMSTriangle"===Q?(Q=2/3*100,P=Q-100,J={rings:[[[-57.735026918962575,P],[0,Q],[57.735026918962575,P],[-57.735026918962575,P]]]},P={xmin:-57.735026918962575,ymin:P,xmax:57.735026918962575,ymax:Q}):"arrow"===Q&&(J={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},P={xmin:-50,ymin:-50,
xmax:50,ymax:50});return[P,J]},T=Q=>"vertical"===Q||"horizontal"===Q||"cross"===Q||"esriSFSCross"===Q||"esriSFSVertical"===Q||"esriSFSHorizontal"===Q;t.CIMSimbolInflatedSizeHelper=y;t.CIMSymbolHelper=C;t.OverrideHelper=H;t.SymbolHelper=G;t.slsDashToTemplateArray=M;t.symbolToCIM=function(Q){if(!Q||!Q.type)return null;let J;switch(Q.type){case "cim":return Q.data;case "web-style":return Q;case "simple-marker":J=C.fromSimpleMarker(Q);break;case "picture-marker":J=C.fromPictureMarker(Q);break;case "simple-line":J=
C.fromSimpleLineSymbol(Q);break;case "simple-fill":J=C.fromSimpleFillSymbol(Q);break;case "picture-fill":J=C.fromPictureFillSymbol(Q);break;case "text":J=C.fromTextSymbol(Q)}return{type:"CIMSymbolReference",symbol:J}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(t,u){function B(g,d=0){let a=0;for(let c=0;4>c;c++)a+=g[d+c]*y[c];return a}function D(g){return g-Math.floor(g)}const z=[1,256,65536,16777216],y=[1/256,1/65536,
1/16777216,1/4294967296],l=B(new Uint8ClampedArray([255,255,255,255]));t.packFloatRGBA=function(g,d,a=0){g=u.clamp(g,0,l);for(let c=0;4>c;c++)d[a+c]=Math.floor(256*D(g*z[c]))};t.unpackFloatRGBA=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(t){let u=function(){function D(){this.setIdentity()}var z=D.prototype;z.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,
this.rz_c);return this.rz};z.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};z.setTranslate=function(y,l){this.tx=y;this.ty=l};z.setTranslateZ=function(y){this.tz=y};z.setRotateCS=function(y,l){this.rz=void 0;this.rz_c=y;this.rz_s=l};z.setRotate=function(y){this.rz=y;this.rz_s=this.rz_c=void 0};z.setRotateY=function(y){this.ry=y};z.setScale=function(y){this.s=y};z.setMeasure=function(y){this.m=y};return D}(),B=function(){function D(){}D.prototype.next=
function(){return null};return D}();t.EmptyPlacementCursor=B;t.Placement=u;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./CIMResourceManager ./enums ./Rect ./TextRasterizer ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h,n,r,x){const q=Math.PI/180,A=D.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let E=function(){function O(K){this._t=K}O.createIdentity=function(){return new O([1,0,0,0,1,0])};var N=O.prototype;N.clone=function(){return new O(this._t.slice())};N.transform=function(K){const I=this._t;return[I[0]*K[0]+I[1]*K[1]+I[2],I[3]*K[0]+I[4]*K[1]+I[5]]};O.createScale=function(K,I){return new O([K,0,0,0,I,0])};N.scale=function(K,I){const M=this._t;M[0]*=K;M[1]*=K;
M[2]*=K;M[3]*=I;M[4]*=I;M[5]*=I;return this};N.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};O.createTranslate=function(K,I){return new O([0,0,K,0,0,I])};N.translate=function(K,I){const M=this._t;M[2]+=K;M[5]+=I;return this};O.createRotate=function(K){const I=Math.cos(K);K=Math.sin(K);return new O([I,-K,0,K,I,0])};N.rotate=function(K){return O.multiply(this,O.createRotate(K),this)};O.multiply=function(K,I,M){K=K._t;I=I._t;const U=K[1]*I[0]+K[4]*I[1],T=K[2]*I[0]+
K[5]*I[1]+I[2],Q=K[0]*I[3]+K[3]*I[4],J=K[1]*I[3]+K[4]*I[4],P=K[2]*I[3]+K[5]*I[4]+I[5],S=M._t;S[0]=K[0]*I[0]+K[3]*I[1];S[1]=U;S[2]=T;S[3]=Q;S[4]=J;S[5]=P;return M};N.invert=function(){const K=this._t;let I=K[0]*K[4]-K[1]*K[3];if(0===I)return new O([0,0,0,0,0,0]);I=1/I;return new O([K[4]*I,-K[1]*I,(K[1]*K[5]-K[2]*K[4])*I,-K[3]*I,K[0]*I,(K[2]*K[3]-K[0]*K[5])*I])};return O}();D=function(){function O(K,I){this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new y(k.Placement,
null,null,100);this._earlyReturn=!1;this._mapRotation=0;this._resourceManager=K||new p;this._transfos.push(I||E.createIdentity());this._sizeTransfos.push(I?I.scaleRatio():1)}var N=O.prototype;N.setTransform=function(K,I){this._transfos=[K||E.createIdentity()];this._sizeTransfos=[I?I:K?K.scaleRatio():1]};N.setGeomUnitsPerPoint=function(K){this._geomUnitsPerPoint=K};N.transformPt=function(K){return this._transfos[this._transfos.length-1].transform(K)};N.transformSize=function(K){return K*this._sizeTransfos[this._sizeTransfos.length-
1]};N.reverseTransformPt=function(K){return this._transfos[this._transfos.length-1].invert().transform(K)};N.reverseTransformSize=function(K){return K/this._sizeTransfos[this._sizeTransfos.length-1]};N.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};N.isEmbedded=function(){return 1<this._transfos.length};N.back=function(){return this._transfos[this._transfos.length-1]};N.push=function(K,I){I=I?K.scaleRatio():1;E.multiply(K,this.back(),K);this._transfos.push(K);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-
1]*I)};N.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};N.drawSymbol=function(K,I){if(K)switch(K.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(K,I);break;case "CIMTextSymbol":this.drawTextSymbol(K,I)}};N.drawMultiLayerSymbol=function(K,I){if(K){var M=K.symbolLayers;if(M)if((K=K.effects)&&0<K.length){if(I=this.executeEffects(K,I))for(K=I.next();K;)this.drawSymbolLayers(M,K),K=I.next()}else this.drawSymbolLayers(M,I)}};
N.executeEffects=function(K,I){const M=this._resourceManager.geometryEngine;I=new e.SimpleGeometryCursor(I);for(const U of K)(K=f.getEffectOperator(U))&&(I=K.execute(I,U,this.geomUnitsPerPoint(),M));return I};N.drawSymbolLayers=function(K,I){let M=K.length;for(;M--;){const T=K[M];if(T&&!1!==T.enable){var U=T.effects;if(U&&0<U.length){if(U=this.executeEffects(U,I)){let Q=null;for(;(Q=U.next())&&(this.drawSymbolLayer(T,Q),!this._earlyReturn););}}else this.drawSymbolLayer(T,I);if(this._earlyReturn)break}}};
N.drawSymbolLayer=function(K,I){switch(K.type){case "CIMSolidFill":this.drawSolidFill(I,K.color);break;case "CIMHatchFill":this.drawHatchFill(I,K);break;case "CIMPictureFill":this.drawPictureFill(I,K);break;case "CIMGradientFill":this.drawGradientFill(I,K);break;case "CIMSolidStroke":this.drawSolidStroke(I,K.color,K.width,K.capStyle,K.joinStyle,K.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(I,K);break;case "CIMGradientStroke":this.drawGradientStroke(I,K);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(K,
I)}};N.drawHatchFill=function(K,I){const M=this._buildHatchPolyline(I,K,this.geomUnitsPerPoint());M&&(this.pushClipPath(K),this.drawMultiLayerSymbol(I.lineSymbol,M),this.popClipPath())};N.drawPictureFill=function(K,I){};N.drawGradientFill=function(K,I){};N.drawPictureStroke=function(K,I){};N.drawGradientStroke=function(K,I){};N.drawMarkerLayer=function(K,I){var M=K.markerPlacement;if(M){const T=f.getPlacementOperator(M);if(T){var U="CIMMarkerPlacementInsidePolygon"===M.type;U&&this.pushClipPath(I);
if(I=T.execute(I,M,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine))for(M=null;(M=I.next())&&(this.drawMarker(K,M),!this._earlyReturn););U&&this.popClipPath()}}else{M=this._placementPool.acquire();if(c.isPoint(I))M.tx=I.x,M.ty=I.y,this.drawMarker(K,M);else if(c.isPolygon(I))[M.tx,M.ty]=a.polygonCentroid(I),this.drawMarker(K,M);else for(U of I.points)if(M.tx=U[0],M.ty=U[1],this.drawMarker(K,M),this._earlyReturn)break;this._placementPool.release(M)}};N.drawMarker=function(K,I){switch(K.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(K,
I);break;case "CIMVectorMarker":this.drawVectorMarker(K,I)}};N.drawPictureMarker=function(K,I){var M,U,T,Q,J;if(K){var P=this._resourceManager.getResource(K.url),S=null!=(M=K.size)?M:10;if(!(z.isNone(P)||0>=S)&&(M=P.width,P=P.height,M&&P)){P=M/P;M=null!=(U=K.scaleX)?U:1;U=E.createIdentity();var W=K.anchorPoint;if(W){let Z=W.x;W=W.y;"Absolute"!==K.anchorPointUnits&&(Z*=S*P*M,W*=S);U.translate(-Z,-W)}P=null!=(T=K.rotation)?T:0;K.rotateClockwise&&(P=-P);this._mapRotation&&(P+=this._mapRotation);P&&U.rotate(P*
q);T=null!=(Q=K.offsetX)?Q:0;Q=null!=(J=K.offsetY)?J:0;if(T||Q)this._mapRotation&&(P=q*this._mapRotation,J=Math.cos(P),P=Math.sin(P),M=T*P+Q*J,T=T*J-Q*P,Q=M),U.translate(T,Q);J=this.geomUnitsPerPoint();1!==J&&U.scale(J,J);(J=I.getAngle())&&U.rotate(J);U.translate(I.tx,I.ty);this.push(U,!1);this.drawImage(K.url,S,K.scaleX);this.pop()}}};N.drawVectorMarker=function(K,I){var M,U,T,Q;if(K){var J=K.markerGraphics;if(J){var P=null!=(M=K.size)?M:10,S=(M=K.frame)?M.ymax-M.ymin:0;S=P&&S?P/S:1;P=E.createIdentity();
M&&P.translate(.5*-(M.xmax+M.xmin),.5*-(M.ymax+M.ymin));var W=K.anchorPoint;if(W){let Z=W.x;W=W.y;"Absolute"!==K.anchorPointUnits?M&&(Z*=M.xmax-M.xmin,W*=M.ymax-M.ymin):(Z/=S,W/=S);P.translate(-Z,-W)}1!==S&&P.scale(S,S);M=null!=(U=K.rotation)?U:0;K.rotateClockwise&&(M=-M);this._mapRotation&&(M+=this._mapRotation);M&&P.rotate(M*q);U=null!=(T=K.offsetX)?T:0;T=null!=(Q=K.offsetY)?Q:0;if(U||T)this._mapRotation&&(M=q*this._mapRotation,Q=Math.cos(M),M=Math.sin(M),S=U*M+T*Q,U=U*Q-T*M,T=S),P.translate(U,
T);Q=this.geomUnitsPerPoint();1!==Q&&P.scale(Q,Q);(Q=I.getAngle())&&P.rotate(Q);P.translate(I.tx,I.ty);this.push(P,K.scaleSymbolsProportionally);for(const Z of J)if(Z&&Z.symbol&&Z.geometry||A.error("Invalid marker graphic",Z),this.drawSymbol(Z.symbol,Z.geometry),this._earlyReturn)break;this.pop()}}};N.drawTextSymbol=function(K,I){var M,U,T,Q;if(K&&c.isPoint(I)&&!(0>=(null!=(M=K.height)?M:10))){M=E.createIdentity();var J=null!=(U=K.angle)?U:0;(J=-J)&&M.rotate(J*q);U=null!=(T=K.offsetX)?T:0;T=null!=
(Q=K.offsetY)?Q:0;(U||T)&&M.translate(U,T);Q=this.geomUnitsPerPoint();1!==Q&&M.scale(Q,Q);M.translate(I.x,I.y);this.push(M,!1);this.drawText(K);this.pop()}};N._buildHatchPolyline=function(K,I,M){var U=(void 0!==K.separation?K.separation:4)*M,T=void 0!==K.rotation?K.rotation:0;if(0===U)return null;0>U&&(U=-U);for(var Q=0,J=.5*U;Q>J;)Q-=U;for(;Q<-J;)Q+=U;Q=g.create();d.getBoundsXY(Q,I);Q[0]-=J;Q[1]-=J;Q[2]+=J;Q[3]+=J;for(var P=[[Q[0],Q[1]],[Q[0],Q[3]],[Q[2],Q[3]],[Q[2],Q[1]]];180<T;)T-=180;for(;0>T;)T+=
180;J=Math.cos(T*q);var S=Math.sin(T*q);T=-U*S;I=U*J;Q=(void 0!==K.offsetX?K.offsetX*M:0)*S-(void 0!==K.offsetY?K.offsetY*M:0)*J;let W;var Z=K=Number.MAX_VALUE;W=M=-Number.MAX_VALUE;for(var V of P){var Y=V[0];const X=V[1];P=J*Y+S*X;Y=-S*Y+J*X;Z=Math.min(Z,P);K=Math.min(K,Y);W=Math.max(W,P);M=Math.max(M,Y)}K=Math.floor(K/U)*U;V=J*Z-S*K-T*Q/U;Z=S*Z+J*K-I*Q/U;P=J*W-S*K-T*Q/U;Q=S*W+J*K-I*Q/U;U=1+Math.round((M-K)/U);J=[];for(S=0;S<U;S++)V+=T,Z+=I,P+=T,Q+=I,J.push([[V,Z],[P,Q]]);return{paths:J}};return O}();
let F=function(O){function N(I,M){I=O.call(this,I,M)||this;I.reset();return I}u._inheritsLoose(N,O);var K=N.prototype;K.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};K.envelope=function(){return new b(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};K.bounds=function(){return g.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};K.drawSolidFill=function(I){!I||0<this._clipCount||(c.isPolygon(I)?this._processPath(I.rings,
0):c.isPolyline(I)?this._processPath(I.paths,0):c.isExtent(I)?(I=C(I))&&this._processPath(I.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};K.drawSolidStroke=function(I,M,U){!I||0<this._clipCount||(M=.5*this.transformSize(U),c.isPolygon(I)?this._processPath(I.rings,M):c.isPolyline(I)?this._processPath(I.paths,M):c.isExtent(I)?(I=C(I))&&this._processPath(I.rings,M):console.error("drawSolidStroke unexpected geometry type!"))};K.pushClipPath=function(I){this.drawSolidFill(I);++this._clipCount};
K.popClipPath=function(){--this._clipCount};K.drawImage=function(I,M,U){let T=U*M,Q=M;I=this._resourceManager.getResource(I);!M&&z.isSome(I)&&(T=U*I.width,Q=I.height);this._merge(this.transformPt([-T/2,-Q/2]),0);this._merge(this.transformPt([-T/2,Q/2]),0);this._merge(this.transformPt([T/2,-Q/2]),0);this._merge(this.transformPt([T/2,Q/2]),0)};K.drawText=function(I){this._textRasterizer||(this._textRasterizer=new h.TextRasterizer)};K._processPath=function(I,M){if(I)for(const U of I)if(I=U?U.length:
0,1<I){this._merge(this.transformPt(U[0]),M);for(let T=1;T<I;++T)this._merge(this.transformPt(U[T]),M)}};K._merge=function(I,M){I[0]-M<this._xmin&&(this._xmin=I[0]-M);I[0]+M>this._xmax&&(this._xmax=I[0]+M);I[1]-M<this._ymin&&(this._ymin=I[1]-M);I[1]+M>this._ymax&&(this._ymax=I[1]+M)};return N}(D),w=function(O){function N(){var I=O.apply(this,arguments)||this;I._searchPoint=[0,0];I._searchDistPoint=0;return I}u._inheritsLoose(N,O);var K=N.prototype;K.hitTest=function(I,M,U,T,Q,J){J*=l.pt2px(1);this.setTransform();
this.setGeomUnitsPerPoint(J);this._searchPoint=[(I[0]+I[2])/2,(I[1]+I[3])/2];this._searchDistPoint=(I[2]-I[0])/2/J;this._textInfo=T;this._mapRotation=M&&("CIMPointSymbol"===M.type&&"Map"!==M.angleAlignment||"CIMTextSymbol"===M.type)?Q:0;this._earlyReturn=!1;this.drawSymbol(M,U);return this._earlyReturn};K.drawSolidFill=function(I,M){this._hitTestFill(I)};K.drawHatchFill=function(I,M){this._hitTestFill(I)};K.drawPictureFill=function(I,M){this._hitTestFill(I)};K.drawGradientFill=function(I,M){this._hitTestFill(I)};
K.drawSolidStroke=function(I,M,U,T,Q,J){this._hitTestStroke(I,U)};K.drawPictureStroke=function(I,M){this._hitTestStroke(I,M.width)};K.drawGradientStroke=function(I,M){this._hitTestStroke(I,M.width)};K.pushClipPath=function(I){};K.popClipPath=function(){};K.drawImage=function(I,M,U){I=this._resourceManager.getResource(I);if(!z.isNone(I)&&0!==I.height&&0!==M){M*=this.geomUnitsPerPoint();U=I.width/I.height*U*M;I=this.reverseTransformPt(this._searchPoint);var T=this._searchDistPoint;Math.abs(I[0])<U/
2+T&&Math.abs(I[1])<M/2+T&&(this._earlyReturn=!0)}};K.drawText=function(I){var M,U,T=this._textInfo;if(T&&(T=T.get(I))){var {text:Q,mosaicItem:J}=T;if(J&&0!==J.glyphMosaicItems.length){T=null!=(M=I.height)?M:10;M=L(I.lineGapType,null!=(U=I.lineGap)?U:0,T);U=B.bidiText(Q)[1];I=x.shapeGlyphs(J.glyphMosaicItems,U,{scale:T/r.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:G(I.horizontalAlignment),vAlign:H(I.verticalAlignment),maxLineWidth:512,lineHeight:r.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(M||
1,4)),decoration:I.font.decoration||"none",isCIM:!0});M=this.reverseTransformPt(this._searchPoint);U=M[0];M=M[1];for(const P of I.glyphs)if(U>P.xTopLeft&&U<P.xBottomRight&&M>-P.yBottomRight&&M<-P.yTopLeft){this._earlyReturn=!0;break}}}};K._hitTestFill=function(I){let M=null;if(c.isExtent(I))M=[[[I.xmin,I.ymin],[I.xmin,I.ymax],[I.xmax,I.ymax],[I.xmax,I.ymin],[I.xmin,I.ymin]]];else if(c.isPolygon(I))M=I.rings;else if(c.isPolyline(I))M=I.paths;else return;I=this.reverseTransformPt(this._searchPoint);
this._pointInPolygon(I,M)&&(this._earlyReturn=!0);const U=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(I,M,U)&&(this._earlyReturn=!0)};K._hitTestStroke=function(I,M){let U=null;if(c.isExtent(I))U=[[[I.xmin,I.ymin],[I.xmin,I.ymax],[I.xmax,I.ymax],[I.xmax,I.ymin],[I.xmin,I.ymin]]];else if(c.isPolygon(I))U=I.rings;else if(c.isPolyline(I))U=I.paths;else return;I=this.reverseTransformPt(this._searchPoint);M*=this.geomUnitsPerPoint();const T=this.reverseTransformSize(this._searchDistPoint)*
this.geomUnitsPerPoint();this._nearLine(I,U,M/2+T)&&(this._earlyReturn=!0)};K._pointInPolygon=function(I,M){let U=0;for(const T of M){M=T.length;for(let Q=1;Q<M;++Q){const J=T[Q-1],P=T[Q];J[1]>I[1]!==P[1]>I[1]&&(0<(P[0]-J[0])*(I[1]-J[1])-(P[1]-J[1])*(I[0]-J[0])?U++:U--)}}return 0!==U};K._nearLine=function(I,M,U){for(const Q of M){M=Q.length;for(let J=1;J<M;++J){var T=Q[J-1];const P=Q[J];let S=(P[0]-T[0])*(P[0]-T[0])+(P[1]-T[1])*(P[1]-T[1]);if(0!==S&&(S=Math.sqrt(S),Math.abs(((P[0]-T[0])*(I[1]-T[1])-
(P[1]-T[1])*(I[0]-T[0]))/S)<U&&(T=((P[0]-T[0])*(I[0]-T[0])+(P[1]-T[1])*(I[1]-T[1]))/S,T>-U&&T<S+U)))return!0}}return!1};return N}(D),v=function(O){function N(I,M,U){M=O.call(this,M,U)||this;M._ctx=I;return M}u._inheritsLoose(N,O);var K=N.prototype;K.drawSolidFill=function(I,M){if(I){if(c.isPolygon(I))this._buildPath(I.rings,!0);else if(c.isPolyline(I))this._buildPath(I.paths,!0);else if(c.isExtent(I))this._buildPath(C(I).rings,!0);else if(c.isMultipoint(I))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");
else return;I=this._ctx;I.fillStyle="string"===typeof M?M:"rgba("+Math.round(M[0])+","+Math.round(M[1])+","+Math.round(M[2])+","+M[3]/255+")";I.fill("evenodd")}};K.drawSolidStroke=function(I,M,U,T,Q,J){if(I&&M&&0!==U){if(c.isPolygon(I))this._buildPath(I.rings,!0);else if(c.isPolyline(I))this._buildPath(I.paths,!1);else if(c.isExtent(I))this._buildPath(C(I).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}I=this._ctx;I.strokeStyle="string"===typeof M?M:"rgba("+
Math.round(M[0])+","+Math.round(M[1])+","+Math.round(M[2])+","+M[3]/255+")";I.lineWidth=this.transformSize(U)+.5;this._setCapStyle(T);this._setJoinStyle(Q);I.miterLimit=J;I.stroke()}};K.pushClipPath=function(I){this._ctx.save();if(c.isPolygon(I))this._buildPath(I.rings,!0);else if(c.isPolyline(I))this._buildPath(I.paths,!0);else if(c.isExtent(I))this._buildPath(C(I).rings,!0);else return;this._ctx.clip("evenodd")};K.popClipPath=function(){this._ctx.restore()};K.drawImage=function(I,M,U){I=this._resourceManager.getResource(I);
if(!z.isNone(I)){var T=this._ctx,Q=T.canvas.width;T=T.canvas.height;var J=I.width/I.height*U*M,P=U*M;M||(J=U*I.width,P=U*I.height);this._ctx.drawImage(I,0,0,I.width,I.height,0,0,Math.min(this.transformSize(J),Q),Math.min(this.transformSize(P),T))}};K.drawText=function(I){this._textRasterizer||(this._textRasterizer=new h.TextRasterizer)};K._buildPath=function(I,M){const U=this._ctx;U.beginPath();if(I)for(const T of I)if(I=T?T.length:0,1<I){let Q=this.transformPt(T[0]);U.moveTo(Q[0],Q[1]);for(let J=
1;J<I;++J)Q=this.transformPt(T[J]),U.lineTo(Q[0],Q[1]);M&&U.closePath()}};K._setCapStyle=function(I){switch(I){case m.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case m.LineCapStyle.Round:this._ctx.lineCap="round";break;case m.LineCapStyle.Square:this._ctx.lineCap="square"}};K._setJoinStyle=function(I){switch(I){case m.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case m.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case m.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return N}(D);
const C=O=>O?{spatialReference:O.spatialReference,rings:[[[O.xmin,O.ymin],[O.xmin,O.ymax],[O.xmax,O.ymax],[O.xmax,O.ymin],[O.xmin,O.ymin]]]}:null,G=O=>{switch(O){case "Left":return n.HAlign.Left;case "Right":return n.HAlign.Right;case "Center":case "Justify":return n.HAlign.Center}},H=O=>{switch(O){case "Top":return n.VAlign.Top;case "Center":return n.VAlign.Center;case "Bottom":return n.VAlign.Bottom;case "Baseline":return n.VAlign.Baseline}},L=(O,N,K)=>{switch(O){case "ExtraLeading":return 1+N/
K;case "Multiple":return N;case "Exact":return N/K}};t.CIMSymbolDrawHelper=D;t.C_DEG_TO_RAD=q;t.CanvasDrawHelper=v;t.EnvDrawHelper=F;t.HittestDrawHelper=w;t.Transformation=E;t.horizontalAlignment2HAlign=G;t.lineGapType2LineHeight=L;t.verticalAlignment2VAlign=H;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(t,u){let B=function(){function D(z){this._geometry=z}D.prototype.next=function(){const z=this._geometry;
this._geometry=null;return z};return D}();t.SimpleGeometryCursor=B;t.clone=function(D){return u.clone(D)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h,n,r,x,q){t.getEffectOperator=function(A){if(!A)return null;switch(A.type){case "CIMGeometricEffectAddControlPoints":return u.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return B.EffectArrow.local();case "CIMGeometricEffectBuffer":return D.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return z.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return y.EffectCut.local();case "CIMGeometricEffectDashes":return l.EffectDashes.local();
case "CIMGeometricEffectDonut":return g.EffectDonut.local();case "CIMGeometricEffectJog":return d.EffectJog.local();case "CIMGeometricEffectMove":return a.EffectMove.local();case "CIMGeometricEffectOffset":return c.EffectOffset.local();case "CIMGeometricEffectReverse":return e.EffectReverse.local();case "CIMGeometricEffectRotate":return f.EffectRotate.local();case "CIMGeometricEffectScale":return k.EffectScale.local();case "CIMGeometricEffectWave":return p.EffectWave.local()}return null};t.getPlacementOperator=
function(A){if(!A)return null;switch(A.type){case "CIMMarkerPlacementAlongLineSameSize":return m.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return b.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return h.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return n.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return r.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return x.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return q.PlacementPolygonCenter.local()}return null};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(t,u,B,D){let z=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a)};return l}();z.instance=
null;let y=function(){function l(d,a,c){this._inputGeometries=d;this._angleTolerance=void 0!==a.angleTolerance?a.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var g=l.prototype;g.next=function(){for(var d=this._inputGeometries.next();d;){if(B.isPolygon(d))return this._isClosed=!0,d=u.clone(d),this._processMultipath(d.rings),d;if(B.isPolyline(d))return this._isClosed=!1,d=u.clone(d),this._processMultipath(d.paths),d;if(B.isExtent(d)){if(this._maxCosAngle)return d;
this._isClosed=!0;d=[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]];this._processPath(d);return{rings:[d]}}d=this._inputGeometries.next()}return null};g._processMultipath=function(d){if(d)for(const a of d)this._processPath(a)};g._processPath=function(d){if(d){let a=d.length,c=d[0],e,f,k,p,m,b;this._isClosed&&++a;for(let h=1;h<a;++h){let n;n=this._isClosed&&h===a-1?d[0]:d[h];const r=n[0]-c[0],x=n[1]-c[1],q=Math.sqrt(r*r+x*x);1<h&&0<q&&0<k&&(e*r+f*x)/q/k<=this._maxCosAngle&&
D.setId(c,1);1===h&&(p=r,m=x,b=q);0<q&&(c=n,e=r,f=x,k=q)}this._isClosed&&0<k&&0<b&&(e*p+f*m)/b/k<=this._maxCosAngle&&D.setId(d[0],1)}};return l}();t.EffectAddControlPoints=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(t,u,B,D){function z(b){if(!b)return null;B.isPoint(b)?b.y=-b.y:B.isPolygon(b)?l(b.rings):B.isPolyline(b)?l(b.paths):B.isMultipoint(b)&&y(b.points)}
function y(b){if(b){const h=b.length;for(let n=0;n<h;n++)b[n][1]=-b[n][1]}}function l(b){if(b)for(const h of b)y(h)}function g(b){if(b){var h=b.length;for(--h;0<h;--h)b[h][0]-=b[h-1][0],b[h][1]-=b[h-1][1]}}function d(b){if(b)for(const h of b)g(h)}function a(b){if(b){const h=b.length;for(let n=1;n<h;++n)b[n][0]+=b[n-1][0],b[n][1]+=b[n-1][1]}}function c(b){if(b)for(const h of b)a(h)}function e(b){b&&(B.isPolygon(b)?c(b.rings):B.isPolyline(b)?c(b.paths):B.isMultipoint(b)&&a(b.points),z(b))}function f(b){b&&
b.reverse()}function k(b){return{rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}}let p=function(){function b(h,n,r,x){this.acceptPolygon=n;this.acceptPolyline=r;this.geomUnitsPerPoint=x;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;h&&(B.isPolygon(h)?n&&(this.multiPath=h.rings,this.isClosed=!0):B.isPolyline(h)?r&&(this.multiPath=h.paths,this.isClosed=!1):B.isExtent(h)&&n&&(this.multiPath=k(h).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=
this.multiPath.length));this.internalPlacement=new D.Placement}b.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const h=this.processPath(this.multiPath[this.pathIndex]);if(h)return h}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return b}(),m=function(){function b(h,n,r,x){this.inputGeometries=h;this.acceptPolygon=n;this.acceptPolyline=r;this.geomUnitsPerPoint=x;this.pathIndex=this.pathCount=
-1;this.iteratePath=!1}b.prototype.next=function(){for(;;){if(!this.multiPath){for(var h=this.inputGeometries.next();h;)if(B.isPolygon(h)?this.acceptPolygon&&(this.multiPath=h.rings,this.isClosed=!0):B.isPolyline(h)?this.acceptPolyline&&(this.multiPath=h.paths,this.isClosed=!1):B.isExtent(h)&&this.acceptPolygon&&(this.multiPath=k(h).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else h=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||
this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,h=this.processPath(this.multiPath[this.pathIndex]))return h;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return b}();t.PathGeometryCursor=m;t.PathTransformationCursor=p;t.cloneAndDecodeGeometry=function(b){b=u.clone(b);e(b);return b};t.deltaDecodeGeometry=e;t.deltaEncodeGeometry=function(b){b&&(z(b),B.isPolygon(b)?d(b.rings):B.isPolyline(b)?d(b.paths):B.isMultipoint(b)&&g(b.points))};t.getCoord2D=function(b,h,n){return[b[0]+
(h[0]-b[0])*n,b[1]+(h[1]-b[1])*n]};t.getId=function(b){return b[4]};t.isClosedPath=function(b){return b&&0!==b.length?b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]:!1};t.reverseMultipath=function(b){if(b)for(const h of b)f(h)};t.reversePath=f;t.setId=function(b,h){b[4]=h};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(t,
u,B,D,z){const y=z.GeometricEffectArrowType.OpenEnded;let l=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(a,c,e,f){return new g(a,c,e)};return d}();l.instance=null;let g=function(d){function a(e,f,k){e=d.call(this,e,!1,!0)||this;e._curveHelper=new D.CurveHelper;e._width=(void 0!==f.width?f.width:5)*k;e._arrowType=void 0!==f.geometricEffectArrowType?f.geometricEffectArrowType:void 0!==f.arrowType?f.arrowType:y;e._offsetFlattenError=
D.PIXEL_TOLERANCE*k;return e}u._inheritsLoose(a,d);var c=a.prototype;c.processPath=function(e){switch(this._arrowType){default:return this._constructSimpleArrow(e,!0);case z.GeometricEffectArrowType.Block:return this._constructSimpleArrow(e,!1);case z.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(e)}};c._constructSimpleArrow=function(e,f){var k=this._curveHelper.calculatePathLength(e),p=this._width;k<2*p&&(p=k/2);k=this._curveHelper.getSubCurve(e,0,k-p);if(!k)return null;var m=
p/2;if(this._curveHelper.isEmpty(k,!1))return null;p=this._constructOffset(k,-m);if(!p)return null;k=this._constructOffset(k,m);if(!k)return null;const b=this._constructArrowBasePoint(p,-m/2);if(!b)return null;m=this._constructArrowBasePoint(k,m/2);if(!m)return null;e=e[e.length-1];f||(this._makeControlPoint(k,!0),this._makeControlPoint(p,!0));const h=new D.PathHelper;h.addPath(k,!0);h.lineTo(m);this._makeControlPoint(h.path());h.lineTo(e);this._makeControlPoint(h.path());h.lineTo(b);this._makeControlPoint(h.path());
h.addPath(p,!1);return f?{paths:[h.path()]}:(h.close(),{rings:[h.path()]})};c._constructCrossedArrow=function(e){var f=this._curveHelper.calculatePathLength(e),k=this._width;f<3.732050807568877*k&&(k=f/3.732050807568877);var p=this._curveHelper.getSubCurve(e,0,f-2.732050807568877*k);if(!p)return null;var m=k/2;if(this._curveHelper.isEmpty(p,!1))return null;const b=this._constructOffset(p,m);if(!b)return null;p=this._constructOffset(p,-m);if(!p)return null;f=this._curveHelper.getSubCurve(e,0,f-k);
if(!f||this._curveHelper.isEmpty(f,!1))return null;k=this._constructOffset(f,m);if(!k)return null;var h=this._constructOffset(f,-m);if(!h)return null;f=k[k.length-1];k=this._constructArrowBasePoint(k,m/2);if(!k)return null;const n=h[h.length-1];m=this._constructArrowBasePoint(h,-m/2);if(!m)return null;e=e[e.length-1];this._makeControlPoint(b,!1);this._makeControlPoint(p,!1);h=new D.PathHelper;h.addPath(b,!0);this._makeControlPoint(h.path());h.lineTo(n);h.lineTo(m);this._makeControlPoint(h.path());
h.lineTo(e);this._makeControlPoint(h.path());h.lineTo(k);this._makeControlPoint(h.path());h.lineTo(f);this._makeControlPoint(h.path());h.addPath(p,!1);return{paths:[h.path()]}};c._constructOffset=function(e,f){return this._curveHelper.offset(e,f,z.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};c._constructArrowBasePoint=function(e,f){if(!e||2>e.length)return null;var k=e[e.length-2];e=e[e.length-1];k=[e[0]-k[0],e[1]-k[1]];this._curveHelper.normalize(k);return[e[0]+k[1]*f,e[1]-k[0]*
f]};c._makeControlPoint=function(e,f=!1){f?B.setId(e[0],1):B.setId(e[e.length-1],1)};return a}(B.PathGeometryCursor);t.EffectArrow=l;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","./enums"],function(t,u){let B=function(){function z(){this._path=[]}var y=z.prototype;y.path=function(){return this._path};y.addPath=function(l,g){g||l.reverse();Array.prototype.push.apply(this._path,l);g||l.reverse()};z.mergePath=function(l,g){g&&Array.prototype.push.apply(l,
g)};y.startPath=function(l){this._path.push(l)};y.lineTo=function(l){this._path.push(l)};y.close=function(){const l=this._path;1<l.length&&(l[0][0]!==l[l.length-1][0]||l[0][1]!==l[l.length-1][1])&&l.push([l[0][0],l[0][1]])};return z}(),D=function(){function z(l,g){}var y=z.prototype;y.normalize=function(l){const g=Math.sqrt(l[0]*l[0]+l[1]*l[1]);l[0]/=g;l[1]/=g};y.calculateLength=function(l,g){const d=g[0]-l[0];l=g[1]-l[1];return Math.sqrt(d*d+l*l)};y.calculateSegLength=function(l,g){return this.calculateLength(l[g],
l[g+1])};y.calculatePathLength=function(l){let g=0;const d=l?l.length:0;for(let a=0;a<d-1;++a)g+=this.calculateSegLength(l,a);return g};y.calculatePathArea=function(l){let g=0;const d=l?l.length:0;for(let a=0;a<d-1;++a)g+=(l[a+1][0]-l[a][0])*(l[a+1][1]+l[a][1]);return g/2};y.getCoord2D=function(l,g,d){return[l[0]+(g[0]-l[0])*d,l[1]+(g[1]-l[1])*d]};y.getSegCoord2D=function(l,g,d){return this.getCoord2D(l[g],l[g+1],d)};y.getAngle=function(l,g,d){return Math.atan2(g[1]-l[1],g[0]-l[0])};y.getSegAngle=
function(l,g,d){return this.getAngle(l[g],l[g+1],d)};y.getAngleCS=function(l,g,d){d=g[0]-l[0];l=g[1]-l[1];g=Math.sqrt(d*d+l*l);return 0<g?[d/g,l/g]:[1,0]};y.getSegAngleCS=function(l,g,d){return this.getAngleCS(l[g],l[g+1],d)};y.cut=function(l,g,d,a){d=0>=d?l[g]:this.getSegCoord2D(l,g,d);l=1<=a?l[g+1]:this.getSegCoord2D(l,g,a);return[d,l]};y.addSegment=function(l,g,d){d&&l.push(g[0]);l.push(g[1])};y.getSubCurve=function(l,g,d){const a=[];return this.appendSubCurve(a,l,g,d)?a:null};y.appendSubCurve=
function(l,g,d,a){const c=g?g.length-1:0;let e=0,f=!0,k=0;for(;k<c;){const m=this.calculateSegLength(g,k);if(0!==m){if(f){if(e+m>d){var p=(d-e)/m;let b=1,h=!1;e+m>=a&&(b=(a-e)/m,h=!0);(p=this.cut(g,k,p,b))&&this.addSegment(l,p,f);if(h)break;f=!1}}else{if(e+m>a){(g=this.cut(g,k,0,(a-e)/m))&&this.addSegment(l,g,f);break}this.addSegment(l,[g[k],g[k+1]],f)}e+=m}++k}return!0};y.getCIMPointAlong=function(l,g){const d=l?l.length-1:0;let a=0,c=-1;for(;c<d;){++c;const e=this.calculateSegLength(l,c);if(0!==
e){if(a+e>g)return this.getCoord2D(l[c],l[c+1],(g-a)/e);a+=e}}return null};y.isEmpty=function(l,g){if(!l||1>=l.length)return!0;const d=l?l.length-1:0;let a=-1;for(;a<d;)if(++a,l[a+1][0]!==l[a][0]||l[a+1][1]!==l[a][1]||g&&l[a+1][2]!==l[a][2])return!1;return!0};y.offset=function(l,g,d,a,c){if(!l||2>l.length)return null;var e=0,f=l[e++];for(c=e;e<l.length;){var k=l[e];if(k[0]!==f[0]||k[1]!==f[1])e!==c&&(l[c]=l[e]),f=l[c++];e++}(e=l[0][0]===l[c-1][0]&&l[0][1]===l[c-1][1])&&--c;if(c<(e?3:2))return null;
k=[];f=e?l[c-1]:null;let p=l[0];for(let n=0;n<c;n++){const r=n===c-1?e?l[0]:null:l[n+1];if(f)if(r){var m=[r[0]-p[0],r[1]-p[1]];this.normalize(m);f=[p[0]-f[0],p[1]-f[1]];this.normalize(f);var b=f[0]*m[1]-f[1]*m[0],h=f[0]*m[0]+f[1]*m[1];if(0<=b===0>=g)1>h&&(m=[m[0]-f[0],m[1]-f[1]],this.normalize(m),f=Math.sqrt((1+h)/2),f>1/a&&(f=-Math.abs(g)/f,k.push([p[0]-m[0]*f,p[1]-m[1]*f])));else switch(d){case u.GeometricEffectOffsetMethod.Mitered:if(h=Math.sqrt((1+h)/2),0<h&&1/h<a){m=[m[0]-f[0],m[1]-f[1]];this.normalize(m);
f=Math.abs(g)/h;k.push([p[0]-m[0]*f,p[1]-m[1]*f]);break}case u.GeometricEffectOffsetMethod.Bevelled:k.push([p[0]+f[1]*g,p[1]-f[0]*g]);k.push([p[0]+m[1]*g,p[1]-m[0]*g]);break;case u.GeometricEffectOffsetMethod.Rounded:if(1>h){k.push([p[0]+f[1]*g,p[1]-f[0]*g]);h=Math.floor(2.5*(1-h));if(0<h){let x=b=1/h;for(let q=1;q<h;q++,x+=b){const A=[f[1]*(1-x)+m[1]*x,-f[0]*(1-x)-m[0]*x];this.normalize(A);k.push([p[0]+A[0]*g,p[1]+A[1]*g])}}k.push([p[0]+m[1]*g,p[1]-m[0]*g])}break;default:0>b?(k.push([p[0]+(f[1]+
f[0])*g,p[1]+(f[1]-f[0])*g]),k.push([p[0]+(m[1]-m[0])*g,p[1]-(m[0]+m[1])*g])):(h=Math.sqrt((1+Math.abs(h))/2),m=[m[0]-f[0],m[1]-f[1]],this.normalize(m),f=g/h,k.push([p[0]-m[0]*f,p[1]-m[1]*f]))}}else m=[p[0]-f[0],p[1]-f[1]],this.normalize(m),k.push([p[0]+m[1]*g,p[1]-m[0]*g]);else m=[r[0]-p[0],r[1]-p[1]],this.normalize(m),k.push([p[0]+m[1]*g,p[1]-m[0]*g]);f=p;p=r}if(k.length<(e?3:2))return null;e&&k.push([k[0][0],k[0][1]]);return k};return z}();t.CurveHelper=D;t.PIXEL_TOLERANCE=.03;t.PathHelper=B;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(t,u,B,D){let z=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a,c)};return l}();z.instance=null;let y=function(){function l(g,d,a,c){this._inputGeometries=g;this._curveHelper=new B.CurveHelper;this._size=(void 0!==d.size?
d.size:1)*a;this._offsetFlattenError=B.PIXEL_TOLERANCE*a}l.prototype.next=function(){let g=this._inputGeometries.next();for(;g;){if(u.isExtent(g))if(0<this._size){var d=this._curveHelper.offset([[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]],this._size,D.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(d)return{rings:[d]}}else if(0>this._size){if(0<Math.min(g.xmax-g.xmin,g.ymax-g.ymin)+2*this._size)return{xmin:g.xmin-this._size,xmax:g.xmax+this._size,
ymin:g.ymin-this._size,ymax:g.ymax+this._size}}else return g;if(u.isPolygon(g)){if(0===this._size)return g;d=[];for(const c of g.rings){var a=this._curveHelper.offset(c,this._size,D.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);a&&d.push(a)}if(d.length)return{rings:d}}if(u.isPolyline(g)&&0<this._size){d=[];for(const c of g.paths)if(c&&1<c.length){a=this._curveHelper.offset(c,this._size,D.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);const e=this._curveHelper.offset(c,
-this._size,D.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(a&&e){for(let f=e.length-1;0<=f;f--)a.push(e[f]);a.push([a[0][0],a[0][1]]);d.push(a)}}if(d.length)return{rings:d}}u.isPoint(g);g=this._inputGeometries.next()}return null};return l}();t.EffectBuffer=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(t,u,B,D){let z=
function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a)};return l}();z.instance=null;let y=function(){function l(d,a,c){var e;this._default_point_size=20;this._inputGeometries=d;this._geomUnitsPerPoint=c;this._rule=null!=(e=a.rule)?e:D.GeometricEffectControlMeasureLineRule.FullGeometry;this._default_size=this._default_point_size*c}var g=l.prototype;g.next=function(){let d;for(;d=this._inputGeometries.next();){let a;
u.isPoint(d)?a=this._processGeom([[[d.x,d.y]]]):u.isMultipoint(d)?a=this._processGeom([d.points]):u.isPolyline(d)?a=this._processGeom(d.paths):u.isPolygon(d)&&(a=this._processGeom(d.rings));if(a&&a.length)return{paths:a}}return null};g._clone=function(d){return[d[0],d[1]]};g._mid=function(d,a){return[(d[0]+a[0])/2,(d[1]+a[1])/2]};g._mix=function(d,a,c,e){return[d[0]*a+c[0]*e,d[1]*a+c[1]*e]};g._add=function(d,a){return[d[0]+a[0],d[1]+a[1]]};g._add2=function(d,a,c){return[d[0]+a,d[1]+c]};g._sub=function(d,
a){return[d[0]-a[0],d[1]-a[1]]};g._dist=function(d,a){return Math.sqrt((d[0]-a[0])*(d[0]-a[0])+(d[1]-a[1])*(d[1]-a[1]))};g._norm=function(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])};g._normalize=function(d,a=1){a/=this._norm(d);d[0]*=a;d[1]*=a};g._leftPerpendicular=function(d){const a=d[0];d[0]=-d[1];d[1]=a};g._leftPerp=function(d){return[-d[1],d[0]]};g._rightPerpendicular=function(d){const a=-d[0];d[0]=d[1];d[1]=a};g._rightPerp=function(d){return[d[1],-d[0]]};g._dotProduct=function(d,a){return d[0]*
a[0]+d[1]*a[1]};g._crossProduct=function(d,a){return d[0]*a[1]-d[1]*a[0]};g._rotateDirect=function(d,a,c){const e=d[0]*c+d[1]*a;d[0]=d[0]*a-d[1]*c;d[1]=e};g._makeCtrlPt=function(d){d=[d[0],d[1]];B.setId(d,1);return d};g._addAngledTicks=function(d,a,c,e){const f=this._sub(c,a);this._normalize(f);var k=this._crossProduct(f,this._sub(e,a));e=0<k?this._rightPerp(f):this._leftPerp(f);k=Math.abs(k)/2;const p=[];p.push([a[0]+(e[0]-f[0])*k,a[1]+(e[1]-f[1])*k]);p.push(a);p.push(c);p.push([c[0]+(e[0]+f[0])*
k,c[1]+(e[1]+f[1])*k]);d.push(p)};g._addBezier2=function(d,a,c,e,f){if(0===f--)d.push(e);else{var k=this._mid(a,c);c=this._mid(c,e);var p=this._mid(k,c);this._addBezier2(d,a,k,p,f);this._addBezier2(d,p,c,e,f)}};g._addBezier3=function(d,a,c,e,f,k){if(0===k--)d.push(f);else{var p=this._mid(a,c),m=this._mid(c,e);e=this._mid(e,f);c=this._mid(p,m);m=this._mid(m,e);var b=this._mid(c,m);this._addBezier3(d,a,p,c,b,k);this._addBezier3(d,b,m,e,f,k)}};g._add90DegArc=function(d,a,c,e,f){e=null!=f?f:0<this._crossProduct(this._sub(c,
a),this._sub(e,a));f=this._mid(a,c);const k=this._sub(f,a);e?this._leftPerpendicular(k):this._rightPerpendicular(k);f[0]+=k[0];f[1]+=k[1];this._addBezier3(d,a,this._mix(a,.33333,f,.66667),this._mix(c,.33333,f,.66667),c,4)};g._addArrow=function(d,a,c){var e=a[0],f=a[1],k=a[a.length-1],p=this._sub(e,f);this._normalize(p);const m=this._crossProduct(p,this._sub(k,f));f=.5*m;var b=this._leftPerp(p);const h=[k[0]-b[0]*m,k[1]-b[1]*m];var n=a.length-1;k=[];k.push(c?[-b[0],-b[1]]:b);var r=[-p[0],-p[1]];for(c=
1;c<n-1;c++){p=this._sub(a[c+1],a[c]);this._normalize(p);var x=this._dotProduct(p,r);b=this._crossProduct(p,r);x=Math.sqrt((1+x)/2);r=this._sub(p,r);this._normalize(r);r[0]/=x;r[1]/=x;k.push(0>b?[-r[0],-r[1]]:r);r=p}k.push(this._rightPerp(r));for(n=k.length-1;0<n;n--)d.push([a[n][0]+k[n][0]*f,a[n][1]+k[n][1]*f]);d.push([h[0]+k[0][0]*f,h[1]+k[0][1]*f]);d.push([h[0]+k[0][0]*m,h[1]+k[0][1]*m]);d.push(e);d.push([h[0]-k[0][0]*m,h[1]-k[0][1]*m]);d.push([h[0]-k[0][0]*f,h[1]-k[0][1]*f]);for(e=1;e<k.length;e++)d.push([a[e][0]-
k[e][0]*f,a[e][1]-k[e][1]*f])};g._cp2=function(d,a,c){return 2<=d.length?d[1]:this._add2(d[0],a*this._default_size,c*this._default_size)};g._cp3=function(d,a,c,e){if(3<=d.length)return d[2];c=this._mix(d[0],1-c,a,c);d=this._sub(a,d[0]);this._normalize(d);this._rightPerpendicular(d);return[c[0]+d[0]*e*this._default_size,c[1]+d[1]*e*this._default_size]};g._arrowPath=function(d){if(2<d.length)return d;const a=d[0];d=this._cp2(d,-4,0);const c=this._sub(a,d);this._normalize(c);const e=this._rightPerp(c);
return[a,d,[a[0]+(e[0]-c[0])*this._default_size,a[1]+(e[1]-c[1])*this._default_size]]};g._arrowLastSeg=function(d){var a=d[0];const c=this._cp2(d,-4,0);if(3<=d.length)a=d[d.length-1];else{d=this._sub(a,c);this._normalize(d);const e=this._rightPerp(d);a=[a[0]+(e[0]-d[0])*this._default_size,a[1]+(e[1]-d[1])*this._default_size]}return[c,a]};g._processGeom=function(d){if(!d)return null;const a=[];for(const c of d){if(!c||0===c.length)continue;const e=c.length;let f=c[0];switch(this._rule){case D.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:{const k=
this._cp2(c,0,-1),p=this._cp3(c,k,.5,4),m=[];m.push(p);m.push(this._mid(f,k));a.push(m);break}case D.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:{const k=this._cp2(c,0,-1);a.push([k,f]);break}case D.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:{const k=this._cp2(c,-4,1),p=this._cp3(c,k,.882353,-1.94),m=[];m.push(this._mid(k,p));m.push(f);a.push(m);break}case D.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:{const k=this._cp2(c,-4,1),p=this._cp3(c,
k,.882353,-1.94),m=this._sub(p,k);let b;b=0<this._crossProduct(m,this._sub(f,k))?this._rightPerp(b):this._leftPerp(m);const h=[];h.push([k[0]+(b[0]-m[0])/3,k[1]+(b[1]-m[1])/3]);h.push(k);h.push(p);h.push([p[0]+(b[0]+m[0])/3,p[1]+(b[1]+m[1])/3]);a.push(h);break}case D.GeometricEffectControlMeasureLineRule.DoublePerpendicular:{const k=this._cp2(c,0,-1),p=this._cp3(c,k,.5,3),m=this._mid(f,k),b=this._sub(m,p);this._normalize(b);const h=this._crossProduct(b,this._sub(f,p));this._leftPerpendicular(b);const n=
[];n.push(f);n.push([p[0]+b[0]*h,p[1]+b[1]*h]);a.push(n);const r=[];r.push([p[0]-b[0]*h,p[1]-b[1]*h]);r.push(k);a.push(r);break}case D.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:{const k=this._cp2(c,0,-1),p=this._cp3(c,k,.5,3),m=this._mid(f,k),b=this._sub(m,p);this._normalize(b);const h=this._crossProduct(b,this._sub(f,p));this._leftPerpendicular(b);const n=[];n.push([p[0]+b[0]*h,p[1]+b[1]*h]);n.push([p[0]-b[0]*h,p[1]-b[1]*h]);a.push(n);break}case D.GeometricEffectControlMeasureLineRule.TriplePerpendicular:{const k=
this._cp2(c,0,-1),p=this._cp3(c,k,.5,4),m=this._mid(f,k),b=this._sub(m,p);this._normalize(b);const h=this._crossProduct(b,this._sub(f,p));this._leftPerpendicular(b);const n=[];n.push([p[0]+b[0]*h*.8,p[1]+b[1]*h*.8]);n.push([m[0]+.8*(f[0]-m[0]),m[1]+.8*(f[1]-m[1])]);a.push(n);a.push([p,m]);const r=[];r.push([p[0]-b[0]*h*.8,p[1]-b[1]*h*.8]);r.push([m[0]+.8*(k[0]-m[0]),m[1]+.8*(k[1]-m[1])]);a.push(r);break}case D.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:{const k=this._cp2(c,0,-1),
p=this._cp3(c,k,.5,4),m=this._mid(f,k);let b=this._sub(k,f);const h=Math.cos(Math.PI/18),n=Math.sin(Math.PI/18),r=Math.sqrt((1+h)/2),x=Math.sqrt((1-h)/2),q=[];let A;0<this._crossProduct(b,this._sub(p,f))?(q.push(f),b=this._sub(f,m),A=k):(q.push(k),b=this._sub(k,m),A=f);this._rotateDirect(b,r,x);b[0]/=r;b[1]/=r;for(let E=1;18>=E;E++)q.push(this._add(m,b)),this._rotateDirect(b,h,n);q.push(A);a.push(q);break}case D.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:{const k=this._cp2(c,0,
-1),p=this._cp3(c,k,1,-1);let m=this._sub(f,k);this._normalize(m);const b=this._crossProduct(m,this._sub(p,k))/2;this._leftPerpendicular(m);const h=[k[0]+m[0]*b,k[1]+m[1]*b];m=this._sub(k,h);const n=Math.cos(Math.PI/18);let r=Math.sin(Math.PI/18);0<b&&(r=-r);const x=[k];for(let q=1;18>=q;q++)this._rotateDirect(m,n,r),x.push(this._add(h,m));a.push(x);break}case D.GeometricEffectControlMeasureLineRule.HalfCircleExtended:{const k=this._cp2(c,0,-2),p=this._cp3(c,k,1,-1);let m;if(4<=e)m=c[3];else{const x=
this._sub(f,k);m=this._add(p,x)}const b=this._dist(k,p)/2/.75,h=this._sub(k,f);this._normalize(h,b);const n=this._sub(p,m);this._normalize(n,b);a.push([m,p]);const r=[this._clone(p)];this._addBezier3(r,p,this._add(p,n),this._add(k,h),k,4);r.push(f);a.push(r);break}case D.GeometricEffectControlMeasureLineRule.OpenCircle:{const k=this._cp2(c,-2,0),p=this._sub(k,f),m=Math.cos(Math.PI/18),b=-Math.sin(Math.PI/18),h=[k];for(let n=1;33>=n;n++)this._rotateDirect(p,m,b),h.push(this._add(f,p));a.push(h);break}case D.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:{const k=
this._cp2(c,0,-1);let p;if(3<=e)p=c[2];else{const r=this._sub(k,f),x=this._leftPerp(r);p=[f[0]+x[0]-.25*r[0],f[1]+x[1]-.25*r[1]]}let m;if(4<=e)m=c[3];else{const r=this._mid(f,k),x=this._sub(f,k);this._normalize(x);this._leftPerpendicular(x);const q=this._crossProduct(x,this._sub(p,r));this._rightPerpendicular(x);m=[p[0]+x[0]*q*2,p[1]+x[1]*q*2]}const b=this._sub(k,f);let h,n;h=0<this._crossProduct(b,this._sub(p,f))?this._rightPerp(b):this._leftPerp(b);n=[];n.push(p);n.push(f);n.push([f[0]+(h[0]-b[0])/
3,f[1]+(h[1]-b[1])/3]);a.push(n);h=0<this._crossProduct(b,this._sub(m,k))?this._rightPerp(h):this._leftPerp(b);n=[];n.push([k[0]+(h[0]+b[0])/3,k[1]+(h[1]+b[1])/3]);n.push(k);n.push(m);a.push(n);break}case D.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:{const k=this._cp2(c,0,2),p=this._cp3(c,k,0,1);let m;if(4<=e)m=c[3];else{const b=this._sub(k,f);m=this._add(p,b)}this._addAngledTicks(a,f,k,this._mid(p,m));this._addAngledTicks(a,p,m,this._mid(f,k));break}case D.GeometricEffectControlMeasureLineRule.GapExtentMidline:{const k=
this._cp2(c,2,0),p=this._cp3(c,k,0,1);let m;if(4<=e)m=c[3];else{const h=this._sub(k,f);m=this._add(p,h)}const b=[];b.push(this._mid(f,p));b.push(this._mid(k,m));a.push(b);break}case D.GeometricEffectControlMeasureLineRule.Chevron:{const k=this._cp2(c,-1,-1);let p;if(3<=e)p=c[2];else{const m=this._sub(k,f);this._leftPerpendicular(m);p=this._add(f,m)}a.push([k,this._makeCtrlPt(f),p]);break}case D.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:{const k=this._cp2(c,0,-2),p=this._cp3(c,k,.5,
-1);let m=this._sub(k,f);const b=this._norm(m);m[0]/=b;m[1]/=b;const h=this._crossProduct(m,this._sub(p,f));let n=this._dotProduct(m,this._sub(p,f));n<.05*b?n=.05*b:n>.95*b&&(n=.95*b);const r=[f[0]+m[0]*n,f[1]+m[1]*n];this._leftPerpendicular(m);let x=[];x.push([r[0]-m[0]*h,r[1]-m[1]*h]);x.push([r[0]+m[0]*h,r[1]+m[1]*h]);a.push(x);const q=[k[0]+m[0]*h,k[1]+m[1]*h];m=this._sub(k,q);const A=Math.cos(Math.PI/18);let E=Math.sin(Math.PI/18);0>h&&(E=-E);x=[f,k];for(let F=1;9>=F;F++)this._rotateDirect(m,
A,E),x.push(this._add(q,m));a.push(x);break}case D.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:{const k=this._cp2(c,2,0),p=this._mid(f,k),m=this._sub(k,p),b=Math.cos(Math.PI/18),h=Math.sin(Math.PI/18),n=[f,k];for(let r=1;18>=r;r++)this._rotateDirect(m,b,h),n.push(this._add(p,m));a.push(n);break}case D.GeometricEffectControlMeasureLineRule.TripleParallelExtended:{const k=this._cp2(c,0,-2),p=this._cp3(c,k,1,-2),m=this._mid(f,k),b=this._sub(p,k);this._normalize(b);const h=Math.abs(this._crossProduct(b,
this._sub(m,k)))/2,n=this._dist(k,p),r=[k,f];r.push([f[0]+b[0]*n*.5,f[1]+b[1]*n*.5]);a.push(r);const x=[];x.push([m[0]-b[0]*h,m[1]-b[1]*h]);x.push([m[0]+b[0]*n*.375,m[1]+b[1]*n*.375]);B.setId(x[x.length-1],1);x.push([m[0]+b[0]*n*.75,m[1]+b[1]*n*.75]);a.push(x);a.push([k,p]);break}case D.GeometricEffectControlMeasureLineRule.ParallelWithTicks:{const k=this._cp2(c,3,0),p=this._cp3(c,k,.5,-1),m=this._sub(p,k);this._normalize(m);const b=this._crossProduct(m,this._sub(p,f));this._leftPerpendicular(m);
this._addAngledTicks(a,f,k,p);this._addAngledTicks(a,this._mix(f,1,m,b),this._mix(k,1,m,b),this._mid(f,k));break}case D.GeometricEffectControlMeasureLineRule.Parallel:{const k=this._cp2(c,3,0),p=this._cp3(c,k,.5,-1),m=this._sub(k,f);this._normalize(m);const b=this._leftPerp(m),h=this._crossProduct(m,this._sub(p,f));let n=[f,k];a.push(n);n=[];n.push([f[0]+b[0]*h,f[1]+b[1]*h]);n.push([k[0]+b[0]*h,k[1]+b[1]*h]);a.push(n);break}case D.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:{const k=
this._cp2(c,3,0),p=this._cp3(c,k,.5,-1),m=this._mid(f,k),b=this._sub(k,f);this._normalize(b);const h=this._crossProduct(b,this._sub(p,f));this._leftPerpendicular(b);const n=[];n.push([m[0]-b[0]*h*.25,m[1]-b[1]*h*.25]);n.push([m[0]+b[0]*h*1.25,m[1]+b[1]*h*1.25]);a.push(n);break}case D.GeometricEffectControlMeasureLineRule.ParallelOffset:{const k=this._cp2(c,3,0),p=this._cp3(c,k,.5,-1),m=this._sub(k,f);this._normalize(m);const b=this._crossProduct(m,this._sub(p,f));this._leftPerpendicular(m);const h=
[];h.push([f[0]-m[0]*b,f[1]-m[1]*b]);h.push([k[0]-m[0]*b,k[1]-m[1]*b]);a.push(h);const n=[];n.push([f[0]+m[0]*b,f[1]+m[1]*b]);n.push([k[0]+m[0]*b,k[1]+m[1]*b]);a.push(n);break}case D.GeometricEffectControlMeasureLineRule.OffsetOpposite:{const k=this._cp2(c,3,0),p=this._cp3(c,k,.5,-1),m=this._sub(k,f);this._normalize(m);const b=this._crossProduct(m,this._sub(p,f));this._leftPerpendicular(m);const h=[];h.push([f[0]-m[0]*b,f[1]-m[1]*b]);h.push([k[0]-m[0]*b,k[1]-m[1]*b]);a.push(h);break}case D.GeometricEffectControlMeasureLineRule.OffsetSame:{const k=
this._cp2(c,3,0),p=this._cp3(c,k,.5,-1),m=this._sub(k,f);this._normalize(m);const b=this._crossProduct(m,this._sub(p,f));this._leftPerpendicular(m);const h=[];h.push([f[0]+m[0]*b,f[1]+m[1]*b]);h.push([k[0]+m[0]*b,k[1]+m[1]*b]);a.push(h);break}case D.GeometricEffectControlMeasureLineRule.CircleWithArc:{let k=this._cp2(c,3,0);const p=this._cp3(c,k,.5,-1);let m,b;if(4<=e)m=c[3],b=0<this._crossProduct(this._sub(m,k),this._sub(p,k));else{m=k;b=0<this._crossProduct(this._sub(m,f),this._sub(p,f));const q=
24*this._geomUnitsPerPoint,A=this._sub(m,f);this._normalize(A,q);const E=Math.sqrt(2)/2;this._rotateDirect(A,E,b?E:-E);k=this._add(f,A)}const h=this._sub(k,f),n=Math.cos(Math.PI/18),r=Math.sin(Math.PI/18),x=[k];for(let q=1;36>=q;q++)this._rotateDirect(h,n,r),x.push(this._add(f,h));this._add90DegArc(x,k,m,p,b);B.setId(x[x.length-8],1);a.push(x);break}case D.GeometricEffectControlMeasureLineRule.DoubleJog:{let k=this._cp2(c,-3,1),p;p=3<=e?c[2]:this._add(f,this._sub(f,k));let m;if(4<=e)m=c[3];else{const F=
f;f=k;m=p;const w=this._dist(f,F),v=this._dist(m,F);let C=30*this._geomUnitsPerPoint;.5*w<C&&(C=.5*w);.5*v<C&&(C=.5*v);k=this._mix(f,C/w,F,(w-C)/w);p=this._mix(m,C/v,F,(v-C)/v)}const b=this._mid(f,k),h=this._mid(m,p),n=this._dist(f,k),r=this._dist(p,m);let x=Math.min(n,r)/8;x=Math.min(x,24*this._geomUnitsPerPoint);const q=Math.cos(Math.PI/4);let A=this._sub(f,k);this._normalize(A,x);0<this._crossProduct(A,this._sub(m,k))?this._rotateDirect(A,q,-q):this._rotateDirect(A,q,q);let E=[];E.push(k);E.push(this._add(b,
A));E.push(this._sub(b,A));E.push(f);a.push(E);A=this._sub(m,p);this._normalize(A,x);0>this._crossProduct(A,this._sub(f,p))?this._rotateDirect(A,q,q):this._rotateDirect(A,q,-q);E=[];E.push(p);E.push(this._add(h,A));E.push(this._sub(h,A));E.push(m);a.push(E);break}case D.GeometricEffectControlMeasureLineRule.PerpendicularOffset:{const k=this._cp2(c,-4,1),p=this._cp3(c,k,.882353,-1.94),m=this._sub(p,k);0<this._crossProduct(m,this._sub(f,k))?this._rightPerpendicular(m):this._leftPerpendicular(m);const b=
[m[0]/8,m[1]/8],h=this._sub(this._mid(k,p),b);a.push([h,f]);break}case D.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:{const k=this._arrowPath(c),p=[];let m=k.length-2;for(;m--;)p.push(k[m]);a.push(p);break}case D.GeometricEffectControlMeasureLineRule.MultivertexArrow:{const k=this._arrowPath(c),p=[];this._addArrow(p,k,!1);a.push(p);break}case D.GeometricEffectControlMeasureLineRule.CrossedArrow:{const k=this._arrowPath(c),p=[];this._addArrow(p,k,!0);a.push(p);break}case D.GeometricEffectControlMeasureLineRule.ChevronArrow:{const [k,
p]=this._arrowLastSeg(c),m=10*this._geomUnitsPerPoint,b=this._sub(f,k);this._normalize(b);const h=this._crossProduct(b,this._sub(p,k)),n=this._leftPerp(b),r=[p[0]-n[0]*h*2,p[1]-n[1]*h*2],x=[];x.push([p[0]+b[0]*m,p[1]+b[1]*m]);x.push(f);x.push([r[0]+b[0]*m,r[1]+b[1]*m]);a.push(x);break}case D.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:{const [k,p]=this._arrowLastSeg(c),m=this._sub(f,k);this._normalize(m);const b=this._crossProduct(m,this._sub(p,k));this._leftPerpendicular(m);const h=
[p[0]-m[0]*b,p[1]-m[1]*b],n=[];n.push([h[0]+m[0]*b*.5,h[1]+m[1]*b*.5]);n.push(this._mid(h,f));n.push([h[0]-m[0]*b*.5,h[1]-m[1]*b*.5]);a.push(n);break}case D.GeometricEffectControlMeasureLineRule.PartialFirstSegment:{const [k,p]=this._arrowLastSeg(c),m=this._sub(f,k);this._normalize(m);const b=this._crossProduct(m,this._sub(p,k));this._leftPerpendicular(m);a.push([k,[p[0]-m[0]*b,p[1]-m[1]*b]]);break}case D.GeometricEffectControlMeasureLineRule.Arch:{const k=this._cp2(c,0,-1),p=this._cp3(c,k,.5,1),
m=this._sub(f,k),b=this._mix(p,1,m,.55),h=this._mix(p,1,m,-.55),n=[f];this._addBezier2(n,f,b,p,4);this._addBezier2(n,p,h,k,4);a.push(n);break}case D.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:{const k=this._cp2(c,-4,1),p=this._cp3(c,k,.882353,-1.94),m=this._sub(p,k);0<this._crossProduct(m,this._sub(f,k))?this._rightPerpendicular(m):this._leftPerpendicular(m);const b=[m[0]/8,m[1]/8],h=this._sub(this._mid(k,p),b),n=this._sub(this._mix(k,.75,p,.25),b),r=this._sub(this._mix(k,.25,p,.75),
b),x=[k];this._addBezier2(x,k,n,h,3);this._addBezier2(x,h,r,p,3);a.push(x);for(let q=0;8>q;q++){const A=x[2*q+1],E=[this._clone(A)];E.push(this._add(A,[m[0]/4,m[1]/4]));a.push(E)}break}case D.GeometricEffectControlMeasureLineRule.Arc90Degrees:{const k=this._cp2(c,0,-1),p=this._cp3(c,k,.5,1),m=[k];this._add90DegArc(m,k,f,p);a.push(m);break}default:a.push(c)}}return a};return l}();t.EffectControlMeasureLine=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(t,u,B,D){let z=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a)};return l}();z.instance=null;let y=function(l){function g(d,a,c){d=l.call(this,d,!0,!0)||this;d._curveHelper=new D.CurveHelper;d._beginCut=(void 0!==a.beginCut?a.beginCut:1)*c;d._endCut=(void 0!==a.endCut?a.endCut:1)*c;d._middleCut=(void 0!==
a.middleCut?a.middleCut:0)*c;d._invert=void 0!==a.invert?a.invert:!1;0>d._beginCut&&(d._beginCut=0);0>d._endCut&&(d._endCut=0);0>d._middleCut&&(d._middleCut=0);return d}u._inheritsLoose(g,l);g.prototype.processPath=function(d){var a=this._beginCut;const c=this._endCut,e=this._middleCut,f=this._curveHelper.calculatePathLength(d),k=[];if(!this._invert)0===a&&0===c&&0===e?k.push(d):a+c+e>=f||(0===e?(d=this._curveHelper.getSubCurve(d,a,f-c))&&k.push(d):((a=this._curveHelper.getSubCurve(d,a,.5*(f-e)))&&
k.push(a),(a=this._curveHelper.getSubCurve(d,.5*(f+e),f-c))&&k.push(a)));else if(0!==a||0!==c||0!==e)a+c+e>=f?k.push(d):((a=this._curveHelper.getSubCurve(d,0,a))&&k.push(a),(a=this._curveHelper.getSubCurve(d,.5*(f-e),.5*(f+e)))&&k.push(a),(a=this._curveHelper.getSubCurve(d,f-c,c))&&k.push(a));return 0===k.length?null:{paths:k}};return g}(B.PathGeometryCursor);t.EffectCut=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),
function(t,u,B,D,z,y){let l=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(a,c,e,f){return new g(a,c,e)};return d}();l.instance=null;let g=function(d){function a(c,e,f){var k,p;c=d.call(this,c,!0,!0)||this;c._walker=new y.GeometryWalker;c._walker.updateTolerance(f);c._endings=e.lineDashEnding;c._customDashPos=-(null!=(k=e.offsetAlongLine)?k:0)*f;c._offsetAtEnd=(null!=(p=e.customEndingOffset)?p:0)*f;c._pattern=new y.DashPattern;
c._pattern.init(e.dashTemplate,!0);c._pattern.scale(f);return c}u._inheritsLoose(a,d);a.prototype.processPath=function(c){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[c]};if(!this.iteratePath){var e=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case z.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case z.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case z.LineDashEnding.NoConstraint:this.isClosed||
(e=!1);break;case z.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var f=this._walker.calculatePathLength(c);if(this._pattern.isEmpty()||f<.1*this._pattern.length()||!this._walker.init(c,this._pattern,e))return{paths:[c]}}if(this.iteratePath)c=this._pattern.nextValue();else{switch(this._endings){default:e=.5*this._pattern.firstValue();break;case z.LineDashEnding.HalfGap:e=.5*-this._pattern.lastValue();break;case z.LineDashEnding.FullGap:e=-this._pattern.lastValue();
break;case z.LineDashEnding.FullPattern:e=0;break;case z.LineDashEnding.NoConstraint:case z.LineDashEnding.Custom:e=-this._customDashPos}c=e/this._pattern.length();c-=Math.floor(c);e=c*this._pattern.length();this._pattern.reset();c=this._pattern.nextValue();for(f=!1;e>=c;)e-=c,c=this._pattern.nextValue(),f=!f;c-=e;f?(this._walker.nextPosition(c),c=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(c),c=this._pattern.nextValue(),this._walker.nextPosition(c),c=this._pattern.nextValue())}(e=
this._walker.nextCurve(c))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),D.PathHelper.mergePath(e,this._firstCurve),this._firstCurve=null)):(c=this._pattern.nextValue(),!this._walker.nextPosition(c)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(e=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,e=this._firstCurve,this._firstCurve=null);return{paths:[e]}};return a}(B.PathGeometryCursor);t.EffectDashes=
l;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(t,u,B,D){let z=function(){function g(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var d=g.prototype;d.isEmpty=function(){return 0===this._values.length};d.size=function(){return this._values.length};d.init=function(a,c,e=!0){this._setEmpty();if(!a||0===a.length)return!1;
for(let f=0;f<a.length;f++){let k=Math.abs(a[f]);e&&1E-7>k&&(k=1E-7);this._values.push(k);this._length+=k}c&&a.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};d.scale=function(a){const c=this._values?this._values.length:0;for(let e=0;e<c;++e)this._values[e]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};d.addValue=function(a){this._length+=a;this._values.push(a)};d.firstValue=function(){return this._values[0]};d.lastValue=
function(){return this._values[this._values.length-1]};d.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};d.reset=function(){this._currentValue=-1};d.length=function(){return this._length};d._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return g}();t.EndType=void 0;(function(g){g[g.FAIL=0]="FAIL";g[g.END=1]="END";g[g.CONTINUE=2]="CONTINUE"})(t.EndType||
(t.EndType={}));let y=function(){function g(){this.reset()}var d=g.prototype;d.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};d.isValid=function(){return-1!==this.segment};d.copyTo=function(a){a.segment=this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return g}(),l=function(g){function d(c=0,e=!1){c=g.call(this,c,e)||this;c._tolerance=D.PIXEL_TOLERANCE;c._currentPosition=
new y;return c}u._inheritsLoose(d,g);var a=d.prototype;a.updateTolerance=function(c){this._tolerance=D.PIXEL_TOLERANCE*c};a.init=function(c,e,f=!0){f?(this._patternLength=e.length(),this._partExtPtGap=e.extPtGap,this._partCtrlPtGap=e.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=c;this._seg=-1;return this._setPosAtNextPart()};a.curPositionIsValid=function(){return this._currentPosition.isValid()};a.nextPosition=
function(c,e=t.EndType.FAIL){const f=new y;if(!this._nextPosition(c,f,null,e))return!1;f.copyTo(this._currentPosition);return!0};a.curPointAndAngle=function(c){c.pt=this._getPoint(this._currentPosition);const [e,f]=this._getAngle(this._currentPosition);c.ca=e;c.sa=f};a.nextPointAndAngle=function(c,e,f=t.EndType.FAIL){const k=new y;if(!this._nextPosition(c,k,null,f))return!1;k.copyTo(this._currentPosition);e.pt=this._getPoint(k);const [p,m]=this._getAngle(k);e.ca=p;e.sa=m;return!0};a.nextCurve=function(c){if(0===
c)return null;const e=[],f=new y;if(!this._nextPosition(c,f,e,t.EndType.END))return null;f.copyTo(this._currentPosition);return e};a.isPathEnd=function(){return this._currentPosition.isPathEnd};a.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};a._nextPosition=function(c,e,f,k){if(this._currentPosition.isPathEnd)return!1;var p=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(p/=this._currentPosition.segmentLength);
for(this._currentPosition.copyTo(e);e.abscissa+c*this._partLengthRatio>e.segmentLength+this._tolerance;)if(f&&(0===f.length&&(0===p?(p=this._path[e.segment],f.push([p[0],p[1]])):f.push(this.getSegCoord2D(this._path,e.segment,p))),p=this._path[e.segment+1],f.push([p[0],p[1]])),p=0,c-=(e.segmentLength-e.abscissa)/this._partLengthRatio,this._partSegCount)e.segment=this._nextSegment(),e.segmentLength=this.calculateSegLength(this._path,e.segment),e.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(k===
t.EndType.FAIL)return!1;e.segmentLength=this.calculateSegLength(this._path,e.segment);e.isPartEnd=!0;k===t.EndType.END?(e.abscissa=e.segmentLength,e.isPathEnd=!0):e.abscissa=e.segmentLength+c;return!0}this._currentPosition.copyTo(e)}e.abscissa+=c*this._partLengthRatio;f&&(0===f.length&&(0===p?(c=this._path[e.segment],f.push([c[0],c[1]])):f.push(this.getSegCoord2D(this._path,e.segment,p))),c=e.abscissa/e.segmentLength,1===c?(c=this._path[e.segment+1],f.push([c[0],c[1]])):f.push(this.getSegCoord2D(this._path,
e.segment,c)));!this._partSegCount&&Math.abs(e.abscissa-e.segmentLength)<this._tolerance&&(e.isPathEnd=this._partIsLast,e.isPartEnd=!0);return!0};a._getPoint=function(c){if(-1===c.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,c.segment,0>=c.segmentLength?0:c.abscissa/c.segmentLength)};a._getAngle=function(c){if(-1===c.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,c.segment,0>=c.segmentLength?0:c.abscissa/c.segmentLength)};a._setPosAtNextPart=
function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===B.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var c=this._partSegCount;c;)this._previousSegment(),--c;this._currentPosition.segment=
this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;c=this._getStartPointIndex();this._ctrlPtBegin=1===B.getId(this._path[c]);c=c+this._partSegCount+1;c>=this._path.length&&(c=0);this._ctrlPtEnd=1===B.getId(this._path[c]);if(0<this._patternLength){c=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const e=
this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let f=Math.round((this._partLength-(c+e))/this._patternLength);0>=f&&(f=0<c+e?0:1);this._partLengthRatio=this._partLength/(c+e+f*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};a._hasNextSegment=function(){return this._seg<this._path.length-2};a._previousSegment=function(){return--this._seg};a._nextSegment=function(){return++this._seg};a._getStartPointIndex=function(){return this._seg};
a._getEndPointIndex=function(){return this._seg+1};return d}(D.CurveHelper);t.DashPattern=z;t.GeometryWalker=l;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(t,u,B,D){let z=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a)};return l}();z.instance=
null;let y=function(){function l(g,d,a){this._inputGeometries=g;this._curveHelper=new B.CurveHelper;this._width=(void 0!==d.width?d.width:2)*a;switch(d.method){default:this._method=D.GeometricEffectOffsetMethod.Mitered;break;case D.GeometricEffectDonutMethod.Bevelled:this._method=D.GeometricEffectOffsetMethod.Bevelled;break;case D.GeometricEffectDonutMethod.Rounded:case D.GeometricEffectDonutMethod.TrueBuffer:this._method=D.GeometricEffectOffsetMethod.Rounded;break;case D.GeometricEffectDonutMethod.Square:this._method=
D.GeometricEffectOffsetMethod.Square}this._option=d.option;this._offsetFlattenError=B.PIXEL_TOLERANCE*a}l.prototype.next=function(){for(var g=this._inputGeometries.next();g;){if(u.isExtent(g)&&0<this._width){if(0>Math.min(g.xmax-g.xmin,g.ymax-g.ymin)-2*this._width)return g;var d=[];d.push([[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]]);d.push([[g.xmin+this._width,g.ymin+this._width],[g.xmax-this._width,g.ymin+this._width],[g.xmax-this._width,g.ymax-this._width],
[g.xmin+this._width,g.ymax-this._width],[g.xmin+this._width,g.ymin+this._width]]);return{rings:d}}if(u.isPolygon(g)&&0<this._width){d=[];for(const a of g.rings){g=this._curveHelper.calculatePathLength(a);const c=this._curveHelper.offset(a,this._width,this._method,4,this._offsetFlattenError);c&&(0>g&&c.reverse(),d.push(c))}if(d.length)return{rings:d}}g=this._inputGeometries.next()}return null};return l}();t.EffectDonut=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(t,u,B,D){let z=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a)};return l}();z.instance=null;let y=function(l){function g(d,a,c){d=l.call(this,d,!1,!0)||this;d._curveHelper=new D.CurveHelper;d._length=(void 0!==a.length?a.length:20)*c;d._angle=void 0!==a.angle?a.angle:225;d._position=void 0!==a.position?
a.position:50;0>d._length&&(d._length=-d._length);20>d._position&&(d._position=20);80<d._position&&(d._position=80);d._mirror=!1;return d}u._inheritsLoose(g,l);g.prototype.processPath=function(d){if(this._curveHelper.isEmpty(d,!1))return null;const a=d[0];d=d[d.length-1];this._curveHelper.normalize([d[0]-a[0],d[1]-a[1]]);const c=[a[0]+(d[0]-a[0])*this._position/100,a[1]+(d[1]-a[1])*this._position/100],e=Math.cos((90-this._angle)/180*Math.PI);let f=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&
(f=-f);this._mirror=!this._mirror;return{paths:[[a,[c[0]-this._length/2*e,c[1]-this._length/2*f],[c[0]+this._length/2*e,c[1]+this._length/2*f],d]]}};return g}(B.PathGeometryCursor);t.EffectJog=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(t,u,B){let D=function(){function y(){}y.local=function(){null===y.instance&&(y.instance=new y);return y.instance};y.prototype.execute=
function(l,g,d,a){return new z(l,g,d)};return y}();D.instance=null;let z=function(){function y(g,d,a){this._inputGeometries=g;this._offsetX=void 0!==d.offsetX?d.offsetX*a:0;this._offsetY=void 0!==d.offsetY?-d.offsetY*a:0}var l=y.prototype;l.next=function(){for(var g=this._inputGeometries.next();g;){if(B.isExtent(g))return{xmin:g.xmin+this._offsetX,xmax:g.xmax+this._offsetX,ymin:g.ymin+this._offsetY,ymax:g.ymax+this._offsetY};if(B.isPolygon(g))return g=u.clone(g),this._moveMultipath(g.rings,this._offsetX,
this._offsetY),g;if(B.isPolyline(g))return g=u.clone(g),this._moveMultipath(g.paths,this._offsetX,this._offsetY),g;if(B.isMultipoint(g))return g=u.clone(g),this._movePath(g.points,this._offsetX,this._offsetY),g;if(B.isPoint(g))return{x:g.x+this._offsetX,y:g.y+this._offsetY};g=this._inputGeometries.next()}return null};l._moveMultipath=function(g,d,a){if(g)for(const c of g)this._movePath(c,d,a)};l._movePath=function(g,d,a){if(g)for(const c of g)c[0]+=d,c[1]+=a};return y}();t.EffectMove=D;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(t,u,B,D){let z=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a)};return l}();z.instance=null;let y=function(){function l(g,d,a){var c;this._inputGeometries=g;this._curveHelper=new B.CurveHelper;this._offset=(null!=(c=d.offset)?
c:1)*a;this._method=d.method;this._option=d.option;this._offsetFlattenError=B.PIXEL_TOLERANCE*a}l.prototype.next=function(){for(var g=this._inputGeometries.next();g;){if(0===this._offset)return g;if(u.isExtent(g)){if(this._method===D.GeometricEffectOffsetMethod.Rounded&&0<this._offset){var d=this._curveHelper.offset([[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]],-this._offset,this._method,4,this._offsetFlattenError);return d?{rings:[d]}:null}if(0<Math.min(g.xmax-
g.xmin,g.ymax-g.ymin)+2*this._offset)return{xmin:g.xmin-this._offset,xmax:g.xmax+this._offset,ymin:g.ymin-this._offset,ymax:g.ymax+this._offset}}if(u.isPolygon(g)){var a=[];for(d of g.rings){const c=this._curveHelper.offset(d,-this._offset,this._method,4,this._offsetFlattenError);c&&a.push(c)}if(a.length)return{rings:a}}if(u.isPolyline(g)){a=[];for(const c of g.paths)(g=this._curveHelper.offset(c,-this._offset,this._method,4,this._offsetFlattenError))&&a.push(g);if(a.length)return{paths:a}}g=this._inputGeometries.next()}return null};
return l}();t.EffectOffset=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(t,u,B,D){let z=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a)};return l}();z.instance=null;let y=function(){function l(g,d,a){this._inputGeometries=g;this._reverse=
void 0!==d.reverse?d.reverse:!0}l.prototype.next=function(){for(var g=this._inputGeometries.next();g;){if(!this._reverse)return g;if(B.isPolyline(g))return g=u.clone(g),D.reverseMultipath(g.paths),g;g=this._inputGeometries.next()}return null};return l}();t.EffectReverse=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],
function(t,u,B,D,z){let y=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(d,a,c,e){return new l(d,a,c)};return g}();y.instance=null;let l=function(){function g(a,c,e){this._inputGeometries=a;this._rotateAngle=void 0!==c.angle?c.angle*Math.PI/180:0}var d=g.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var c=B.create();D.getBoundsXY(c,a);const e=(c[2]+c[0])/2;
c=(c[3]+c[1])/2;if(z.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,e,c),a;if(z.isPolygon(a))return a=u.clone(a),this._rotateMultipath(a.rings,e,c),a;if(z.isPolyline(a))return a=u.clone(a),this._rotateMultipath(a.paths,e,c),a;if(z.isMultipoint(a))return a=u.clone(a),this._rotatePath(a.points,e,c),a;if(z.isPoint(a))return a;a=this._inputGeometries.next()}return null};d._rotateMultipath=function(a,c,e){if(a)for(const f of a)this._rotatePath(f,
c,e)};d._rotatePath=function(a,c,e){if(a){const f=Math.cos(this._rotateAngle),k=Math.sin(this._rotateAngle);for(const p of a){a=p[0]-c;const m=p[1]-e;p[0]=c+a*f-m*k;p[1]=e+a*k+m*f}}};return g}();t.EffectRotate=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(t,u,B,D,z){let y=
function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(d,a,c,e){return new l(d,a,c)};return g}();y.instance=null;let l=function(){function g(a,c,e){this._inputGeometries=a;this._xFactor=void 0!==c.xScaleFactor?c.xScaleFactor:1.15;this._yFactor=void 0!==c.yScaleFactor?c.yScaleFactor:1.15}var d=g.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var c=B.create();
D.getBoundsXY(c,a);const e=(c[2]+c[0])/2;c=(c[3]+c[1])/2;if(z.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,e,c),a;if(z.isPolygon(a))return a=u.clone(a),this._scaleMultipath(a.rings,e,c),a;if(z.isPolyline(a))return a=u.clone(a),this._scaleMultipath(a.paths,e,c),a;if(z.isMultipoint(a))return a=u.clone(a),this._scalePath(a.points,e,c),a;if(z.isPoint(a))return a;a=this._inputGeometries.next()}return null};
d._scaleMultipath=function(a,c,e){if(a)for(const f of a)this._scalePath(f,c,e)};d._scalePath=function(a,c,e){if(a)for(const f of a)a=(f[1]-e)*this._yFactor,f[0]=c+(f[0]-c)*this._xFactor,f[1]=e+a};return g}();t.EffectScale=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(t,u,B,D,z){let y=function(){function g(){}g.local=function(){null===
g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(d,a,c,e){return new l(d,a,c)};return g}();y.instance=null;let l=function(){function g(a,c,e){this._inputGeometries=a;this._height=(void 0!==c.amplitude?c.amplitude:2)*e;this._period=(void 0!==c.period?c.period:3)*e;this._style=c.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new z.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);
this._walker=new z.GeometryWalker;this._walker.updateTolerance(e)}var d=g.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._height||0===this._period)return a;if(u.isPolyline(a)){const c=this._processGeom(a.paths);if(c.length)return{paths:c}}if(u.isPolygon(a)&&(a=this._processGeom(a.rings),a.length))return{rings:a};a=this._inputGeometries.next()}return null};d._processGeom=function(a){const c=[];for(const e of a)if(this._walker.init(e,this._pattern))switch(this._style){default:c.push(this._constructCurve(e,
!1));break;case D.GeometricEffectWaveform.Square:c.push(this._constructSquare(e));break;case D.GeometricEffectWaveform.Triangle:c.push(this._constructTriangle(e));break;case D.GeometricEffectWaveform.Random:c.push(this._constructCurve(e,!0))}else c.push(e);return c};d._constructCurve=function(a,c){const e=new B.PathHelper;var f=this._walker.calculatePathLength(a),k=Math.round(f/this._period);0===k&&(k=1);const p=this._period/16,m=1/(16*k+1);f=2*Math.PI*f/(f/k);k=2*Math.PI*Math.random();const b=2*
Math.PI*Math.random(),h=2*Math.PI*Math.random(),n=.75-Math.random()/2,r=.75-Math.random()/2,x={};this._walker.curPointAndAngle(x);e.startPath(x.pt);let q=0;for(;;)if(this._walker.nextPointAndAngle(p,x)){const A=q;q+=m;let E;if(c){const F=this._height/2*(1+.3*Math.sin(n*f*A+k));E=F*Math.sin(f*A+b);E+=F*Math.sin(r*f*A+h);E/=2}else E=.5*this._height*Math.sin(.5*f*A);e.lineTo([x.pt[0]-E*x.sa,x.pt[1]+E*x.ca])}else{e.lineTo(a[a.length-1]);break}return e.path()};d._constructSquare=function(a){const c=new B.PathHelper;
a=this._walker.calculatePathLength(a);Math.round(a/this._period);for(a=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const k={};if(this._walker.nextPointAndAngle(this._period,k)){const p={};this._walker.nextPointAndAngle(this._period,p)&&(a?(c.startPath(f.pt),a=!1):c.lineTo(f.pt),c.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),c.lineTo([k.pt[0]-this._height/2*k.sa,k.pt[1]+this._height/2*k.ca]),c.lineTo([k.pt[0]+this._height/2*
k.sa,k.pt[1]-this._height/2*k.ca]),c.lineTo([p.pt[0]+this._height/2*p.sa,p.pt[1]-this._height/2*p.ca]),e=!0)}}if(!e){c.lineTo(this._walker.getPathEnd());break}}return c.path()};d._constructTriangle=function(a){const c=new B.PathHelper;a=this._walker.calculatePathLength(a);Math.round(a/this._period);for(a=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const k={};if(this._walker.nextPointAndAngle(this._period/2,k)){const p={};this._walker.nextPointAndAngle(this._period,
p)&&(this._walker.nextPosition(this._period/2)&&(a?(c.startPath(f.pt),a=!1):c.lineTo(f.pt),c.lineTo([k.pt[0]-this._height/2*k.sa,k.pt[1]+this._height/2*k.ca]),c.lineTo([p.pt[0]+this._height/2*p.sa,p.pt[1]-this._height/2*p.ca])),e=!0)}}if(!e){c.lineTo(this._walker.getPathEnd());break}}return c.path()};return g}();t.EffectWave=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../CIMCursor","../enums","../GeometryWalker"],function(t,u,B,D,z){let y=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(d,a,c,e){return new l(d,a,c)};return g}();y.instance=null;let l=function(g){function d(c,e,f){var k;c=g.call(this,c,!0,!0)||this;c._geometryWalker=new z.GeometryWalker;c._geometryWalker.updateTolerance(f);c._angleToLine=null!=(k=e.angleToLine)?k:!0;c._offset=(e.offset?e.offset:0)*f;c._originalEndings=
e.endings;c._offsetAtEnd=(e.customEndingOffset?e.customEndingOffset:0)*f;c._position=-(e.offsetAlongLine?e.offsetAlongLine:0)*f;c._pattern=new z.DashPattern;c._pattern.init(e.placementTemplate,!1);c._pattern.scale(f);c._endings=c._originalEndings;return c}u._inheritsLoose(d,g);var a=d.prototype;a.processPath=function(c){if(this._pattern.isEmpty())return null;if(this.iteratePath)var e=this._pattern.nextValue();else{this._endings=this._originalEndings===D.PlacementEndings.WithFullGap&&this.isClosed?
D.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;let f=!0;switch(this._endings){case D.PlacementEndings.NoConstraint:e=-this._position;e=this._adjustPosition(e);f=!1;break;default:e=-this._pattern.lastValue()/2;break;case D.PlacementEndings.WithFullGap:e=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case D.PlacementEndings.WithMarkers:e=0;break;case D.PlacementEndings.Custom:e=-this._position,e=this._adjustPosition(e),this._pattern.extPtGap=
.5*this._offsetAtEnd}if(!this._geometryWalker.init(c,this._pattern,f))return null;this._pattern.reset();for(c=0;e>c;)e-=c,c=this._pattern.nextValue();e=c-=e;this.iteratePath=!0}c={};if(!this._geometryWalker.nextPointAndAngle(e,c)||this._endings===D.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===D.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(c.pt[0]-
this._offset*c.sa,c.pt[1]+this._offset*c.ca);this._angleToLine&&this.internalPlacement.setRotateCS(c.ca,c.sa);return this.internalPlacement};a._adjustPosition=function(c){c/=this._pattern.length();c-=Math.floor(c);return c*this._pattern.length()};return d}(B.PathTransformationCursor);t.PlacementAlongLineSameSize=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper","../enums"],function(t,u,B,D,z){let y=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(d,a,c,e){return new l(d,a,c)};return g}();y.instance=null;let l=function(g){function d(c,e,f){c=g.call(this,c,!1,!0)||this;c._curveHelper=new D.CurveHelper;c._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;c._offset=void 0!==e.offset?e.offset*f:0;c._type=e.extremityPlacement;c._position=void 0!==e.offsetAlongLine?
e.offsetAlongLine*f:0;c._beginProcessed=!1;return c}u._inheritsLoose(d,g);var a=d.prototype;a.processPath=function(c){let e;switch(this._type){default:this._beginProcessed?(e=this._atExtremities(c,this._position,!1),this.iteratePath=this._beginProcessed=!1):(e=this._atExtremities(c,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case z.ExtremityPlacement.JustBegin:e=this._atExtremities(c,this._position,!0);break;case z.ExtremityPlacement.JustEnd:e=this._atExtremities(c,this._position,
!1);case z.ExtremityPlacement.None:}return e};a._atExtremities=function(c,e,f){var k=c.length;if(2>k)return null;var p=f?1:k-2;const m=f?k:-1,b=f?1:-1;let h=0;f=f?c[0]:c[k-1];for(k=p;k!==m;k+=b){p=f;f=c[k];const n=this._curveHelper.calculateLength(p,f);if(h+n>e){c=(e-h)/n;const [r,x]=this._curveHelper.getAngleCS(p,f,c);c=B.getCoord2D(p,f,c);this.internalPlacement.setTranslate(c[0]-this._offset*x,c[1]+this._offset*r);this._angleToLine&&this.internalPlacement.setRotateCS(-r,-x);return this.internalPlacement}h+=
n}return null};return d}(B.PathTransformationCursor);t.PlacementAtExtremities=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(t,u,B,D){let z=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(g,d,a,c){return new y(g,d,a)};return l}();z.instance=
null;let y=function(l){function g(d,a,c){d=l.call(this,d,!0,!0)||this;d._walker=new D.GeometryWalker;d._walker.updateTolerance(c);d._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;d._offset=void 0!==a.offset?a.offset*c:0;d._beginGap=void 0!==a.beginPosition?a.beginPosition*c:0;d._endGap=void 0!==a.endPosition?a.endPosition*c:0;d._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;d._pattern=new D.DashPattern;d._pattern.init(a.positionArray,!1,!1);d._subPathLen=0;d._posCount=d._pattern.size();d._isFirst=
!0;d._prevPos=0;return d}u._inheritsLoose(g,l);g.prototype.processPath=function(d){if(this._pattern.isEmpty())return null;if(this.iteratePath){d=this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+d;d=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(d)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(d,this._pattern,!1))return null;
this._pattern.reset();d=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+d;d=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(d,a,D.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca);d=this._isFirst&&this._flipFirst;let c;this._angleToLine?(c=a.ca,a=a.sa):(c=1,a=0);d&&(c=-c,a=-a);this.internalPlacement.setRotateCS(c,a);this._isFirst=!1;this._posCount--;0===this._posCount&&
(this.iteratePath=!1);return this.internalPlacement};return g}(B.PathTransformationCursor);t.PlacementAtRatioPositions=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../CIMPlacements","../enums"],function(t,u,B){let D=function(){function y(){}y.local=function(){null===y.instance&&(y.instance=new y);return y.instance};y.prototype.execute=function(l,g,d,a){return new z(l,g,d,a)};return y}();D.instance=null;let z=
function(){function y(g,d,a,c){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==d.stepX?Math.abs(d.stepX):16)*a;this._stepY=(void 0!==d.stepY?Math.abs(d.stepY):16)*a;if(0!==this._stepX&&0!==this._stepY&&g&&void 0!==g.rings&&g.rings){this._gridType=void 0!==d.gridType?d.gridType:B.PlacementGridType.Fixed;if(this._gridType===B.PlacementGridType.Random)this._randomness=void 0!==d.randomness?d.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=
1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==d.gridAngle?d.gridAngle:0;this._shiftOddRows=void 0!==d.shiftOddRows?d.shiftOddRows:!1;this._offsetX=void 0!==d.offsetX?d.offsetX*a:0;this._offsetY=void 0!==d.offsetY?d.offsetY*a:0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=
.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new u.Placement;this._calculateMinMax(g);this._geometry=g}}var l=y.prototype;l.next=function(){return this._geometry?this._nextInside():null};l._calculateMinMax=function(g){this._yMax=this._yMin=this._xMax=this._xMin=0;let d,
a,c,e,f;a=c=Number.MAX_VALUE;e=f=-Number.MAX_VALUE;for(const p of g.rings){const m=p?p.length:0;for(let b=0;b<m;++b){var k=p[b][0]-this._graphicOriginX-this._offsetX;d=p[b][1]-this._graphicOriginY-this._offsetY;g=this._cosAngle*k-this._sinAngle*d;k=this._sinAngle*k+this._cosAngle*d;a=Math.min(a,g);e=Math.max(e,g);c=Math.min(c,k);f=Math.max(f,k)}}a+=this._graphicOriginX;e+=this._graphicOriginX;c+=this._graphicOriginY;f+=this._graphicOriginY;this._xMin=Math.round(a/this._stepX);this._xMax=Math.round(e/
this._stepX);this._yMin=Math.round(c/this._stepY);this._yMax=Math.round(f/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};l._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var g=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(g+=.5*this._stepX);const d=this._currentY*this._stepY+this._offsetY;this._currentX++;
let a;this._gridType===B.PlacementGridType.Random?(a=this._graphicOriginX+g+this._stepX*this._randomness*(.5-Math.random())*2/3,g=this._graphicOriginY+d+this._stepY*this._randomness*(.5-Math.random())*2/3):(a=this._graphicOriginX+this._cosAngle*g+this._sinAngle*d,g=this._graphicOriginY-this._sinAngle*g+this._cosAngle*d);this._internalPlacement.setTranslate(a,g);return this._internalPlacement}};return y}();t.PlacementInsidePolygon=D;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(t,u,B,D,z){let y=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(d,a,c,e){return new l(d,a,c)};return g}();y.instance=null;let l=function(g){function d(c,e,f){c=g.call(this,c,!0,!0)||this;c._curveHelper=new D.CurveHelper;c._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;c._offset=void 0!==e.offset?e.offset*f:0;c._relativeTo=
e.relativeTo;c._position=void 0!==e.startPointOffset?e.startPointOffset*f:0;c._epsilon=.001*f;return c}u._inheritsLoose(d,g);var a=d.prototype;a.processPath=function(c){var e=this._position;if(this._relativeTo===z.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||(this._segmentCount=c.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var f=this._curSegment;this._curSegment++;e=c[f-1];f=c[f];const k=this._curveHelper.calculateLength(e,f);if(k<this._epsilon)continue;
c=.5+this._position/k;const [p,m]=this._curveHelper.getAngleCS(e,f,c);c=B.getCoord2D(e,f,c);this.internalPlacement.setTranslate(c[0]-this._offset*m,c[1]+this._offset*p);this._angleToLine&&this.internalPlacement.setRotateCS(p,m);return this.internalPlacement}this.iteratePath=!1;return null}this._relativeTo===z.PlacementOnLineRelativeTo.LineEnd&&B.reversePath(c);e=this.onLine(c,e);this._relativeTo===z.PlacementOnLineRelativeTo.LineEnd&&B.reversePath(c);return e};a.onLine=function(c,e){let f,k=!1;switch(this._relativeTo){default:f=
this._curveHelper.calculatePathLength(c)/2+e;break;case z.PlacementOnLineRelativeTo.LineBeginning:f=e;break;case z.PlacementOnLineRelativeTo.LineEnd:f=e,k=!0}const p=c.length;let m=0,b=c[0];for(let h=1;h<p;++h){e=b;b=c[h];const n=this._curveHelper.calculateLength(e,b);if(m+n>f){c=(f-m)/n;const [r,x]=this._curveHelper.getAngleCS(e,b,c);c=B.getCoord2D(e,b,c);e=k?-this._offset:this._offset;this.internalPlacement.setTranslate(c[0]-e*x,c[1]+e*r);this._angleToLine&&(k?this.internalPlacement.setRotateCS(-r,
-x):this.internalPlacement.setRotateCS(r,x));return this.internalPlacement}m+=n}return null};return d}(B.PathTransformationCursor);t.PlacementOnLine=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(t,u,B,D){function z(g,d){const a=Math.PI;for(;Math.abs(d-g)>a+2E-15;)d=d-g>a?d-2*a:d+2*a;return(g+d)/2}let y=function(){function g(){}
g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(d,a,c,e){return new l(d,a,c)};return g}();y.instance=null;let l=function(g){function d(c,e,f){c=g.call(this,c,!0,!0)||this;c._curveHelper=new D.CurveHelper;c._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;c._offset=void 0!==e.offset?e.offset*f:0;c._endPoints=void 0!==e.placeOnEndPoints?e.placeOnEndPoints:!0;c._controlPoints=void 0!==e.placeOnControlPoints?e.placeOnControlPoints:!0;c._regularVertices=
void 0!==e.placeOnRegularVertices?e.placeOnRegularVertices:!0;c._tags=[];c._tagIterator=0;return c}u._inheritsLoose(d,g);var a=d.prototype;a.processPath=function(c){this.iteratePath||(this._preparePath(c),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;c=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(c[2]);let e=c[0],f=c[1];if(0!==this._offset){const k=Math.cos(c[2]);e-=this._offset*
Math.sin(c[2]);f+=this._offset*k}this.internalPlacement.setTranslate(e,f);this._tagIterator++;return this.internalPlacement};a._preparePath=function(c){this._tagIterator=this._tags.length=0;const e=B.isClosedPath(c),f=c.length-1;let k=0,p=0,m=0,b=0,h=0,n,r;for(;k<f;){k++;n=c[k-1];r=c[k];const x=B.getId(n),q=B.getId(r);if(this._angleToLine||0!==this._offset)b=this._curveHelper.getAngle(n,r,0);1===k?e?(p=b,m=x):(this._endPoints||this._controlPoints&&1===x)&&this._tags.push([n[0],n[1],b]):1===x?this._controlPoints&&
this._tags.push([n[0],n[1],z(h,b)]):this._regularVertices&&this._tags.push([n[0],n[1],z(h,b)]);if(this._angleToLine||0!==this._offset)h=this._curveHelper.getAngle(n,r,1);k===f&&(e?1===q||1===m?this._controlPoints&&this._tags.push([r[0],r[1],z(h,p)]):this._regularVertices&&this._tags.push([r[0],r[1],z(h,p)]):(this._endPoints||this._controlPoints&&1===q)&&this._tags.push([r[0],r[1],h]))}this._tagIterator=0};return d}(B.PathTransformationCursor);t.PlacementOnVertices=y;Object.defineProperty(t,"__esModule",
{value:!0})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements","../enums"],function(t,u,B,D,z){let y=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(d,a,c,e){return new l(d,a,c)};return g}();y.instance=null;let l=function(){function g(a,c,e){this._geometry=a;this._offsetX=void 0!==c.offsetX?
c.offsetX*e:0;this._offsetY=void 0!==c.offsetY?c.offsetY*e:0;this._method=void 0!==c.method?c.method:z.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new D.Placement}var d=g.prototype;d.next=function(){const a=this._geometry;this._geometry=null;return a&&void 0!==a.rings?this._polygonCenter(a):null};d._polygonCenter=function(a){switch(this._method){default:case z.PlacementPolygonCenterMethod.CenterOfMass:case z.PlacementPolygonCenterMethod.BoundingBoxCenter:{const c=u.create();B.getBoundsXY(c,
a);this._internalPlacement.setTranslate((c[2]+c[0])/2+this._offsetX,(c[3]+c[1])/2+this._offsetY)}}return this._internalPlacement};return g}();t.PlacementPolygonCenter=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(t){return function(){function u(B=0,D=0,z=0,y=0){this.x=B;this.y=D;this.width=z;this.height=y}u.prototype.union=function(B){this.x=Math.min(this.x,B.x);this.y=Math.min(this.y,B.y);this.width=
Math.max(this.width,B.width);this.height=Math.max(this.height,B.height)};t._createClass(u,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return u}()})},"esri/symbols/cim/TextRasterizer":function(){define(["exports","../../core/screenUtils"],function(t,u){let B=function(){function z(){}var y=z.prototype;y.rasterizeText=function(l,g){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var d=this._textRasterizationCanvas,a=d.getContext("2d");
this._setFontProperties(a,g);this.parameters=g;this.textLines=l.split(/\r?\n/);this.lineHeight=this._computeLineHeight();l=this._computeTextWidth(a,g);const {decoration:c,weight:e}=g.font;this.lineThroughWidthOffset=c&&"line-through"===c?.1*this.lineHeight:0;var f=this.lineHeight*this.textLines.length;d.width=l+2*this.lineThroughWidthOffset;d.height=f;this.renderedLineHeight=Math.round(this.lineHeight*g.pixelRatio);this.renderedHaloSize=g.halo.size*g.pixelRatio;this.renderedWidth=l*g.pixelRatio;this.renderedHeight=
f*g.pixelRatio;this.lineThroughWidthOffset*=g.pixelRatio;d=g.color;this.fillStyle=`rgba(${d.slice(0,3).toString()},${d[3]})`;this.haloStyle=`rgb(${g.halo.color.slice(0,3).toString()})`;d=this.renderedLineHeight;l=this.renderedHaloSize;this._setFontProperties(a,g);f=a.textAlign;var k=this.renderedWidth;f=("center"===f?.5*k:"right"===f?k:0)+l;k=this.lineThroughWidthOffset;let p=0;0<l&&this._renderHalo(a,f,l,k,p,g);p+=l;k+=f;for(var m of this.textLines)a.globalCompositeOperation="destination-out",a.fillStyle=
"rgb(0, 0, 0)",a.fillText(m,k,p),a.globalCompositeOperation="source-over",a.fillStyle=this.fillStyle,a.fillText(m,k,p),c&&"none"!==c&&this._renderDecoration(a,k,p,c,e),p+=d;m=this.renderedWidth+2*this.lineThroughWidthOffset;d=this.renderedHeight;a=a.getImageData(0,0,m,d);a=new Uint8Array(a.data);if(g.premultiplyColors)for(l=0;l<a.length;l+=4)g=a[l+3]/255,a[l]*=g,a[l+1]*=g,a[l+2]*=g;return{size:[m,d],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};y._renderHalo=function(l,
g,d,a,c,e){const f=this.renderedWidth,k=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=f;this._haloRasterizationCanvas.height=k;const p=this._haloRasterizationCanvas,m=p.getContext("2d");m.clearRect(0,0,f,k);this._setFontProperties(m,e);const {decoration:b,weight:h}=e.font;m.fillStyle=this.haloStyle;m.strokeStyle=this.haloStyle;e=3>this.renderedHaloSize;m.lineJoin=e?"miter":"round";e?this._renderHaloEmulated(m,
g,d,b,h):this._renderHaloNative(m,g,d,b,h);l.globalAlpha=this.parameters.halo.color[3];l.drawImage(p,0,0,f,k,a,c,f,k);l.globalAlpha=1};y._renderHaloEmulated=function(l,g,d,a,c){const e=this.renderedLineHeight,f=this.renderedHaloSize;for(const k of this.textLines){for(const [p,m]of D)l.fillText(k,g+f*p,d+f*m);a&&"none"!==a&&this._renderDecoration(l,g,d,a,c);d+=e}};y._renderHaloNative=function(l,g,d,a,c){const e=this.renderedLineHeight,f=this.renderedHaloSize;for(const k of this.textLines){const p=
2*f;for(let m=0;5>m;m++)l.lineWidth=(.6+.1*m)*p,l.strokeText(k,g,d),a&&"none"!==a&&this._renderDecoration(l,g,d,a,c);d+=e}};y._setFontProperties=function(l,g){var d=g.font;d=`${d.style} ${d.weight} ${u.pt2px(g.size*g.pixelRatio)}px ${d.family}, sans-serif`;l.font=d;l.textBaseline="top";switch(g.horizontalAlignment){case "left":g="left";break;case "right":g="right";break;case "center":g="center";break;default:g="left"}l.textAlign=g};y.computeTextSize=function(l,g){this._textRasterizationCanvas||(this._textRasterizationCanvas=
document.createElement("canvas"));const d=this._textRasterizationCanvas;var a=d.getContext("2d");this._setFontProperties(a,g);this.parameters=g;this.textLines=l.split(/\r?\n/);this.lineHeight=this._computeLineHeight();l=this._computeTextWidth(a,g);a=this.lineHeight*this.textLines.length;d.width=l;d.height=a;return[l*g.pixelRatio,a*g.pixelRatio]};y._computeTextWidth=function(l,g){let d=0;for(const a of this.textLines)d=Math.max(d,l.measureText(a).width);g=g.font;if("italic"===g.style||"oblique"===
g.style||"string"===typeof g.weight&&("bold"===g.weight||"bolder"===g.weight)||"number"===typeof g.weight&&600<g.weight)d+=.3*l.measureText("w").width;d+=2*this.parameters.halo.size;return Math.round(d)};y._computeLineHeight=function(){let l=1.275*this.parameters.size;const g=this.parameters.font.decoration;g&&"underline"===g&&(l*=1.3);return Math.round(l+2*this.parameters.halo.size)};y._renderDecoration=function(l,g,d,a,c){const e=.9*this.lineHeight;c="bold"===c?.06:"bolder"===c?.09:.04;switch(l.textAlign){case "center":g-=
this.renderedWidth/2;break;case "right":g-=this.renderedWidth}const f=l.textBaseline;if("underline"===a)switch(f){case "top":d+=e;break;case "middle":d+=e/2}else if("line-through"===a)switch(f){case "top":d+=e/1.5;break;case "middle":d+=e/3}l.save();l.beginPath();l.strokeStyle=l.fillStyle;l.lineWidth=Math.ceil(e*c);l.moveTo(g-this.lineThroughWidthOffset,d);l.lineTo(g+this.renderedWidth+2*this.lineThroughWidthOffset,d);l.stroke();l.restore()};return z}();const D=[];for(let z=0;360>z;z+=22.5)D.push([Math.cos(Math.PI*
z/180),Math.sin(Math.PI*z/180)]);t.TextRasterizer=B;t.default=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),function(t,u,B,D,z,y,l,g,d,a){const c=
Math.PI/180;let e=function(){function m(h,n,r,x){this._rotationT=D.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const q=r.rect,A=new Float32Array(8);h*=x;n*=x;const E=r.code?q.width*x:r.metrics.width,F=r.code?q.height*x:r.metrics.height;A[0]=h;A[1]=n;A[2]=h+E;A[3]=n;A[4]=h;A[5]=n+F;A[6]=h+E;A[7]=n+F;this._data=A;this._setTextureCoords(q);this._scale=x;this._mosaic=r;this.x=h;this.y=n;this.maxOffset=Math.max(h+E,n+F)}var b=m.prototype;b.setTransform=function(h){this._T=
h;this._offsets=null};b._setOffsets=function(h){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const n=this._offsets,r=new Float32Array(8),x=B.multiply(D.create(),this._rotationT,this._T);D.transformMany(r,h,x);n.upperLeft=g.i1616to32(8*r[0],8*r[1]);n.upperRight=g.i1616to32(8*r[2],8*r[3]);n.lowerLeft=g.i1616to32(8*r[4],8*r[5]);n.lowerRight=g.i1616to32(8*r[6],8*r[7])};b._setTextureCoords=function({x:h,y:n,width:r,height:x}){this._texcoords={upperLeft:g.i1616to32(h,
n),upperRight:g.i1616to32(h+r,n),lowerLeft:g.i1616to32(h,n+x),lowerRight:g.i1616to32(h+r,n+x)}};u._createClass(m,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(h){this._angle=h;B.fromRotation(this._rotationT,-h);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",
get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:q,
width:A}=this._mosaic.metrics;var h=A*this._scale,n=Math.abs(q)*this._scale,r=new Float32Array(8);r[0]=this.x;r[1]=this.y;r[2]=this.x+h;r[3]=this.y;r[4]=this.x;r[5]=this.y+n;r[6]=this.x+h;r[7]=this.y+n;h=B.multiply(D.create(),this._rotationT,this._T);D.transformMany(r,r,h);n=h=Infinity;let E=0;var x=0;for(let F=0;4>F;F++){const w=r[2*F],v=r[2*F+1];h=Math.min(h,w);n=Math.min(n,v);E=Math.max(E,w);x=Math.max(x,v)}r=E-h;x-=n;this._bounds=new a(h+r/2,n+x/2,r,x)}return this._bounds}}]);return m}();const f=
(m,b)=>({code:0,page:0,sdf:!0,rect:new d(0,0,11,8),textureBinding:b,metrics:{advance:0,height:4,width:m,left:0,top:0}});let k=function(){function m(h,n,r){this._rotation=0;this._decorate(h,n,r);this.glyphs=h;this.bounds=this._createBounds(h);this.isMultiline=1<n.length;this._hasRotation=0!==r.angle;this._T=this._createGlyphTransform(this.bounds,r);for(const x of h)x.setTransform(this._T)}var b=m.prototype;b.setRotation=function(h){if(0!==h||0!==this._rotation){this._rotation=h;var n=this._T;h=B.fromRotation(D.create(),
h);B.multiply(n,h,n);for(const r of this.glyphs)r.setTransform(this._T)}};b._decorate=function(h,n,r){if(r.decoration&&"none"!==r.decoration&&h.length){var x=r.scale;r="underline"===r.decoration?30:20;var q=h[0].textureBinding;for(const A of n)h.push(new e(A.startX*x,A.startY*x+r*x,f((A.width+A.glyphWidthEnd)*x,q),1))}};b._createBounds=function(h){let n=Infinity,r=Infinity,x=0;var q=0;for(const A of h)n=Math.min(n,A.xTopLeft),r=Math.min(r,A.yTopLeft),x=Math.max(x,A.xTopLeft+A.width),q=Math.max(q,
A.yBottomRight);h=x-n;q-=r;return new a(n+h/2,r+q/2,h,q)};b._createGlyphTransform=function(h,n){const r=c*n.angle,x=D.create(),q=y.create();B.translate(x,x,z.set(q,n.xOffset,-n.yOffset));n.isCIM?B.rotate(x,x,r):(B.translate(x,x,z.set(q,h.x,h.y)),B.rotate(x,x,r),B.translate(x,x,z.set(q,-h.x,-h.y)));return x};u._createClass(m,[{key:"boundsT",get:function(){var h=this.bounds;const n=z.set(y.create(),h.x,h.y);z.transformMat2d(n,n,this._T);return this._hasRotation?(h=Math.max(h.width,h.height),new a(n[0],
n[1],h,h)):new a(n[0],n[1],h.width,h.height)}}]);return m}(),p=function(m,b,h,n,r,x){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(b,h));this.end=Math.max(0,Math.max(b,h));this.end<m.length&&(this.glyphWidthEnd=m[this.end].metrics.width);this.width=n;this.yMin=r;this.yMax=x};t.ShapedGlyph=e;t.ShapingInfo=k;t.shapeGlyphs=function(m,b,h){const n=h.scale,r=[];{var x=[];var q=1/h.scale*h.maxLineWidth;var A=b?m.length-1:0;var E=b?-1:m.length;b=b?-1:1;var F=A,w=0,v=0;let L=
F,O=L,N=0,K=Infinity,I=0;for(;F!==E;){const {code:M,metrics:U}=m[F];var C=Math.abs(U.top);10!==M&&32!==M&&(K=Math.min(K,C),I=Math.max(I,C+U.height));10===M?(F!==A&&(x.push(new p(m,L,F-b,w,K,I)),K=Infinity,I=0),w=0,L=F+b,O=F+b,v=0):32===M?(O=F+b,v=0,N=U.advance,w+=U.advance):(w>q&&(O!==L?(C=O-2*b,w-=N,x.push(new p(m,L,C,w-v,K,I)),K=Infinity,I=0,L=O,w=v):(x.push(new p(m,L,F-b,w,K,I)),K=Infinity,I=0,O=L=F,w=0)),w+=U.advance,v+=U.advance);F+=b}q=new p(m,L,F-b,w,K,I);0<=q.start&&q.end<m.length&&x.push(q)}for(q=
0;q<x.length;q++);q=A=x[0].yMin;A=x[x.length-1].yMax+h.lineHeight*(x.length-1)+("underline"===h.decoration?4:0)-A;const {vAlign:G,hAlign:H}=h;E=G===l.VAlign.Baseline?1:0;q=(1-E)*-q+A/2*(E?0:G-1)+-26*(E?1:0);for(A=0;A<x.length;A++){const {start:L,end:O,width:N}=x[A];E=N/2*(H+1)*-1-3;b=A*h.lineHeight+q-3;x[A].startX=E;x[A].startY=b;for(F=L;F<=O;F++)w=m[F],10!==w.code&&(v=new e(E+w.metrics.left,b-w.metrics.top,w,n),E+=w.metrics.advance,r.push(v))}return new k(r,x,h)};Object.defineProperty(t,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(t){return function(){function u(B=0,D=0,z=0,y=0){this.x=B;this.y=D;this.width=z;this.height=y}u.prototype.union=function(B){this.x=Math.min(this.x,B.x);this.y=Math.min(this.y,B.y);this.width=Math.max(this.width,B.width);this.height=Math.max(this.height,B.height)};t._createClass(u,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return u}()})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../chunks/vec2f32"],function(t,u){return function(){function B(z,y,l,g){this.center=u.fromValues(z,y);this.centerT=u.create();this.halfWidth=l/2;this.halfHeight=g/2;this.width=l;this.height=g}var D=B.prototype;D.clone=function(){return new B(this.x,this.y,this.width,this.height)};D.serialize=function(z){z.writeF32(this.center[0]);z.writeF32(this.center[1]);z.push(this.width);z.push(this.height);return z};D.findCollisionDelta=function(z,y=4){return Math.log2(Math.min((z.halfWidth+this.halfWidth+
y)/Math.abs(z.centerT[0]-this.centerT[0]),(z.halfHeight+this.halfHeight+y)/Math.abs(z.centerT[1]-this.centerT[1])))};D.extend=function(z){const y=Math.min(this.xmin,z.xmin),l=Math.min(this.ymin,z.ymin),g=Math.max(this.xmax,z.xmax)-y;z=Math.max(this.ymax,z.ymax)-l;this.width=g;this.height=z;this.halfWidth=g/2;this.halfHeight=z/2;this.x=y+g/2;this.y=l+z/2};B.deserialize=function(z){const y=z.readF32(),l=z.readF32(),g=z.readInt32();z=z.readInt32();return new B(y,l,g,z)};t._createClass(B,[{key:"x",get:function(){return this.center[0]},
set:function(z){this.center[0]=z}},{key:"y",get:function(){return this.center[1]},set:function(z){this.center[1]=z}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",
get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return B}()})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(t){function u(g,d){g%=d;return 0<=g?g:g+d}const B=Number.POSITIVE_INFINITY,D=Math.PI,z=128/D,y=256/360,l=1/Math.LN2;t.C_256_TO_RAD=D/128;t.C_2PI=2*D;t.C_DEG_TO_256=y;t.C_DEG_TO_RAD=D/180;t.C_INFINITY=B;t.C_PI=D;t.C_PI_BY_2=D/2;t.C_RAD_TO_256=z;t.C_SQRT2=1.414213562;t.C_SQRT2_INV=1/1.414213562;
t.between=function(g,d,a){return g>=d&&g<=a||g>=a&&g<=d};t.degToByte=function(g){return u(g*y,256)};t.interpolate=function(g,d,a){return g*(1-a)+d*a};t.log2=function(g){return Math.log(g)*l};t.positiveMod=u;t.radToByte=function(g){return u(g*z,256)};t.sqr=function(g){return g*g};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(t,u,B,D){function z(l){if(!l)return null;
switch(l.type){case "CIMPointSymbol":var g=l.symbolLayers;if(!g||1!==g.length)break;return z(g[0]);case "CIMVectorMarker":l=l.markerGraphics;if(!l||1!==l.length)break;var d=l[0];if(!d)break;l=d.geometry;if(!l)break;d=d.symbol;if(!d||"CIMPolygonSymbol"!==d.type&&"CIMLineSymbol"!==d.type||null!=(g=d.symbolLayers)&&g.some(a=>!!a.effects))break;return{geom:l,asFill:"CIMPolygonSymbol"===d.type};case "sdf":return{geom:l.geom,asFill:l.asFill}}return null}function y(l){let g=Infinity,d=-Infinity,a=Infinity,
c=-Infinity;for(const e of l)for(const f of e)f[0]<g&&(g=f[0]),f[0]>d&&(d=f[0]),f[1]<a&&(a=f[1]),f[1]>c&&(c=f[1]);return[g,a,d,c]}t.buildSDF=function(l){var g=l.geom;var d=g?g.rings?g.rings:g.paths?g.paths:void 0!==g.xmin&&void 0!==g.ymin&&void 0!==g.xmax&&void 0!==g.ymax?[[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]]]:null:null;g=Infinity;var a=-Infinity;var c=Infinity,e=-Infinity;for(var f of d)for(var k of f)k[0]<g&&(g=k[0]),k[0]>a&&(a=k[0]),k[1]<c&&(c=k[1]),
k[1]>e&&(e=k[1]);a=new D(g,c,a-g,e-c);c=64/Math.max(a.width,a.height);f=Math.round(a.width*c)+62;k=Math.round(a.height*c)+62;g=[];for(var p of d)if(p&&1<p.length){d=[];for(var m of p){let [w,v]=m;w-=a.x;v-=a.y;w*=c;v*=c;w+=30.5;v+=30.5;l.asFill?d.push([w,v]):d.push([Math.round(w),Math.round(v)])}l.asFill&&(e=d.length-1,d[0][0]===d[e][0]&&d[0][1]===d[e][1]||d.push(d[0]));g.push(d)}var b;p=f*k;m=Array(p);for(d=0;d<p;++d)m[d]=962;for(b of g)for(d=b.length,a=1;a<d;++a){c=b[a-1];e=b[a];var h=void 0,n=
void 0;c[0]<e[0]?(h=c[0],n=e[0]):(h=e[0],n=c[0]);var r=void 0,x=void 0;c[1]<e[1]?(r=c[1],x=e[1]):(r=e[1],x=c[1]);var q=Math.floor(h)-31;n=Math.floor(n)+31;r=Math.floor(r)-31;x=Math.floor(x)+31;0>q&&(q=0);n>f&&(n=f);0>r&&(r=0);x>k&&(x=k);h=e[0]-c[0];const w=e[1]-c[1],v=h*h+w*w;for(;q<n;q++)for(let C=r;C<x;C++){var A=(q-c[0])*h+(C-c[1])*w,E=void 0;0>A?(E=c[0],A=c[1]):A>v?(E=e[0],A=e[1]):(A/=v,E=c[0]+A*h,A=c[1]+A*w);E=(q-E)*(q-E)+(C-A)*(C-A);A=(k-C-1)*f+q;E<m[A]&&(m[A]=E)}}for(b=0;b<p;++b)m[b]=Math.sqrt(m[b]);
b=m;if(l.asFill)for(var F of g)for(l=F.length,g=1;g<l;++g)for(p=F[g-1],m=F[g],p[0]<m[0]?(d=p[0],a=m[0]):(d=m[0],a=p[0]),p[1]<m[1]?(e=p[1],c=m[1]):(e=m[1],c=p[1]),d=Math.floor(d),a=Math.floor(a)+1,e=Math.floor(e),c=Math.floor(c)+1,31>d&&(d=31),a>f-31&&(a=f-31),31>e&&(e=31),c>k-31&&(c=k-31);e<c;++e)if(p[1]>e!==m[1]>e){n=(k-e-1)*f;for(r=d;r<a;++r)r<(m[0]-p[0])*(e-p[1])/(m[1]-p[1])+p[0]&&(b[n+r]=-b[n+r]);for(r=31;r<d;++r)b[n+r]=-b[n+r]}F=b.length;l=new Uint8Array(4*F);for(g=0;g<F;++g)u.packFloatRGBA(.5-
b[g]/62,l,4*g);F=l;return[F,f,k]};t.getExtent=function(l){return l?l.rings?y(l.rings):l.paths?y(l.paths):B.isExtent(l)?[l.xmin,l.ymin,l.xmax,l.ymax]:null:null};t.getSDFInfo=z;t.getSDFMetrics=function(l,g,d,a,c){const [e,f,k,p]=l;if(k<e||p<f)return[0,0,0];var m=k-e,b=p-f;l=64/Math.max(m,b);m=Math.round(m*l);b=Math.round(b*l)+62;let h=1;g&&(h=b/l/(g.ymax-g.ymin));let n=0,r=0;a&&(c?g&&d&&0<g.ymax-g.ymin&&(n=a.x/((g.xmax-g.xmin)/(g.ymax-g.ymin)*d),r=a.y/d):(n=a.x,r=a.y));n=.5*(g.xmax+g.xmin)+n*(g.xmax-
g.xmin);r=.5*(g.ymax+g.ymin)+r*(g.ymax-g.ymin);n=(n-e)*l+31;r=(r-f)*l+31;return[h,n/(m+62)-.5,-(r/b-.5)]};t.getSDFSymbol=function(l){l=l.markerGraphics;if(!l||1!==l.length)return null;l=l[0];if(!l)return null;l=l.symbol;return!l||"CIMPolygonSymbol"!==l.type&&"CIMLineSymbol"!==l.type?null:l};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(t){function u(B){B=B.toLowerCase().split(" ").join("-");switch(B){case "serif":return"noto-serif";
case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return B}}t.getFontDecorationTop=function(B){switch(B){case "underline":return-26;case "line-through":return-18}return NaN};t.getFontFamily=u;t.getFullyQualifiedFontName=function(B){a:{if(B.weight)switch(B.weight.toLowerCase()){case "bold":case "bolder":var D="-bold";break a}D=""}a:{if(B.style)switch(B.style.toLowerCase()){case "italic":case "oblique":var z=
"-italic";break a}z=""}D+=z;return u(B.family)+(0<D.length?D:"-regular")};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),function(t,u,B,D,z,y,l){function g(a){const c=new Set;for(const e of a)c.add(Math.floor(e/256));return c}function d(a,c,e){a.has(c)||a.set(c,
e().then(()=>{a.delete(c)}).catch(f=>{a.delete(c);B.throwIfNotAbortError(f)}));return a.get(c)}return function(){function a(e,f,k){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=e;this.height=f;this._glyphSource=k;this._binPack=new z(e-4,f-4);this._glyphData.push(new Uint8Array(e*f));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var c=a.prototype;c.dispose=
function(){this._binPack=null;for(const e of this._textures)e&&e.dispose();this._textures.length=0;this._glyphData.length=0};c._initDecorationGlyph=function(){var e=[117,149,181,207,207,181,149,117];const f=[];for(let k=0;k<e.length;k++){const p=e[k];for(let m=0;11>m;m++)f.push(p)}e={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(f)};this._recordGlyph(e)};c.getGlyphItems=function(){var e=t._asyncToGenerator(function*(f,k,p){const m=this._getGlyphCache(f);yield this._fetchRanges(f,
k,p);return k.map(b=>this._getMosaicItem(m,f,b))});return function(f,k,p){return e.apply(this,arguments)}}();c.bind=function(e,f,k,p){const m=this._getTexture(e,k);m.setSamplingMode(f);this._dirties[k]&&(m.setData(this._glyphData[k]),this._dirties[k]=!1);e.bindTexture(m,p)};c._getGlyphCache=function(e){this._glyphCache[e]||(this._glyphCache[e]={});return this._glyphCache[e]};c._getTexture=function(e,f){this._textures[f]||(this._textures[f]=new l.Texture(e,{pixelFormat:y.PixelFormat.ALPHA,dataType:y.PixelType.UNSIGNED_BYTE,
width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[f]};c._invalidate=function(){this._dirties[this._currentPage]=!0};c._fetchRanges=function(){var e=t._asyncToGenerator(function*(f,k,p){const m=[];g(k).forEach(b=>{m.push(this._fetchRange(f,b,p))});yield Promise.all(m)});return function(f,k,p){return e.apply(this,arguments)}}();c._fetchRange=function(){var e=t._asyncToGenerator(function*(f,k,p){return 256<k?null:d(this._rangePromises,f+k,()=>this._glyphSource.getRange(f,
k,p))});return function(f,k,p){return e.apply(this,arguments)}}();c._getMosaicItem=function(e,f,k){if(!e[k]){f=this._glyphSource.getGlyph(f,k);if(!f||!f.metrics)return{rect:new D(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:k,sdf:!0};const p=this._recordGlyph(f);e[k]={rect:p,page:this._currentPage,metrics:f.metrics,code:k,sdf:!0};this._invalidate()}return e[k]};c._recordGlyph=function(e){var f=e.metrics;if(0===f.width)f=new D(0,0,0,0);else{const k=f.width+6,p=f.height+6;
f=this._binPack.allocate(k,p);f.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new z(this.width-4,this.height-4),f=this._binPack.allocate(k,p));const m=this._glyphData[this._currentPage];e=e.bitmap;let b,h;if(e)for(let n=0;n<p;n++){b=k*n;h=this.width*(f.y+n)+f.x;for(let r=
0;r<k;r++)m[h+r]=e[b+r]}u("esri-glyph-debug")&&this._showDebugPage(m)}return f};c._showDebugPage=function(e){const f=document.createElement("canvas"),k=f.getContext("2d"),p=new ImageData(this.width,this.height),m=p.data;f.width=this.width;f.height=this.height;f.style.border="1px solid black";for(let b=0;b<e.length;++b)m[4*b]=e[b],m[4*b+1]=0,m[4*b+2]=0,m[4*b+3]=255;k.putImageData(p,0,0);document.body.appendChild(f)};return a}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./Rect"],function(t,u){return function(){function B(z,y){this._height=this._width=0;this._free=[];this._width=z;this._height=y;this._free.push(new u(0,0,z,y))}var D=B.prototype;D.allocate=function(z,y){if(z>this._width||y>this._height)return new u;let l=null,g=-1;for(let d=0;d<this._free.length;++d){const a=this._free[d];z<=a.width&&y<=a.height&&(null===l||a.y<=l.y&&a.x<=l.x)&&(l=a,g=d)}if(null===l)return new u;this._free.splice(g,1);l.width<l.height?(l.width>z&&this._free.push(new u(l.x+z,l.y,l.width-
z,y)),l.height>y&&this._free.push(new u(l.x,l.y+y,l.width,l.height-y))):(l.width>z&&this._free.push(new u(l.x+z,l.y,l.width-z,l.height)),l.height>y&&this._free.push(new u(l.x,l.y+y,z,l.height-y)));return new u(l.x,l.y,z,y)};D.release=function(z){for(let y=0;y<this._free.length;++y){const l=this._free[y];if(l.y===z.y&&l.height===z.height&&l.x+l.width===z.x)l.width+=z.width;else if(l.x===z.x&&l.width===z.width&&l.y+l.height===z.y)l.height+=z.height;else if(z.y===l.y&&z.height===l.height&&z.x+z.width===
l.x)l.x=z.x,l.width+=z.width;else if(z.x===l.x&&z.width===l.width&&z.y+z.height===l.y)l.y=z.y,l.height+=z.height;else continue;this._free.splice(y,1);this.release(z)}this._free.push(z)};t._createClass(B,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return B}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request","../../../../core/pbf"],function(t,u){let B=function(){function z(l){this._metrics=[];for(this._bitmaps=
[];l.next();)switch(l.tag()){case 1:{const g=l.getMessage();for(;g.next();)switch(g.tag()){case 3:{const d=g.getMessage();let a,c,e,f,k,p,m;for(;d.next();)switch(d.tag()){case 1:a=d.getUInt32();break;case 2:c=d.getBytes();break;case 3:e=d.getUInt32();break;case 4:f=d.getUInt32();break;case 5:k=d.getSInt32();break;case 6:p=d.getSInt32();break;case 7:m=d.getUInt32();break;default:d.skip()}d.release();a&&(this._metrics[a]={width:e,height:f,left:k,top:p,advance:m},this._bitmaps[a]=c);break}default:g.skip()}g.release();
break}default:l.skip()}}var y=z.prototype;y.getMetrics=function(l){return this._metrics[l]};y.getBitmap=function(l){return this._bitmaps[l]};return z}(),D=function(){function z(){this._ranges=[]}var y=z.prototype;y.getRange=function(l){return this._ranges[l]};y.addRange=function(l,g){this._ranges[l]=g};return z}();return function(){function z(l){this._glyphInfo={};this._baseURL=l}var y=z.prototype;y.getRange=function(l,g,d){const a=this._getFontStack(l);if(a.getRange(g))return Promise.resolve();const c=
256*g,e=c+255;l=this._baseURL.replace("{fontstack}",l).replace("{range}",c+"-"+e);return t(l,{responseType:"array-buffer",...d}).then(f=>{a.addRange(g,new B(new u(new Uint8Array(f.data),new DataView(f.data))))})};y.getGlyph=function(l,g){if(l=this._getFontStack(l)){var d=Math.floor(g/256);if(!(256<d)&&(l=l.getRange(d)))return{metrics:l.getMetrics(g),bitmap:l.getBitmap(g)}}};y._getFontStack=function(l){let g=this._glyphInfo[l];g||(g=this._glyphInfo[l]=new D);return g};return z}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/floatRGBA",
"../../../../core/promiseUtils"],function(t,u){return function(){function B(z){this.size=z;const y=document.createElement("canvas");y.width=y.height=z;this._context=y.getContext("2d");this._gridOuter=new Float64Array(z*z);this._gridInner=new Float64Array(z*z);this._f=new Float64Array(z);this._d=new Float64Array(z);this._z=new Float64Array(z+1);this._v=new Int16Array(z)}var D=B.prototype;D.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&
(document.body.removeChild(this._svg),this._svg=null)};D.draw=function(z,y,l=31){this._initSVG();const g=this.createSVGString(z);return new Promise((d,a)=>{const c=new Image;c.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(g);c.onload=()=>{c.onload=null;this._context.clearRect(0,0,this.size,this.size);this._context.drawImage(c,0,0,this.size,this.size);var f=this._context.getImageData(0,0,this.size,this.size);const k=new Uint8Array(this.size*this.size*4);for(let p=0;p<this.size*this.size;p++){const m=
f.data[4*p+3]/255;this._gridOuter[p]=1===m?0:0===m?1E20:Math.max(0,.5-m)**2;this._gridInner[p]=1===m?1E20:0===m?0:Math.max(0,m-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(f=0;f<this.size*this.size;f++)t.packFloatRGBA(.5-(this._gridOuter[f]-this._gridInner[f])/(2*l),k,4*f);d(k)};const e=y&&y.signal;if(e)u.onAbort(e,()=>a(u.createAbortError()))})};D._initSVG=function(){if(!this._svg){const z=document.createElementNS("http://www.w3.org/2000/svg",
"svg");z.setAttribute("style","position: absolute;");z.setAttribute("width","0");z.setAttribute("height","0");z.setAttribute("aria-hidden","true");z.setAttribute("role","presentation");document.body.appendChild(z);this._svg=z}};D.createSVGString=function(z){this._initSVG();const y=document.createElementNS("http://www.w3.org/2000/svg","path");y.setAttribute("d",z);this._svg.appendChild(y);z=y.getBBox();var l=z.width/z.height;const g=this.size/2;let d,a,c;1<l?(a=d=g/z.width,c=this.size/4,l=g-1/l*g/
2):(d=a=g/z.height,c=g-g*l/2,l=this.size/4);y.setAttribute("style",`transform: matrix(${d}, 0, 0, ${a}, ${-z.x*d+c}, ${-z.y*a+l})`);z=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${this._svg.innerHTML}</svg>`;this._svg.removeChild(y);return z};D._edt=function(z,y,l){const g=this._f,d=this._d,a=this._v,c=this._z;for(var e=0;e<y;e++){for(var f=0;f<l;f++)g[f]=z[f*y+e];this._edt1d(g,d,a,c,l);for(f=0;f<l;f++)z[f*y+e]=d[f]}for(e=0;e<l;e++){for(f=
0;f<y;f++)g[f]=z[e*y+f];this._edt1d(g,d,a,c,y);for(f=0;f<y;f++)z[e*y+f]=Math.sqrt(d[f])}};D._edt1d=function(z,y,l,g,d){l[0]=0;g[0]=-1E20;g[1]=1E20;for(let a=1,c=0;a<d;a++){let e=(z[a]+a*a-(z[l[c]]+l[c]*l[c]))/(2*a-2*l[c]);for(;e<=g[c];)c--,e=(z[a]+a*a-(z[l[c]]+l[c]*l[c]))/(2*a-2*l[c]);c++;l[c]=a;g[c]=e;g[c+1]=1E20}for(let a=0,c=0;a<d;a++){for(;g[c+1]<a;)c++;y[a]=(a-l[c])*(a-l[c])+z[l[c]]}};return B}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/maybe ./definitions ./GeometryUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),
function(t,u,B,D,z,y,l,g,d){function a(c){return c&&"static"===c.type}return function(){function c(f,k,p,m=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=k||0>=p)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=k;this._pageHeight=p;this._requestRender=f;0<m&&(this._maxItemSize=m);this.pixelRatio=window.devicePixelRatio||
1;this._binPack=new l(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var e=c.prototype;e.getWidth=function(f){return f>=this._mosaicPages.length?-1:this._mosaicPages[f].size[0]};e.getHeight=function(f){return f>=this._mosaicPages.length?-1:this._mosaicPages[f].size[1]};e.getPageTexture=function(f){return f<this._mosaicPages.length?
this._mosaicPages[f].texture:null};e.has=function(f){return this._mosaicRects.has(f)};e.getSpriteItem=function(f){return this._mosaicRects.get(f)};e.addSpriteItem=function(f,k,p,m,b,h){if(this._mosaicRects.has(f))return this._mosaicRects.get(f);let n,r,x;a(p)?[n,r,x]=this._allocateImage(k[0],k[1]):(n=new y(0,0,k[0],k[1]),r=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:p,size:k,dirty:!0,texture:void 0}));if(0>=n.width||0>=n.height)return null;h={rect:n,width:k[0],height:k[1],sdf:b,simplePattern:h,
pixelRatio:1,page:r};this._mosaicRects.set(f,h);a(p)&&this._copy({rect:n,spriteSize:k,spriteData:p.data,page:r,pageSize:x,repeat:m,sdf:b});return h};e.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};e.processNextItem=function(){const f=this._spriteCopyQueue.pop();f&&this._copy(f)};e.getSpriteItems=function(f){const k={};for(const p of f)k[p]=this.getSpriteItem(p);return k};e.getMosaicItemPosition=function(f){const k=(f=this.getSpriteItem(f))&&f.rect;if(!k)return null;k.width=
f.width;k.height=f.height;const p=D.SPRITE_PADDING,m=this._mosaicPages[f.page];return{size:[f.width,f.height],tl:[(k.x+p)/m[0],(k.y+p)/m[1]],br:[(k.x+p+f.width)/m[0],(k.y+p+f.height)/m[1]],page:f.page}};e.bind=function(f,k,p=0,m=0){p=this._mosaicPages[p];var b=p.mosaicsData,h=p.texture;h||(h=p.size,h=a(b)?new d.Texture(f,{pixelFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,width:h[0],height:h[1]},new Uint8Array(b.data.buffer)):new d.Texture(f,{pixelFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,
samplingMode:g.TextureSamplingMode.LINEAR,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE,width:h[0],height:h[1]},null),p.texture=h);h.setSamplingMode(k);a(b)?(f.bindTexture(h,m),p.dirty&&(h.setData(new Uint8Array(b.data.buffer)),h.generateMipmap())):(k=b.data,b=k.bindFrame(f,h,m),B.isSome(this._requestRender)&&b&&0<k.frameCount&&this._requestRender.requestRender(),k.bindFrame(f,h,m));p.dirty=!1};c._copyBits=function(f,k,p,m,b,h,n,r,x,q,A){let E=m*k+p;n=r*h+n;if(A)for(n-=h,A=-1;A<=q;A++,E=((A+q)%q+m)*k+
p,n+=h)for(r=-1;r<=x;r++)b[n+r]=f[E+(r+x)%x];else for(p=0;p<q;p++){for(m=0;m<x;m++)b[n+m]=f[E+m];E+=k;n+=h}};e._copy=function(f){if(!(f.page>=this._mosaicPages.length)){var k=this._mosaicPages[f.page],p=k.mosaicsData;if(!a(k.mosaicsData))throw new u("mapview-invalid-resource","unsuitable data type!");var m=f.spriteData;(p=p.data)&&m||console.error("Source or target images are uninitialized!");c._copyBits(m,f.spriteSize[0],0,0,p,f.pageSize[0],f.rect.x+D.SPRITE_PADDING,f.rect.y+D.SPRITE_PADDING,f.spriteSize[0],
f.spriteSize[1],f.repeat);k.dirty=!0}};e._allocateImage=function(f,k){f+=2*D.SPRITE_PADDING;k+=2*D.SPRITE_PADDING;var p=Math.max(f,k);if(this._maxItemSize&&this._maxItemSize<p){p=2**Math.ceil(z.log2(f));const m=2**Math.ceil(z.log2(k));f=new y(0,0,f,k);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(p*m)},size:[p,m],dirty:!0,texture:void 0});return[f,this._mosaicPages.length-1,[p,m]]}p=this._binPack.allocate(f,k);return 0>=p.width?(p=this._mosaicPages[this._currentPage],!p.dirty&&
a(p.mosaicsData)&&(p.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new l(this._pageWidth,this._pageHeight),this._allocateImage(f,k)):[p,this._currentPage,[this._pageWidth,this._pageHeight]]};e.dispose=function(){this._binPack=null;for(const k of this._mosaicPages){var f=k.texture;f&&f.dispose();
f=k.mosaicsData;a(f)||f.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};t._createClass(c,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);return c}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../../../../../core/promiseUtils"],function(t,u,B,D){function z(n,r=0,x=n.length-r){let q=-1;for(let A=r,E=r+x;A<E;A++)q=q>>>8^f[(q^n[A])&255];return q^-1}function y(n){const r=
n.constructor===Uint8Array?n:new Uint8Array(n);return b.some((x,q)=>x!==r[q])?!1:!0}function l(n,r){const x=new Uint8Array(r);if(b.some((H,L)=>H!==x[L]))return p;let q=!1;g(x,H=>!(q="acTL"===H));if(!q)return m;const A=[],E=[];let F=null,w=null,v=0;g(x,(H,L,O,N)=>{const K=new DataView(L.buffer);switch(H){case "IHDR":F=L.subarray(O+8,O+8+N);n.width=K.getUint32(O+8);n.height=K.getUint32(O+12);break;case "acTL":n.numPlays=K.getUint32(O+8+4);break;case "fcTL":w&&(n.frames.push(w),v++);w=new h;w.width=
K.getUint32(O+8+4);w.height=K.getUint32(O+8+8);w.left=K.getUint32(O+8+12);w.top=K.getUint32(O+8+16);H=K.getUint16(O+8+20);L=K.getUint16(O+8+22);0===L&&(L=100);w.delay=1E3*H/L;10>=w.delay&&(w.delay=100);n.playTime+=w.delay;w.disposeOp=K.getUint8(O+8+24);w.blendOp=K.getUint8(O+8+25);w.dataParts=[];0===v&&2===w.disposeOp&&(w.disposeOp=1);break;case "fdAT":w&&w.dataParts.push(L.subarray(O+8+4,O+8+N));break;case "IDAT":w&&w.dataParts.push(L.subarray(O+8,O+8+N));break;case "IEND":E.push(a(L,O,12+N));break;
default:A.push(a(L,O,12+N))}});if(0===n.frames.length)return m;n.frameCount=n.frames.length;const C=new Blob(A),G=new Blob(E);n.frames.forEach(H=>{let L=[];L.push(b);F.set(e(H.width),0);F.set(e(H.height),4);L.push(c("IHDR",F));L.push(C);H.dataParts.forEach(O=>L.push(c("IDAT",O)));L.push(G);H.data=new Blob(L,{type:"image/png"});delete H.dataParts;L=null});return n}function g(n,r){const x=new DataView(n.buffer);let q=8;let A,E;do{A=x.getUint32(q);var F=q+4;F=Array.prototype.slice.call(n.subarray(F,
F+4));F=String.fromCharCode.apply(String,F);E=r(F,n,q,A);q+=12+A}while(!1!==E&&"IEND"!==F&&q<n.length)}function d(n){const r=new Uint8Array(n.length);for(let x=0;x<n.length;x++)r[x]=n.charCodeAt(x);return r}function a(n,r,x){const q=new Uint8Array(x);q.set(n.subarray(r,r+x));return q}function c(n,r){const x=n.length+r.length,q=new Uint8Array(x+8),A=new DataView(q.buffer);A.setUint32(0,r.length);q.set(d(n),4);q.set(r,8);n=z(q,4,x);A.setUint32(x+4,n);return q}function e(n){return new Uint8Array([n>>>
24&255,n>>>16&255,n>>>8&255,n&255])}const f=new Uint32Array(256);for(var k=0;256>k;k++){let n=k;for(let r=0;8>r;r++)n=0!==(n&1)?3988292384^n>>>1:n>>>1;f[k]=n}const p=new B("Not a PNG"),m=new B("Not an animated PNG"),b=new Uint8Array([137,80,78,71,13,10,26,10]);k=function(){function n(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}n.create=function(){var x=u._asyncToGenerator(function*(q,
A){const E=new n;try{yield E._load(q,A)}catch(F){if(!D.isAbortError(F))return new B("invalid-resource",`Could not load PNG: ${F.message}`)}return E});return function(q,A){return x.apply(this,arguments)}}();var r=n.prototype;r.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};r.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};r.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};r.bindFrame=function(x,q,A){x.bindTexture(q,
A);x=this.frameChanged();if(!x)return!1;A=this.currentFrame;const E=A.frameData,F=q.descriptor;(A.left||A.top||A.width!==F.width||A.height!==F.height)&&q.setData(null);q.updateData(0,A.left,A.top,A.width,A.height,E);this.updateUsedFrame();return x};r.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};r.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};r._load=function(){var x=u._asyncToGenerator(function*(q,A){try{const E=l(this,q);if(E!==this)return E;
this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;yield Promise.all(this.frames.map(F=>F.createImage(this._resizeCanvas)))}catch(E){if(!D.isAbortError(E))return new B("invalid-resource","Could not parse PNG")}this.play()});return function(q,A){return x.apply(this,arguments)}}();r._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=
this.frames.length-1);var x=this.currentFrameNumber;--x;0>x&&(x=this.frames.length-1);x=-this.frames[x].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,x=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;var q=this.frames[this.currentFrameNumber];this.currentFrame={frameData:q.imageData,top:q.top,left:q.left,width:q.width,height:q.height};this.timerID=window.setTimeout(()=>this._play(),x)}};return n}();let h=function(){function n(){this.blendOp=
this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}n.prototype.createImage=function(){var r=u._asyncToGenerator(function*(x){if(null===this.imageData)return new Promise((q,A)=>{const E=URL.createObjectURL(this.data),F=document.createElement("img");F.onload=()=>{URL.revokeObjectURL(E);{x.width=F.width;x.height=F.height;var w=x.getContext("2d");w.drawImage(F,0,0,F.width,F.height);w=w.getImageData(0,0,F.width,F.height);w=new Uint8Array(w.data);let v;for(let C=
0;C<w.length;C+=4)v=w[C+3]/255,w[C]*=v,w[C+1]*=v,w[C+2]*=v;w=new ImageData(new Uint8ClampedArray(w.buffer),F.width,F.height)}this.imageData=w;q()};F.onerror=()=>{URL.revokeObjectURL(E);this.imageData=null;A(Error("Image creation error"))};F.src=E})});return function(x){return r.apply(this,arguments)}}();return n}();t.default=k;t.getPNGSize=function(n){n=new Uint8Array(n);let r,x;g(n,(q,A,E)=>{A=new DataView(A.buffer);"IHDR"===q&&(r=A.getUint32(E+8),x=A.getUint32(E+12))});return[r,x]};t.isAnimatedPNG=
function(n){n=new Uint8Array(n);if(!y(n))return!1;let r=!1;g(n,x=>!(r="acTL"===x));return r};t.isPNG=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../../../../../core/promiseUtils"],function(t,u,B,D){function z(g){if(!g||0===g.byteLength)return!1;g=g.constructor===Uint8Array?g:new Uint8Array(g);return 71===g[0]&&73===g[1]&&70===g[2]&&
56===g[3]}let y=function(){function g(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}g.create=function(){var a=u._asyncToGenerator(function*(c,e){const f=new g;try{yield f._load(c,e)}catch(k){if(!D.isAbortError(k))return new B("invalid-resource",
`Could not load PNG: ${k.message}`)}return f});return function(c,e){return a.apply(this,arguments)}}();var d=g.prototype;d.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};d.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};d.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};d.bindFrame=function(a,c,e){a.bindTexture(c,e);if(a=this.frameChanged())e=this.currentFrame,c.updateData(0,0,0,e.width,e.height,e.frameData),this.updateUsedFrame();
return a};d.seekFrame=function(a){clearTimeout(this.timerID);this.currentFrameNumber=a%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};d.seek=function(a){clearTimeout(this.timerID);0>a&&(a=0);a=1E3*a%this.length;let c=0;for(;a>this.frames[c].time+this.frames[c].delay&&c<this.frames.length;)c+=1;this.currentFrameNumber=c;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};d.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};
d.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};d._load=function(){var a=u._asyncToGenerator(function*(c,e){try{this.loading=!0,yield this._parse(c,e),this.loading=!1,this.play()}catch(f){if(!D.isAbortError(f))return new B("invalid-resource","Could not parse gif!")}});return function(c,e){return a.apply(this,arguments)}}();d._parse=function(a,c){const e=new l(a);e.pos+=6;this.width=e.data[e.pos++]+(e.data[e.pos++]<<8);this.height=e.data[e.pos++]+(e.data[e.pos++]<<8);a=e.data[e.pos++];
this.globalColourCount=1<<(a&7)+1;e.pos++;e.pos++;a&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,e));return new Promise((f,k)=>{setTimeout(()=>this._parseBlock(e,f,k,c),0)})};d._parseBlock=function(){var a=u._asyncToGenerator(function*(c,e,f,k){if(k&&k.signal&&D.isAborted(k.signal))f(D.createAbortError());else{var p=c.data[c.pos++];if(44===p){if(this._parseImg(c),this.firstFrameOnly){this._finishedLoading();e();return}}else{if(59===p){this._finishedLoading();e();return}this._parseExt(c)}if("function"===
typeof this.onprogress)this.onprogress({bytesRead:c.pos,totalBytes:c.data.length,frame:this.frames.length});setTimeout(()=>this._parseBlock(c,e,f,k),0)}});return function(c,e,f,k){return a.apply(this,arguments)}}();d._parseColourTable=function(a,c){const e=[];for(let f=0;f<a;f++)e.push([c.data[c.pos++],c.data[c.pos++],c.data[c.pos++]]);return e};d._parseImg=function(a){const c=k=>{const p=this.pixelBufSize/k;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),
this.interlacedBufSize=this.pixelBufSize);let m=0;for(let b=0;4>b;b++)for(let h=this.interlaceOffsets[b];h<p;h+=this.interlaceSteps[b])this.deinterlaceBuf.set(this.pixelBuf.subarray(m,m+k),h*k),m+=k},e={};this.frames.push(e);e.disposalMethod=this.disposalMethod;e.time=this.length;e.delay=10*this.delayTime;this.length+=e.delay;e.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;e.leftPos=a.data[a.pos++]+(a.data[a.pos++]<<8);e.topPos=a.data[a.pos++]+(a.data[a.pos++]<<8);e.width=
a.data[a.pos++]+(a.data[a.pos++]<<8);e.height=a.data[a.pos++]+(a.data[a.pos++]<<8);const f=a.data[a.pos++];e.localColourTableFlag=f&128?!0:!1;e.localColourTableFlag&&(e.localColourTable=this._parseColourTable(1<<(f&7)+1,a));this.pixelBufSize!==e.width*e.height&&(this.pixelBuf=new Uint8Array(e.width*e.height),this.pixelBufSize=e.width*e.height);this._lzwDecode(a.data[a.pos++],a.readSubBlocksB());f&64?(e.interlaced=!0,c(e.width)):e.interlaced=!1;this._processFrame(e)};d._lzwDecode=function(a,c){let e,
f,k,p,m;let b,h;k=f=0;let n=[];const r=1<<a,x=r+1;p=a+1;for(h=!1;!h;){var q=m;for(e=m=0;e<p;e++)c[k>>3]&1<<(k&7)&&(m|=1<<e),k++;if(m===r){n=[];p=a+1;for(e=0;e<r;e++)n[e]=[e];n[r]=[];n[x]=null}else{if(m===x){h=!0;break}m>=n.length?n.push(n[q].concat(n[q][0])):q!==r&&n.push(n[q].concat(n[m][0]));q=n[m];b=q.length;for(e=0;e<b;e++)this.pixelBuf[f++]=q[e];n.length===1<<p&&12>p&&p++}}};d._processFrame=function(a){a.image=document.createElement("canvas");a.image.width=this.width;a.image.height=this.height;
a.ctx=a.image.getContext("2d");const c=a.localColourTableFlag?a.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=a);const e=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;e||a.ctx.drawImage(this.lastFrame.image,0,0,this.width,this.height);const f=a.ctx.getImageData(a.leftPos,a.topPos,a.width,a.height),k=a.transparencyIndex,p=f.data,m=a.interlaced?this.deinterlaceBuf:this.pixelBuf,b=m.length;let h=0,n,r;for(let x=0;x<b;x++)n=m[x],r=c[n],k!==
n?(p[h++]=r[0],p[h++]=r[1],p[h++]=r[2],p[h++]=255):(e&&(p[h+3]=0),h+=4);a.ctx.putImageData(f,a.leftPos,a.topPos);this.lastFrame=a};d._parseExt=function(a){const c=a.data[a.pos++];249===c?this._parseGCExt(a):254===c?this.comment+=a.readSubBlocks():255===c?this._parseAppExt(a):(1===c&&(a.pos+=13),a.readSubBlocks())};d._parseAppExt=function(a){a.pos+=1;"NETSCAPE"===a.getString(8)?a.pos+=8:(a.pos+=3,a.readSubBlocks())};d._parseGCExt=function(a){a.pos++;const c=a.data[a.pos++];this.disposalMethod=(c&28)>>
2;this.transparencyGiven=c&1?!0:!1;this.delayTime=a.data[a.pos++]+(a.data[a.pos++]<<8);this.transparencyIndex=a.data[a.pos++];a.pos++};d._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);
this.playOnLoad&&this.play()};d._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var a=this.currentFrameNumber;--a;0>a&&(a=this.frames.length-1);a=-this.frames[a].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,a=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;this._setCurrentFrame(this.currentFrameNumber);this.timerID=
window.setTimeout(()=>this._play(),a)}};d._setCurrentFrame=function(a){this.currentFrame={frameData:this.frames[a].image,top:0,left:0,width:this.width,height:this.height}};return g}(),l=function(){function g(a){this.pos=0;this.data=new Uint8ClampedArray(a);this.len=this.data.length}var d=g.prototype;d.getString=function(a){let c="";for(;a--;)c+=String.fromCharCode(this.data[this.pos++]);return c};d.readSubBlocks=function(){let a,c,e="";do for(c=a=this.data[this.pos++];c--;)e+=String.fromCharCode(this.data[this.pos++]);
while(0!==a&&this.pos<this.len);return e};d.readSubBlocksB=function(){let a,c;const e=[];do for(c=a=this.data[this.pos++];c--;)e.push(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return e};return g}();t.default=y;t.getGIFSize=function(g){var d=new Uint8ClampedArray(g);let a=6;g=d[a++]+(d[a++]<<8);d=d[a++]+(d[a++]<<8);return[g,d]};t.isAnimatedGIF=function(g){if(!g||0===g.byteLength)return!1;g=new Uint8Array(g);if(!z(g))return!1;let d=0;for(let a=0,c=g.length-9;a<c;++a)if(0===g[a]&&33===g[a+
1]&&249===g[a+2]&&4===g[a+3]&&0===g[a+8]&&(44===g[a+9]||33===g[a+9])&&(d++,1<d))return!0;return!1};t.isGIF=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(t,u){t.ok=function(B,D){return B&&"name"in B?(D&&D.error(new u(B.name,B.message,B.details)),!1):!0};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(t){t.keyFromSymbol=
function(u){switch(u.type){case "esriSMS":return`${u.style}.${u.path}`;case "esriSLS":return`${u.style}.${u.cap}`;case "esriSFS":return`${u.style}`;case "esriPFS":case "esriPMS":return u.imageData?`${u.imageData}${u.width}${u.height}`:`${u.url}${u.width}${u.height}`;default:return"mosaicHash"in u?u.mosaicHash:JSON.stringify(u)}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),
function(t,u,B,D,z,y){y=function(l){function g(){var a=l.apply(this,arguments)||this;a.defines=[];a._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",0]])};return a}u._inheritsLoose(g,l);var d=g.prototype;d.dispose=function(){this._quad&&this._quad.dispose()};d.bind=function(){};d.unbind=function(){};d.draw=function(a,c){if(c.size){var {context:e,renderingOptions:f}=a;this._quad||(this._quad=new z(e,[0,0,1,0,0,1,1,1]));var k=e.getBoundFramebufferObject(),{x:p,y:m,
width:b,height:h}=e.getViewport();c.bindTextures(e);var n=c.getBlock(D.ATTRIBUTE_DATA_ANIMATION);if(!B.isNone(n)){var r=n.getFBO(e);n=n.getFBO(e,1);e.setViewport(0,0,c.size,c.size);this._computeDelta(a,n,f.labelsAnimationTime);this._updateAnimationState(a,n,r);e.bindFramebuffer(k);e.setViewport(p,m,b,h)}}};d._computeDelta=function(a,c,e){const {context:f,painter:k,displayLevel:p}=a,m=k.materialManager.getProgram(a,this._desc,["delta"]);f.bindFramebuffer(c);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);
f.useProgram(m);m.setUniform1i("u_maskTexture",D.TEXTURE_BINDING_ATTRIBUTE_DATA_0);m.setUniform1i("u_sourceTexture",D.TEXTURE_BINDING_ATTRIBUTE_DATA_1);m.setUniform1f("u_timeDelta",a.deltaTime);m.setUniform1f("u_animationTime",e);m.setUniform1f("u_zoomLevel",Math.round(10*p));this._quad.draw()};d._updateAnimationState=function(a,c,e){const {context:f,painter:k}=a;a=k.materialManager.getProgram(a,this._desc,["update"]);f.bindTexture(c.colorTexture,1);f.useProgram(a);a.setUniform1i("u_sourceTexture",
1);f.bindFramebuffer(e);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);this._quad.draw()};return g}(y.Effect);t.AnimationEffect=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],function(t){let u=function(){function B(){this.name=this.constructor.name}B.prototype.createOptions=function(D,z){return null};return B}();t.Effect=u;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ../shaders/BlendPrograms ../../../../webgl/enums ../../../../webgl/Texture".split(" "),
function(t,u,B,D,z,y,l,g,d){const a=B.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");B=function(){function c(){this._size=[0,0]}var e=c.prototype;e.dispose=function(f){this._backBufferTexture=D.disposeMaybe(this._backBufferTexture);this._quad=D.disposeMaybe(this._quad)};e.draw=function(f,k,p,m,b){const {context:h,drawPhase:n}=f;this._setupShader(h);m&&"normal"!==m&&n!==z.WGLDrawPhase.LABEL?this._drawBlended(f,k,p,m,b):(f=l.createProgramTemplate("normal"),(f=h.programCache.acquire(f.shaders.vertexShader,
f.shaders.fragmentShader,f.attributes))?(h.useProgram(f),k.setSamplingMode(p),h.bindTexture(k,0),f.setUniform1i("u_layerTexture",0),f.setUniform1f("u_opacity",b),h.setBlendingEnabled(!0),h.setBlendFunction(g.BlendFactor.ONE,g.BlendFactor.ONE_MINUS_SRC_ALPHA),k=this._quad,k.draw(),k.unbind(),f.dispose()):a.error(new u("mapview-BlendEffect",'Error creating shader program for blend mode "normal"')))};e._drawBlended=function(f,k,p,m,b){const {context:h,state:n,pixelRatio:r,inFadeTransition:x}=f;var {size:q}=
n,A=h.getBoundFramebufferObject();let E;D.isSome(A)?(q=A.descriptor,E=q.width,q=q.height):(E=Math.round(r*q[0]),q=Math.round(r*q[1]));this._createOrResizeTexture(f,E,q);f=this._backBufferTexture;A.copyToTexture(0,0,E,q,0,0,f);h.setStencilTestEnabled(!1);h.setStencilWriteMask(0);h.setBlendingEnabled(!0);h.setDepthTestEnabled(!1);h.setDepthWriteEnabled(!1);A=l.createProgramTemplate(m);(A=h.programCache.acquire(A.shaders.vertexShader,A.shaders.fragmentShader,A.attributes))?(h.useProgram(A),f.setSamplingMode(p),
h.bindTexture(f,0),A.setUniform1i("u_backbufferTexture",0),k.setSamplingMode(p),h.bindTexture(k,1),A.setUniform1i("u_layerTexture",1),A.setUniform1f("u_opacity",b),A.setUniform1f("u_inFadeOpacity",x?1:0),h.setBlendFunction(g.BlendFactor.ONE,g.BlendFactor.ZERO),k=this._quad,k.draw(),k.unbind(),A.dispose(),h.setBlendFunction(g.BlendFactor.ONE,g.BlendFactor.ONE_MINUS_SRC_ALPHA)):a.error(new u("mapview-BlendEffect",`Error creating shader program for blend mode ${m}`))};e._setupShader=function(f){this._quad||
(this._quad=new y(f,[-1,-1,1,-1,-1,1,1,1]))};e._createOrResizeTexture=function(f,k,p){({context:f}=f);if(null===this._backBufferTexture||k!==this._size[0]||p!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(k,p):this._backBufferTexture=new d.Texture(f,{target:g.TextureType.TEXTURE_2D,pixelFormat:g.PixelFormat.RGBA,internalFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:g.TextureSamplingMode.LINEAR,flipped:!1,
width:k,height:p}),this._size[0]=k,this._size[1]=p};return c}();t.BlendEffect=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],function(t,u){t.createProgramTemplate=function(B){return{attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:{vertexShader:`#define ${B.replace("-","_").toUpperCase()}\n`+u.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${B.replace("-","_").toUpperCase()}\n`+
u.resolveIncludes("blend/blend.frag")}}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect","../../../../webgl/enums"],function(t,u,B,D){B=function(z){function y(g){var d=z.call(this)||this;d.name=d.constructor.name;d.defines=[g];return d}u._inheritsLoose(y,z);var l=y.prototype;l.dispose=function(){};l.bind=function({context:g,painter:d}){this._prev=g.getBoundFramebufferObject();
const {width:a,height:c}=g.getViewport();d=d.getFbos(a,c).effect0;g.bindFramebuffer(d);g.setColorMask(!0,!0,!0,!0);g.setClearColor(0,0,0,0);g.clear(g.gl.COLOR_BUFFER_BIT)};l.unbind=function(){};l.draw=function(g,d){const {context:a,painter:c}=g;d=c.getPostProcessingEffects(d);const e=a.getBoundFramebufferObject();for(const {postProcessingEffect:f,effect:k}of d)f.draw(g,e,k);a.bindFramebuffer(this._prev);a.setStencilTestEnabled(!1);c.blitTexture(a,e.colorTexture,D.TextureSamplingMode.NEAREST);a.setStencilTestEnabled(!0)};
return y}(B.Effect);t.FeatureEffect=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces ../../../../webgl/enums".split(" "),function(t,u,B,D,z,y,l,g){return function(d){function a(){var e=d.apply(this,arguments)||this;e.defines=["highlight"];
e._hlRenderer=new y;e._hlGradient=new z;e._width=void 0;e._height=void 0;e._hlSurfaces=new l;e._adjustedWidth=void 0;e._adjustedHeight=void 0;e._blitRenderer=new B.BitBlitRenderer;return e}t._inheritsLoose(a,d);var c=a.prototype;c.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};c.bind=function(e){const {context:f,painter:k}=e,{width:p,height:m}=f.getViewport(),b=k.getFbos(p,
m).effect0;this.setup(e,p,m);f.bindFramebuffer(b);f.setColorMask(!0,!0,!0,!0);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT)};c.unbind=function(){};c.setup=function({context:e},f,k){this._width=f;this._height=k;const p=f%4,m=k%4;f+=2>p?-p:4-p;k+=2>m?-m:4-m;this._adjustedWidth=f;this._adjustedHeight=k;this._boundFBO=e.getBoundFramebufferObject();f=Math.round(1*f);k=Math.round(1*k);this._hlRenderer.setup(e,f,k);this._hlSurfaces.setup(e,f,k)};c.draw=function({context:e}){const f=e.getBoundFramebufferObject();
e.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setStencilTestEnabled(!1);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(e,f.colorTexture,g.TextureSamplingMode.NEAREST,1);e.setStencilTestEnabled(!1);e.setBlendingEnabled(!1);e.setColorMask(!1,!1,!1,!0);e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex);
e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex);e.bindFramebuffer(this._boundFBO);e.setBlendingEnabled(!0);e.setColorMask(!0,!0,!0,!0);e.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};c.setHighlightOptions=function(e){this._hlGradient.setHighlightOptions(e)};return a}(D.Effect)})},
"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define(["../../../../../../core/Logger","../../definitions","./parameters","../../../../../webgl/enums","../../../../../webgl/Texture"],function(t,u,B,D,z){function y(d,a){a.fillColor[0]=d.color.r/255;a.fillColor[1]=d.color.g/255;a.fillColor[2]=d.color.b/255;a.fillColor[3]=d.color.a;d.haloColor?(a.outlineColor[0]=d.haloColor.r/255,a.outlineColor[1]=d.haloColor.g/255,a.outlineColor[2]=d.haloColor.b/255,a.outlineColor[3]=d.haloColor.a):
(a.outlineColor[0]=a.fillColor[0],a.outlineColor[1]=a.fillColor[1],a.outlineColor[2]=a.fillColor[2],a.outlineColor[3]=a.fillColor[3]);a.fillColor[3]*=d.fillOpacity;a.outlineColor[3]*=d.haloOpacity;a.fillColor[0]*=a.fillColor[3];a.fillColor[1]*=a.fillColor[3];a.fillColor[2]*=a.fillColor[3];a.outlineColor[0]*=a.outlineColor[3];a.outlineColor[1]*=a.outlineColor[3];a.outlineColor[2]*=a.outlineColor[3];a.outlineWidth=B.HIGHLIGHT_SIZING.outlineWidth;a.outerHaloWidth=B.HIGHLIGHT_SIZING.outerHaloWidth;a.innerHaloWidth=
B.HIGHLIGHT_SIZING.innerHaloWidth;a.outlinePosition=B.HIGHLIGHT_SIZING.outlinePosition}const l=t.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),g=[0,0,0,0];return function(){function d(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:B.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:B.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:B.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:B.HIGHLIGHT_SIZING.outerHaloWidth};
this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*B.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}var a=d.prototype;a.setHighlightOptions=function(c){function e(r,x,q){n[0]=(1-q)*r[0]+q*x[0];n[1]=(1-q)*r[1]+q*x[1];n[2]=(1-q)*r[2]+q*x[2];n[3]=(1-q)*r[3]+q*x[3]}const f=this._convertedHighlightOptions;y(c,f);c=f.outlinePosition-f.outlineWidth/2-f.outerHaloWidth;const k=f.outlinePosition-f.outlineWidth/2,p=f.outlinePosition+f.outlineWidth/2,m=f.outlinePosition+f.outlineWidth/2+f.innerHaloWidth;
var b=Math.sqrt(Math.PI/2)*B.SIGMA,h=Math.abs(c)>b?Math.round(10*(Math.abs(c)-b))/10:0;b=Math.abs(m)>b?Math.round(10*(Math.abs(m)-b))/10:0;h&&!b?l.error("The outer rim of the highlight is "+h+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!h&&b?l.error("The inner rim of the highlight is "+b+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
h&&b&&l.error("The highlight is "+Math.max(h,b)+"px away from the edge of the feature; consider reducing some width values.");const n=[void 0,void 0,void 0,void 0];({texelData:b}=this);for(let r=0;r<B.SHADE_TEXTURE_SIZE;++r)h=c+r/(B.SHADE_TEXTURE_SIZE-1)*(m-c),h<c?(n[4*r]=0,n[4*r+1]=0,n[4*r+2]=0,n[4*r+3]=0):h<k?e(g,f.outlineColor,(h-c)/(k-c)):h<p?[n[0],n[1],n[2],n[3]]=f.outlineColor:h<m?e(f.outlineColor,f.fillColor,(h-p)/(m-p)):[n[4*r],n[4*r+1],n[4*r+2],n[4*r+3]]=f.fillColor,b[4*r]=255*n[0],b[4*r+
1]=255*n[1],b[4*r+2]=255*n[2],b[4*r+3]=255*n[3];this.minMaxDistance[0]=c;this.minMaxDistance[1]=m;this.shadeTexChanged=!0};a.applyHighlightOptions=function(c,e){this.shadeTex||(this.shadeTex=new z.Texture(c,{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,width:B.SHADE_TEXTURE_SIZE,height:1,samplingMode:D.TextureSamplingMode.LINEAR}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,B.SHADE_TEXTURE_SIZE,
1,this.texelData),this.shadeTexChanged=!1);c.bindTexture(this.shadeTex,u.TEXTURE_BINDING_HIGHLIGHT_1);e.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return d}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],function(t){t.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];t.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,
outlinePosition:0};t.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.SHADE_TEXTURE_SIZE=256;t.SIGMA=1;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../definitions ./parameters ../../shaders/HighlightPrograms ../../../../../webgl/BufferObject ../../../../../webgl/enums ../../../../../webgl/ProgramTemplate ../../../../../webgl/VertexArrayObject ../../../../../webgl/VertexElementDescriptor".split(" "),
function(t,u,B,D,z,y,l,g){return function(){function d(){this._height=this._width=void 0;this._resources=null}var a=d.prototype;a.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.preBlur=function(c,e){c.bindTexture(e,t.TEXTURE_BINDING_HIGHLIGHT_0);c.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",u.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);c.bindVAO(this._resources.quadVAO);c.drawArrays(z.PrimitiveType.TRIANGLE_STRIP,0,4);c.bindVAO()};a.finalBlur=function(c,e){c.bindTexture(e,t.TEXTURE_BINDING_HIGHLIGHT_0);c.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",u.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
c.bindVAO(this._resources.quadVAO);c.drawArrays(z.PrimitiveType.TRIANGLE_STRIP,0,4);c.bindVAO()};a.renderHighlight=function(c,e,f){c.bindTexture(e,t.TEXTURE_BINDING_HIGHLIGHT_0);c.useProgram(this._resources.highlightProgram);f.applyHighlightOptions(c,this._resources.highlightProgram);c.bindVAO(this._resources.quadVAO);c.setBlendingEnabled(!0);c.setBlendFunction(z.BlendFactor.ONE,z.BlendFactor.ONE_MINUS_SRC_ALPHA);c.drawArrays(z.PrimitiveType.TRIANGLE_STRIP,0,4);c.bindVAO()};a._initialize=function(c,
e,f){this._width=e;this._height=f;e=D.BufferObject.createVertex(c,z.Usage.STATIC_DRAW,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);f=new l.VertexArrayObject(c,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[new g.VertexElementDescriptor("a_position",2,z.DataType.BYTE,0,4),new g.VertexElementDescriptor("a_texcoord",2,z.DataType.UNSIGNED_BYTE,2,4)]},{geometry:e});const k=y.createProgram(c,B.highlight),p=y.createProgram(c,B.blur);c.useProgram(k);k.setUniform1i("u_texture",t.TEXTURE_BINDING_HIGHLIGHT_0);
k.setUniform1i("u_shade",t.TEXTURE_BINDING_HIGHLIGHT_1);k.setUniform1f("u_sigma",u.SIGMA);c.useProgram(p);p.setUniform1i("u_texture",t.TEXTURE_BINDING_HIGHLIGHT_0);p.setUniform1f("u_sigma",u.SIGMA);this._resources={quadGeometry:e,quadVAO:f,highlightProgram:k,blurProgram:p}};a.setup=function(c,e,f){this._resources?(this._width=e,this._height=f):this._initialize(c,e,f)};return d}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(t,
u){const B={shaders:{vertexShader:u.resolveIncludes("highlight/textured.vert"),fragmentShader:u.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};u={shaders:{vertexShader:u.resolveIncludes("highlight/textured.vert"),fragmentShader:u.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};t.blur=u;t.highlight=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../webgl/enums","../../../../../webgl/FramebufferObject","../../../../../webgl/Texture"],function(t,u,B,D){function z(y,l,g){l=new D.Texture(y,{target:u.TextureType.TEXTURE_2D,pixelFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,width:l,height:g,samplingMode:u.TextureSamplingMode.LINEAR});y=new B.FramebufferObject(y,{colorTarget:u.TargetType.TEXTURE,depthStencilTarget:u.DepthStencilTargetType.STENCIL_RENDER_BUFFER},l);return[l,y]}
return function(){function y(){this._height=this._width=void 0;this._resources=null}var l=y.prototype;l.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};l._initialize=function(g,d,a){this._width=d;this._height=a;const [c,e]=z(g,d,a),[f,k]=z(g,d,a);this._resources={sharedBlur1Tex:c,sharedBlur1Fbo:e,sharedBlur2Tex:f,sharedBlur2Fbo:k}};
l.setup=function(g,d,a){!this._resources||this._width===d&&this._height===a||this.dispose();this._resources||this._initialize(g,d,a)};t._createClass(y,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);return y}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),
function(t,u,B,D,z,y){z=function(l){function g(){var a=l.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["hittest"];return a}u._inheritsLoose(g,l);var d=g.prototype;d.dispose=function(){B.isSome(this._fbo)&&this._fbo.dispose()};d.createOptions=function({pixelRatio:a},c,e=D.HITTEST_RADIUS){if(!c.length)return null;c=c.shift();const f=c.point.x,k=c.point.y;this._outstanding=c;return{type:"hittest",distance:e*a,position:[f,k]}};d.bind=function(a){const {context:c,attributeView:e}=a;
e.size&&(a=e.getBlock(D.ATTRIBUTE_DATA_GPGPU),B.isNone(a)||(a=a.getFBO(c),c.setViewport(0,0,e.size,e.size),c.bindFramebuffer(a),c.setColorMask(!0,!0,!0,!0),c.setClearColor(0,0,0,0),c.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT)))};d.unbind=function(a){};d.draw=function(a){const {context:c,attributeView:e}=a;var f=e.getBlock(D.ATTRIBUTE_DATA_GPGPU);if(!B.isNone(this._outstanding))if(a=this._outstanding.resolver,B.isNone(f))a.resolve([]),this._outstanding=null;else{var k=f.getFBO(c);f=new Uint8Array(k.width*
k.height*4);k.readPixels(0,0,k.width,k.height,y.PixelFormat.RGBA,y.PixelType.UNSIGNED_BYTE,f);k=[];for(let p=0;p<f.length;p+=4)f[p]&&k.push(p/4);this._outstanding=null;a.resolve(k)}};return g}(z.Effect);t.HittestEffect=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/HittestEffectVTL":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),function(t,u,
B,D,z,y){z=function(l){function g(){var a=l.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["id"];a._lastSize=0;return a}u._inheritsLoose(g,l);var d=g.prototype;d.dispose=function(){B.isSome(this._fbo)&&this._fbo.dispose()};d.bind=function({context:a,painter:c}){const {width:e,height:f}=a.getViewport();this._boundFBO=a.getBoundFramebufferObject();c=c.getFbos(e,f).effect0;a.bindFramebuffer(c);a.setColorMask(!0,!0,!0,!0);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT)};d.unbind=
function({context:a}){a.bindFramebuffer(this._boundFBO);this._boundFBO=null};d.draw=function({context:a,state:c,pixelRatio:e},f,k=2*D.HITTEST_RADIUS){const p=a.getBoundFramebufferObject(),m=c.size[1]*e,b=Math.round(k*e),h=b/2,n=b/2;this._ensureBuffer(b);f.forEach((r,x)=>{var q=new Map;p.readPixels(Math.floor(x.x*e-b/2),Math.floor(m-x.y*e-b/2),b,b,y.PixelFormat.RGBA,y.PixelType.UNSIGNED_BYTE,this._buf);for(let F=0;F<this._buf32.length;F++){const w=this._buf32[F];if(4294967295!==w&&0!==w){var A=F%b,
E=b-Math.floor(F/b);A=(h-A)*(h-A)+(n-E)*(n-E);E=q.has(w)?q.get(w):4294967295;q.set(w,Math.min(A,E))}}q=Array.from(q).sort((F,w)=>F[1]-w[1]).map(F=>F[0]);r.resolve(q);f.delete(x)})};d._ensureBuffer=function(a){this._lastSize!==a&&(this._lastSize=a,this._buf=new Uint8Array(4*a*a),this._buf32=new Uint32Array(this._buf.buffer))};return g}(z.Effect);t.HittestEffectVTL=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define("exports ./Bloom ./Blur ./Colorize ./DropShadow ./Opacity".split(" "),
function(t,u,B,D,z,y){const l={colorize:()=>new D.Colorize,blur:()=>new B.Blur,bloom:()=>new u.Bloom,opacity:()=>new y.Opacity,"drop-shadow":()=>new z.DropShadow};let g=function(){function d(c){this._requestRender=c;this._effectMap=new Map}var a=d.prototype;a.dispose=function(){this._requestRender&&(this._requestRender=null);this._effectMap.forEach(c=>c.dispose());this._effectMap.clear()};a.getPostProcessingEffects=function(c){if(!c||0===c.length)return[];const e=[];for(const f of c){a:switch(c=f.type,
c){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;default:c="colorize"}let k=this._effectMap.get(c);k||(k=l[c](),this._effectMap.set(c,k));e.push({postProcessingEffect:k,effect:f})}return e};return d}();t.EffectManager=g;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/Bloom":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(t,u,B,D){const z=[1,
0],y=[0,1],l=[1,.8,.6,.4,.2],g=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];let d=function(){function a(){this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=5;this._kernelSizeArray=[3,5,7,9,11];this._size=[0,0];this._programDesc={luminosityHighPass:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/luminosityHighPass",attributes:new Map([["a_position",0]])},gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/gaussianBlur",attributes:new Map([["a_position",
0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var c=a.prototype;c.dispose=function(){this._quad&&(this._quad.dispose(),this._quad=null);this._intensityFBO&&(this._intensityFBO.dispose(),this._intensityFBO=null);this._compositeFBO&&(this._compositeFBO.dispose(),this._compositeFBO=null);if(this._mipsFBOs){for(let e=0;e<
this._nMips;e++)this._mipsFBOs[e]&&(this._mipsFBOs[e].horizontal.dispose(),this._mipsFBOs[e].vertical.dispose());this._mipsFBOs=null}};c.draw=function(e,f,k){const {width:p,height:m}=f,{context:b,painter:h}=e,{materialManager:n}=h;var r=b.gl;const x=this._programDesc,{strength:q,radius:A,threshold:E}=k;this._quad||(this._quad=new u(b,[-1,-1,1,-1,-1,1,1,1]));this._createOrResizeResources(e,p,m);b.setStencilTestEnabled(!1);b.setBlendingEnabled(!0);b.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);
b.setStencilWriteMask(0);k=this._quad;k.bind();b.bindFramebuffer(this._intensityFBO);var F=n.getProgram(e,x.luminosityHighPass);b.useProgram(F);b.bindTexture(f.colorTexture,0);F.setUniform1i("u_texture",0);F.setUniform3fv("u_defaultColor",[0,0,0]);F.setUniform1f("u_defaultOpacity",0);F.setUniform1f("u_luminosityThreshold",E);F.setUniform1f("u_smoothWidth",.01);F=[Math.round(p/2),Math.round(m/2)];b.setViewport(0,0,F[0],F[1]);b.setClearColor(0,0,0,0);b.clear(r.COLOR_BUFFER_BIT);k.draw();b.setBlendingEnabled(!1);
r=this._intensityFBO.colorTexture;for(let w=0;w<this._nMips;w++){const v=n.getProgram(e,x.gaussianBlur,[{name:"radius",value:this._kernelSizeArray[w]}]);b.useProgram(v);b.bindTexture(r,w+1);v.setUniform1i("u_colorTexture",w+1);v.setUniform2fv("u_texSize",F);v.setUniform2fv("u_direction",z);b.setViewport(0,0,F[0],F[1]);const C=this._mipsFBOs[w];b.bindFramebuffer(C.horizontal);k.draw();r=C.horizontal.colorTexture;b.bindFramebuffer(C.vertical);b.bindTexture(r,w+1);v.setUniform2fv("u_direction",y);k.draw();
r=C.vertical.colorTexture;F[0]=Math.round(F[0]/2);F[1]=Math.round(F[1]/2)}b.setViewport(0,0,p,m);F=n.getProgram(e,x.composite,[{name:"nummips",value:5}]);b.bindFramebuffer(this._compositeFBO);b.useProgram(F);F.setUniform1f("u_bloomStrength",q);F.setUniform1f("u_bloomRadius",A);F.setUniform1fv("u_bloomFactors",l);F.setUniform3fv("u_bloomTintColors",g);b.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);F.setUniform1i("u_blurTexture1",1);b.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);
F.setUniform1i("u_blurTexture2",2);b.bindTexture(this._mipsFBOs[2].vertical.colorTexture,3);F.setUniform1i("u_blurTexture3",3);b.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);F.setUniform1i("u_blurTexture4",4);b.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5);F.setUniform1i("u_blurTexture5",5);k.draw();b.bindFramebuffer(f);b.setBlendingEnabled(!0);e=n.getProgram(e,x.blit);b.useProgram(e);b.bindTexture(this._compositeFBO.colorTexture,6);e.setUniform1i("u_texture",6);b.setBlendFunction(B.BlendFactor.ONE,
B.BlendFactor.ONE);k.draw();k.unbind();b.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);b.setStencilTestEnabled(!0)};c._createOrResizeResources=function(e,f,k){({context:e}=e);if(!this._compositeFBO||this._size[0]!==f||this._size[1]!==k){this._size[0]=f;this._size[1]=k;var p=[Math.round(f/2),Math.round(k/2)];this._compositeFBO?this._compositeFBO.resize(f,k):this._compositeFBO=new D.FramebufferObject(e,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,
width:f,height:k});this._intensityFBO?this._intensityFBO.resize(p[0],p[1]):this._intensityFBO=new D.FramebufferObject(e,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]});for(f=0;f<this._nMips;f++)this._mipsFBOs[f]?
(this._mipsFBOs[f].horizontal.resize(p[0],p[1]),this._mipsFBOs[f].vertical.resize(p[0],p[1])):this._mipsFBOs[f]={horizontal:new D.FramebufferObject(e,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]}),
vertical:new D.FramebufferObject(e,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]})},p[0]=Math.round(p[0]/2),p[1]=Math.round(p[1]/2)}};return a}();t.Bloom=d;Object.defineProperty(t,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/Blur":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(t,u,B,D){const z=[1,0],y=[0,1];let l=function(){function g(){this._blurFBO=null;this._size=[0,0];this._programDesc={gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",
attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var d=g.prototype;d.dispose=function(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)};d.draw=function(a,c,e){const {context:f}=a,{type:k,radius:p}=e;0!==p&&(this._createOrResizeResources(a),this._quad||(this._quad=new u(f,[-1,-1,1,-1,-1,1,1,1])),e=this._quad,e.bind(),"blur"===k?this._gaussianBlur(a,c,p):this._radialBlur(a,c),e.unbind())};d._gaussianBlur=
function(a,c,e){const {context:f,state:k,painter:p,pixelRatio:m}=a;var {size:b}=k;const {materialManager:h}=p,n=this._quad;b=[Math.round(m*b[0]),Math.round(m*b[1])];const r=this._blurFBO;a=h.getProgram(a,this._programDesc.gaussianBlur,[{name:"radius",value:Math.ceil(e)}]);f.useProgram(a);f.setBlendingEnabled(!1);f.bindFramebuffer(r);f.bindTexture(c.colorTexture,4);a.setUniform1i("u_colorTexture",4);a.setUniform2fv("u_texSize",b);a.setUniform2fv("u_direction",z);a.setUniform1f("u_sigma",e);n.draw();
f.bindFramebuffer(c);f.setStencilWriteMask(0);f.setStencilTestEnabled(!1);f.setDepthWriteEnabled(!1);f.setDepthTestEnabled(!1);f.bindTexture(r.colorTexture,5);a.setUniform1i("u_colorTexture",5);a.setUniform2fv("u_direction",y);n.draw();f.setBlendingEnabled(!0);f.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);f.setStencilTestEnabled(!0)};d._radialBlur=function(a,c){const {context:e,painter:f}=a,{materialManager:k}=f,p=this._programDesc,m=this._quad,b=this._blurFBO;e.bindFramebuffer(b);
const h=k.getProgram(a,p.radialBlur);e.useProgram(h);e.setBlendingEnabled(!1);e.bindTexture(c.colorTexture,4);h.setUniform1i("u_colorTexture",4);m.draw();e.bindFramebuffer(c);e.setStencilWriteMask(0);e.setStencilTestEnabled(!1);e.setDepthWriteEnabled(!1);e.setDepthTestEnabled(!1);e.setBlendingEnabled(!0);a=k.getProgram(a,p.blit);e.useProgram(a);e.bindTexture(b.colorTexture,5);a.setUniform1i("u_texture",5);e.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);m.draw()};d._createOrResizeResources=
function(a){const {context:c,state:e,pixelRatio:f}=a;var {size:k}=e;a=Math.round(f*k[0]);k=Math.round(f*k[1]);this._blurFBO&&this._size[0]===a&&this._size[1]===k||(this._size[0]=a,this._size[1]=k,this._blurFBO?this._blurFBO.resize(a,k):this._blurFBO=new D.FramebufferObject(c,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:a,height:k},{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,
wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:a,height:k}))};return g}();t.Blur=l;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/Colorize":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/Texture"],function(t,u,B,D){let z=function(){function y(){this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",
attributes:new Map([["a_position",0]])}}var l=y.prototype;l.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};l.draw=function(g,d,a){const {width:c,height:e}=d;this._createOrResizeResources(g,c,e);const {context:f,painter:k}=g,{materialManager:p}=k,m=this._programDesc,b=this._quad;a=a.colorMatrix;b.bind();const h=this._layerFBOTexture;f.bindFramebuffer(d);d.copyToTexture(0,0,c,e,0,0,h);f.setBlendingEnabled(!1);f.setStencilTestEnabled(!1);g=p.getProgram(g,
m);f.useProgram(g);f.bindTexture(h,2);g.setUniformMatrix4fv("u_coefficients",a);g.setUniform1i("u_colorTexture",2);b.draw();f.setBlendingEnabled(!0);f.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);f.setStencilTestEnabled(!0);b.unbind()};l._createOrResizeResources=function(g,d,a){({context:g}=g);this._layerFBOTexture&&this._size[0]===d&&this._size[1]===a||(this._size[0]=d,this._size[1]=a,this._layerFBOTexture?this._layerFBOTexture.resize(d,a):this._layerFBOTexture=new D.Texture(g,
{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:d,height:a}),this._quad||(this._quad=new u(g,[-1,-1,1,-1,-1,1,1,1])))};return y}();t.Colorize=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/DropShadow":function(){define("exports ../../../../../../core/screenUtils ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/FramebufferObject ../../../../../webgl/Texture".split(" "),
function(t,u,B,D,z,y){const l=[1,0],g=[0,1];let d=function(){function a(){this._verticalBlurFBO=this._horizontalBlurFBO=null;this._size=[0,0];this._programDesc={blur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/drop-shadow/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",
0]])}}}var c=a.prototype;c.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null);this._horizontalBlurFBO&&(this._horizontalBlurFBO.dispose(),this._horizontalBlurFBO=null);this._verticalBlurFBO&&(this._verticalBlurFBO.dispose(),this._verticalBlurFBO=null)};c.draw=function(e,f,k){const {context:p,state:m,painter:b}=e,{materialManager:h}=b,n=this._programDesc,r=f.width,x=f.height,q=[Math.round(r/2),Math.round(x/2)],{blurRadius:A,offsetX:E,offsetY:F,color:w}=
k;k=[u.pt2px(E/2),u.pt2px(F/2)];this._createOrResizeResources(e,r,x,q);const v=this._horizontalBlurFBO,C=this._verticalBlurFBO;p.setStencilWriteMask(0);p.setStencilTestEnabled(!1);p.setDepthWriteEnabled(!1);p.setDepthTestEnabled(!1);const G=this._layerFBOTexture;f.copyToTexture(0,0,r,x,0,0,G);this._quad||(this._quad=new B(p,[-1,-1,1,-1,-1,1,1,1]));p.setViewport(0,0,q[0],q[1]);const H=this._quad;H.bind();p.setBlendingEnabled(!1);const L=h.getProgram(e,n.blur,[{name:"radius",value:Math.ceil(A)}]);p.useProgram(L);
p.bindFramebuffer(v);p.bindTexture(f.colorTexture,4);L.setUniform1i("u_colorTexture",4);L.setUniform2fv("u_texSize",q);L.setUniform2fv("u_direction",l);L.setUniform1f("u_sigma",A);H.draw();p.bindFramebuffer(C);p.bindTexture(v.colorTexture,5);L.setUniform1i("u_colorTexture",5);L.setUniform2fv("u_direction",g);H.draw();p.bindFramebuffer(f);p.setViewport(0,0,r,x);e=h.getProgram(e,n.composite);p.useProgram(e);p.bindTexture(C.colorTexture,2);e.setUniform1i("u_blurTexture",2);p.bindTexture(G,3);e.setUniform1i("u_layerFBOTexture",
3);e.setUniform4fv("u_shadowColor",[w[0]/255*w[3],w[1]/255*w[3],w[2]/255*w[3],w[3]]);e.setUniformMatrix3fv("u_displayViewMat3",m.displayMat3);e.setUniform2fv("u_shadowOffset",k);H.draw();p.setBlendingEnabled(!0);p.setStencilTestEnabled(!0);p.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);H.unbind()};c._createOrResizeResources=function(e,f,k,p){({context:e}=e);this._horizontalBlurFBO&&this._size[0]===f&&this._size[1]===k||(this._size[0]=f,this._size[1]=k,this._horizontalBlurFBO?
this._horizontalBlurFBO.resize(p[0],p[1]):this._horizontalBlurFBO=new z.FramebufferObject(e,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]}),this._verticalBlurFBO?this._verticalBlurFBO.resize(p[0],
p[1]):this._verticalBlurFBO=new z.FramebufferObject(e,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]}),this._layerFBOTexture?this._layerFBOTexture.resize(f,k):this._layerFBOTexture=new y.Texture(e,
{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:f,height:k}))};return a}();t.DropShadow=d;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/Opacity":function(){define(["exports","../../../../../webgl/enums","../../../../../webgl/Texture"],function(t,u,B){let D=function(){function z(){this._size=
[0,0]}var y=z.prototype;y.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};y.draw=function(l,g,d){const {width:a,height:c}=g;this._createOrResizeResources(l,a,c);const {context:e,painter:f}=l;({amount:l}=d);d=e.gl;const k=this._layerFBOTexture;e.bindFramebuffer(g);g.copyToTexture(0,0,a,c,0,0,k);e.setBlendingEnabled(!0);e.setStencilTestEnabled(!1);e.setDepthTestEnabled(!1);e.setClearColor(0,0,0,0);e.clear(d.COLOR_BUFFER_BIT);f.blitTexture(e,k,
u.TextureSamplingMode.NEAREST,l)};y._createOrResizeResources=function(l,g,d){({context:l}=l);this._layerFBOTexture&&this._size[0]===g&&this._size[1]===d||(this._size[0]=g,this._size[1]=d,this._layerFBOTexture?this._layerFBOTexture.resize(g,d):this._layerFBOTexture=new B.Texture(l,{target:u.TextureType.TEXTURE_2D,pixelFormat:u.PixelFormat.RGBA,internalFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:u.TextureSamplingMode.NEAREST,flipped:!1,
width:g,height:d}))};return z}();t.Opacity=D;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/arrayUtils","../../../../../core/maybe","../enums"],function(t,u,B){return function(){function D(y,l){var g;this.brushes=y;this.name=l.name;this.drawPhase=l.drawPhase||B.WGLDrawPhase.MAP;this._targetFn=l.target;this.effects=l.effects||[];this.enableDefaultDraw=null!=(g=l.enableDefaultDraw)?g:()=>!0}var z=D.prototype;
z.render=function(y){const {context:l,profiler:g}=y,d=this._targetFn();var a=this.drawPhase&y.drawPhase;g.recordPassStart(this.name);if(a){this.enableDefaultDraw()&&this._doRender(y,d);g.recordPassEnd();for(const c of this.effects){if(!c.enable())continue;a=c.apply;g.recordPassStart(this.name+"."+a.name);g.recordBrushStart(a.name);const e=c.args&&c.args(),{x:f,y:k,width:p,height:m}=l.getViewport(),b=l.getBoundFramebufferObject();a.bind(y,e);const h=a.createOptions(y,e),n=y.passOptions;y.passOptions=
h;this._doRender(y,d,a.defines);y.passOptions=n;a.draw(y,e);a.unbind(y,e);l.bindFramebuffer(b);l.setViewport(f,k,p,m);g.recordBrushEnd();g.recordPassEnd()}}};z._doRender=function(y,l,g){if(!u.isNone(l))if(t.isArrayLike(l))for(const d of l){if(d.visible)for(const a of this.brushes)y.profiler.recordBrushStart(a.name),a.prepareState(y,d,g),a.draw(y,d,g),y.profiler.recordBrushEnd()}else for(const d of this.brushes)y.profiler.recordBrushStart(d.name),d.prepareState(y,l,g),d.draw(y,l,g),y.profiler.recordBrushEnd()};
return D}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(t,u,B,D,z,y,l){const g=z("esri-2d-profiler");z=function(){function d(c,e){this._events=new D;this._entries=new Map;this._timings=new B(10);if(g){this._ext=l.createDisjointTimerQuery(c.gl,{});this._debugOutput=
e;var f=c.gl;if(this.enableCommandLogging)for(const k in f)if("function"===typeof f[k]){const p=f[k],m=-1!==k.indexOf("draw");f[k]=(...b)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:k,args:b,isDrawCommand:m});this._currentSummary&&(this._currentSummary.commands++,m&&this._currentSummary.drawCommands++);return p.apply(f,b)}}}}var a=d.prototype;a.recordContainerStart=function(c){g&&(this._currentContainer=c)};a.recordContainerEnd=
function(){g&&(this._currentContainer=null)};a.recordPassStart=function(c){g&&(this._currentPass=c,this._initSummary())};a.recordPassEnd=function(){g&&(this._currentPass=null,this._emitSummary())};a.recordBrushStart=function(c){g&&(this._currentBrush=c)};a.recordBrushEnd=function(){g&&(this._currentBrush=null)};a.recordStart=function(c){if(g&&y.isSome(this._ext)){if(this._entries.has(c)){const m=this._entries.get(c);var e=this._ext.resultAvailable(m.query),f=this._ext.disjoint();if(e&&!f){e=this._ext.getResult(m.query)/
1E6;f=0;if(y.isSome(this._timings.enqueue(e))){f=this._timings.entries;const b=f.length;let h=0;for(var k of f)h+=k;f=h/b}k=e.toFixed(2);e=f?f.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${c}, ${k} ms (${e} last 10 avg)\n${m.commandsLen} Commands (${m.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(m.summaries),console.log("Commands: ",m.commands),console.groupEnd()):console.log(`Frame report for ${c}, ${k} ms (${e} last 10 avg)`);
this._debugOutput.innerHTML=`${k} (${e})`}for(const b of m.handles)b.remove();this._entries.delete(c)}const p={name:c,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(p.handles.push(this._events.on("command",m=>{p.commandsLen++;p.commands.push(m);m.isDrawCommand&&p.drawCommands++})),p.handles.push(this._events.on("summary",m=>{p.summaries.push(m)})));this._ext.beginTimeElapsed(p.query);this._entries.set(c,p)}};a.recordEnd=
function(c){g&&y.isSome(this._ext)&&this._entries.has(c)&&this._ext.endTimeElapsed()};a._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};u._createClass(d,[{key:"enableCommandLogging",get:function(){return!("object"===typeof g&&g.disableCommands)}}]);return d}();t.Profiler=z;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(t,u){return function(){function B(z){this._start=this.size=0;this.maxSize=z;this._buffer=Array(z)}var D=B.prototype;D.enqueue=function(z){if(this.size===this.maxSize){const y=this._buffer[this._start];this._buffer[this._start]=z;this._start=(this._start+1)%this.maxSize;return y}this._buffer[(this._start+this.size++)%this.maxSize]=z;return null};D.dequeue=function(){if(0===
this.size)return null;const z=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return z};D.peek=function(){return 0===this.size?null:this._buffer[this._start]};D.find=function(z){if(0===this.size)return null;for(const y of this._buffer)if(u.isSome(y)&&z(y))return y;return null};D.clear=function(z){let y=this.dequeue();for(;u.isSome(y);)z&&z(y),y=this.dequeue()};t._createClass(B,[{key:"entries",get:function(){return this._buffer}}]);return B}()})},
"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","./isWebGL2Context"],function(t,u){let B=function(D,z,y,l,g,d,a,c){this.createQuery=D;this.resultAvailable=z;this.getResult=y;this.disjoint=l;this.beginTimeElapsed=g;this.endTimeElapsed=d;this.createTimestamp=a;this.timestampBits=c};t.DisjointTimerQuery=B;t.createDisjointTimerQuery=function(D,z){if(z.disjointTimerQuery)return null;let y=D.getExtension("EXT_disjoint_timer_query_webgl2");return y&&u(D)?new B(()=>D.createQuery(),
l=>D.getQueryParameter(l,D.QUERY_RESULT_AVAILABLE),l=>D.getQueryParameter(l,D.QUERY_RESULT),()=>D.getParameter(y.GPU_DISJOINT_EXT),l=>D.beginQuery(y.TIME_ELAPSED_EXT,l),()=>D.endQuery(y.TIME_ELAPSED_EXT),l=>y.queryCounterEXT(l,y.TIMESTAMP_EXT),()=>D.getQuery(y.TIMESTAMP_EXT,y.QUERY_COUNTER_BITS_EXT)):(y=D.getExtension("EXT_disjoint_timer_query"))?new B(()=>y.createQueryEXT(),l=>y.getQueryObjectEXT(l,y.QUERY_RESULT_AVAILABLE_EXT),l=>y.getQueryObjectEXT(l,y.QUERY_RESULT_EXT),()=>D.getParameter(y.GPU_DISJOINT_EXT),
l=>y.beginQueryEXT(y.TIME_ELAPSED_EXT,l),()=>y.endQueryEXT(y.TIME_ELAPSED_EXT),l=>y.queryCounterEXT(l,y.TIMESTAMP_EXT),()=>y.getQueryEXT(y.TIMESTAMP_EXT,y.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(t,u){u={shaders:{vertexShader:u.resolveIncludes("stencil/stencil.vert"),fragmentShader:u.resolveIncludes("stencil/stencil.frag")},attributes:new Map([["a_pos",
0]])};t.stencil=u;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/RenderingContext":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/time ./BufferObject ./FramebufferObject ../../core/has ./checkWebGLError ./context-util ./enums ./ShaderTranspiler ./ProgramCache ./Texture ./VertexArrayObject ./ContextState ./InstanceCounter ./renderState ./Util ./WebGLDriverTest ./capabilities/Capabilities ./capabilities/isWebGL2Context".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h,n,r,x,q){function A(F,w,v,C){w?C!==w&&F.bindBuffer(v,w.glName):F.bindBuffer(v,null);return w}function E(F,w){switch(F){case c.PrimitiveType.POINTS:return 2*w;case c.PrimitiveType.TRIANGLES:return w/3;case c.PrimitiveType.TRIANGLE_STRIP:return w-2;case c.PrimitiveType.TRIANGLE_FAN:return w-2;default:return 0}}y=function(){function F(v,C){this.gl=v;this.instanceCounter=new b.InstanceCounter;this.programCache=new f.ProgramCache(this);this._state=new m.ContextState;
this._numOfTriangles=this._numOfDrawCalls=0;this.type=q(v)?a.ContextType.WEBGL2:a.ContextType.WEBGL1;this._loadExtensions();this.configure(C)}var w=F.prototype;w.configure=function(v){this._capabilities=new x.Capabilities(this.gl,v);this._parameters=this._loadParameters(v);v=this.gl.getParameter(this.gl.VIEWPORT);this._state=new m.ContextState;this._state.viewport={x:v[0],y:v[1],width:v[2],height:v[3]};this._stateTracker=new h.StateTracker({setBlending:C=>{C?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(C.opRgb,
C.opAlpha),this.setBlendFunctionSeparate(C.srcRgb,C.dstRgb,C.srcAlpha,C.dstAlpha),C=C.color,this.setBlendColor(C.r,C.g,C.b,C.a)):this.setBlendingEnabled(!1)},setCulling:C=>{C?(this.setFaceCullingEnabled(!0),this.setCullFace(C.face),this.setFrontFace(C.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:C=>{C?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(C.factor,C.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:C=>{C?(this.setDepthTestEnabled(!0),this.setDepthFunction(C.func)):
this.setDepthTestEnabled(!1)},setStencilTest:C=>{if(C){this.setStencilTestEnabled(!0);const G=C.function;this.setStencilFunction(G.func,G.ref,G.mask);C=C.operation;this.setStencilOp(C.fail,C.zFail,C.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:C=>{C?(this.setDepthWriteEnabled(!0),this.setDepthRange(C.zNear,C.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:C=>{C?this.setColorMask(C.r,C.g,C.b,C.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:C=>{C?this.setStencilWriteMask(C.mask):
this.setStencilWriteMask(0)}});this.enforceState();this._driverTest=new r.WebGLDriverTest(this)};w.dispose=function(){this.programCache.dispose();this.bindVAO(null);this.unbindBuffer(c.BufferType.ARRAY_BUFFER);this.unbindBuffer(c.BufferType.ELEMENT_ARRAY_BUFFER);q(this.gl)&&(this.unbindBuffer(c.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(c.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(c.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(c.BufferType.COPY_READ_BUFFER),
this.unbindBuffer(c.BufferType.COPY_WRITE_BUFFER));this._state.textureUnitMap.length=0;d.webglDebugEnabled()&&this.instanceCounter.printResourceCount()};w.setPipelineState=function(v){this._stateTracker.setPipeline(v)};w.setBlendingEnabled=function(v){this._state.blend!==v&&(!0===v?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=v,this._stateTracker.invalidateBlending())};w.externalProgramUpdate=function(){var v;null==(v=this._state.program)?void 0:v.stop();this._state.program=
null};w.externalTextureUnitUpdate=function(v,C){for(let G=0;G<v.length;++G)this._state.textureUnitMap[v[G]]=null;0<=C&&(this._state.activeTexture=C)};w.externalVertexArrayObjectUpdate=function(){const v=this.capabilities.vao;v&&(v.bindVertexArray(null),this._state.vertexArrayObject=null);this._state.vertexBuffer=null;this._state.indexBuffer=null};w.externalVertexBufferUpdate=function(){this._state.vertexBuffer=null};w.externalIndexBufferUpdate=function(){this._state.indexBuffer=null};w.setBlendColor=
function(v,C,G,H){if(v!==this._state.blendColor.r||C!==this._state.blendColor.g||G!==this._state.blendColor.b||H!==this._state.blendColor.a)this.gl.blendColor(v,C,G,H),this._state.blendColor.r=v,this._state.blendColor.g=C,this._state.blendColor.b=G,this._state.blendColor.a=H,this._stateTracker.invalidateBlending()};w.setBlendFunction=function(v,C){if(v!==this._state.blendFunction.srcRGB||C!==this._state.blendFunction.dstRGB)this.gl.blendFunc(v,C),this._state.blendFunction.srcRGB=v,this._state.blendFunction.srcAlpha=
v,this._state.blendFunction.dstRGB=C,this._state.blendFunction.dstAlpha=C,this._stateTracker.invalidateBlending()};w.setBlendFunctionSeparate=function(v,C,G,H){if(this._state.blendFunction.srcRGB!==v||this._state.blendFunction.srcAlpha!==G||this._state.blendFunction.dstRGB!==C||this._state.blendFunction.dstAlpha!==H)this.gl.blendFuncSeparate(v,C,G,H),this._state.blendFunction.srcRGB=v,this._state.blendFunction.srcAlpha=G,this._state.blendFunction.dstRGB=C,this._state.blendFunction.dstAlpha=H,this._stateTracker.invalidateBlending()};
w.setBlendEquation=function(v){this._state.blendEquation.mode!==v&&(this.gl.blendEquation(v),this._state.blendEquation.mode=v,this._state.blendEquation.modeAlpha=v,this._stateTracker.invalidateBlending())};w.setBlendEquationSeparate=function(v,C){if(this._state.blendEquation.mode!==v||this._state.blendEquation.modeAlpha!==C)this.gl.blendEquationSeparate(v,C),this._state.blendEquation.mode=v,this._state.blendEquation.modeAlpha=C,this._stateTracker.invalidateBlending()};w.setColorMask=function(v,C,
G,H){if(this._state.colorMask.r!==v||this._state.colorMask.g!==C||this._state.colorMask.b!==G||this._state.colorMask.a!==H)this.gl.colorMask(v,C,G,H),this._state.colorMask.r=v,this._state.colorMask.g=C,this._state.colorMask.b=G,this._state.colorMask.a=H,this._stateTracker.invalidateColorWrite()};w.setClearColor=function(v,C,G,H){if(this._state.clearColor.r!==v||this._state.clearColor.g!==C||this._state.clearColor.b!==G||this._state.clearColor.a!==H)this.gl.clearColor(v,C,G,H),this._state.clearColor.r=
v,this._state.clearColor.g=C,this._state.clearColor.b=G,this._state.clearColor.a=H};w.setFaceCullingEnabled=function(v){this._state.faceCulling!==v&&(!0===v?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=v,this._stateTracker.invalidateCulling())};w.setPolygonOffsetFillEnabled=function(v){this._state.polygonOffsetFill!==v&&(!0===v?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._state.polygonOffsetFill=v,this._stateTracker.invalidatePolygonOffset())};
w.setPolygonOffset=function(v,C){if(this._state.polygonOffset[0]!==v||this._state.polygonOffset[1]!==C)this._state.polygonOffset[0]=v,this._state.polygonOffset[1]=C,this.gl.polygonOffset(v,C),this._stateTracker.invalidatePolygonOffset()};w.setCullFace=function(v){this._state.cullFace!==v&&(this.gl.cullFace(v),this._state.cullFace=v,this._stateTracker.invalidateCulling())};w.setFrontFace=function(v){this._state.frontFace!==v&&(this.gl.frontFace(v),this._state.frontFace=v,this._stateTracker.invalidateCulling())};
w.setScissorTestEnabled=function(v){this._state.scissorTest!==v&&(!0===v?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=v)};w.setScissorRect=function(v,C,G,H){if(this._state.scissorRect.x!==v||this._state.scissorRect.y!==C||this._state.scissorRect.width!==G||this._state.scissorRect.height!==H)this.gl.scissor(v,C,G,H),this._state.scissorRect.x=v,this._state.scissorRect.y=C,this._state.scissorRect.width=G,this._state.scissorRect.height=H};w.setDepthTestEnabled=
function(v){this._state.depthTest!==v&&(!0===v?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=v,this._stateTracker.invalidateDepthTest())};w.setClearDepth=function(v){this._state.clearDepth!==v&&(this.gl.clearDepth(v),this._state.clearDepth=v)};w.setDepthFunction=function(v){this._state.depthFunction!==v&&(this.gl.depthFunc(v),this._state.depthFunction=v,this._stateTracker.invalidateDepthTest())};w.setDepthWriteEnabled=function(v){this._state.depthWrite!==
v&&(this.gl.depthMask(v),this._state.depthWrite=v,this._stateTracker.invalidateDepthWrite())};w.setDepthRange=function(v,C){if(this._state.depthRange.zNear!==v||this._state.depthRange.zFar!==C)this.gl.depthRange(v,C),this._state.depthRange.zNear=v,this._state.depthRange.zFar=C,this._stateTracker.invalidateDepthWrite()};w.setStencilTestEnabled=function(v){this._state.stencilTest!==v&&(!0===v?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._state.stencilTest=v,this._stateTracker.invalidateStencilTest())};
w.setClearStencil=function(v){v!==this._state.clearStencil&&(this.gl.clearStencil(v),this._state.clearStencil=v)};w.setStencilFunction=function(v,C,G){if(this._state.stencilFunction.func!==v||this._state.stencilFunction.ref!==C||this._state.stencilFunction.mask!==G)this.gl.stencilFunc(v,C,G),this._state.stencilFunction.face=c.Face.FRONT_AND_BACK,this._state.stencilFunction.func=v,this._state.stencilFunction.ref=C,this._state.stencilFunction.mask=G,this._stateTracker.invalidateStencilTest()};w.setStencilFunctionSeparate=
function(v,C,G,H){if(this._state.stencilFunction.face!==v||this._state.stencilFunction.func!==C||this._state.stencilFunction.ref!==G||this._state.stencilFunction.mask!==H)this.gl.stencilFuncSeparate(v,C,G,H),this._state.stencilFunction.face=v,this._state.stencilFunction.func=C,this._state.stencilFunction.ref=G,this._state.stencilFunction.mask=H,this._stateTracker.invalidateStencilTest()};w.setStencilWriteMask=function(v){this._state.stencilWriteMask!==v&&(this.gl.stencilMask(v),this._state.stencilWriteMask=
v,this._stateTracker.invalidateStencilWrite())};w.setStencilOp=function(v,C,G){if(this._state.stencilOperation.face!==c.Face.FRONT_AND_BACK||this._state.stencilOperation.fail!==v||this._state.stencilOperation.zFail!==C||this._state.stencilOperation.zPass!==G)this.gl.stencilOp(v,C,G),this._state.stencilOperation.face=c.Face.FRONT_AND_BACK,this._state.stencilOperation.fail=v,this._state.stencilOperation.zFail=C,this._state.stencilOperation.zPass=G,this._stateTracker.invalidateStencilTest()};w.setStencilOpSeparate=
function(v,C,G,H){if(this._state.stencilOperation.face!==v||this._state.stencilOperation.fail!==C||this._state.stencilOperation.zFail!==G||this._state.stencilOperation.zPass!==H)this.gl.stencilOpSeparate(v,C,G,H),this._state.stencilOperation.face=v,this._state.stencilOperation.fail=C,this._state.stencilOperation.zFail=G,this._state.stencilOperation.zPass=H,this._stateTracker.invalidateStencilTest()};w.setActiveTexture=function(v,C=!1){const G=this._state.activeTexture;0<=v&&(C||v!==this._state.activeTexture)&&
(this.gl.activeTexture(c.BASE_TEXTURE_UNIT+v),this._state.activeTexture=v);return G};w.clear=function(v){v&&this.gl.clear(v)};w.clearSafe=function(v,C=255){v&&(v&c.ClearBufferBit.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),v&c.ClearBufferBit.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),v&c.ClearBufferBit.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(C),this.gl.clear(v))};w.drawArrays=function(v,C,G){d.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=E(v,G));this.gl.drawArrays(v,
C,G);d.webglDebugEnabled()&&(v=n.getErrorString(this))&&console.error("drawArrays:",v)};w.drawElements=function(v,C,G,H){d.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=E(v,C));this.gl.drawElements(v,C,G,H);if(d.webglDebugEnabled()){const K=n.getErrorString(this);if(K){var L,O=this.getBoundVAO(),N=null==O?void 0:O.indexBuffer;O={indexBuffer:N,vertexBuffers:null==O?void 0:O.vertexBuffers};v={mode:v,count:C,type:G,offset:H};N=null!=(L=B.applySome(N,I=>I.size))?L:0;C=H+C;console.error(`drawElements: ${K}${N<
C?`. Buffer is too small. Attempted to draw index ${C} of ${N}`:""}`,{args:v,vao:O})}}};w.logIno=function(){d.webglDebugEnabled()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)};w.setViewport=function(v,C,G,H){G=Math.max(Math.round(G),1);H=Math.max(Math.round(H),1);const L=this._state.viewport;if(L.x!==v||L.y!==C||L.width!==G||L.height!==H)L.x=v,L.y=C,L.width=G,L.height=H,this.gl.viewport(v,C,G,H)};w.getViewport=function(){return{x:this._state.viewport.x,y:this._state.viewport.y,
width:this._state.viewport.width,height:this._state.viewport.height}};w.useProgram=function(v){var C,G;this._state.program!==v&&(null==(C=this._state.program)?void 0:C.stop(),this._state.program=v,this.gl.useProgram(null!=(G=null==v?void 0:v.glName)?G:null))};w.bindTexture=function(v,C,G=!1){(C>=this.parameters.maxTextureImageUnits||0>C)&&console.error("Input texture unit is out of range of available units!");const H=this._state.textureUnitMap[C];if(B.isNone(v)||null==v.glName)return B.isSome(H)&&
(this.setActiveTexture(C,G),this.gl.bindTexture(H.descriptor.target,null)),this._state.textureUnitMap[C]=null,H;if(!G&&H===v)return v.isDirty&&(this.setActiveTexture(C,G),v.applyChanges()),H;this.setActiveTexture(C,G);this.gl.bindTexture(v.descriptor.target,v.glName);v.applyChanges();this._state.textureUnitMap[C]=v;return H};w.unbindTextureAllUnits=function(v){for(let C=0;C<this.parameters.maxTextureImageUnits;C++)this._state.textureUnitMap[C]===v&&(this.bindTexture(null,C),this._state.textureUnitMap[C]=
null)};w.bindFramebuffer=function(v,C=!1){if(C||this._state.readFramebuffer!==v||this._state.drawFramebuffer!==v)B.isNone(v)?(this.gl.bindFramebuffer(c.FramebufferTarget.FRAMEBUFFER,null),this._state.readFramebuffer=null,this._state.drawFramebuffer=null):(v.initializeAndBind(c.FramebufferTarget.FRAMEBUFFER),this._state.readFramebuffer=v,this._state.drawFramebuffer=v)};w.bindFramebufferSeparate=function(v,C,G=!1){const H=C===c.FramebufferTarget.READ_FRAMEBUFFER,L=H?this._state.readFramebuffer:this._state.drawFramebuffer;
if(G||L!==v)B.isNone(v)?this.gl.bindFramebuffer(C,null):v.initializeAndBind(C),H?this._state.readFramebuffer=B.unwrapOr(v,null):this._state.drawFramebuffer=B.unwrapOr(v,null)};w.blitFramebuffer=function(v,C,G=0,H=0,L=v.width,O=v.height,N=0,K=0,I=C.width,M=C.height,U=c.ClearBufferBit.COLOR_BUFFER_BIT,T=c.TextureSamplingMode.NEAREST){this.bindFramebufferSeparate(v,c.FramebufferTarget.READ_FRAMEBUFFER);this.bindFramebufferSeparate(C,c.FramebufferTarget.DRAW_FRAMEBUFFER);this.gl.blitFramebuffer(G,H,L,
O,N,K,I,M,U,T)};w.bindBuffer=function(v,C){if(v){var G;null!=(G=C)?G:C=v.bufferType;switch(C){case c.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=A(this.gl,v,C,this._state.vertexBuffer);break;case c.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=A(this.gl,v,C,this._state.indexBuffer);break;case c.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=A(this.gl,v,C,this._state.uniformBuffer);break;case c.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=A(this.gl,v,C,this._state.pixelPackBuffer);
break;case c.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=A(this.gl,v,C,this._state.pixelUnpackBuffer);break;case c.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=A(this.gl,v,C,this._state.copyReadBuffer);break;case c.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=A(this.gl,v,C,this._state.copyWriteBuffer)}}};w.bindRenderbuffer=function(v){const C=this.gl;v||(C.bindRenderbuffer(C.RENDERBUFFER,null),this._state.renderbuffer=null);this._state.renderbuffer!==v&&(C.bindRenderbuffer(C.RENDERBUFFER,
v.glName),this._state.renderbuffer=v)};w._getBufferBinding=function(v,C){if(C>=this.parameters.maxUniformBufferBindings||0>C)return console.error("Uniform buffer binding point is out of range!"),null;v=this._state.uniformBufferBindingPoints;let G=v[C];B.isNone(G)&&(G={buffer:null,offset:0,size:0},v[C]=G);return G};w.bindBufferBase=function(v,C,G){const H=this._getBufferBinding(v,C);B.isNone(H)||H.buffer===G&&0===H.offset&&0===H.size||(this.gl.bindBufferBase(v,C,G?G.glName:null),H.buffer=G,H.offset=
0,H.size=0)};w.bindBufferRange=function(v,C,G,H,L){const O=this._getBufferBinding(v,C);B.isNone(O)||O.buffer===G&&O.offset===H&&O.size===L||(0!==H%this._parameters.uniformBufferOffsetAlignment?console.error("Uniform buffer binding offset is not a multiple of the context offset alignment"):(this.gl.bindBufferRange(v,C,G.glName,H,L),O.buffer=G,O.offset=H,O.size=L))};w.bindUBO=function(v,C,G,H){B.isNone(C)?this.bindBufferBase(c.BufferType.UNIFORM_BUFFER,v,null):(d.webglDebugEnabled()&&(null!=H?H:C.byteLength)>
this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),C.initialize(),void 0!==G&&void 0!==H?this.bindBufferRange(c.BufferType.UNIFORM_BUFFER,v,C.buffer,G,H):this.bindBufferBase(c.BufferType.UNIFORM_BUFFER,v,C.buffer))};w.unbindUBO=function(v){for(let C=0,G=this._state.uniformBufferBindingPoints.length;C<G;C++){const H=this._state.uniformBufferBindingPoints[C];B.isSome(H)&&H.buffer===v.buffer&&this.bindBufferBase(c.BufferType.UNIFORM_BUFFER,
C,null)}};w.unbindBuffer=function(v){switch(v){case c.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=A(this.gl,null,v,this._state.vertexBuffer);break;case c.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=A(this.gl,null,v,this._state.indexBuffer);break;case c.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=A(this.gl,null,v,this._state.uniformBuffer);break;case c.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=A(this.gl,null,v,this._state.pixelPackBuffer);break;case c.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=
A(this.gl,null,v,this._state.pixelUnpackBuffer);break;case c.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=A(this.gl,null,v,this._state.copyReadBuffer);break;case c.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=A(this.gl,null,v,this._state.copyWriteBuffer)}};w.bindVAO=function(v=null){B.isNone(v)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null):this._state.vertexArrayObject!==v&&(v.bind(),this._state.vertexArrayObject=v)};
w.clientWaitAsync=function(){var v=u._asyncToGenerator(function*(C=z.Milliseconds(10)){const G={};this.instanceCounter.increment(c.ResourceType.Sync,G);const H=this.gl,L=H.fenceSync(c.SyncCondition.SYNC_GPU_COMMANDS_COMPLETE,0);H.flush();let O;do yield D.after(C),O=H.clientWaitSync(L,0,0);while(O===c.ClientWaitSyncStatus.TIMEOUT_EXPIRED);H.deleteSync(L);this.instanceCounter.decrement(c.ResourceType.Sync,G);if(O===c.ClientWaitSyncStatus.WAIT_FAILED)throw Error("Client wait failed");});return function(){return v.apply(this,
arguments)}}();w.getBoundFramebufferObject=function(v=c.FramebufferTarget.FRAMEBUFFER){return v===c.FramebufferTarget.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer};w.getBoundVAO=function(){return this._state.vertexArrayObject};w.resetState=function(){this.useProgram(null);this.bindVAO(null);this.bindFramebuffer(null,!0);this.unbindBuffer(c.BufferType.ARRAY_BUFFER);this.unbindBuffer(c.BufferType.ELEMENT_ARRAY_BUFFER);q(this.gl)&&(this.unbindBuffer(c.BufferType.UNIFORM_BUFFER),
this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(c.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(c.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(c.BufferType.COPY_READ_BUFFER),this.unbindBuffer(c.BufferType.COPY_WRITE_BUFFER));for(let v=0;v<this.parameters.maxTextureImageUnits;++v)this.bindTexture(null,v);this.setBlendingEnabled(!1);this.setBlendFunction(c.BlendFactor.ONE,c.BlendFactor.ZERO);this.setBlendEquation(c.BlendOperation.ADD);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);
this.setCullFace(c.Face.BACK);this.setFrontFace(c.CullMode.CCW);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(c.CompareFunction.LESS);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(c.CompareFunction.ALWAYS,0,0);this.setStencilOp(c.StencilOperation.KEEP,c.StencilOperation.KEEP,c.StencilOperation.KEEP);
this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};w.enforceState=function(){var v,C;const G=this.gl;var H=this.capabilities.vao;H&&H.bindVertexArray(null);for(let I=0;I<this.parameters.maxVertexAttributes;I++)G.disableVertexAttribArray(I);this._state.vertexBuffer?G.bindBuffer(this._state.vertexBuffer.bufferType,
this._state.vertexBuffer.glName):G.bindBuffer(c.BufferType.ARRAY_BUFFER,null);this._state.indexBuffer?G.bindBuffer(this._state.indexBuffer.bufferType,this._state.indexBuffer.glName):G.bindBuffer(c.BufferType.ELEMENT_ARRAY_BUFFER,null);if(q(G)){var L,O;this._state.uniformBuffer?G.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):G.bindBuffer(c.BufferType.UNIFORM_BUFFER,null);for(var N=0;N<this._parameters.maxUniformBufferBindings;N++){var K=this._state.uniformBufferBindingPoints[N];
if(B.isSome(K)&&null!==K.buffer){const {buffer:I,offset:M,size:U}=K;0===M&&0===U?G.bindBufferBase(c.BufferType.UNIFORM_BUFFER,N,I.glName):G.bindBufferRange(c.BufferType.UNIFORM_BUFFER,N,I.glName,M,U)}else G.bindBufferBase(c.BufferType.UNIFORM_BUFFER,N,null)}this._state.pixelPackBuffer?G.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):G.bindBuffer(c.BufferType.PIXEL_PACK_BUFFER,null);this._state.pixelUnpackBuffer?G.bindBuffer(this._state.pixelUnpackBuffer.bufferType,
this._state.pixelUnpackBuffer.glName):G.bindBuffer(c.BufferType.PIXEL_UNPACK_BUFFER,null);this._state.copyReadBuffer?G.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):G.bindBuffer(c.BufferType.COPY_READ_BUFFER,null);this._state.copyWriteBuffer?G.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):G.bindBuffer(c.BufferType.COPY_WRITE_BUFFER,null);G.bindFramebuffer(c.FramebufferTarget.READ_FRAMEBUFFER,null);G.readBuffer(G.BACK);this._state.readFramebuffer&&
(G.bindFramebuffer(c.FramebufferTarget.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),G.readBuffer(c.ColorAttachment.COLOR_ATTACHMENT0));G.bindFramebuffer(c.FramebufferTarget.DRAW_FRAMEBUFFER,null!=(L=null==(O=this._state.drawFramebuffer)?void 0:O.glName)?L:null)}else this._state.readFramebuffer=this._state.drawFramebuffer,G.bindFramebuffer(c.FramebufferTarget.FRAMEBUFFER,null!=(N=null==(K=this._state.drawFramebuffer)?void 0:K.glName)?N:null);if(H&&this._state.vertexArrayObject){if(H=this._state.vertexArrayObject)this._state.vertexArrayObject.unbind(),
this._state.vertexArrayObject=null;this.bindVAO(H)}G.useProgram(null!=(v=null==(C=this._state.program)?void 0:C.glName)?v:null);G.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a);G.bindRenderbuffer(G.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null);!0===this._state.blend?G.enable(this.gl.BLEND):G.disable(this.gl.BLEND);G.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha);
G.blendFuncSeparate(this._state.blendFunction.srcRGB,this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha);G.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,this._state.clearColor.a);G.clearDepth(this._state.clearDepth);G.clearStencil(this._state.clearStencil);G.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a);G.cullFace(this._state.cullFace);G.depthFunc(this._state.depthFunction);
G.depthRange(this._state.depthRange.zNear,this._state.depthRange.zFar);!0===this._state.depthTest?G.enable(G.DEPTH_TEST):G.disable(G.DEPTH_TEST);G.depthMask(this._state.depthWrite);G.frontFace(this._state.frontFace);G.lineWidth(1);!0===this._state.faceCulling?G.enable(G.CULL_FACE):G.disable(G.CULL_FACE);G.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]);!0===this._state.polygonOffsetFill?G.enable(G.POLYGON_OFFSET_FILL):G.disable(G.POLYGON_OFFSET_FILL);G.scissor(this._state.scissorRect.x,
this._state.scissorRect.y,this._state.scissorRect.width,this._state.scissorRect.height);!0===this._state.scissorTest?G.enable(G.SCISSOR_TEST):G.disable(G.SCISSOR_TEST);G.stencilFunc(this._state.stencilFunction.func,this._state.stencilFunction.ref,this._state.stencilFunction.mask);G.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass);!0===this._state.stencilTest?G.enable(G.STENCIL_TEST):G.disable(G.STENCIL_TEST);
G.stencilMask(this._state.stencilWriteMask);for(v=0;v<this.parameters.maxTextureImageUnits;v++)G.activeTexture(c.BASE_TEXTURE_UNIT+v),G.bindTexture(c.TextureType.TEXTURE_2D,null),G.bindTexture(c.TextureType.TEXTURE_CUBE_MAP,null),q(G)&&(G.bindTexture(c.TextureType.TEXTURE_3D,null),G.bindTexture(c.TextureType.TEXTURE_2D_ARRAY,null)),C=this._state.textureUnitMap[v],B.isSome(C)&&G.bindTexture(C.descriptor.target,C.glName);G.activeTexture(c.BASE_TEXTURE_UNIT+this._state.activeTexture);G.viewport(this._state.viewport.x,
this._state.viewport.y,this._state.viewport.width,this._state.viewport.height);d.webglDebugEnabled()&&(this._numOfTriangles=this._numOfDrawCalls=0)};w._loadExtensions=function(){this.type===a.ContextType.WEBGL1&&this.gl.getExtension("OES_element_index_uint");this.gl.getExtension("KHR_parallel_shader_compile")};w._loadParameters=function(v){var C,G=this.capabilities.textureFilterAnisotropic;v=null!=(C=v.maxAnisotropy)?C:Infinity;C=q(this.gl);const H=this.gl;G={versionString:this.gl.getParameter(this.gl.VERSION),
maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:G?Math.min(this.gl.getParameter(G.MAX_TEXTURE_MAX_ANISOTROPY),v):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:C?H.getParameter(H.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:C?H.getParameter(H.MAX_VERTEX_UNIFORM_BLOCKS):
0,maxFragmentUniformBlocks:C?H.getParameter(H.MAX_FRAGMENT_UNIFORM_BLOCKS):0,maxUniformBlockSize:C?H.getParameter(H.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:C?H.getParameter(H.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:C?H.getParameter(H.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:C?H.getParameter(H.MAX_SAMPLES):1};k.Texture.TEXTURE_UNIT_FOR_UPDATES=G.maxTextureImageUnits-1;return G};u._createClass(F,[{key:"driverTest",get:function(){return this._driverTest}},{key:"contextAttributes",
get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){return this._parameters}},{key:"capabilities",get:function(){return this._capabilities}}]);return F}();t.RenderingContext=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/ContextState":function(){define(["exports","./enums"],function(t,u){t.ContextState=function(){this.blend=!1;this.blendColor={r:0,g:0,b:0,a:0};this.blendFunction={srcRGB:u.BlendFactor.ONE,dstRGB:u.BlendFactor.ZERO,srcAlpha:u.BlendFactor.ONE,
dstAlpha:u.BlendFactor.ZERO};this.blendEquation={mode:u.BlendOperation.ADD,modeAlpha:u.BlendOperation.ADD};this.colorMask={r:!0,g:!0,b:!0,a:!0};this.faceCulling=!1;this.cullFace=u.Face.BACK;this.frontFace=u.CullMode.CCW;this.scissorTest=!1;this.scissorRect={x:0,y:0,width:0,height:0};this.depthTest=!1;this.depthFunction=u.CompareFunction.LESS;this.clearDepth=1;this.depthWrite=!0;this.depthRange={zNear:0,zFar:1};this.viewport=null;this.polygonOffsetFill=this.stencilTest=!1;this.polygonOffset=[0,0];
this.stencilFunction={face:u.Face.FRONT_AND_BACK,func:u.CompareFunction.ALWAYS,ref:0,mask:1};this.clearStencil=0;this.stencilWriteMask=1;this.stencilOperation={face:u.Face.FRONT_AND_BACK,fail:u.StencilOperation.KEEP,zFail:u.StencilOperation.KEEP,zPass:u.StencilOperation.KEEP};this.clearColor={r:0,g:0,b:0,a:0};this.copyWriteBuffer=this.copyReadBuffer=this.pixelUnpackBuffer=this.pixelPackBuffer=this.uniformBuffer=this.indexBuffer=this.vertexBuffer=this.program=null;this.uniformBufferBindingPoints=[];
this.renderbuffer=this.drawFramebuffer=this.readFramebuffer=null;this.activeTexture=0;this.textureUnitMap=[]};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/InstanceCounter":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../support/AllocationTracer","./enums"],function(t,u,B,D){const z=new function(){this.RECORD_ALLOCATIONS=!1};let y=function(){function l(){this._current=[];this._max=[];for(this._allocations=new B.AllocationTracer(z.RECORD_ALLOCATIONS);this._current.length<
D.ResourceType.COUNT;)this._current.push(0),this._max.push(0)}var g=l.prototype;g.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};g.increment=function(d,a){const c=++this._current[d];this._max[d]=Math.max(c,this._max[d]);this._allocations.add(a)};g.decrement=function(d,a){--this._current[d];this._allocations.remove(a)};g.printResourceCount=function(){if(0<this.total){console.log("Live objects:");for(let d=0;d<D.ResourceType.COUNT;++d){const a=this._current[d];
0<a&&console.log(`${D.ResourceType[d]}: ${a}`)}}this._allocations.print()};u._createClass(l,[{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((d,a)=>d+a,0)}}]);return l}();t.InstanceCounter=y;t.test=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/support/AllocationTracer":function(){define(["exports"],function(t){let u=function(){function B(z){this._allocations=new Map;z?Error.stackTraceLimit=
Infinity:(this.add=()=>{},this.remove=()=>{})}var D=B.prototype;D.add=function(z){this._allocations.set(z,Error().stack)};D.remove=function(z){this._allocations.delete(z)};D.print=function(){if(0<this._allocations.size){console.log(`${this._allocations.size} live object allocations:`);const z=new Map;this._allocations.forEach(y=>{var l;z.set(y,(null!=(l=z.get(y))?l:0)+1)});z.forEach((y,l)=>{l=l.split("\n");l.shift();l.shift();console.log(`${y}: ${l.shift()}`);l.forEach(g=>console.log("   ",g))})}};
return B}();t.AllocationTracer=u;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/renderState":function(){define(["exports","../3d/webgl-engine/lib/basicInterfaces","./enums"],function(t,u,B){function D(N){return E.intern(N)}function z(N){return F.intern(N)}function y(N){return w.intern(N)}function l(N){return v.intern(N)}function g(N){return C.intern(N)}function d(N){return G.intern(N)}function a(N){return H.intern(N)}function c(N){return L.intern(N)}function e(N){return"["+
N.join(",")+"]"}function f(N){return N?e([N.srcRgb,N.srcAlpha,N.dstRgb,N.dstAlpha,N.opRgb,N.opAlpha,N.color.r,N.color.g,N.color.b,N.color.a]):null}function k(N){return N?e([N.face,N.mode]):null}function p(N){return N?e([N.factor,N.units]):null}function m(N){return N?e([N.func]):null}function b(N){return N?e([N.function.func,N.function.ref,N.function.mask,N.operation.fail,N.operation.zFail,N.operation.zPass]):null}function h(N){return N?e([N.zNear,N.zFar]):null}function n(N){return N?e([N.r,N.g,N.b,
N.a]):null}function r(N){return N?e([N.mask]):null}const x={face:B.Face.BACK,mode:B.CullMode.CCW},q={face:B.Face.FRONT,mode:B.CullMode.CCW};var A=function(){function N(K,I){this.makeKey=K;this.makeRef=I;this.interns=new Map}N.prototype.intern=function(K){if(!K)return null;const I=this.makeKey(K),M=this.interns;M.has(I)||M.set(I,this.makeRef(K));return M.get(I)};return N}();const E=new A(f,N=>({__tag:"Blending",...N})),F=new A(k,N=>({__tag:"Culling",...N})),w=new A(p,N=>({__tag:"PolygonOffset",...N})),
v=new A(m,N=>({__tag:"DepthTest",...N})),C=new A(b,N=>({__tag:"StencilTest",...N})),G=new A(h,N=>({__tag:"DepthWrite",...N})),H=new A(n,N=>({__tag:"ColorWrite",...N})),L=new A(r,N=>({__tag:"StencilWrite",...N})),O=new A(function(N){return N?e([f(N.blending),k(N.culling),p(N.polygonOffset),m(N.depthTest),b(N.stencilTest),h(N.depthWrite),n(N.colorWrite),r(N.stencilWrite)]):null},N=>({blending:D(N.blending),culling:z(N.culling),polygonOffset:y(N.polygonOffset),depthTest:l(N.depthTest),stencilTest:g(N.stencilTest),
depthWrite:d(N.depthWrite),colorWrite:a(N.colorWrite),stencilWrite:c(N.stencilWrite)}));A=function(){function N(I){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=I}var K=N.prototype;K.setPipeline=function(I){if(this._pipelineInvalid||I!==this._pipeline)this._setBlending(I.blending),this._setCulling(I.culling),this._setPolygonOffset(I.polygonOffset),
this._setDepthTest(I.depthTest),this._setStencilTest(I.stencilTest),this._setDepthWrite(I.depthWrite),this._setColorWrite(I.colorWrite),this._setStencilWrite(I.stencilWrite),this._pipeline=I;this._pipelineInvalid=!1};K.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};K.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};K.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};K.invalidateDepthTest=function(){this._pipelineInvalid=
this._depthTestInvalid=!0};K.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};K.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};K.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};K.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};K._setBlending=function(I){this._blending=this._setSubState(I,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=
!1};K._setCulling=function(I){this._culling=this._setSubState(I,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};K._setPolygonOffset=function(I){this._polygonOffset=this._setSubState(I,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};K._setDepthTest=function(I){this._depthTest=this._setSubState(I,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=
!1};K._setStencilTest=function(I){this._stencilTest=this._setSubState(I,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};K._setDepthWrite=function(I){this._depthWrite=this._setSubState(I,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};K._setColorWrite=function(I){this._colorWrite=this._setSubState(I,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=
!1};K._setStencilWrite=function(I){this._stencilWrite=this._setSubState(I,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};K._setSubState=function(I,M,U,T){if(U||I!==M)T(I),this._pipelineInvalid=!0;return I};return N}();t.StateTracker=A;t.backFaceCullingParams=x;t.cullingParams=N=>N===u.CullFaceOptions.Back?x:N===u.CullFaceOptions.Front?q:null;t.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};t.defaultDepthWriteParams={zNear:0,zFar:1};t.frontFaceCullingParams=
q;t.makeBlending=D;t.makeColorWrite=a;t.makeCulling=z;t.makeDepthTest=l;t.makeDepthWrite=d;t.makePipelineState=function(N){return O.intern(N)};t.makePolygonOffset=y;t.makeStencilTest=g;t.makeStencilWrite=c;t.separateBlendingParams=function(N,K,I,M,U=B.BlendOperation.ADD,T=B.BlendOperation.ADD,Q=[0,0,0,0]){return{srcRgb:N,srcAlpha:K,dstRgb:I,dstAlpha:M,opRgb:U,opAlpha:T,color:{r:Q[0],g:Q[1],b:Q[2],a:Q[3]}}};t.simpleBlendingParams=function(N,K,I=B.BlendOperation.ADD,M=[0,0,0,0]){return{srcRgb:N,srcAlpha:N,
dstRgb:K,dstAlpha:K,opRgb:I,opAlpha:I,color:{r:M[0],g:M[1],b:M[2],a:M[3]}}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/basicInterfaces":function(){define(["exports"],function(t){t.CullFaceOptions=void 0;(function(u){u[u.None=0]="None";u[u.Front=1]="Front";u[u.Back=2]="Back";u[u.COUNT=3]="COUNT"})(t.CullFaceOptions||(t.CullFaceOptions={}));t.DepthTestFunction=void 0;(function(u){u[u.Less=0]="Less";u[u.Lequal=1]="Lequal";u[u.COUNT=2]="COUNT"})(t.DepthTestFunction||
(t.DepthTestFunction={}));t.AntiAliasingMode=void 0;(function(u){u[u.NONE=0]="NONE";u[u.SMAA=1]="SMAA"})(t.AntiAliasingMode||(t.AntiAliasingMode={}));t.TransparencyPassType=void 0;(function(u){u[u.Color=0]="Color";u[u.Alpha=1]="Alpha";u[u.FrontFace=2]="FrontFace";u[u.NONE=3]="NONE";u[u.COUNT=4]="COUNT"})(t.TransparencyPassType||(t.TransparencyPassType={}));t.RenderRequestType=void 0;(function(u){u[u.BACKGROUND=0]="BACKGROUND";u[u.UPDATE=1]="UPDATE"})(t.RenderRequestType||(t.RenderRequestType={}));
t.ResourceState=void 0;(function(u){u[u.NOT_LOADED=0]="NOT_LOADED";u[u.LOADING=1]="LOADING";u[u.LOADED=2]="LOADED"})(t.ResourceState||(t.ResourceState={}));t.StencilBits=void 0;(function(u){u[u.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded";u[u.OutlineVisualElementMask=2]="OutlineVisualElementMask"})(t.StencilBits||(t.StencilBits={}));t.UpdatePolicy=void 0;(function(u){u[u.ASYNC=0]="ASYNC";u[u.SYNC=1]="SYNC"})(t.UpdatePolicy||(t.UpdatePolicy={}));t.Object3DState=void 0;(function(u){u[u.Highlight=
0]="Highlight";u[u.MaskOccludee=1]="MaskOccludee";u[u.COUNT=2]="COUNT"})(t.Object3DState||(t.Object3DState={}));t.PrimitiveType=void 0;(function(u){u[u.Triangle=0]="Triangle";u[u.Point=1]="Point";u[u.Line=2]="Line"})(t.PrimitiveType||(t.PrimitiveType={}));t.PowerOfTwoResizeMode=void 0;(function(u){u[u.STRETCH=1]="STRETCH";u[u.PAD=2]="PAD"})(t.PowerOfTwoResizeMode||(t.PowerOfTwoResizeMode={}));t.ValidationState=void 0;(function(u){u[u.CHANGED=0]="CHANGED";u[u.UNCHANGED=1]="UNCHANGED"})(t.ValidationState||
(t.ValidationState={}));t.AlphaDiscardMode=void 0;(function(u){u[u.Blend=0]="Blend";u[u.Opaque=1]="Opaque";u[u.Mask=2]="Mask";u[u.MaskBlend=3]="MaskBlend";u[u.COUNT=4]="COUNT"})(t.AlphaDiscardMode||(t.AlphaDiscardMode={}));t.Decorations=void 0;(function(u){u[u.OFF=0]="OFF";u[u.ON=1]="ON"})(t.Decorations||(t.Decorations={}));Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/WebGLDriverTest":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ./testDoublePrecisionArithmetic ./testFloatBufferBlend ./testSamplerPrecision ./testSVGPremultipliedAlpha".split(" "),
function(t,u,B,D,z,y,l){let g=function(){function d(a){this.context=a;this._floatBufferBlendWorking=z.testFloatBufferBlend(a);l.testSVGPremultipliedAlpha(a).then(c=>this._svgAlwaysPremultipliesAlpha=!c)}u._createClass(d,[{key:"floatBufferBlendWorking",get:function(){if(B.isNone(this._floatBufferBlendWorking))throw Error("floatBufferBlendWorking test not yet available");return this._floatBufferBlendWorking}},{key:"svgAlwaysPremultipliesAlpha",get:function(){if(B.isNone(this._svgAlwaysPremultipliesAlpha))throw Error("svgAlwaysPremultipliesAlpha test not yet available");
return this._svgAlwaysPremultipliesAlpha}},{key:"doublePrecisionRequiresObfuscation",get:function(){if(B.isNone(this._doublePrecisionRequiresObfuscation)){const a=D.testDoublePrecisionArithmetic(this.context,!1),c=D.testDoublePrecisionArithmetic(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==a&&(0===c||5<a/c)}return this._doublePrecisionRequiresObfuscation}},{key:"ignoresSamplerPrecision",get:function(){B.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=y.testSamplerPrecision(this.context));
return this._ignoresSamplerPrecision}}]);return d}();t.WebGLDriverTest=g;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/testDoublePrecisionArithmetic":function(){define("exports ../../core/floatRGBA ../../chunks/vec3f64 ./BufferObject ./doublePrecisionUtils ./enums ./FramebufferObject ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(t,u,B,D,z,y,l,g,d){t.testDoublePrecisionArithmetic=function(a,c){var e=new l.FramebufferObject(a,{colorTarget:y.TargetType.TEXTURE,
depthStencilTarget:y.DepthStencilTargetType.NONE},{target:y.TextureType.TEXTURE_2D,wrapMode:y.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:y.PixelFormat.RGBA,dataType:y.PixelType.UNSIGNED_BYTE,samplingMode:y.TextureSamplingMode.NEAREST,width:1,height:1});const f=D.BufferObject.createVertex(a,y.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),k=new g.VertexArrayObject(a,new Map([["position",0]]),{geometry:[new d.VertexElementDescriptor("position",2,y.DataType.UNSIGNED_SHORT,0,4)]},{geometry:f}),
p=B.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),m=B.fromValues(5633271.46742708,2626873.6381334523,1434963.231608387);c=a.programCache.acquire(`\n\n  precision highp float;\n\n  attribute vec2 position;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  ${c?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = dpPlusFrc(hiA, hiB);\n    vec3 e = dpMinusFrc(t1, hiA);\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = hiA + hiB;\n    vec3 e = t1 - hiA;\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT =\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat = 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color = float2rgba(val.z / 25.0);\n\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\n  }\n  `,
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",new Map([["position",0]]));var b=new Float32Array(6);z.encodeDoubleArray(p,b,3);var h=new Float32Array(6);z.encodeDoubleArray(m,h,3);a.useProgram(c);c.setUniform3f("u_highA",b[0],b[2],b[4]);c.setUniform3f("u_lowA",b[1],b[3],b[5]);c.setUniform3f("u_highB",h[0],h[2],h[4]);c.setUniform3f("u_lowB",h[1],h[3],h[5]);b=c;h=a.getBoundFramebufferObject();const {x:n,y:r,width:x,height:q}=a.getViewport();
a.bindFramebuffer(e);a.setViewport(0,0,1,1);a.bindVAO(k);a.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,4);c=new Uint8Array(4);e.readPixels(0,0,1,1,y.PixelFormat.RGBA,y.PixelType.UNSIGNED_BYTE,c);b.dispose();k.dispose(!1);f.dispose();e.dispose();a.setViewport(n,r,x,q);a.bindFramebuffer(h);a=(p[2]-m[2])/25;e=u.unpackFloatRGBA(c);return Math.abs(a-e)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/doublePrecisionUtils":function(){define(["exports"],function(t){function u(z,y,l){for(let g=
0;g<l;++g)y[2*g]=z[g],y[2*g+1]=z[g]-y[2*g]}const B=new Float64Array(1),D=new Float32Array(2);t.decodeDoubleArray=function(z,y,l){for(let g=0;g<l;++g)y[g]=z[2*g]+z[2*g+1]};t.encodeDouble=function(z,y){D[0]=z;D[1]=z-D[0];y[0]=D[0];y[1]=D[1]};t.encodeDoubleArray=u;t.encodeDoubleArraySplit=function(z,y,l,g){for(let d=0;d<g;++d)B[0]=z[d],u(B,D,1),y[d]=D[0],l[d]=D[1]};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/testFloatBufferBlend":function(){define("exports ../3d/webgl-engine/lib/OrderIndependentTransparency ./BufferObject ./context-util ./enums ./FramebufferObject ./renderState ./VertexArrayObject ./VertexElementDescriptor".split(" "),
function(t,u,B,D,z,y,l,g,d){var a={exports:{}};(function(c){(function(e){e=e();void 0!==e&&(c.exports=e)})(function(){function e(q){if(null==r){r={};x={};for(var A in q)"number"==typeof q[A]&&(r[q[A]]=A,x[A]=q[A])}}function f(){if(null==r)throw"WebGLDebugUtils.init(ctx) not called";}function k(q){f();var A=r[q];return void 0!==A?"gl."+A:"/*UNKNOWN WebGL ENUM*/ 0x"+q.toString(16)}function p(q,A,E,F){q=n[q];if(void 0!==q&&(q=q[A],void 0!==q&&q[E])){if("object"===typeof q[E]&&void 0!==q[E].enumBitwiseOr){A=
q[E].enumBitwiseOr;E=0;q=[];for(var w=0;w<A.length;++w){var v=x[A[w]];0!==(F&v)&&(E|=v,q.push(k(v)))}return E===F?q.join(" | "):k(F)}return k(F)}return null===F?"null":void 0===F?"undefined":F.toString()}function m(q,A,E){q.__defineGetter__(E,function(){return A[E]});q.__defineSetter__(E,function(F){A[E]=F})}function b(q,A,E,F){function w(L,O){return function(){E&&E(O,arguments);var N=L[O].apply(L,arguments),K=F.getError();0!=K&&(v[K]=!0,A(K,O,arguments));return N}}F=F||q;e(q);A=A||function(L,O,N){for(var K=
"",I=N.length,M=0;M<I;++M)K+=(0==M?"":", ")+p(O,I,M,N[M]);L="WebGL error "+k(L)+" in "+O+"("+K+")";window.console&&window.console.error?window.console.error(L):window.console&&window.console.log&&window.console.log(L)};var v={},C={},G;for(G in q)if("function"==typeof q[G])if("getExtension"!=G)C[G]=w(q,G);else{var H=w(q,G);C[G]=function(){var L=H.apply(q,arguments);return b(L,A,E,F)}}else m(C,q,G);C.getError=function(){for(var L in v)if(v.hasOwnProperty(L)&&v[L])return v[L]=!1,L;return q.NO_ERROR};
return C}function h(q){var A=q.getParameter(q.MAX_VERTEX_ATTRIBS),E=q.createBuffer();q.bindBuffer(q.ARRAY_BUFFER,E);for(var F=0;F<A;++F)q.disableVertexAttribArray(F),q.vertexAttribPointer(F,4,q.FLOAT,!1,0,0),q.vertexAttrib1f(F,0);q.deleteBuffer(E);A=q.getParameter(q.MAX_TEXTURE_IMAGE_UNITS);for(F=0;F<A;++F)q.activeTexture(q.TEXTURE0+F),q.bindTexture(q.TEXTURE_CUBE_MAP,null),q.bindTexture(q.TEXTURE_2D,null);q.activeTexture(q.TEXTURE0);q.useProgram(null);q.bindBuffer(q.ARRAY_BUFFER,null);q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,
null);q.bindFramebuffer(q.FRAMEBUFFER,null);q.bindRenderbuffer(q.RENDERBUFFER,null);q.disable(q.BLEND);q.disable(q.CULL_FACE);q.disable(q.DEPTH_TEST);q.disable(q.DITHER);q.disable(q.SCISSOR_TEST);q.blendColor(0,0,0,0);q.blendEquation(q.FUNC_ADD);q.blendFunc(q.ONE,q.ZERO);q.clearColor(0,0,0,0);q.clearDepth(1);q.clearStencil(-1);q.colorMask(!0,!0,!0,!0);q.cullFace(q.BACK);q.depthFunc(q.LESS);q.depthMask(!0);q.depthRange(0,1);q.frontFace(q.CCW);q.hint(q.GENERATE_MIPMAP_HINT,q.DONT_CARE);q.lineWidth(1);
q.pixelStorei(q.PACK_ALIGNMENT,4);q.pixelStorei(q.UNPACK_ALIGNMENT,4);q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!1);q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);q.UNPACK_COLORSPACE_CONVERSION_WEBGL&&q.pixelStorei(q.UNPACK_COLORSPACE_CONVERSION_WEBGL,q.BROWSER_DEFAULT_WEBGL);q.polygonOffset(0,0);q.sampleCoverage(1,!1);q.scissor(0,0,q.canvas.width,q.canvas.height);q.stencilFunc(q.ALWAYS,0,4294967295);q.stencilMask(4294967295);q.stencilOp(q.KEEP,q.KEEP,q.KEEP);q.viewport(0,0,q.canvas.width,q.canvas.height);
for(q.clear(q.COLOR_BUFFER_BIT|q.DEPTH_BUFFER_BIT|q.STENCIL_BUFFER_BIT);q.getError(););}var n={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},
texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},
bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,
1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},r=null,x=null;return{init:e,mightBeEnum:function(q){f();return void 0!==r[q]},glEnumToString:k,glFunctionArgToString:p,glFunctionArgsToString:function(q,A){for(var E="",F=A.length,
w=0;w<F;++w)E+=(0==w?"":", ")+p(q,F,w,A[w]);return E},makeDebugContext:b,makeLostContextSimulatingCanvas:function(q){function A(P){return"function"==typeof P?P:function(S){P.handleEvent(S)}}function E(){for(var P=Object.keys(J),S=0;S<P.length;++S)delete J[P]}function F(){++U;K||M==U&&q.loseContext()}function w(P,S){var W=P[S];return function(){F();if(!K)return W.apply(P,arguments)}}function v(P){return{statusMessage:P,preventDefault:function(){T=!0}}}function C(P){for(var S in P)"function"==typeof P[S]?
O[S]=w(P,S):m(O,P,S);O.getError=function(){F();if(!K)for(var V;V=G.getError();)J[V]=!0;for(V in J)if(J[V])return delete J[V],V;return O.NO_ERROR};var W="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(S=0;S<W.length;++S){var Z=W[S];O[Z]=function(V){return function(){F();if(K)return null;var Y=V.apply(P,arguments);Y.__webglDebugContextLostId__=N;I.push(Y);return Y}}(P[Z])}W="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(S=0;S<W.length;++S)Z=W[S],O[Z]=function(V){return function(){F();return K?null:V.apply(P,arguments)}}(O[Z]);W="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(S=0;S<W.length;++S)Z=W[S],O[Z]=function(V){return function(){F();return K?!1:V.apply(P,arguments)}}(O[Z]);O.checkFramebufferStatus=function(V){return function(){F();return K?O.FRAMEBUFFER_UNSUPPORTED:V.apply(P,arguments)}}(O.checkFramebufferStatus);O.getAttribLocation=function(V){return function(){F();
return K?-1:V.apply(P,arguments)}}(O.getAttribLocation);O.getVertexAttribOffset=function(V){return function(){F();return K?0:V.apply(P,arguments)}}(O.getVertexAttribOffset);O.isContextLost=function(){return K};return O}var G,H=[],L=[];var O={};var N=1,K=!1,I=[],M=0,U=0,T=!1,Q=0,J={};q.getContext=function(P){return function(){var S=P.apply(q,arguments);if(S instanceof WebGLRenderingContext){if(S!=G){if(G)throw"got different context";G=S;O=C(G)}return O}return S}}(q.getContext);(function(P){var S=P.addEventListener;
P.addEventListener=function(W,Z,V){switch(W){case "webglcontextlost":H.push(A(Z));break;case "webglcontextrestored":L.push(A(Z));break;default:S.apply(P,arguments)}}})(q);q.loseContext=function(){if(!K){K=!0;M=0;for(++N;G.getError(););E();J[G.CONTEXT_LOST_WEBGL]=!0;var P=v("context lost"),S=H.slice();setTimeout(function(){for(var W=0;W<S.length;++W)S[W](P);0<=Q&&setTimeout(function(){q.restoreContext()},Q)},0)}};q.restoreContext=function(){K&&L.length&&setTimeout(function(){if(!T)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var P=0;P<I.length;++P){var S=I[P];S instanceof WebGLBuffer?G.deleteBuffer(S):S instanceof WebGLFramebuffer?G.deleteFramebuffer(S):S instanceof WebGLProgram?G.deleteProgram(S):S instanceof WebGLRenderbuffer?G.deleteRenderbuffer(S):S instanceof WebGLShader?G.deleteShader(S):S instanceof WebGLTexture&&G.deleteTexture(S)}h(G);K=!1;U=0;T=!1;P=L.slice();S=v("context restored");for(var W=0;W<P.length;++W)P[W](S)},0)};q.loseContextInNCalls=function(P){if(K)throw"You can not ask a lost contet to be lost";
M=U+P};q.getNumCalls=function(){return U};q.setRestoreTimeout=function(P){Q=P};return q},resetToInitialState:h}})})(a);t.testFloatBufferBlend=function(c){var e,f,k;if(!c.gl)return!1;if(c.type===D.ContextType.WEBGL1){var p,m;return!(null==(p=c.capabilities.textureFloat)||!p.textureFloat||null==(m=c.capabilities.colorBufferFloat)||!m.textureFloat)}if(!((null==(e=c.capabilities.textureFloat)?0:e.textureFloat)&&(null==(f=c.capabilities.colorBufferFloat)?0:f.textureFloat)&&(null==(k=c.capabilities.colorBufferFloat)?
0:k.floatBlend)))return!1;e=new y.FramebufferObject(c,{colorTarget:z.TargetType.TEXTURE,depthStencilTarget:z.DepthStencilTargetType.NONE},{target:z.TextureType.TEXTURE_2D,wrapMode:z.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:z.PixelFormat.RGBA,dataType:z.PixelType.FLOAT,internalFormat:z.SizedPixelFormat.RGBA32F,samplingMode:z.TextureSamplingMode.NEAREST,width:1,height:1});f=B.BufferObject.createVertex(c,z.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1]));k=new g.VertexArrayObject(c,new Map([["a_pos",
0]]),{geometry:[new d.VertexElementDescriptor("a_pos",2,z.DataType.UNSIGNED_SHORT,0,4)]},{geometry:f});p=c.programCache.acquire("\n  precision highp float;\n  attribute vec2 a_pos;\n\n  void main() {\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n   precision highp float;\n\n   void main() {\n    gl_FragColor \x3d vec4(0.5, 0.5, 0.5, 0.5);\n   }\n  ",new Map([["a_pos",0]]));c.useProgram(p);m=c.getBoundFramebufferObject();const {x:b,y:h,width:n,height:r}=c.getViewport();c.bindFramebuffer(e);
c.setViewport(0,0,1,1);c.bindVAO(k);c.drawArrays(z.PrimitiveType.TRIANGLE_STRIP,0,4);var x=l.makePipelineState({blending:u.blendingAlpha});c.setPipelineState(x);c.drawArrays(z.PrimitiveType.TRIANGLE_STRIP,0,4);a.exports.init(c);x=c.gl.getError();c.setViewport(b,h,n,r);c.bindFramebuffer(m);p.dispose();k.dispose(!1);f.dispose();e.dispose();return 1282===x?(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1):!0};Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports","./basicInterfaces","../../../webgl/enums","../../../webgl/renderState"],function(t,u,B,D){const z=D.separateBlendingParams(B.BlendFactor.SRC_ALPHA,B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA,B.BlendFactor.ONE_MINUS_SRC_ALPHA),y=D.simpleBlendingParams(B.BlendFactor.ONE,B.BlendFactor.ONE),l=D.simpleBlendingParams(B.BlendFactor.ZERO,B.BlendFactor.ONE_MINUS_SRC_ALPHA),g={factor:-1,
units:-2};t.OITPolygonOffset=g;t.OITPolygonOffsetLimit=5E5;t.blendingAlpha=l;t.blendingColor=y;t.blendingDefault=z;t.getOITPolygonOffset=function(d){return d?g:null};t.oitBlending=function(d){return d===u.TransparencyPassType.FrontFace?null:d===u.TransparencyPassType.Alpha?l:y};t.oitDepthTest=function(d,a=B.CompareFunction.LESS){return d===u.TransparencyPassType.NONE||d===u.TransparencyPassType.FrontFace?a:B.CompareFunction.LEQUAL};t.oitDepthWrite=function(d){return d===u.TransparencyPassType.FrontFace?
D.defaultDepthWriteParams:null};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/testSamplerPrecision":function(){define("exports ../../core/Logger ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(t,u,B,D,z,y,l,g){const d=u.getLogger("esri.views.WebGLDriverTest");t.testSamplerPrecision=function(a){var c=new z.FramebufferObject(a,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE},
{target:D.TextureType.TEXTURE_2D,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,samplingMode:D.TextureSamplingMode.NEAREST,width:1,height:1});const e=new Uint8Array(4),f=B.BufferObject.createVertex(a,D.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),k=new l.VertexArrayObject(a,new Map([["a_position",0]]),{geometry:[new g.VertexElementDescriptor("a_position",2,D.DataType.SHORT,0,4)]},{geometry:f}),p=a.programCache.acquire("\nprecision highp float;\nattribute vec2 a_pos;\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",new Map([["a_pos",0]]));a.useProgram(p);var m=new y.Texture(a,{target:D.TextureType.TEXTURE_2D,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,samplingMode:D.TextureSamplingMode.NEAREST,width:1,height:1},new Uint8Array([2,255,0,0]));p.setUniform1i("u_texture",0);a.bindTexture(m,0);m=a.getBoundFramebufferObject();a.bindFramebuffer(c);a.useProgram(p);
const {x:b,y:h,width:n,height:r}=a.getViewport();a.setViewport(0,0,1,1);a.bindVAO(k);a.drawArrays(D.PrimitiveType.TRIANGLE_STRIP,0,4);a.setViewport(b,h,n,r);c.readPixels(0,0,1,1,D.PixelFormat.RGBA,D.PixelType.UNSIGNED_BYTE,e);p.dispose();k.dispose(!1);f.dispose();c.dispose();(c=255!==e[0]||255!==e[1]||255!==e[2]||255!==e[3])&&d.warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${e[0]}.${e[1]}.${e[2]}.${e[3]}]`);
a.bindFramebuffer(m);return c};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../2d/engine/webgl/DefaultVertexAttributeLayouts ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject".split(" "),function(t,u,B,D,z,y,l,g){function d(){d=u._asyncToGenerator(function*(a){const c=new Image;c.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";
c.width=5;c.height=5;yield c.decode();if(!a.gl)return!0;const e=new y.FramebufferObject(a,{colorTarget:z.TargetType.TEXTURE,depthStencilTarget:z.DepthStencilTargetType.NONE},{target:z.TextureType.TEXTURE_2D,wrapMode:z.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:z.PixelFormat.RGBA,dataType:z.PixelType.UNSIGNED_BYTE,samplingMode:z.TextureSamplingMode.NEAREST,width:1,height:1}),f=D.BufferObject.createVertex(a,z.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),k=new g.VertexArrayObject(a,new Map([["a_pos",
0]]),B.Pos2us,{geometry:f}),p=a.programCache.acquire("\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv \x3d a_pos;\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor \x3d texture2D(u_texture, v_uv);\n  }\n  ",new Map([["a_pos",0]]));a.useProgram(p);const m=new l.Texture(a,{dataType:z.PixelType.UNSIGNED_BYTE,
pixelFormat:z.PixelFormat.RGBA,preMultiplyAlpha:!1,wrapMode:z.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:z.TextureSamplingMode.LINEAR},c);a.bindTexture(m,0);p.setUniform1i("u_texture",0);const b=a.getBoundFramebufferObject(),{x:h,y:n,width:r,height:x}=a.getViewport();a.bindFramebuffer(e);a.setViewport(0,0,1,1);a.setClearColor(0,0,0,0);a.setBlendingEnabled(!1);a.clearSafe(z.ClearBufferBit.COLOR_BUFFER_BIT);a.bindVAO(k);a.drawArrays(z.PrimitiveType.TRIANGLE_STRIP,0,4);const q=new Uint8Array(4);e.readPixels(0,
0,1,1,z.PixelFormat.RGBA,z.PixelType.UNSIGNED_BYTE,q);p.dispose();k.dispose(!1);f.dispose();e.dispose();m.dispose();a.setViewport(h,n,r,x);a.bindFramebuffer(b);c.src="";return 255===q[0]});return d.apply(this,arguments)}t.testSVGPremultipliedAlpha=function(a){return d.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/Capabilities":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ./DisjointTimerQuery ./DrawBuffers ./Instancing ./load ./LoseContext ./VertexArrayObjects".split(" "),
function(t,u,B,D,z,y,l,g){let d=function(){function a(c,e){this.gl=c;this._fragDepth=this._shaderTextureLOD=this._standardDerivatives=this._depthTexture=null;this._disabledExtensions=e.disabledExtensions||{};this._debugWebGLExtensions=e.debugWebGLExtensions||{}}a.prototype.enable=function(c){return this[c]};u._createClass(a,[{key:"drawBuffers",get:function(){this._drawBuffers||(this._drawBuffers=D.load(this.gl,this._disabledExtensions));return this._drawBuffers}},{key:"instancing",get:function(){this._instancing||
(this._instancing=z.load(this.gl));return this._instancing}},{key:"vao",get:function(){this._vertexArrayObject||(this._vertexArrayObject=g.load(this.gl,this._disabledExtensions));return this._vertexArrayObject}},{key:"compressedTextureETC",get:function(){this._compressedTextureETC||(this._compressedTextureETC=y.loadCompressedTextureETC(this.gl,this._disabledExtensions));return this._compressedTextureETC}},{key:"compressedTextureS3TC",get:function(){this._compressedTextureS3TC||(this._compressedTextureS3TC=
y.loadCompressedTextureS3TC(this.gl,this._disabledExtensions));return this._compressedTextureS3TC}},{key:"textureFilterAnisotropic",get:function(){this._textureFilterAnisotropic||(this._textureFilterAnisotropic=y.loadTextureFilterAnisotropicCapability(this.gl,this._disabledExtensions));return this._textureFilterAnisotropic}},{key:"disjointTimerQuery",get:function(){this._disjointTimerQuery||(this._disjointTimerQuery=B.createDisjointTimerQuery(this.gl,this._disabledExtensions));return this._disjointTimerQuery}},
{key:"textureFloat",get:function(){this._textureFloat||(this._textureFloat=y.loadTextureFloat(this.gl,this._disabledExtensions));return this._textureFloat}},{key:"colorBufferFloat",get:function(){this._colorBufferFloat||(this._colorBufferFloat=y.loadColorBufferFloat(this.gl,this._disabledExtensions));return this._colorBufferFloat}},{key:"blendMinMax",get:function(){this._minMaxBlending||(this._minMaxBlending=y.loadMinMaxBlending(this.gl,this._disabledExtensions));return this._minMaxBlending}},{key:"depthTexture",
get:function(){null===this._depthTexture&&(this._depthTexture=y.loadBooleanExtension(this.gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return this._depthTexture}},{key:"standardDerivatives",get:function(){null===this._standardDerivatives&&(this._standardDerivatives=y.loadBooleanExtension(this.gl,this._disabledExtensions,"standardDerivatives",!0,["OES_standard_derivatives"]));return this._standardDerivatives}},{key:"shaderTextureLOD",
get:function(){null===this._shaderTextureLOD&&(this._shaderTextureLOD=y.loadBooleanExtension(this.gl,this._disabledExtensions,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return this._shaderTextureLOD}},{key:"fragDepth",get:function(){null===this._fragDepth&&(this._fragDepth=y.loadBooleanExtension(this.gl,this._disabledExtensions,"fragDepth",!0,["EXT_frag_depth"]));return this._fragDepth}},{key:"loseContext",get:function(){this._loseContext||(this._loseContext=l.load(this.gl,this._debugWebGLExtensions));
return this._loseContext}},{key:"textureNorm16",get:function(){this._textureNorm16||(this._textureNorm16=y.loadTextureNorm16(this.gl,this._disabledExtensions));return this._textureNorm16}}]);return a}();t.Capabilities=d;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(t,u){t.load=function(B,D){return D.disjointTimerQuery?null:u(B)?{drawBuffers:B.drawBuffers.bind(B),MAX_DRAW_BUFFERS:B.MAX_DRAW_BUFFERS,
MAX_COLOR_ATTACHMENTS:B.MAX_COLOR_ATTACHMENTS}:D.drawBuffers?null:(B=B.getExtension("WEBGL_draw_buffers"))?{drawBuffers:B.drawBuffersWEBGL.bind(B),MAX_DRAW_BUFFERS:B.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:B.MAX_COLOR_ATTACHMENTS_WEBGL}:null};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],function(t,u){t.load=function(B){return u(B)?{drawArraysInstanced:B.drawArraysInstanced.bind(B),drawElementsInstanced:B.drawElementsInstanced.bind(B),
vertexAttribDivisor:B.vertexAttribDivisor.bind(B)}:(B=B.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:B.drawArraysInstancedANGLE.bind(B),drawElementsInstanced:B.drawElementsInstancedANGLE.bind(B),vertexAttribDivisor:B.vertexAttribDivisorANGLE.bind(B)}:null};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/load":function(){define(["exports","./isWebGL2Context"],function(t,u){t.loadBooleanExtension=function(B,D,z,y,l){if(y&&u(B))return!0;if(D[z])return!1;
for(const g of l)if(B.getExtension(g))return!0;return!1};t.loadColorBufferFloat=function(B,D){if(u(B)){var z=!D.colorBufferFloat&&B.getExtension("EXT_color_buffer_half_float"),y=!D.colorBufferFloat&&B.getExtension("EXT_color_buffer_float");D=!D.floatBlend&&!D.colorBufferFloat&&B.getExtension("EXT_float_blend");return z||y||D?{textureFloat:!!y,textureHalfFloat:!!z,floatBlend:!!D,R16F:B.R16F,RG16F:B.RG16F,RGBA16F:B.RGBA16F,R32F:B.R32F,RG32F:B.RG32F,RGBA32F:B.RGBA32F,R11F_G11F_B10F:B.R11F_G11F_B10F,
RGB16F:B.RGB16F}:null}return B instanceof WebGLRenderingContext?(z=!D.colorBufferFloat&&B.getExtension("EXT_color_buffer_half_float"),y=!D.colorBufferFloat&&B.getExtension("WEBGL_color_buffer_float"),B=!D.floatBlend&&!D.colorBufferFloat&&B.getExtension("EXT_float_blend"),z||y||B?{textureFloat:!!y,textureHalfFloat:!!z,floatBlend:!!B,RGBA16F:z?z.RGBA16F_EXT:void 0,RGB16F:z?z.RGB16F_EXT:void 0,RGBA32F:y?y.RGBA32F_EXT:void 0}:null):null};t.loadCompressedTextureETC=function(B,D){return D.compressedTextureETC?
null:(B=B.getExtension("WEBGL_compressed_texture_etc"))?{COMPRESSED_R11_EAC:B.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:B.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:B.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:B.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:B.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:B.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:B.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:B.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,
COMPRESSED_RGBA8_ETC2_EAC:B.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:B.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null};t.loadCompressedTextureS3TC=function(B,D){return D.compressedTextureS3TC?null:(B=B.getExtension("WEBGL_compressed_texture_s3tc"))?{COMPRESSED_RGB_S3TC_DXT1:B.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:B.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:B.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:B.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null};t.loadMinMaxBlending=
function(B,D){return u(B)?{MIN:B.MIN,MAX:B.MAX}:D.blendMinMax?null:(B=B.getExtension("EXT_blend_minmax"))?{MIN:B.MIN_EXT,MAX:B.MAX_EXT}:null};t.loadTextureFilterAnisotropicCapability=function(B,D){return D.textureFilterAnisotropic?null:(B=B.getExtension("EXT_texture_filter_anisotropic")||B.getExtension("MOZ_EXT_texture_filter_anisotropic")||B.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))?{MAX_TEXTURE_MAX_ANISOTROPY:B.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:B.TEXTURE_MAX_ANISOTROPY_EXT}:
null};t.loadTextureFloat=function(B,D){if(u(B))return{textureFloat:!0,textureFloatLinear:!D.textureFloatLinear&&!!B.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!D.textureHalfFloatLinear&&!!B.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:B.HALF_FLOAT,R16F:B.R16F,RG16F:B.RG16F,RGBA16F:B.RGBA16F,R32F:B.R32F,RG32F:B.RG32F,RGBA32F:B.RGBA32F,R11F_G11F_B10F:B.R11F_G11F_B10F,RGB16F:B.RGB16F};if(B instanceof WebGLRenderingContext){const z=!D.textureHalfFloat&&
B.getExtension("OES_texture_half_float");return{textureFloat:!D.textureFloat&&!!B.getExtension("OES_texture_float"),textureFloatLinear:!D.textureFloatLinear&&!!B.getExtension("OES_texture_float_linear"),textureHalfFloat:!!z,textureHalfFloatLinear:!D.textureHalfFloatLinear&&!!B.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:z?z.HALF_FLOAT_OES:void 0}}return null};t.loadTextureNorm16=function(B,D){return!u(B)||D.textureNorm16?null:(B=B.getExtension("EXT_texture_norm16"))?{R16:B.R16_EXT,RG16:B.RG16_EXT,
RGB16:B.RGB16_EXT,RGBA16:B.RGBA16_EXT,R16_SNORM:B.R16_SNORM_EXT,RG16_SNORM:B.RG16_SNORM_EXT,RGB16_SNORM:B.RGB16_SNORM_EXT,RGBA16_SNORM:B.RGBA16_SNORM_EXT}:null};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],function(t){t.load=function(u,B){const D=B.loseContext&&u.getExtension("WEBGL_lose_context");return D?{loseRenderingContext:()=>D.loseContext()}:null};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports",
"./isWebGL2Context"],function(t,u){t.load=function(B,D){return u(B)?{createVertexArray:B.createVertexArray.bind(B),deleteVertexArray:B.deleteVertexArray.bind(B),bindVertexArray:B.bindVertexArray.bind(B)}:D.vao?null:(B=B.getExtension("OES_vertex_array_object")||B.getExtension("MOZ_OES_vertex_array_object")||B.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:B.createVertexArrayOES.bind(B),deleteVertexArray:B.deleteVertexArrayOES.bind(B),bindVertexArray:B.bindVertexArrayOES.bind(B)}:
null};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),function(t,u,
B,D,z,y,l,g,d,a,c,e,f){const k=y.getLogger("esri.views.2d.layers.labels.LabelManager");B=function(p){function m(h){h=p.call(this,h)||this;h._applyVisibilityPassThrottled=l.throttle(h._applyVisibilityPass,32,t._assertThisInitialized(h));h.lastUpdateId=-1;h.updateRequested=!1;h.view=null;return h}t._inheritsLoose(m,p);var b=m.prototype;b.initialize=function(){this.collisionEngine=new f.CollisionEngine};b.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=
null};b.update=function(h){this._applyVisibilityPassThrottled(h)};b.viewChange=function(){this.requestUpdate()};b.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};b.processUpdate=function(h){this._set("updateParameters",h);this.updateRequested&&(this.updateRequested=!1,this.update(h))};b._applyVisibilityPass=function(h){try{const n=this.view.featuresTilingScheme.getClosestInfoForScale(h.state.scale).level;this.collisionEngine.run(this.view.allLayerViews.items,
h,n)}catch(n){k.error(new D("mapview-labeling","Encountered an error during label decluttering",n))}};t._createClass(m,[{key:"updating",get:function(){return this.updateRequested}}]);return m}(z.HandleOwnerMixin(B));u.__decorate([g.property()],B.prototype,"updateRequested",void 0);u.__decorate([g.property({readOnly:!0})],B.prototype,"updateParameters",void 0);u.__decorate([g.property()],B.prototype,"updating",null);u.__decorate([g.property()],B.prototype,"view",void 0);return B=u.__decorate([e.subclass("esri.views.2d.layers.labels.LabelManager")],
B)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),function(t,u,B,D,z,y){function l(c,e){const f=[];c.forEachTile(k=>f.push(k));f.sort((k,p)=>k.instanceId-p.instanceId);f.forEach(k=>{u.isSome(k.labelMetrics)&&k.isReady&&e(k,k.labelMetrics.getCursor())})}function g(c){return e=>B.pt2px(y.getSizeForValueSimple(e,c))}function d(c){for(const f of c){var e;
c=("featureReduction"in f&&"cluster"===(null==(e=f.featureReduction)?void 0:e.type)&&f.featureReduction).labelingInfo||[];c=[...f.labelingInfo||[],...c];if(f.labelsVisible&&c.length&&c.some(k=>"none"===k.deconflictionStrategy))return!0}return!1}let a=function(){function c(){}var e=c.prototype;e.run=function(f,k,p){const m=[];for(let r=f.length-1;0<=r;r--)a:{var b=m,h=f[r];if("feature"!==h.layer.type&&"csv"!==h.layer.type&&"geojson"!==h.layer.type&&"ogc-feature"!==h.layer.type&&"stream"!==h.layer.type&&
"subtype-group"!==h.layer.type&&"wfs"!==h.layer.type)break a;const x=h.layer.geometryType,q=!d("subtype-group"===h.layer.type?h.layer.sublayers.items:[h.layer]),A={};if("subtype-group"!==h.layer.type){if("heatmap"===h.layer.renderer.type)break a;b:{var n=h.layer.renderer;if(n="visualVariables"in n&&n.visualVariables)for(const E of n)if("size"===E.type){n=g(E);break b}n=null}A[0]=n}n=h.tileRenderer;u.isNone(n)||b.push({tileRenderer:n,vvEvaluators:A,deconflictionEnabled:q,geometryType:x,visible:h.layer.visible&&
!h.suspended})}this._transformMetrics(m,k);this._runCollision(m,k,p)};e._runCollision=function(f,k,p){const [m,b]=k.state.size;k=new z.CollisionBitsetGrid(m*k.pixelRatio,b*k.pixelRatio);for(const {tileRenderer:h,deconflictionEnabled:n,visible:r}of f){const x=h.featuresView.attributeView;n?r?(this._prepare(h),this._collideVisible(k,h,p),this._collideInvisible(k,h)):l(h,(q,A)=>{for(;A.nextId();)x.setLabelMinZoom(A.id,255)}):l(h,(q,A)=>{for(;A.nextId();)x.setLabelMinZoom(A.id,0)})}};e._isFiltered=function(f,
k,p){k=k.getFilterFlags(f);f=!p.hasFilter||!!(k&D.FILTER_FLAG_0);p=!u.isSome(p.featureEffect)||p.featureEffect.excludedLabelsVisible||!!(k&D.EFFECT_FLAG_0);return!(f&&p)};e._prepare=function(f){const k=f.featuresView.attributeView,p=new Set;l(f,(m,b)=>{for(;b.nextId();)p.has(b.id)||(p.add(b.id),this._isFiltered(b.id,k,f.layerView)?k.setLabelMinZoom(b.id,254):0!==k.getLabelMinZoom(b.id)?k.setLabelMinZoom(b.id,255):k.setLabelMinZoom(b.id,0))})};e._collideVisible=function(f,k,p){const m=k.featuresView.attributeView,
b=new Set;l(k,(h,n)=>{for(;n.nextId();)if(!b.has(n.id))if(h.key.level!==p)m.setLabelMinZoom(n.id,254);else if(0===m.getLabelMinZoom(n.id))switch(f.insertMetrics(n)){case z.HAS_COLLISION:m.setLabelMinZoom(n.id,254);b.add(n.id);break;case z.NONE:m.setLabelMinZoom(n.id,0),b.add(n.id)}})};e._collideInvisible=function(f,k){const p=k.featuresView.attributeView,m=new Set;l(k,(b,h)=>{for(;h.nextId();)if(!m.has(h.id)&&255===p.getLabelMinZoom(h.id))switch(f.insertMetrics(h)){case z.HAS_COLLISION:p.setLabelMinZoom(h.id,
255);m.add(h.id);break;case z.NONE:p.setLabelMinZoom(h.id,0),m.add(h.id)}})};e._transformMetrics=function(f,k){for(const {tileRenderer:p,geometryType:m,vvEvaluators:b}of f)l(p,(h,n)=>{const r=p.featuresView.attributeView;h=h.transforms.labelMat2d;h[4]=Math.round(h[4]);h[5]=Math.round(h[5]);const x=h[4],q=h[5],A="polyline"===m;for(;n.next();){const G=n.boundsCount,H=n.anchorX,L=n.anchorY;var E=n.size,F=b[0];if(u.isSome(F)){var w=r.getVVSize(n.id);F=F(w);E=isNaN(F)||null==F||Infinity===F?E:F}F=E/2*
n.directionX;E=E/2*n.directionY;for(w=0;w<G;w++){var v=H,C=n.anchorY;A?(v=v+n.boundsX(w)+F,C=C+n.boundsY(w)+E,k.state.rotation?(v=h[0]*v+h[2]*C+h[4],C=h[1]*v+h[3]*C+h[5]):(v+=x,C+=q),n.setBoundsComputedAnchorX(w,Math.floor(v)),n.setBoundsComputedAnchorY(w,Math.floor(C))):(k.state.rotation?(v=h[0]*H+h[2]*L+h[4],C=h[1]*H+h[3]*L+h[5]):(v+=x,C+=q),v=v+n.boundsX(w)+F,C=C+n.boundsY(w)+E,n.setBoundsComputedAnchorX(w,v),n.setBoundsComputedAnchorY(w,C))}}})};return c}();t.CollisionEngine=a;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports","../../../../../core/mathUtils","../definitions","../../../layers/features/support/StaticBitSet"],function(t,u,B,D){let z=function(){function l(d,a){this.width=d;this.height=a;d=Math.ceil(d/1);a=Math.ceil(a/1);this._cols=d;this._rows=a;this._cells=D.StaticBitSet.create(d*a)}var g=l.prototype;g.insertMetrics=function(d){const a=this._hasCollision(d);0===a&&this._markMetrics(d);return a};g.getCellId=
function(d,a){return d+a*this._cols};g.has=function(d){return this._cells.has(d)};g.hasRange=function(d,a){return this._cells.hasRange(d,a)};g.set=function(d){this._cells.set(d)};g.setRange=function(d,a){this._cells.setRange(d,a)};g._hasCollision=function(d){const a=d.id;let c=0,e=0;d.save();do{const f=d.boundsCount;c+=f;for(let k=0;k<f;k++){const p=d.boundsComputedAnchorX(k),m=d.boundsComputedAnchorY(k),b=d.boundsWidth(k)+2,h=d.boundsHeight(k)+2;switch(this._collide(p,m,b,h)){case 2:return 2;case 1:e++}}}while(d.peekId()===
a&&d.next());d.restore();return c===e?1:0};g._collide=function(d,a,c,e){d-=c/2;a-=e/2;c=d+c;var f=a+e;if(0>c||0>f||d>this.width||a>this.height)return 1;e=u.clamp(Math.floor(d/1),0,this._cols);var k=u.clamp(Math.floor(a/1),0,this._rows);d=u.clamp(Math.ceil(c/1),0,this._cols);a=u.clamp(Math.ceil(f/1),0,this._rows);for(c=k;c<=a;c++)for(f=e;f<=d;f++)if(k=this.getCellId(f,c),this.has(k))return 2;return 0};g._mark=function(d,a,c,e){d-=c/2;a-=e/2;c=d+c;var f=a+e;e=u.clamp(Math.floor(d/1),0,this._cols);var k=
u.clamp(Math.floor(a/1),0,this._rows);d=u.clamp(Math.ceil(c/1),0,this._cols);a=u.clamp(Math.ceil(f/1),0,this._rows);for(c=k;c<=a;c++)for(f=e;f<=d;f++)k=this.getCellId(f,c),this.set(k);return!1};g._markMetrics=function(d){const a=d.id;do{const c=d.boundsCount;for(let e=0;e<c;e++){const f=d.boundsComputedAnchorX(e),k=d.boundsComputedAnchorY(e),p=d.boundsWidth(e)+2,m=d.boundsHeight(e)+2;this._mark(f,k,p,m)}}while(d.peekId()===a&&d.next())};return l}(),y=function(){function l(d,a=2){this._bucketSize=
d;this._rowsLength=B.TILE_SIZE/d;this._colsLength=B.TILE_SIZE/d;this._elementsPerBucket=a;this._grid=this._initGrid()}var g=l.prototype;g.checkOverlap=function(d,a){d=Math.floor(d/this._bucketSize);a=Math.floor(a/this._bucketSize);return 0>d||d>=this._rowsLength||0>a||a>=this._colsLength?!0:this._grid[a*this._colsLength+d]>=this._elementsPerBucket};g.markUsed=function(d,a){this._grid[Math.floor(a/this._bucketSize)*this._colsLength+Math.floor(d/this._bucketSize)]+=1};g.reset=function(){this._grid=
this._initGrid()};g._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};return l}();t.CollisionBitsetGrid=z;t.CollisionGrid=y;t.HAS_COLLISION=2;t.NONE=0;t.OUTSIDE_EXTENT=1;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(t){let u=function(){function B(z,y){this._mask=0;this._buf=z;this._mask=y}B.fromBuffer=function(z,y){return new B(z,y)};B.create=function(z,y=4294967295){z=new Uint32Array(Math.ceil(z/
32));return new B(z,y)};var D=B.prototype;D._getIndex=function(z){return Math.floor(z/32)};D.has=function(z){z&=this._mask;return!!(this._buf[this._getIndex(z)]&1<<z%32)};D.hasRange=function(z,y){for(;z%32&&z!==y;){if(this.has(z))return!0;z++}for(;y%32&&z!==y;){if(this.has(z))return!0;y--}if(z===y)return!1;for(z/=32;z!==y/32;z++)if(this._buf[z])return!0;return!1};D.set=function(z){z&=this._mask;const y=this._getIndex(z);this._buf[y]|=1<<z%32};D.setRange=function(z,y){for(;z%32&&z!==y;)this.set(z++);
for(;y%32&&z!==y;)this.set(y--);if(z!==y)for(z/=32;z!==y/32;z++)this._buf[z]=4294967295};D.unset=function(z){z&=this._mask;const y=this._getIndex(z);this._buf[y]&=4294967295^1<<z%32};D.resize=function(z){const y=this._buf;z=new Uint32Array(Math.ceil(z/32));z.set(y);this._buf=z};D.or=function(z){for(let y=0;y<this._buf.length;y++)this._buf[y]|=z._buf[y];return this};D.and=function(z){for(let y=0;y<this._buf.length;y++)this._buf[y]&=z._buf[y];return this};D.xor=function(z){for(let y=0;y<this._buf.length;y++)this._buf[y]^=
z._buf[y];return this};D.ior=function(z){for(let y=0;y<this._buf.length;y++)this._buf[y]|=~z._buf[y];return this};D.iand=function(z){for(let y=0;y<this._buf.length;y++)this._buf[y]&=~z._buf[y];return this};D.ixor=function(z){for(let y=0;y<this._buf.length;y++)this._buf[y]^=~z._buf[y];return this};D.any=function(){for(let z=0;z<this._buf.length;z++)if(this._buf[z])return!0;return!1};D.copy=function(z){for(let y=0;y<this._buf.length;y++)this._buf[y]=z._buf[y];return this};D.clone=function(){return new B(this._buf.slice(),
this._mask)};D.clear=function(){for(let z=0;z<this._buf.length;z++)this._buf[z]=0};D.forEachSet=function(z){for(let y=0;y<this._buf.length;y++){let l=this._buf[y],g=32*y;if(l)for(;l;)l&1&&z(g),l>>>=1,g++}};D.countSet=function(){let z=0;this.forEachSet(y=>{z++});return z};return B}();t.StaticBitSet=u;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils",
"../../../../../renderers/visualVariables/support/sizeVariableUtils"],function(t,u,B,D){function z(d,a){switch(a.transformationType){case D.TransformationType.Additive:var c=y(a.minSize,d);return d+=c||a.minDataValue;case D.TransformationType.Constant:return c=(c=a.stops)&&c.length&&c[0].size,null==c&&(c=a.minSize),d=y(c,d);case D.TransformationType.ClampedLinear:c=(d-a.minDataValue)/(a.maxDataValue-a.minDataValue);var e=y(a.minSize,d),f=y(a.maxSize,d);d=d<=a.minDataValue?e:d>=a.maxDataValue?f:e+
c*(f-e);return d;case D.TransformationType.Proportional:return c=d/a.minDataValue,e=y(a.minSize,d),d=y(a.maxSize,d),d=u.clamp(c*e,e,d);case D.TransformationType.Stops:{const [k,p,m]=l(d,a.cache.ipData);k===p?d=y(a.stops[k].size,d):(c=y(a.stops[k].size,d),d=y(a.stops[p].size,d),d=c+(d-c)*m)}return d;case D.TransformationType.RealWorldSize:{c=B.meterIn[a.valueUnit];e=y(a.minSize,d);f=y(a.maxSize,d);({valueRepresentation:a}=a);let k=null;k="area"===a?2*Math.sqrt(d/g)/c:"radius"===a||"distance"===a?2*
d/c:d/c;d=u.clamp(k,e,f)}return d;case D.TransformationType.Identity:return d;case D.TransformationType.Unknown:return null}}function y(d,a){return"number"===typeof d?d:z(a,d)}function l(d,a){if(a){var c=0,e=a.length-1;a.some((f,k)=>{if(d<f)return e=k,!0;c=k;return!1});return[c,e,(d-a[c])/(a[e]-a[c])]}}const g=Math.PI;t.getSizeForValueSimple=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/BidiText ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/CIMSymbolHelper ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ./GraphicStore ./graphicsUtils ../support/cimSymbolUtils ../../../layers/GraphicsView ../../../webgl/capabilities ../features/createSymbolSchema".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h,n,r,x,q,A,E,F,w,v,C,G,H,L,O,N,K,I,M,U,T,Q){function J(S,W,Z){if(Z.has(S))return Z.get(S);W={tile:W,addedOrModified:[],removed:[]};Z.set(S,W);return W}const P=y("esri-2d-graphic-debug");B=function(S){function W(V){V=S.call(this,V)||this;V._storage=new O.ComputedAttributeStorage;V._displayIds=new Map;V._controller=new AbortController;V._tiles=new Map;V._graphicStoreUpdate=!1;V._graphicsSet=new Set;V._matcher=Promise.resolve(null);V._tileUpdateSet=new Set;
V._tilesToUpdate=new Map;V._graphicIdToAbortController=new Map;V._attached=!1;V._updatingGraphicsTimer=null;V._hashToExpandedSymbol=new Map;V._hashToExpandedSymbolPromise=new Map;V._hashToCIMSymbolPromise=new Map;V._hashToCIM=new Map;V._processing=!1;V._needsProcessing=!1;V._pendingUpdate={added:new Set,updated:new Set,removed:new Set};V.lastUpdateId=-1;V.updateRequested=!1;V.graphicUpdateHandler=V.graphicUpdateHandler.bind(t._assertThisInitialized(V));return V}t._inheritsLoose(W,S);var Z=W.prototype;
Z.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null;this._hashToCIM.clear();this._hashToCIMSymbolPromise.clear();this._hashToExpandedSymbolPromise.clear()};Z._createMatcher=function(V,Y,X){V&&(V=H.createMatcherSchema({indexCount:0,
fields:{}},"feature",V),this._matcher=G.createMatcher(V,Y,null,X))};Z._createDisplayId=function(V){this._displayIds.has(V)||this._displayIds.set(V,this._storage.createDisplayId());return this._displayIds.get(V)};Z.initialize=function(){this._attributeStore=new L({type:"local",initialize:Y=>Promise.resolve(this.container.attributeView.initialize(Y)),update:Y=>this.container.attributeView.requestUpdate(Y),render:()=>this.container.requestRender()},T.getWebGL1Capabilities());this.container.hasHighlight=
()=>this._attributeStore.hasHighlight;const V=new C.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._graphicStore=new K(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,Y=>{this._createDisplayId(Y.uid);this._setFilterState(Y.uid,Y.visible)},Y=>{const X=this._displayIds.get(Y.uid);this._displayIds.delete(Y.uid);this._storage.releaseDisplayId(X)},this._hashToCIM);this._meshFactory=new v.WGLMeshFactory(null,
this.uid,V);this._templateStore=V;this.handles.add([this.watch("renderer",Y=>{this._createMatcher(Y,V,this.container.stage.resourceManager);for(const X of this.graphics)this._pendingUpdate.updated.add(X);this.requestUpdate()}),this.view.graphicsTileStore.on("update",Y=>this._onTileUpdate(Y)),this.container.on("attach",()=>{P&&this.container.enableRenderingBounds(()=>this._graphicStore.getAllBounds());0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,added:this.graphics.items,
removed:[],moved:[]});this.handles.add(this.graphics.on("change",X=>this._graphicsChangeHandler(X)),"graphics");const Y=this.container.stage.resourceManager;this._createMatcher(this.renderer,V,Y);this._graphicStore.setResourceManager(Y);this._attached=!0;this.notifyChange("updating")})]);this._onTileUpdate({added:this.view.graphicsTileStore.tiles,removed:[]})};Z.hitTest=function(V){if(!this.view||!this.view.position)return null;const {resolution:Y,rotation:X}=this.view.state;return this._graphicStore.hitTest(V.x,
V.y,2,Y,X)};Z.update=function(V){g.throwIfAborted(this._controller.signal);({resolution:V}=V.state);this._graphicStore.updateLevel(V);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};Z.viewChange=function(){this.requestUpdate()};Z.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};Z.processUpdate=function(V){this.updateRequested&&(this.updateRequested=
!1,this.update(V))};Z.graphicUpdateHandler=function(V){const {graphic:Y,property:X,newValue:R}=V;switch(X){case "attributes":case "geometry":case "symbol":this._pendingUpdate.updated.add(Y);this.requestUpdate();break;case "visible":this._setFilterState(Y.uid,R),this._attributeStore.sendUpdates()}};Z.setHighlight=function(V){const Y=V.map(X=>this._displayIds.get(X));this._attributeStore.setHighlight(V,Y)};Z._getIntersectingTiles=function(V){V=this._graphicStore.getBounds(V);if(!V||0===k.width(V)||
0===k.height(V))return[];const Y=I.intersectingInternationalDateline(V,this.view.spatialReference);return l.isSome(Y)?[...new Set([...this.view.graphicsTileStore.boundsIntersections(Y[0]),...this.view.graphicsTileStore.boundsIntersections(Y[1])])]:this.view.graphicsTileStore.boundsIntersections(V)};Z._updateTile=function(){var V=t._asyncToGenerator(function*(Y){g.throwIfAborted(this._controller.signal);const X=Y.tile;var R=this._getGraphicsData(this._templateStore,X,Y.addedOrModified);R=yield this._processGraphics(X,
R);g.throwIfAborted(this._controller.signal);this._patchTile(X.key,{type:"update",addOrUpdate:R,remove:Y.removed,end:!0,clear:!1,sort:!1});return R});return function(Y){return V.apply(this,arguments)}}();Z._patchTile=function(V,Y){this._tiles.has(V)&&(V=this._tiles.get(V),this.container.onTileData(V,Y),this.container.requestRender())};Z._graphicsChangeHandler=function(V){const Y=this._pendingUpdate;for(const X of V.added)Y.added.add(X);for(const X of V.moved)Y.updated.add(X);for(const X of V.removed)this._pendingUpdate.added.has(X)?
Y.added.delete(X):Y.removed.add(X);this._processing?this._needsProcessing=!0:this._updateGraphics()};Z._getGraphicsToUpdate=function(){const V={added:[],removed:[],updated:[]};if(!this.graphics)return V;const Y=this._pendingUpdate;for(const X of this.graphics.items)Y.added.has(X)?V.added.push(X):Y.updated.has(X)&&V.updated.push(X);for(const X of Y.removed)this._graphicStore.has(X)&&V.removed.push(X);Y.added.clear();Y.removed.clear();Y.updated.clear();return V};Z._updateGraphics=function(){var V=t._asyncToGenerator(function*(){this._processing=
!0;const {added:Y,removed:X,updated:R}=this._getGraphicsToUpdate(),aa=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var {resolution:ba}=this.view.state;this._graphicStore.updateLevel(ba)}ba=[];const ia=Array(Y.length+X.length);for(let fa=0;fa<R.length;fa++){var ca=R[fa];const ka=this._getIntersectingTiles(ca);for(const la of ka){var da=la.id;J(da,la,aa).removed.push(this._displayIds.get(ca.uid))}ba.push(this._updateGraphic(ca,null));ia[fa]=ca}var ea=R.length;for(ca=0;ca<Y.length;ca++){const fa=
Y[ca];ia[ea+ca]=fa;this._graphicsSet.add(fa);ba.push(this._addGraphic(fa))}for(const fa of X){this._abortProcessingGraphic(fa.uid);const ka=this._getIntersectingTiles(fa);for(const la of ka)da=la.id,J(da,la,aa).removed.push(this._displayIds.get(fa.uid));this._graphicsSet.delete(fa);this._graphicStore.remove(fa)}this._flipUpdatingGraphics();yield Promise.all(ba);let ha;for(ea=0;ea<ia.length;ea++){ha=ia[ea];const fa=this._getIntersectingTiles(ha);for(const ka of fa)da=ka.id,J(da,ka,aa).addedOrModified.push(ha)}this._graphicStore.updateZ();
da=[];for(const [,fa]of aa)da.push(this._updateTile(fa));yield Promise.all(da)}catch(ia){g.isAbortError(ia)}for(const ia of X)try{const ha=yield this._getSymbolForGraphic(ia,{});if(ha){const fa=ha.hash();this._hashToExpandedSymbol.delete(fa)}}catch(ha){g.isAbortError(ha)}aa.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())});return function(){return V.apply(this,arguments)}}();Z._getArcadeInfo=function(V){const Y=(V.attributes?
Object.keys(V.attributes):[]).map(X=>({name:X,alias:X,type:"string"===typeof V.attributes[X]?"esriFieldTypeString":"esriFieldTypeDouble"}));return l.isNone(V.geometry)?null:{geometryType:m.getJsonType(V.geometry),spatialReference:f.fromJSON(V.geometry.spatialReference),fields:Y}};Z._getSymbolForGraphic=function(V,Y){g.throwIfAborted(this._controller.signal);return l.isSome(V.symbol)?Promise.resolve(V.symbol):l.isSome(this.renderer)?this.renderer.getSymbolAsync(V,{scale:this.view.scale,abortOptions:Y}):
Promise.resolve(this._getNullSymbol(V))};Z._getCIMSymbol=function(V,Y,X){var R=this._hashToCIM.get(Y);if(R)return Promise.resolve(R);V=r.symbolToCIM(V);if(l.isSome(V)){if("CIMSymbolReference"===V.type)return R=V,this._hashToCIM.set(Y,R),Promise.resolve(R);if(R=this._hashToCIMSymbolPromise.get(Y))return R;R=V.fetchCIMSymbol(X).then(aa=>{this._hashToCIM.set(Y,aa.data);this._hashToCIMSymbolPromise.delete(Y);return aa}).catch(aa=>{this._hashToCIMSymbolPromise.delete(Y);g.throwIfAbortError(aa);return null});
this._hashToCIMSymbolPromise.set(Y,R);return R}return Promise.resolve(null)};Z._expandCIMSymbol=function(V,Y,X,R){var aa=this._hashToExpandedSymbol.get(X);if(aa)return Promise.resolve(aa);if(aa=this._hashToExpandedSymbolPromise.get(X))return aa;aa=this.container.stage;Y=this._getArcadeInfo(Y);const ba=H.createSymbolSchemaOptions(null);V=Q.createSymbolSchema(V,ba);aa=M.expandSymbol(V,Y,aa.resourceManager,R);this._hashToExpandedSymbolPromise.set(X,aa);aa.then(ca=>{this._hashToExpandedSymbol.set(X,ca);
this._hashToExpandedSymbolPromise.delete(X);return ca});return aa};Z._getSymbolResources=function(){var V=t._asyncToGenerator(function*(Y,X){g.throwIfAborted(this._controller.signal);return this.container.stage?this._getSymbolForGraphic(Y,X).then(R=>{const aa=R.hash();return this._getCIMSymbol(R,aa,X).then(ba=>l.isNone(ba)?null:this._expandCIMSymbol(ba,Y,aa,X).then(ca=>{const da=ca.layers.filter(ea=>"text"===ea.type&&"string"===typeof ea.text);if(da&&0<da.length){const ea=Array(da.length);for(let ha=
0;ha<da.length;ha++){const fa=da[ha],ka=[],[la]=D.bidiText(fa.text);for(let pa=0;pa<la.length;pa++)ka.push(la.charCodeAt(pa));ea[ha]={symbol:fa,id:ha,glyphIds:ka}}const ia=new Map;return this.container.getMaterialItems(ea).then(ha=>{for(let fa=0;fa<da.length;fa++){const ka=da[fa];ia.set(ka.cim,{text:ka.text,mosaicItem:ha[fa].mosaicItem})}return{symbol:ca,textInfo:ia,hash:aa}})}return{symbol:ca,hash:aa}}))}).catch(R=>{g.throwIfAbortError(R);return null}):null});return function(Y,X){return V.apply(this,
arguments)}}();Z._projectAndNormalizeGeometry=function(){var V=t._asyncToGenerator(function*(Y,X){g.throwIfAborted(this._controller.signal);if(l.isNone(Y.geometry)||"mesh"===Y.geometry.type)return null;var R=Y.geometry;m.isPolygon(R)?R.rings=R.rings:m.isPolyline(R)?R.paths=R.paths:m.isExtent(R)&&(Y=yield this._getSymbolForGraphic(Y,X),g.throwIfAborted(this._controller.signal),R=I.isMarkerSymbol(Y.type)||I.isTextSymbol(Y.type)?R.center:I.polygonFromExtent(R));yield n.checkProjectionSupport(R.spatialReference,
this.view.spatialReference);Y=b.normalizeCentralMeridianSync(R);R=n.project(Y,R.spatialReference,this.view.spatialReference);p.closeRingsAndFixWinding(R);return R});return function(Y,X){return V.apply(this,arguments)}}();Z._onTileUpdate=function(V){const Y=h.getInfo(this.view.spatialReference);if(V.added&&0<V.added.length)for(const X of V.added)this._addNewTile(X,Y);if(V.removed&&0<V.removed.length)for(const X of V.removed)this._removeTile(X.key)};Z._addGraphic=function(){var V=t._asyncToGenerator(function*(Y){this._abortProcessingGraphic(Y.uid);
g.throwIfAborted(this._controller.signal);var X=new AbortController;this._graphicIdToAbortController.set(Y.uid,X);X={signal:X.signal};try{yield this._addOrUpdateGraphic(Y,X),g.throwIfAborted(this._controller.signal),this._graphicIdToAbortController.delete(Y.uid)}catch(R){if(this._graphicIdToAbortController.delete(Y.uid),!g.isAbortError(R))throw R;}});return function(Y){return V.apply(this,arguments)}}();Z._updateGraphic=function(V,Y){g.throwIfAborted(this._controller.signal);const X=this._projectAndNormalizeGeometry(V,
Y);Y=this._getSymbolResources(V,Y);return Promise.all([X,Y]).then(([R,aa])=>{g.throwIfAborted(this._controller.signal);this._graphicStore.addOrModify(V,aa,R)})};Z._addOrUpdateGraphic=function(V,Y){g.throwIfAborted(this._controller.signal);const X=this._projectAndNormalizeGeometry(V,Y);Y=this._getSymbolResources(V,Y);return Promise.all([X,Y]).then(([R,aa])=>{g.throwIfAborted(this._controller.signal);this._graphicsSet.has(V)&&this._graphicStore.addOrModify(V,aa,R)})};Z._addTile=function(V){var Y=this.view.featuresTilingScheme.getTileBounds(k.create(),
V);Y=new A.GraphicTile(V,Y[0],Y[3]);this._tiles.set(V,Y);this.container.addChild(Y);return Y};Z._addNewTile=function(){var V=t._asyncToGenerator(function*(Y,X){const R=this._addTile(Y.key),aa=this._graphicStore.queryTileData(this._templateStore,Y);if(0!==aa.length){if(X){X=Math.round((X.valid[1]-X.valid[0])/Y.resolution);for(var ba of aa)ba.geometry&&(m.isPoint(ba.geometry)||m.isMultipoint(ba.geometry))&&this._wrapPoints(ba,X)}ba=Y.key;this._tileUpdateSet.add(Y.key);this.notifyChange("updating");
try{const ca={type:"update",clear:!1,addOrUpdate:yield this._processGraphics(Y,aa),remove:[],end:!0,sort:!1};R.patch(ca);this._tileUpdateSet.delete(ba);this.notifyChange("updating")}catch(ca){if(this._tileUpdateSet.delete(ba),this.notifyChange("updating"),!g.isAbortError(ca))throw ca;}}});return function(Y,X){return V.apply(this,arguments)}}();Z._removeTile=function(V){if(this._tiles.has(V)){var Y=this._tiles.get(V);this.container.removeChild(Y);Y.destroy();this._tiles.delete(V)}};Z._setFilterState=
function(V,Y){const X=this._displayIds.get(V);V=this._attributeStore.getHighlightFlag(V);this._attributeStore.setData(X,0,0,V|(Y?q.FILTER_FLAG_0:0))};Z._getGraphicsData=function(V,Y,X){const R=h.getInfo(this.view.spatialReference);V=this._graphicStore.getGraphicsData(V,Y,X);if(R){Y=Math.round((R.valid[1]-R.valid[0])/Y.resolution);for(const aa of V)aa.geometry&&(m.isPoint(aa.geometry)||m.isMultipoint(aa.geometry))&&this._wrapPoints(aa,Y)}return V};Z._wrapPoints=function(V,Y){const X=V.geometry;m.isMultipoint(X)?
this._wrapMultipoint(X,Y):this._wrapPoint(V,Y)};Z._wrapMultipoint=function(V,Y){var X=V.points;const R=[];let aa=0,ba=0;for(const [ca,da]of X)R.push([ca+aa,da]),aa=0,Y===I.TILE_SIZE?(X=5*I.PIXEL_BUFFER,ca+ba<X?(R.push([Y,0]),aa=-Y):ca+ba>I.TILE_SIZE-X&&(R.push([-Y,0]),aa=Y)):ca+ba<-I.PIXEL_BUFFER?(R.push([Y,0]),aa=-Y):ca+ba>I.TILE_SIZE+I.PIXEL_BUFFER&&(R.push([-Y,0]),aa=Y),ba+=ca;V.points=R};Z._wrapPoint=function(V,Y){const X=V.geometry;if(Y===I.TILE_SIZE){const R=5*I.PIXEL_BUFFER;X.x<R?V.geometry=
{points:[[X.x,X.y],[Y,0]]}:X.x>I.TILE_SIZE-R&&(V.geometry={points:[[X.x,X.y],[-Y,0]]})}else X.x<-I.PIXEL_BUFFER?V.geometry={points:[[X.x,X.y],[Y,0]]}:X.x>I.TILE_SIZE+I.PIXEL_BUFFER&&(V.geometry={points:[[X.x,X.y],[-Y,0]]})};Z._processGraphics=function(V,Y,X){if(!Y||!Y.length||!this._meshFactory)return null;const R=N.GraphicsReader.from(Y),aa=this._meshFactory;return this._matcher.then(ba=>aa.analyzeGraphics(R,this.container.stage.resourceManager,ba,null,null,X).then(()=>{this._attributeStore.sendUpdates();
return this._processAnalyzedGraphics(V,R)}))};Z._processAnalyzedGraphics=function(V,Y){const X=this._meshFactory;var R=Y.getSize();Y=Y.getCursor();const aa=new w.MeshData(V.key.id,{features:R,records:R,metrics:0},{fill:"default"},!1,!1);for(R=[];Y.next();){const ba=Y.readGraphic();ba.insertAfter=-1===ba.insertAfter?-1:this._displayIds.get(ba.insertAfter);ba.displayId=this._displayIds.get(ba.attributes[this.uid]);const ca=new F(ba.displayId);ca.insertAfter=ba.insertAfter;R.push(ca);X.writeGraphic(aa,
Y,V.level,this.container.stage.resourceManager)}V=aa.serialize(V.tileInfoView.tileInfo.isWrappable);return 1!==V.length?new E.TileData:E.TileData.fromVertexData(V[0].message,R)};Z._abortProcessingGraphic=function(V){this._graphicIdToAbortController.has(V)&&this._graphicIdToAbortController.get(V).abort()};Z._getNullSymbol=function(V){V=V.geometry;return m.isPolyline(V)?x.errorPolylineSymbol2D:m.isPolygon(V)||m.isExtent(V)?x.errorPolygonSymbol2D:x.errorPointSymbol2D};Z._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&
clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};t._createClass(W,[{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size}}]);return W}(U.GraphicsView(z.HandleOwnerMixin(B)));u.__decorate([d.property({constructOnly:!0})],B.prototype,"requestUpdateCallback",void 0);u.__decorate([d.property()],
B.prototype,"container",void 0);u.__decorate([d.property({constructOnly:!0})],B.prototype,"graphics",void 0);u.__decorate([d.property()],B.prototype,"updating",null);u.__decorate([d.property()],B.prototype,"view",void 0);u.__decorate([d.property()],B.prototype,"updateRequested",void 0);return B=u.__decorate([e.subclass("esri.views.2d.layers.support.GraphicsView2D")],B)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ./aaBoundingRect ./boundsUtils ./intersectsBase ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),
function(t,u,B,D,z,y,l){function g(b,h){const n=y.getGeometryParts(b);for(const r of n)for(const x of r)x[0]+=h;return b}function d(b,h){if(!h)return b;const n=c(b,h).map(r=>r.extent);return 2>n.length?n[0]||b:2<n.length?(b.xmin=h.valid[0],b.xmax=h.valid[1],b):{rings:n.map(r=>[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]])}}function a(b,h,n){if(Array.isArray(b)){var r=b[0];r>h?(n=y.offsetMagnitude(r,h),b[0]=r+-2*n*h):r<n&&(h=y.offsetMagnitude(r,n),b[0]=r+-2*h*n)}else r=
b.x,r>h?(n=y.offsetMagnitude(r,h),b.x+=-2*n*h):r<n&&(h=y.offsetMagnitude(r,n),b.x+=-2*h*n);return b}function c(b,h){const n=[],{ymin:r,ymax:x}=b;var q=b.xmax-b.xmin,A=b.xmin,E=b.xmax;const [F,w]=h.valid;var v=e(b.xmin,h);var C=v.x;const G=v.frameId;v=e(b.xmax,h);b=v.x;v=v.frameId;h=C===b&&0<q;if(q>2*w){q={xmin:A<E?C:b,ymin:r,xmax:w,ymax:x};A={xmin:F,ymin:r,xmax:A<E?b:C,ymax:x};E={xmin:0,ymin:r,xmax:w,ymax:x};C={xmin:F,ymin:r,xmax:0,ymax:x};b=[];h=[];f(q,E)&&b.push(G);f(q,C)&&h.push(G);f(A,E)&&b.push(v);
f(A,C)&&h.push(v);for(let H=G+1;H<v;H++)b.push(H),h.push(H);n.push({extent:q,frameIds:[G]},{extent:A,frameIds:[v]},{extent:E,frameIds:b},{extent:C,frameIds:h})}else C>b||h?n.push({extent:{xmin:C,ymin:r,xmax:w,ymax:x},frameIds:[G]},{extent:{xmin:F,ymin:r,xmax:b,ymax:x},frameIds:[v]}):n.push({extent:{xmin:C,ymin:r,xmax:b,ymax:x},frameIds:[G]});return n}function e(b,h){const [n,r]=h.valid;h=2*r;var x=0;b>r?(x=Math.ceil(Math.abs(b-r)/h),b-=x*h):b<n&&(x=Math.ceil(Math.abs(b-n)/h),b+=x*h,x=-x);return{x:b,
frameId:x}}function f(b,h){const {xmin:n,ymin:r,xmax:x,ymax:q}=h;return k(b,n,r)&&k(b,n,q)&&k(b,x,q)&&k(b,x,r)}function k(b,h,n){return h>=b.xmin&&h<=b.xmax&&n>=b.ymin&&n<=b.ymax?!0:!1}let p=function(){function b(){}b.prototype.cut=function(h,n){let r;if(h.rings)this.closed=!0,r=h.rings,this.minPts=4;else if(h.paths)this.closed=!1,r=h.paths,this.minPts=2;else return null;const x=r.length;n*=-2;for(let q=0;q<x;q++){const A=r[q];if(A&&A.length>=this.minPts){const E=[];for(const F of A)E.push([F[0]+
n,F[1]]);r.push(E)}}this.closed?h.rings=r:h.paths=r;return h};return b}();const m=u.create();t.normalizeCentralMeridianSync=function(b){if(!b)return null;let h=null;var n=b.spatialReference,r=l.getInfo(n);if(!r)return"toJSON"in b?b.toJSON():b;var x=l.isWebMercator(n)?102100:4326;const q=y.cutParams[x].maxX,A=y.cutParams[x].minX;n=y.cutParams[x].plus180Line;x=y.cutParams[x].minus180Line;let E;b="toJSON"in b?b.toJSON():b;if(z.isPoint(b))E=a(b,q,A);else if(z.isMultipoint(b))b.points=b.points.map(F=>
a(F,q,A)),E=b;else if(z.isExtent(b))E=d(b,r);else if(z.isPolygon(b)||z.isPolyline(b)){B.getBoundsXY(m,b);r={xmin:m[0],ymin:m[1],xmax:m[2],ymax:m[3]};const F=2*y.offsetMagnitude(r.xmin,A)*q;b=0===F?b:g(b,F);r.xmin+=F;r.xmax+=F;D.extentIntersectsPolyline(r,n)&&r.xmax!==q?h=b:D.extentIntersectsPolyline(r,x)&&r.xmin!==A?h=b:E=b}else E=b;return null!==h?(new p).cut(h,q):E};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(t,u,B,D,z,y,l){function g(m,b){if(!b)return null;if("x"in b){var h={x:0,y:0};[h.x,h.y]=m(b.x,b.y,e);null!=b.z&&(h.z=b.z);null!=b.m&&(h.m=b.m);return h}if("xmin"in b)return h={xmin:0,ymin:0,xmax:0,ymax:0},[h.xmin,h.ymin]=m(b.xmin,b.ymin,e),[h.xmax,h.ymax]=m(b.xmax,b.ymax,e),b.hasZ&&(h.zmin=b.zmin,h.zmax=b.zmax,h.hasZ=!0),b.hasM&&(h.mmin=b.mmin,h.mmax=b.mmax,h.hasM=!0),h;if("rings"in b)return{rings:d(b.rings,m),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:d(b.paths,m),hasM:b.hasM,hasZ:b.hasZ};
if("points"in b)return{points:a(b.points,m),hasM:b.hasM,hasZ:b.hasZ}}function d(m,b){const h=[];for(const n of m)h.push(a(n,b));return h}function a(m,b){const h=[];for(const n of m)m=b(n[0],n[1],[0,0]),h.push(m),2<n.length&&m.push(n[2]),3<n.length&&m.push(n[3]);return h}function c(){c=u._asyncToGenerator(function*(m,b){b&&(m=Array.isArray(m)?m.map(h=>B.isSome(h.geometry)&&h.geometry.spatialReference):[m],yield D.initializeProjection(m.map(h=>({source:h,dest:b}))))});return c.apply(this,arguments)}
const e=[0,0],f=g.bind(null,l.lngLatToXY),k=g.bind(null,l.xyToLngLat),p=new (function(){function m(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var b=m.prototype;b.push=function(){var h=u._asyncToGenerator(function*(n,r,x){if(!(n&&n.length&&r&&x)||y.equals(r,x))return n;const q={geometries:n,inSpatialReference:r,outSpatialReference:x,resolve:null};this._jobs.push(q);return new Promise(A=>{q.resolve=A;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(n,
r,x){return h.apply(this,arguments)}}();b._process=function(){this._timer=null;const h=this._jobs.shift();if(h){var {geometries:n,inSpatialReference:r,outSpatialReference:x,resolve:q}=h;l.canProject(r,x)?y.isWebMercator(x)?q(n.map(f)):q(n.map(k)):q(D.projectMany(z.jsonAdapter,n,r,x,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return m}());t.checkProjectionSupport=function(m,b){return c.apply(this,arguments)};t.project=function(m,b,h){if(!m)return m;h||(h=b,b=m.spatialReference);
return y.isValid(b)&&y.isValid(h)&&!y.equals(b,h)?l.canProject(b,h)?(m=y.isWebMercator(h)?f(m):k(m),m.spatialReference=h,m):D.projectMany(z.jsonAdapter,[m],b,h,null)[0]:m};t.projectMany=function(m,b,h){return p.push(m,b,h)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(t){let u=function(l,g,d){this.x=l;this.y=g;this.spatialReference=d;this.m=this.z=void 0},B=function(l,g,d,a){this.rings=l;this.spatialReference=g;this.hasM=
this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},D=function(l,g,d,a){this.paths=l;this.spatialReference=g;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},z=function(l,g,d,a){this.points=l;this.spatialReference=g;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},y=function(l,g,d,a,c){this.xmin=l;this.ymin=g;this.xmax=d;this.ymax=a;this.spatialReference=c;this.mmax=this.mmin=this.zmax=this.zmin=void 0};t.jsonAdapter={convertToGEGeometry:function(l,g){return null==g?null:
l.convertJSONToGeometry(g)},exportPoint:function(l,g,d){d=new u(l.getPointX(g),l.getPointY(g),d);const a=l.hasZ(g),c=l.hasM(g);a&&(d.z=l.getPointZ(g));c&&(d.m=l.getPointM(g));return d},exportPolygon:function(l,g,d){return new B(l.exportPaths(g),d,l.hasZ(g),l.hasM(g))},exportPolyline:function(l,g,d){return new D(l.exportPaths(g),d,l.hasZ(g),l.hasM(g))},exportMultipoint:function(l,g,d){return new z(l.exportPoints(g),d,l.hasZ(g),l.hasM(g))},exportExtent:function(l,g,d){var a=l.hasZ(g);const c=l.hasM(g);
d=new y(l.getXMin(g),l.getYMin(g),l.getXMax(g),l.getYMax(g),d);a&&(a=l.getZExtent(g),d.zmin=a.vmin,d.zmax=a.vmax);c&&(l=l.getMExtent(g),d.mmin=l.vmin,d.mmax=l.vmax);return d}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(t,u,B,D,z,y){y=function(l){function g(){var a=l.apply(this,arguments)||this;a._data=
null;a._displayList=null;a._lastCommitTime=0;a._hasData=!1;a._invalidated=!1;a._wglBuffers=null;a._dirtyMap=new B;return a}u._inheritsLoose(g,l);var d=g.prototype;d.destroy=function(){l.prototype.destroy.call(this);this.clear()};d.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};d.getDisplayList=function(){return this._displayList};d.patch=function(a){if(!0===a.clear)this.clear(),this._hasData=!1;else{var c=a.addOrUpdate,e=a.remove;!this._data&&
c&&c.tileDisplayData.displayObjects.length?(c.tileDisplayData.computeDisplayList(),this._dirtyMap=new B,this._dispRecStore=D.fromTileData(c,this._dirtyMap),this._data=c,this._dirtyMap.markAllDirty(),this._hasData=!0,a.end&&this.ready()):this._data?c&&c.tileDisplayData.displayObjects.length||e.length?this._doPatchData(a):a.end&&this.ready():a.end&&this.ready();a.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};d.commit=function(a){if(!a.time||a.time!==this._lastCommitTime)if(this._lastCommitTime=
a.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new z(a.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};d.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),
this._wglBuffers=null)};d._doPatchData=function(a){this._invalidated=!0;this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=D.fromTileData(this._data,this._dirtyMap));this.requestRender()};d._patchData=function(a){let c=!0;var e=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],f=(a.remove||[]).slice();for(var k of e)null!=k.insertAfter&&f.push(k.id);for(var p of f)if(f=this._data.tileDisplayData.displayObjectRegistry.get(p)){this._data.tileDisplayData.displayList.removeFromList(f.displayRecords);
for(var m of f.displayRecords)this._dispRecStore.delete(m);this._data.tileDisplayData.displayObjectRegistry.delete(p);f=this._data.tileDisplayData.displayObjects.indexOf(f);this._data.tileDisplayData.displayObjects.splice(f,1)}for(const r of e){e=this._data.tileDisplayData.displayObjectRegistry.get(r.id);let x;if(e){p=e.displayRecords;e.set(r);e.displayRecords=p;p=e.displayRecords.length;for(m=0;m<p;++m)if(f=e.displayRecords[m],k=r.displayRecords[m],m>=r.displayRecords.length||f.geometryType!==k.geometryType||
f.symbolLevel!==k.symbolLevel||f.zOrder!==k.zOrder||f.materialKey!==k.materialKey)this._dispRecStore.delete(e.displayRecords[m]),m<r.displayRecords.length&&(e.displayRecords[m]=void 0);e.displayRecords.length=r.displayRecords.length}else if(e=r.copy(),e.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(r.id,e),p=this._data.tileDisplayData.displayObjects,null!=e.insertAfter?(x={},0<=e.insertAfter?(m=this._data.tileDisplayData.displayObjectRegistry.get(e.insertAfter))?(k=p.indexOf(m)+
1,k<p.length?p.splice(k,0,e):(p.push(e),k=p.length)):(p.push(e),k=p.length):(p.unshift(e),k=0)):(p.push(e),k=p.length),x)for(m=0<r.displayRecords.length?1:0,f=0,--k;0<=k&&f<m;--k)for(var b=p[k].displayRecords.length-1;0<=b&&f<m;--b){var h=p[k].displayRecords[b],n=this._data.tileDisplayData.displayList.getDPInfoType();x[n]||(x[n]=h,++f)}p=r.displayRecords.length;for(m=0;m<p;++m){f=r.displayRecords[m];(k=e.displayRecords[m])?(k.meshData=f.meshData,k.materialKey=f.materialKey):(k=f.copy(),k.vertexFrom=
void 0,k.indexFrom=void 0,e.displayRecords[m]=k);h=f.geometryType;b=this._data.tileDisplayData.displayList.getDPInfoType();n=a.addOrUpdate.tileBufferData.geometries[h];h=n.vertexBuffer;n=n.indexBuffer;let q=void 0;x&&(q=x[b]?this._data.tileDisplayData.displayList.splitAfter(x[b]):-1);c=this._dispRecStore.setMeshData(k,f,h,n,q)&&c;x&&null!=k.indexFrom&&null!=k.indexFrom&&(x[b]=k)}}return c};u._createClass(g,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){var a;
return null!=(a=this._displayObjects)?a:[]}}]);return g}(y.WGLTile);t.GraphicTile=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(function(){return function(){function t(){this._dirties=[{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,
indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1}]}var u=t.prototype;u.hasDirty=function(){return this._dirties.some(B=>-1!==B.indexCount||B.allDirty)};u.markAllClean=function(){for(const B of this._dirties)B.indexFrom=-1,B.indexCount=-1,B.vertexFrom=-1,B.vertexCount=-1,B.allDirty=!1};u.markAllDirty=function(){for(const B of this._dirties)B.allDirty=!0};u.forEach=function(B){for(let D=0;D<this._dirties.length;++D){const {indexCount:z,indexFrom:y,vertexCount:l,
vertexFrom:g,allDirty:d}=this._dirties[D],a={};let c=void 0,e=!1;if(d||-1!==g&&0<l)a.geometry={count:l,from:g,allDirty:d},e=!0;if(d||-1!==y&&0<z)c={count:z,from:y,allDirty:d},e=!0;e&&B({indices:c,vertices:a},D)}};u.markDirtyIndices=function(B,D,z){B=this._dirties[B];if(!B.allDirty)if(-1!==B.indexCount){const y=Math.min(B.indexFrom,D);D=Math.max(B.indexFrom+B.indexCount,D+z)-y;B.indexFrom=y;B.indexCount=D}else B.indexFrom=D,B.indexCount=z};u.markDirtyVertices=function(B,D,z,y){B=this._dirties[B];B.allDirty||
(-1!==B.vertexCount?(D=Math.min(B.vertexFrom,z),z=Math.max(B.vertexFrom+B.vertexCount,z+y)-D,B.vertexFrom=D,B.vertexCount=z):(B.vertexFrom=z,B.vertexCount=y))};return t}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has","./FreeList","./Utils"],function(t,u,B){const D=["FILL","LINE","MARKER","TEXT","LABEL"];return function(){function z(l,g,d,a){this._strides=l;this._displayList=g;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=d;for(const c in l){this._freeListsAndStorage[c]=
{vtxFreeList:a?new u.FreeList(a):null,idxFreeList:a?new u.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null};for(const e in l[c])this._freeListsAndStorage[c].vertexBuffers[e]={data:a?B.allocateTypedArrayBuffer(a,l[c][e]):null,stride:l[c][e]}}}z.fromTileData=function(l,g){var d,a=l.getStrides(),c={};for(d=0;d<a.length;d++)c[D[d]]=a[d];d=c;a=[0,0,0,0,0];c=[0,0,0,0,0];var e=l.tileDisplayData.displayObjects;for(var f of e)for(var k of f.displayRecords)a[k.geometryType]=Math.max(a[k.geometryType],
k.vertexFrom+k.vertexCount),c[k.geometryType]=Math.max(c[k.geometryType],k.indexFrom+k.indexCount);g=new z(d,l.tileDisplayData.displayList,g,null);for(f=0;f<l.tileBufferData.geometries.length;++f){k=a[f];e=c[f];var p=l.tileBufferData.geometries[f];d=g._storageFor(D[f]);const m=l.tileBufferData.geometries[f].indexBuffer;d.indexBuffer=m;d.idxFreeList=new u.FreeList(m.length);d.idxFreeList.allocate(e);let b;for(const h in p.vertexBuffer)e=l.tileBufferData.geometries[f].vertexBuffer[h],d.vertexBuffers[h].data=
e.data,d.vertexBuffers[h].stride=e.stride,p=B.strideToPackingFactor(e.stride),e=e.data.length*p/e.stride,b||(b=e);d.vtxFreeList=new u.FreeList(b);d.vtxFreeList.allocate(k)}return g};var y=z.prototype;y.delete=function(l){const g=D[l.geometryType];this._freeVertices(g,l.vertexFrom,l.vertexCount);this._freeIndices(g,l.indexFrom,l.indexCount);this._displayList.removeFromList(l);l.vertexFrom=void 0;l.indexFrom=void 0};y.setMeshData=function(l,g,d,a,c){const e=D[l.geometryType];l.meshData=null;let f=void 0,
k=void 0;void 0===l.vertexFrom?(k=g.vertexCount,f=this._allocateVertices(e,k)):g.vertexCount>l.vertexCount?(this._freeVertices(e,l.vertexFrom,l.vertexCount),k=g.vertexCount,f=this._allocateVertices(e,k)):g.vertexCount===l.vertexCount?(f=l.vertexFrom,k=l.vertexCount):(this._freeVertices(e,l.vertexFrom+g.vertexCount,l.vertexCount-g.vertexCount),f=l.vertexFrom,k=g.vertexCount);let p=!0,m=void 0,b=void 0,h=void 0;void 0===l.indexFrom?(m=c,h=g.indexCount,b=this._allocateIndices(e,h)):g.indexCount>l.indexCount?
(m=this._displayList.removeFromList(l),this._freeIndices(e,l.indexFrom,l.indexCount),h=g.indexCount,b=this._allocateIndices(e,h)):g.indexCount===l.indexCount?(p=!1,b=l.indexFrom,h=l.indexCount):(m=this._displayList.removeFromList(l),this._freeIndices(e,l.indexFrom+g.indexCount,l.indexCount-g.indexCount),b=l.indexFrom,h=g.indexCount);if(-1!==f&&-1!==b){c=this._storageFor(e);B.copyMeshData(f,b,c.vertexBuffers,c.indexBuffer,g,d,a);l.vertexFrom=f;l.indexFrom=b;l.vertexCount=g.vertexCount;l.indexCount=
g.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(l.geometryType,l.indexFrom,l.indexCount);for(const n in d)this._dirtyMap.markDirtyVertices(l.geometryType,n,l.vertexFrom,l.vertexCount)}p&&this._displayList.addToList(l,m);return!0}-1!==f&&this._freeVertices(e,f,k);-1!==b&&this._freeIndices(e,b,h);l.setMeshDataFromBuffers(g,d,a);l.vertexFrom=void 0;l.vertexCount=0;l.indexFrom=void 0;l.indexCount=0;return!1};y.tryAddMeshData=function(l,g){const d=g.vertexBuffer;g=g.indexBuffer;var a=D[l.geometryType];
const c=this._allocateVertices(a,l.vertexCount);if(-1===c)return this._freeVertices(a,c,l.vertexCount),!1;const e=this._allocateIndices(a,l.indexCount);if(-1===e)return this._freeVertices(a,c,l.vertexCount),this._freeIndices(a,e,l.indexCount),!1;a=this._storageFor(a);B.copyMeshData(c,e,a.vertexBuffers,a.indexBuffer,l,d,g);l.vertexFrom=c;l.indexFrom=e;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(l.geometryType,l.indexFrom,l.indexCount);for(const f in d)this._dirtyMap.markDirtyVertices(l.geometryType,
f,c,l.vertexCount)}this._displayList.addToList(l);return!0};y._allocateVertices=function(l,g){l=this._storageFor(l);g=l.vtxFreeList.allocate(g);return-1===g||.5<l.vtxFreeList.fragmentation?-1:g};y._freeVertices=function(l,g,d){this._storageFor(l).vtxFreeList.free(g,d)};y._freeIndices=function(l,g,d){this._storageFor(l).idxFreeList.free(g,d)};y._allocateIndices=function(l,g){l=this._storageFor(l);g=l.idxFreeList.allocate(g);return-1===g||.5<l.idxFreeList.fragmentation?-1:g};y._storageFor=function(l){return this._freeListsAndStorage[l]};
y._stridesFor=function(l,g){return this._strides[l][g]};return z}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(t,u){let B=function(){function z(l){this._largestRange=null;this._parent=l;this._updateLargestRange()}var y=z.prototype;y.rangeCreated=function(l){if(!this._largestRange||l.count>this._largestRange.count)this._largestRange=l};y.rangeResized=function(l,g){if(l===this._largestRange)l.count<g&&this._updateLargestRange();
else if(!this._largestRange||l.count>this._largestRange.count)this._largestRange=l};y.findBestRange=function(l){let g=this._parent._freeHead,d=null;for(;null!==g;)g.count>=l&&(!d||g.count-l<d.count-l)&&(d=g),g=g.next;return d};y.findAdjacentRanges=function(l,g){let d=!0,a=!1,c=null,e=this._parent._freeHead;for(;d&&!a;){const f=null!==e?e.from:this._parent._size;l>=(null!==c?c.from+c.count:0)&&l+g<=f?(d=!1,a=!0):null!==e?(c=e,e=e.next):d=!1}return[c,e]};y._updateLargestRange=function(){let l=null,
g=this._parent._freeHead;for(;null!==g;){if(!l||g.count>l.count)l=g;g=g.next}this._largestRange=l};u._createClass(z,[{key:"largestRange",get:function(){return this._largestRange}}]);return z}(),D=function(){function z(l,g){this._allocated=0;this._size=l;this._freeHead=0<l?{from:0,count:l,prev:null,next:null}:null;this._bookKeeper=g||new B(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var y=z.prototype;y.allocate=function(l){const g=this._bookKeeper.findBestRange(l);if(null===
g)return-1;const d=g.from,a=g.count;g.from+=l;g.count-=l;this._bookKeeper.rangeResized(g,d,a);this._allocated+=l;0===g.count&&(l=null!==g.prev?this._freeHead:g.next,z._removeRange(g),this._freeHead=l);return d};y.free=function(l,g){const [d,a]=this._bookKeeper.findAdjacentRanges(l,g);l={from:l,count:g,prev:d,next:a};null!==d&&(d.next=l);null!==a&&(a.prev=l);this._bookKeeper.rangeCreated(l);this._allocated-=g;if(null!==a&&l.from+l.count===a.from){g=l.from;var c=l.count;z._fuse(l,a);z._removeRange(a);
this._bookKeeper.rangeResized(l,g,c);this._bookKeeper.rangeResized(a,void 0,0)}null!==d&&d.from+d.count===l.from&&(g=d.from,c=d.count,z._fuse(d,l),z._removeRange(l),this._bookKeeper.rangeResized(d,g,c),this._bookKeeper.rangeResized(l,void 0,0));this._freeHead=null!==l.prev?this._freeHead:l};z._removeRange=function(l){null!==l.prev?null!==l.next?(l.prev.next=l.next,l.next.prev=l.prev):l.prev.next=null:null!==l.next&&(l.next.prev=null)};z._fuse=function(l,g){l.count+=g.count;l.next=g.next;g.from+=g.count;
g.count=0;null!==g.next&&(g.next.prev=l)};u._createClass(z,[{key:"fragmentation",get:function(){const l=this._size-this._allocated;return 0===l?0:1-this._bookKeeper.largestRange.count/l}}]);return z}();t.FreeList=D;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["./Utils","../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject"],function(t,u,B,D){return function(){function z(l){this.geometryMap=t.createGeometryData(()=>
({indexBuffer:u.BufferObject.createIndex(l,B.Usage.STATIC_DRAW),vao:null}),(g,d)=>({vertexBuffer:u.BufferObject.createVertex(l,t.C_VBO_INFO[d])}))}var y=z.prototype;y.dispose=function(){for(let l=0;5>l;l++){const g=this.geometryMap[l];if(g){g.data.vao&&g.data.vao.dispose(!1);g.data.indexBuffer&&g.data.indexBuffer.dispose();for(const d in g.buffers)g.buffers[d]&&g.buffers[d].data.vertexBuffer.dispose()}}};y.get=function(l){const g=this.geometryMap[l];return{getVAO(d,a,c){if(!g.data.vao){const e={};
for(const f in g.buffers)e[f]=g.buffers[f].data.vertexBuffer;g.data.vao=new D.VertexArrayObject(d,c,a,e,g.data.indexBuffer)}return g.data.vao}}};y.has=function(l){return null!=this.geometryMap[l]};y.upload=function(l,g){g.forEach((d,a)=>{this._upload(d,a,l)})};y._upload=function(l,g,d){l.indices&&(l.indices.allDirty?this._uploadIndices(d,g):null!=l.indices.from&&null!=l.indices.count&&this._uploadIndices(d,g,l.indices.from,l.indices.count));if(l.vertices){l=l.vertices;for(const a in l){const c=l[a];
c.allDirty?this._uploadVertices(d,g,a):null!=c.from&&null!=c.count&&this._uploadVertices(d,g,a,c.from,c.count)}}};y._uploadVertices=function(l,g,d,a,c){const e=this.geometryMap[g];e&&(g=l.geometries[g].vertexBuffer[d])&&(l=g.stride,g=g.data.buffer,e.buffers[d]&&0<g.byteLength&&(null!=a&&null!=c?e.buffers[d].data.vertexBuffer.setSubData(g,a*l,a*l,(a+c)*l):e.buffers[d].data.vertexBuffer.setData(g)))};y._uploadIndices=function(l,g,d,a){const c=this.geometryMap[g];c&&(l=l.geometries[g].indexBuffer.buffer,
c.data.indexBuffer&&0<l.byteLength&&(null!=d&&null!=a?c.data.indexBuffer.setSubData(l,4*d,4*d,4*(d+a)):c.data.indexBuffer.setData(l)))};return z}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat2d ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2 ../../../../chunks/vec2f32 ./definitions ./TiledDisplayObject".split(" "),function(t,u,B,D,z,y,l,g,d){let a=function(){function c(){}var e=c.prototype;
e.acquire=function(f){return{refCount:1,version:-1,labelMat2d:z.create(),tileMat3:z.create(),dvs:z.create()}};e.release=function(f){};return c}();d=function(c){function e(k,p,m){return c.call(this,k,p,m,g.TILE_SIZE,g.TILE_SIZE)||this}u._inheritsLoose(e,c);var f=e.prototype;f.destroy=function(){c.prototype.destroy.call(this);this._transforms&&e.TransformCache.release(this.key.hash)};f.setTransform=function(k,p){var m=p/(k.resolution*k.pixelRatio),b=this.transforms.tileMat3;const [h,n]=k.toScreenNoRotation([0,
0],[this.x,this.y]);D.set(b,this.width/this.rangeX*m,0,0,0,this.height/this.rangeY*m,0,h,n,1);D.multiply(this.transforms.dvs,k.displayViewMat3,b);m=this.transforms.labelMat2d;p=k.getScreenTransform(m,p);b=l.create();y.transformMat2d(b,[this.x,this.y],p);B.fromTranslation(m,b);B.multiply(m,k.viewMat2d,m)};f._createTransforms=function(){return e.TransformCache.acquire(this.key.hash)};return e}(d.TiledDisplayObject);d.TransformCache=new a;t.WGLTile=d;Object.defineProperty(t,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../DisplayObject","../../tiling/TileKey"],function(t,u,B,D,z){D=function(y){function l(d,a,c,e,f,k=e,p=f){var m=y.call(this)||this;m.triangleCountReportedInDebug=0;m.triangleCount=0;m.texture=null;m.key=new z(d);m.x=a;m.y=c;m.width=e;m.height=f;m.rangeX=k;m.rangeY=p;return m}u._inheritsLoose(l,y);var g=l.prototype;g.destroy=function(){this.texture&&
(this.texture.dispose(),this.texture=null)};g.setTransform=function(d,a){a/=d.resolution*d.pixelRatio;const c=this.transforms.tileMat3,[e,f]=d.toScreenNoRotation([0,0],[this.x,this.y]);B.set(c,this.width/this.rangeX*a,0,0,0,this.height/this.rangeY*a,0,e,f,1);B.multiply(this.transforms.dvs,d.displayViewMat3,c)};return l}(D.DisplayObject);t.TiledDisplayObject=D;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c){const e=new B,f=new B;B=function(){function k(){this.tileBufferData=this.tileDisplayData=null}var p=k.prototype;p.reshuffle=function(){e.reset();const m=z.groupRecordsByGeometryType(this.tileDisplayData.displayObjects);for(var b of m)for(var h of b)h&&e.needMore(h.geometryType,h.meshData?h.meshData.vertexCount:h.vertexCount,h.meshData?h.meshData.indexData.length:h.indexCount);b=m.length;h=new D;for(var n=0;n<b;++n){h.geometries[n].indexBuffer=new Uint32Array(Math.round(1.5*
e.indicesFor(n)));var r=[];for(var x in this.tileBufferData.geometries[n].vertexBuffer)r.push(this.tileBufferData.geometries[n].vertexBuffer[x].stride);r=k._computeVertexAlignment(r);var q=Math.round(1.5*e.verticesFor(n));r=k._align(q,r);for(var A in this.tileBufferData.geometries[n].vertexBuffer)q=this.tileBufferData.geometries[n].vertexBuffer[A].stride,h.geometries[n].vertexBuffer[A]={stride:q,data:y.allocateTypedArrayBuffer(r,q)}}f.reset();this.tileDisplayData.displayList.clear();for(x=0;x<b;++x){A=
m[x];for(const E of A){if(E.meshData)E.writeMeshDataToBuffers(f.verticesFor(x),h.geometries[x].vertexBuffer,f.indicesFor(x),h.geometries[x].indexBuffer),E.meshData=null;else{A=this.tileBufferData.geometries[x].vertexBuffer;n=this.tileBufferData.geometries[x].indexBuffer;r=h.geometries[x].vertexBuffer;q=h.geometries[x].indexBuffer;const F=f.verticesFor(x),w=f.indicesFor(x);y.copyMeshData(F,w,r,q,E,A,n);E.vertexFrom=F;E.indexFrom=w}f.needMore(x,E.vertexCount,E.indexCount)}}for(const E of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(E.displayRecords);
this.tileBufferData=h};p.getStrides=function(){const m=[];for(let b=0;b<this.tileBufferData.geometries.length;++b){const h=this.tileBufferData.geometries[b];m[b]={};for(const n in h.vertexBuffer)m[b][n]=h.vertexBuffer[n].stride}return m};p.clone=function(){const m=new k;m.tileBufferData=this.tileBufferData.clone();m.tileDisplayData=this.tileDisplayData.clone();return m};p._guessSize=function(){const {displayObjects:m}=this.tileDisplayData,b=Math.min(m.length,4);let h=0;for(let n=0;n<b;n++)h=Math.max(h,
m[n].displayRecords.length);return 2*(12*m.length+m.length*h*40)};p.serialize=function(){const m=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),h=this.tileDisplayData.serialize(new c(Int32Array,this._guessSize())).buffer();b.push(h);return{result:{displayData:h,bufferData:m},transferList:b}};k.fromVertexData=function(m,b){const h={},n=new Map;for(const r of b)n.set(r.id,r);y.forEachGeometryType(r=>{const x=m.data[r];if(u.isSome(x)){const A=g.DisplayRecordReader.from(x.records).getCursor();
for(;A.next();){var q=A.id;const E=A.materialKey,F=A.indexFrom,w=A.indexCount,v=A.vertexFrom,C=A.vertexCount,G=n.get(q);q=new l(q,r,E);q.indexFrom=F;q.indexCount=w;q.vertexFrom=v;q.vertexCount=C;G.displayRecords.push(q)}h[r]=d.VertexBuffers.fromVertexData(x,r)}else h[r]=(new a.VertexVectors(r,0,{fill:"default"})).intoBuffers()});return k.fromMeshData({displayObjects:b,vertexBuffersMap:h})};k.fromMeshData=function(m){const b=new k,h=new z.default,n=new D;h.displayObjects=m.displayObjects;for(const r in m.vertexBuffersMap){const x=
m.vertexBuffersMap[r];n.geometries[r].indexBuffer=x.indexBuffer;n.geometries[r].vertexBuffer=x.namedBuffers}b.tileDisplayData=h;b.tileBufferData=n;return b};k.bind=function(m,b){const h=new k;h.tileDisplayData=m;h.tileBufferData=b;return h};k.create=function(m,b){const h=new k;h.tileDisplayData=new z.default;h.tileDisplayData.displayObjects=m;const n=[0,0,0,0,0],r=[0,0,0,0,0],x=[[],[],[],[],[]];for(var q of m)for(var A of q.displayRecords)x[A.geometryType].push(A),n[A.geometryType]+=A.meshData.vertexCount,
r[A.geometryType]+=A.meshData.indexData.length;m=new D;b=[b.fill||{},b.line||{},b.icon||{},b.text||{},b.label||{}];for(q=0;5>q;q++){A=new Uint32Array(r[q]);{var E=b[q];var F=n[q];const w={};for(const v in E){const C={data:y.allocateTypedArrayBuffer(F,E[v]),stride:E[v]};w[v]=C}E=w}l.writeAllMeshDataToBuffers(x[q],E,A);m.geometries[q]={indexBuffer:A,vertexBuffer:E}}h.tileBufferData=m;return h};k._align=function(m,b){const h=m%b;return 0===h?m:m+(b-h)};k._computeVertexAlignment=function(m){let b=!1,
h=!1;for(const n of m)2===n%4?b=!0:0!==n%4&&(h=!0);return h?4:b?2:1};return k}();t.TileData=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(t){return function(){function u(){this._byGeometryType=null}var B=u.prototype;B.reset=function(){this._byGeometryType=null};B.verticesFor=function(D){return this._byGeometryType?this._byGeometryType[D].vertices:0};B.indicesFor=function(D){return this._byGeometryType?
this._byGeometryType[D].indices:0};B.needMore=function(D,z,y){if(z||y)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),D=this._byGeometryType[D],D.vertices+=z,D.indices+=y};t._createClass(u,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return u}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(t){return function(){function u(){this.geometries=
[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var B=u.prototype;B.clone=function(){const D=new u;for(let z=0;z<this.geometries.length;z++){const y=this.geometries[z],l=D.geometries[z];l.indexBuffer=y.indexBuffer.slice();l.vertexBuffer={};for(const g in y.vertexBuffer){const {data:d,stride:a}=y.vertexBuffer[g];l.vertexBuffer[g]={data:d.slice(),stride:a}}}return D};
u.deserialize=function(D){const z=new u;for(let y=0;5>y;++y){z.geometries[y].indexBuffer=new Uint32Array(D.geometries[y].indexBuffer);z.geometries[y].vertexBuffer={};for(const l in D.geometries[y].vertexBuffer)z.geometries[y].vertexBuffer[l]={data:t.allocateTypedArrayBufferwithData(D.geometries[y].vertexBuffer[l].data,D.geometries[y].vertexBuffer[l].stride),stride:D.geometries[y].vertexBuffer[l].stride}}return z};B.serialize=function(){const D={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,
vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let z=0;5>z;++z)for(const y in this.geometries[z].vertexBuffer)D.geometries[z].vertexBuffer[y]={data:this.geometries[z].vertexBuffer[y].data.buffer,stride:this.geometries[z].vertexBuffer[y].stride};return D};
B.getBuffers=function(){const D=[];for(let z=0;5>z;++z){D.push(this.geometries[z].indexBuffer.buffer);for(const y in this.geometries[z].vertexBuffer)D.push(this.geometries[z].vertexBuffer[y].data.buffer)}return D};return u}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(t,u,B,D,z){let y=function(){function l(){}var g=l.prototype;g.computeDisplayList=
function(){this._displayList=new B;for(const d of this.displayObjects)for(const a of d.displayRecords)this._displayList.addToList(a)};g.clone=function(){const d=new l;this.displayObjects&&(d.displayObjects=this.displayObjects.map(a=>a.clone()));return d};g.serialize=function(d){z.serializeList(d,this.displayObjects);return d};g._deserializeObjects=function(d){var a=d.readInt32();a=Array(a);const c=new Map;for(let e=0;e<a.length;++e){const f=D.deserialize(d);a[e]=f;c.set(f.id,f)}this.displayObjects=
a;this._displayList=null;this._displayObjectRegistry=c};l.deserialize=function(d){const a=new l;a._deserializeObjects(d);return a};u._createClass(l,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const d of this.displayObjects)this._displayObjectRegistry.set(d.id,d)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return l}();t.default=y;t.groupRecordsByGeometryType=function(l){const g=
[[],[],[],[],[]];for(const d of l)for(const a of d.displayRecords)g[a.geometryType].push(a);return g};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./enums"],function(t,u){function B(d,a,c,...e){a<d.length?d.splice(a,c,...e):d.push(...e)}const D=new Map;D.set(u.WGLDrawPhase.MAP,[u.WGLGeometryType.FILL,u.WGLGeometryType.LINE,u.WGLGeometryType.MARKER,u.WGLGeometryType.TEXT]);D.set(u.WGLDrawPhase.LABEL,
[u.WGLGeometryType.LABEL]);D.set(u.WGLDrawPhase.LABEL_ALPHA,[u.WGLGeometryType.LABEL]);u=function(){function d(){this.symbolLevels=[]}var a=d.prototype;a.replay=function(c,e,f){for(const m of this.symbolLevels)for(const b of m.zLevels){var k=b.geometryDPInfo.unified;if(k)for(const h of k){k=c.painter.getGeometryBrush(h.geometryType);var p=e.getGeometry(h.geometryType);p={geometryType:h.geometryType,materialKey:h.materialKey,indexFrom:h.indexFrom,indexCount:h.indexCount,target:p};k.prepareState(c,
e);k.drawGeometry(c,e,p,f)}}};a.clear=function(){this.symbolLevels.length=0};a.addToList=function(c,e){if(Array.isArray(c))for(const f of c)this._addToList(f,e);else this._addToList(c,e)};a.removeFromList=function(c){Array.isArray(c)||(c=[c]);let e=null;for(const f of c)e=this._removeFromList(f);return e};a.clone=function(){const c=new d;for(const e of this.symbolLevels)c.symbolLevels.push(e.clone());return c};a.splitAfter=function(c){const e=this._getDisplayList(c.symbolLevel,c.zOrder),f=e.length,
k=c.indexFrom+c.indexCount;for(let p=0;p<f;++p){const m=e[p];if(m.geometryType===c.geometryType&&k>m.indexFrom&&k<=m.indexFrom+m.indexCount)return k<m.indexFrom+m.indexCount&&(c=new z,c.geometryType=m.geometryType,c.materialKey=m.materialKey,c.indexFrom=k,c.indexCount=m.indexFrom+m.indexCount-k,e.splice(p+1,0,c),m.indexCount=k-m.indexFrom),p}};a._addToList=function(c,e){const f=this._getDisplayList(c.symbolLevel,c.zOrder);e=null!=e?e:f.length-1;var k=0<=e&&e<f.length?f[e]:null;null!==k&&k.materialKey===
c.materialKey&&k.indexFrom+k.indexCount===c.indexFrom&&k.geometryType===c.geometryType?k.indexCount+=c.indexCount:(k=new z,k.indexFrom=c.indexFrom,k.indexCount=c.indexCount,k.materialKey=c.materialKey,k.geometryType=c.geometryType,B(f,e+1,0,k))};a._removeFromList=function(c){const e=this._getDisplayList(c.symbolLevel,c.zOrder);var f=e.length;let k=void 0;for(var p=0;p<f;++p){var m=e[p];if(c.indexFrom+c.indexCount>m.indexFrom&&c.indexFrom<m.indexFrom+m.indexCount&&m.geometryType===c.geometryType){k=
p;break}}if(void 0!==k){f=e[k];if(c.indexFrom===f.indexFrom)return f.indexCount-=c.indexCount,f.indexFrom+=c.indexCount,0===f.indexCount&&B(e,k,1),k-1;if(c.indexFrom+c.indexCount===f.indexFrom+f.indexCount)return f.indexCount-=c.indexCount,0===f.indexCount?(B(e,k,1),k-1):k;{p=f.indexFrom;m=c.indexFrom-f.indexFrom;const b=c.indexCount;c=f.indexFrom+f.indexCount-(c.indexFrom+c.indexCount);f.indexCount=m;const h=new z;h.geometryType=f.geometryType;h.materialKey=f.materialKey;h.indexFrom=p+m+b;h.indexCount=
c;B(e,k+1,0,h);return k}}return null};a._getDisplayList=function(c,e){let f;var k=this.symbolLevels.length;for(let m=0;m<k;m++)if(this.symbolLevels[m].symbolLevel===c){f=this.symbolLevels[m];break}f||(f=new g,f.symbolLevel=c,this.symbolLevels.push(f));let p;c=f.zLevels.length;for(k=0;k<c;k++)if(f.zLevels[k].zLevel===e){p=f.zLevels[k];break}p||(p=new l,p.geometryDPInfo=new y,p.zLevel=e,f.zLevels.push(p));p.geometryDPInfo.unified||(p.geometryDPInfo.unified=[]);return p.geometryDPInfo.unified};a.getDPInfoType=
function(){return"unified"};t._createClass(d,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return d}();let z=function(){function d(){this.materialKey=null;this.indexCount=this.indexFrom=0}d.prototype.clone=function(){const a=new d;a.geometryType=this.geometryType;a.materialKey=this.materialKey;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;return a};return d}(),y=function(){function d(){this.unified=this.label=this.text=this.marker=this.line=this.fill=
null}d.prototype.clone=function(){const a=new d;a.fill=this.fill&&this.fill.map(c=>c.clone());a.line=this.line&&this.line.map(c=>c.clone());a.marker=this.marker&&this.marker.map(c=>c.clone());a.text=this.text&&this.text.map(c=>c.clone());a.label=this.label&&this.label.map(c=>c.clone());a.unified=this.unified&&this.unified.map(c=>c.clone());return a};return d}(),l=function(){function d(){this.geometryDPInfo=new y}d.prototype.clone=function(){const a=new d;a.zLevel=this.zLevel;a.geometryDPInfo=this.geometryDPInfo.clone();
return a};return d}(),g=function(){function d(){this.zLevels=[]}d.prototype.clone=function(){const a=new d;a.symbolLevel=this.symbolLevel;for(const c of this.zLevels)a.zLevels.push(c.clone());return a};return d}();return u})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(t,u){return function(){function B(z){this.insertAfter=null;this.id=z;this.displayRecords=[]}var D=B.prototype;D.copy=function(){const z=new B(this.id);
z.set(this);return z};D.clone=function(){const z=new B(this.id);z.displayRecords=this.displayRecords.map(y=>y.clone());z.insertAfter=this.insertAfter;return z};D.set=function(z){this.id=z.id;this.displayRecords=z.displayRecords;this.insertAfter=z.insertAfter};D.serialize=function(z){z.push(this.id);u.serializeList(z,this.displayRecords);return z};B.deserialize=function(z){const y=z.readInt32(),l=new B(y);l.displayRecords=u.deserializeList(z,t,{id:y});return l};return B}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./MeshData","./Utils"],function(t,u,B){return function(){function D(y,l,g,d=0,a=0){this.id=y;this.geometryType=l;this.materialKey=g;this.minZoom=d;this.maxZoom=a;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var z=D.prototype;z.clone=function(){return this.copy()};z.copy=function(){const y=new D(this.id,this.geometryType,this.materialKey);y.vertexFrom=this.vertexFrom;y.vertexCount=this.vertexCount;y.indexFrom=this.indexFrom;y.indexCount=
this.indexCount;y.zOrder=this.zOrder;y.symbolLevel=this.symbolLevel;y.meshData=this.meshData;y.minZoom=this.minZoom;y.maxZoom=this.maxZoom;return y};z.setMeshDataFromBuffers=function(y,l,g){const d=new u;for(const a in l){const c=l[a].stride,e=l[a].data,f=[],k=B.strideToPackingFactor(c);for(let p=0;p<c*y.vertexCount/k;++p)f[p]=e[p+c*y.vertexFrom/k];d.vertexData.set(a,f)}d.indexData.length=0;for(l=0;l<y.indexCount;++l)d.indexData[l]=g[l+y.indexFrom]-y.vertexFrom;d.vertexCount=y.vertexCount;this.meshData=
d};z.readMeshDataFromBuffers=function(y,l){this.meshData?this.meshData.clear():this.meshData=new u;for(const g in y){const d=y[g].stride,a=y[g].data,c=[],e=B.strideToPackingFactor(d);for(let f=0;f<d*this.vertexCount/e;++f)c[f]=a[f+d*this.vertexFrom/e];this.meshData.vertexData.set(g,c)}this.meshData.indexData.length=0;for(y=0;y<this.indexCount;++y)this.meshData.indexData[y]=l[y+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};z.writeMeshDataToBuffers=function(y,l,g,d){for(const a in l){const c=
l[a].stride,e=this.meshData.vertexData.get(a),f=l[a].data,k=B.strideToPackingFactor(c);for(let p=0;p<c*this.meshData.vertexCount/k;++p)f[p+c*y/k]=e[p]}for(l=0;l<this.meshData.indexData.length;++l)d[l+g]=this.meshData.indexData[l]+y;this.vertexFrom=y;this.vertexCount=this.meshData.vertexCount;this.indexFrom=g;this.indexCount=this.meshData.indexData.length};D.writeAllMeshDataToBuffers=function(y,l,g){let d=0,a=0;for(const c of y)c.writeMeshDataToBuffers(d,l,a,g),d+=c.vertexCount,a+=c.indexCount};z._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};z.serialize=function(y){y.push(this.geometryType);y.push(this.materialKey);y.push(this.vertexFrom);y.push(this.vertexCount);y.push(this.indexFrom);y.push(this.indexCount);y.push(this.minZoom);y.push(this.maxZoom);return y};D.deserialize=function(y,l){const g=y.readInt32(),d=y.readInt32();l=new D(l.id,g,d);l.vertexFrom=y.readInt32();l.vertexCount=y.readInt32();l.indexFrom=y.readInt32();l.indexCount=y.readInt32();
l.minZoom=y.readInt32();l.maxZoom=y.readInt32();return l};t._createClass(D,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return D}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function t(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var u=t.prototype;u.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};u.update=function(B,D,z){for(const y in B)this.vertexData.set(y,
B[y]);for(const y in this.vertexData)null===B[y]&&this.vertexData.delete(y);this.vertexCount=D;this.indexData=z};return t}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(t){t.deserializeList=function(u,B,D){var z=u.readInt32();z=Array(z);for(let y=0;y<z.length;y++)z[y]=B.deserialize(u,D);return z};t.serializeList=function(u,B){if(null===B)u.push(0);else{u.push(B.length);for(const D of B)D.serialize(u);return u}};Object.defineProperty(t,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(t,u,B,D){let z=function(){function l(d){this._cursor=this._head=d}l.from=function(d,a=0,c=d.byteLength/y.BYTES_PER_RECORD-a){d=new y(new Int32Array(d,a*y.BYTES_PER_RECORD,c*y.ELEMENTS_PER_RECORD));return new l(d)};var g=l.prototype;g.size=function(){let d=this._cursor,a=0;for(;d;)a+=d.size(),
d=d._link;return a};g.seekIndex=function(d){for(this._cursor=this._head;this._cursor;){const a=this._cursor.size();if(d<a)return this._cursor._index=d,!0;d-=a;this._cursor=this._cursor._link}return!1};g.forEach=function(d){const a=this.getCursor();for(;a.next();)d(a)};g.link=function(d){if(this._head){for(var a=this._head;a._link;)a=a._link;a._link=d._head;a._link._indexStart=a._indexStart+a.size()}else this._head=d._head};g.getCursor=function(){return this.copy()};g.lookup=function(d){for(this._cursor=
this._head;this._cursor&&!this._cursor.lookup(d);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};g.copy=function(){var d;const a=new l(null==(d=this._head)?void 0:d.copy());if(!a._head)return a;d=a._head;let c=a._head._link;for(;c;)d._link=c.copy(),d=c,c=d._link;return a};g.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};g.peekId=function(){var d;
return null!=(d=this._cursor.peekId())?d:this._cursor._link.peekId()};g.delete=function(d){let a=this._head,c=null;for(;a;){if(a.delete(d))return a.isEmpty()&&(B.isSome(c)&&(c._link=a._link),a===this._head&&(this._head=a._link),a===this._cursor&&(this._cursor=a._link)),!0;c=a;a=a._link}return!1};u._createClass(l,[{key:"id",get:function(){return this._cursor.id},set:function(d){this._cursor.id=d}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(d){this._cursor.materialKey=
d}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(d){this._cursor.indexFrom=d}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(d){this._cursor.indexCount=d}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(d){this._cursor.vertexFrom=d}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(d){this._cursor.vertexCount=
d}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(d){this._cursor.sortKey=d}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]);return l}();z.ELEMENTS_PER_RECORD=D.DISPLAY_RECORD_INT_PER_ELEMENT;z.BYTES_PER_RECORD=z.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let y=function(){function l(d){this._link=null;this._index=-1;this._deletedCount=this._indexStart=0;this._offsets={instance:null};this._packedRecords=d}l.from=function(d,a=0,c=
d.byteLength/this.BYTES_PER_RECORD-a){return new l(new Int32Array(d,a*this.BYTES_PER_RECORD,c*this.ELEMENTS_PER_RECORD))};var g=l.prototype;g.delete=function(d){const a=this._index,c=this.lookup(d);if(c)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===d;)this.id=2147483647,++this._deletedCount;this._index=a;return c};g.isEmpty=function(){return this._deletedCount===this.size()};g.link=function(d){this._link?this._link.link(d):this._link=d};g.lookup=function(d){if(B.isNone(this._offsets.instance)){this._offsets.instance=
new Map;var a=this.copy();a._index=-1;let c=0;for(;a.next();)a.id!==c&&(this._offsets.instance.set(a.id,a._index),c=a.id)}if(!this._offsets.instance.has(d))return!1;a=this._index;this._index=this._offsets.instance.get(d);return 2147483647===this.id?(this._index=a,!1):!0};g.size=function(){return this._packedRecords.length/l.ELEMENTS_PER_RECORD};g.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};g.peekId=function(){const d=(this._index+1)*l.ELEMENTS_PER_RECORD;
return d>=this._packedRecords.length?0:this._packedRecords[d]};g.getCursor=function(){return this.copy()};g.copy=function(){const d=new l(this._packedRecords);d._indexStart=this._indexStart;d._link=this._link;d._index=this._index;d._offsets=this._offsets;d._deletedCount=this._deletedCount;return d};u._createClass(l,[{key:"id",get:function(){return this._packedRecords[this._index*l.ELEMENTS_PER_RECORD]},set:function(d){this._packedRecords[this._index*l.ELEMENTS_PER_RECORD]=d}},{key:"materialKey",get:function(){return this._packedRecords[this._index*
l.ELEMENTS_PER_RECORD+1]},set:function(d){this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+1]=d}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+3]},set:function(d){this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+3]=d}},{key:"indexCount",get:function(){return this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+4]},set:function(d){this._packedRecords[this._index*
l.ELEMENTS_PER_RECORD+4]=d}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+5]},set:function(d){this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+5]=d}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+6]},set:function(d){this._packedRecords[this._index*l.ELEMENTS_PER_RECORD+6]=d}},{key:"sortKey",get:function(){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));
return this._packedRecordsF32[this._index*l.ELEMENTS_PER_RECORD+7]},set:function(d){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));this._packedRecordsF32[this._index*l.ELEMENTS_PER_RECORD+7]=d}},{key:"index",get:function(){return this._index}}]);return l}();y.ELEMENTS_PER_RECORD=D.DISPLAY_RECORD_INT_PER_ELEMENT;y.BYTES_PER_RECORD=y.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;t.DisplayRecordReader=z;Object.defineProperty(t,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(t,u){let B=function(){function z(y,l){this.data=y;this.stride=l}z.decode=function(y){const l=u.allocateTypedArrayBufferwithData(y.data,y.stride);return new z(l,y.stride)};z.fromVertexVector=function(y){const l=u.allocateTypedArrayBufferwithData(y.data.buffer(),y.stride);return new z(l,y.stride)};return z}(),D=function(){function z(y,l,g){this.geometryType=y;this.indexBuffer=new Uint32Array(l);this.namedBuffers=
g}z.decode=function(y){const l=y.geometryType,g=y.indexBuffer,d={};for(const a in y.namedBuffers)d[a]=B.decode(y.namedBuffers[a]);return new z(l,g,d)};z.fromVertexData=function(y,l){const g=y.indices,d=u.allocateTypedArrayBufferwithData(y.vertices,y.stride);y={geometry:new B(d,y.stride)};return new z(l,g,y)};z.fromVertexVectors=function(y){const l=y.geometryType,g=y.indexVector.buffer(),d={};for(const a in y.namedVectors)d[a]=B.fromVertexVector(y.namedVectors[a]);return new z(l,g,d)};return z}();
t.VertexBuffers=D;t.default=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(t,u,B,D,z){let y=function(){function g(d,a){this.data=d;this.stride=a}g.prototype.transfer=function(d,a){const c=this.data.buffer();d.vertexCount=this.vertexCount;d.data=c;d.stride=this.stride;a.push(c)};u._createClass(g,[{key:"vertexCount",
get:function(){const d=this.data.length/(this.stride/4);d!==(d|0)&&console.debug("Corrupted stride");return d}}]);return g}(),l=function(){function g(a,c,e){this.geometryType=a;this.indexVector=new z(Uint32Array,6*c);this.namedVectors={};a=B.getStrides(a,e);for(const f in a){e=a[f];let k;switch(e%4){case 0:case 2:k=new z(Uint32Array,e*c);break;case 1:case 3:k=new z(Uint8Array,e*c)}this.namedVectors[f]=new y(k,e)}}var d=g.prototype;d.get=function(a){return this.namedVectors[a].data};d.getVector=function(a){return this.namedVectors[a]};
d.transfer=function(a,c){const e=this.indexVector.buffer(),f={};c.push(e);for(const k in this.namedVectors){const p=this.namedVectors[k];f[k]={};p.transfer(f[k],c)}a.geometryType=this.geometryType;a.indexBuffer=e;a.namedBuffers=f;this.destroy()};d.intoBuffers=function(){const a=D.VertexBuffers.fromVertexVectors(this);this.destroy();return a};d.destroy=function(){this.namedVectors=this.indexVector=null};return g}();t.VertexVectors=l;t.default=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],
function(t){return function(){function u(D,z){this._pos=0;z=z?this._roundToNearest(z,D.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(z);this._buffer=new D(this._array);this._ctor=D;this._i16View=new Int16Array(this._array)}var B=u.prototype;B._roundToNearest=function(D,z){D=Math.round(D);return D+(z-D%z)};B._ensureSize=function(D){if(this._pos+D>=this._buffer.length){D=this._roundToNearest(1.25*(this._array.byteLength+D*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);D=new ArrayBuffer(D);
const z=new this._ctor(D);z.set(this._buffer,0);this._array=D;this._buffer=z;this._i16View=new Int16Array(this._array)}};B.ensureSize=function(D){this._ensureSize(D)};B.writeF32=function(D){this._ensureSize(1);const z=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=D;this._pos++;return z};B.push=function(D){this._ensureSize(1);const z=this._pos;this._buffer[this._pos++]=D;return z};B.writeFixed=function(D){this._buffer[this._pos++]=D};B.setValue=function(D,z){this._buffer[D]=z};B.i1616Add=
function(D,z,y){this._i16View[2*D]+=z;this._i16View[2*D+1]+=y};B.getValue=function(D){return this._buffer[D]};B.incr=function(D){if(this._buffer.length<D)throw Error("Increment index overflows the target buffer");this._buffer[D]++};B.decr=function(D){this._buffer[D]--};B.writeRegion=function(D){this._ensureSize(D.length);const z=this._pos;this._buffer.set(D,this._pos);this._pos+=D.length;return z};B.writeManyFrom=function(D,z,y){for(this._ensureSize(y-z);z!==y;z++)this.writeFixed(D._buffer[z])};B.buffer=
function(){const D=this._array.slice(0,4*this._pos);this.destroy();return D};B.toArray=function(){const D=this._array,z=[];for(let y=0;y<D.byteLength/4;y++)z.push(D[y]);return z};B.seek=function(D){this._pos=D};B.destroy=function(){this._buffer=this._array=null};t._createClass(u,[{key:"length",get:function(){return this._pos}}]);return u}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f){function k(m){switch(m){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function p(m){switch(m){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}B=function(){function m(h,n,r,x,q){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,
isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=n;this.tileKey=h;this._hasAggregate=x;this._pixelBufferEnabled=q;this._strideOptions=r}var b=m.prototype;b.serialize=function(h){const n=[];n.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((r,x)=>{var q=1<<x;x=k(q);q=p(q);x=f.getPow2NeighborKey(new z(this.tileKey),x,q,h);x=this._serializeTileVertexData(this.tileKey,x.id,r.vertexData);x.message.bufferIds=r.displayIds;n.push(x)});
return n};b._serializeTileVertexData=function(h,n,r){var x,q,A,E,F;const w=[];r={[a.WGLGeometryType.MARKER]:null==(x=r.get(a.WGLGeometryType.MARKER))?void 0:x.serialize(w),[a.WGLGeometryType.FILL]:null==(q=r.get(a.WGLGeometryType.FILL))?void 0:q.serialize(w),[a.WGLGeometryType.LINE]:null==(A=r.get(a.WGLGeometryType.LINE))?void 0:A.serialize(w),[a.WGLGeometryType.TEXT]:null==(E=r.get(a.WGLGeometryType.TEXT))?void 0:E.serialize(w),[a.WGLGeometryType.LABEL]:null==(F=r.get(a.WGLGeometryType.LABEL))?void 0:
F.serialize(w)};return{message:{tileKeyOrigin:h,tileKey:n,data:r},transferList:w}};b.featureStart=function(h,n){this._current.insertAfter=h;this._current.sortKey=n};b.featureEnd=function(){};b.recordStart=function(h,n,r,x){this._current.writer=this._getVertexWriter(r);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=x;this._current.id=h;this._current.materialKey=n;this._current.geometryType=
r;this._current.isDotDensity=!1;this._current.writer.recordStart()};b.recordCount=function(){return this._current.writer.recordCount};b.vertexCount=function(){return this._current.writer.vertexCount};b.indexCount=function(){return this._current.writer.indexCount};b.vertexEnsureSize=function(h){this._current.writer.vertexEnsureSize(h)};b.indexEnsureSize=function(h){this._current.writer.indexEnsureSize(h)};b.vertexBounds=function(h,n,r,x){this._current.bufferingEnabled&&this._addOverlap(h,n,r,x)};b.vertexWrite=
function(h){this._current.writer.writeVertex(h)};b.vertexWriteF32=function(h){this._current.writer.writeVertexF32(h)};b.vertexEnd=function(){};b.vertexWriter=function(){return this._current.writer.vertexWriter};b.indexWrite=function(h){this._current.writer.writeIndex(h)};b.indexWriter=function(){return this._current.writer.indexWriter};b.metricWriter=function(){return this._current.writer.metricWriter};b.metricStart=function(h,n,r,x,q,A,E,F){this._current.writer=this._getVertexWriter(a.WGLGeometryType.LABEL);
const w=this._current.writer.metricWriter;w.push(d.getDisplayIdTexel(h));w.push(n);w.push(r);w.push(x);w.push(q);w.push(A);w.push(E);w.push(F);w.push(255);this._current.metricBoxLenPointer=w.push(0)};b.metricEnd=function(){const h=this._current.writer.metricWriter;0===h.getValue(this._current.metricBoxLenPointer)&&h.seek(h.length-10)};b.metricBoxWrite=function(h,n,r,x){const q=this._current.writer.metricWriter;q.incr(this._current.metricBoxLenPointer);q.push(0);q.push(0);q.push(h);q.push(n);q.push(r);
q.push(x)};b.recordEnd=function(){var h=this._current.vertStart,n=this._current.writer.vertexCount-h;if(!n)return!1;this.hasRecords=!0;var r=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,r,this._current.writer.indexCount-r,h,n,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===a.WGLGeometryType.LABEL)return!0;h=this._current.writer;for(n=0;8>
n;n++){var x=1<<n;if(this._current.overlaps&x){this._data.neighbors[n]||(this._data.neighbors[n]={vertexData:new Map,displayIds:new Set});r=this._data.neighbors[n];var q=this._current.geometryType;if(!r.vertexData.has(q)){var A=c.getStrides(q,this._strideOptions).geometry;A=new e.VertexDataWriter(q,A,g.PATCH_PIXEL_BUFFER_ALLOC_SIZE);r.vertexData.set(q,A)}q=r.vertexData.get(this._current.geometryType);A=4096*-k(x);x=4096*-p(x);q.copyLastFrom(h,A,x);r.displayIds.add(this._current.id)}}return!0};b._addOverlap=
function(h,n,r,x){this._current.overlaps|=255^((h<0+r?148:h>=g.TILE_SIZE-r?41:189)|(n<0+x?224:n>=g.TILE_SIZE-x?7:231))};b._getVertexWriter=function(h){if(!this._data.self.has(h)){const n=this._data.self,r=c.getStrides(h,this._strideOptions).geometry;n.set(h,new e.VertexDataWriter(h,r,this.hint.records))}return this._data.self.get(h)};u._createClass(m,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return m}();
t.MeshData=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(t){t.AGGREGATE_VALID_FILTERS_MASK=254;t.DISPLAY_ID_TEXEL_MASK=8388607;t.DISPLAY_ID_TYPE_AGGREGATE=1;t.DISPLAY_ID_TYPE_FEATURE=0;t.DISPLAY_ID_TYPE_MASK=8388608;t.NONAGGREGATE_VALID_FILTERS_MASK=255;t.createDisplayId=function(u,B){return((B?8388608:0)|u)>>>0};t.getDisplayIdFilterMask=u=>1===(u&8388608)>>>23?254:255;t.getDisplayIdTexel=u=>u&8388607;t.getDisplayIdType=
u=>(u&8388608)>>>23;t.isAggregateId=function(u){return 1===(u&8388608)>>>23};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(t,u,B,D,z){let y=function(){function l(d,a,c){this._start={index:0,vertex:0};c=D.getMeshSizeHint(d,a,c);a/=4;this.geometryType=d;this._records=new z(Int32Array,c.recordBytes);this._indices=
new z(Uint32Array,c.indexBytes);this._vertices=new z(Uint32Array,c.vertexBytes);this._metrics=new z(Float32Array,0);this._strideInt=a}var g=l.prototype;g.serialize=function(d){const a=this._records.buffer(),c=this._indices.buffer(),e=this._vertices.buffer(),f=this._metrics.length?this._metrics.buffer():null,k=4*this._strideInt;d.push(a,c,e);return{stride:k,records:a,indices:c,vertices:e,metrics:f}};g.vertexEnsureSize=function(d){this._vertices.ensureSize(d)};g.indexEnsureSize=function(d){this._indices.ensureSize(d)};
g.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};g.recordEnd=function(d,a,c,e,f,k,p,m){this._records.push(d);this._records.push(a);this._records.push(c);this._records.push(e);this._records.push(f);this._records.push(k);this._records.push(p);this._records.writeF32(m)};g.writeIndex=function(d){this._indices.push(d)};g.writeVertex=function(d){this._vertices.push(d)};g.writeVertexF32=function(d){this._vertices.writeF32(d)};g.copyLastFrom=function(d,
a,c){var e=d._records.length-B.DISPLAY_RECORD_INT_PER_ELEMENT;const f=d._records.getValue(e),k=d._records.getValue(e+1),p=d._records.getValue(e+2),m=d._records.getValue(e+4),b=d._records.getValue(e+6);e=d._records.getValue(e+7);const h=this._vertices.length;var n=(d._start.vertex-this._vertices.length)/this._strideInt;const r=this._indices.length,x=this.vertexCount;for(var q=d._start.index;q!==d._indices.length;q++){const A=d._indices.getValue(q);this._indices.push(A-n)}for(n=d._start.vertex;n!==
d._vertices.length;n++)q=d._vertices.getValue(n),this._vertices.push(q);for(d=h;d<=this._vertices.length;d+=this._strideInt)this._vertices.i1616Add(d,a,c);this._records.push(f);this._records.push(k);this._records.push(p);this._records.push(r);this._records.push(m);this._records.push(x);this._records.push(b);this._records.push(e)};u._createClass(l,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/B.DISPLAY_RECORD_INT_PER_ELEMENT}},
{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return l}();t.VertexDataWriter=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],
function(t,u,B){const D=new Map;D.set(B.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});D.set(B.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});D.set(B.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});D.set(B.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});D.set(B.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});t.getMeshHeuristic=function(z){return D.get(z)};
t.getMeshSizeHint=function(z,y,l){const {indicesPerRecord:g,multiplier:d,verticesPerRecord:a}=D.get(z);return{recordBytes:l*u.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:d*g*l*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:d*a*l*y}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(t,u){function B(D,z,y,l){D=D.clone();const g=1<<D.level;z=D.col+z;y=D.row+y;l&&0>z?(D.col=z+g,--D.world):
z>=g?(D.col=z-g,D.world+=1):D.col=z;D.row=y;return D}t.getPow2NeighborKey=B;t.getPow2NeighborTile=function(D,z,y){z=B(D.key,z,y,D.tileInfoView.tileInfo.isWrappable);return new u.Tile(D.tileInfoView,z)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(t,u,B,D,z,y,l,g,d,a){B=function(){function c(f,k,p){this._loadPromise=y.loadLibtess();this._geometryType=f;this._idField=k;this._templateStore=p}var e=c.prototype;e.update=function(f,k){D.isSome(f.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(f.mesh.labels,k));this._schema=f};e._createLabelTemplates=function(f,k){const p=new Map;if("simple"===f.type){for(var m of f.classes)f=g.fromLabelClass(m,k),p.set(m.index,f);return p}for(const b in f.classes){m=f.classes[b];for(const h of m)m=
g.fromLabelClass(h,k),p.set(h.index,m)}return p};e.analyze=function(){var f=u._asyncToGenerator(function*(k,p,m,b,h,n,r){if(!z.isAborted(r)){var x;"dictionary"===m.type&&(x=yield m.analyze(this._idField,k.copy(),p,h,n,r));for(p=0;k.next();){var q=void 0;q=x?x[p++]:D.isSome(b)&&l.isAggregateId(k.getDisplayId())&&1!==k.readAttribute("cluster_count")?b.match(this._idField,k,this._geometryType,h,n):m.match(this._idField,k,this._geometryType,h,n);k.setGroupId(q);if(a.isDynamicId(q)){q=this._templateStore.getDynamicTemplateGroup(q);
for(const A of q)A&&A.analyze&&A.analyze(this._templateStore,k,h,n)}}yield this._loadPromise;return this._templateStore.finalize(r)}});return function(k,p,m,b,h,n,r){return f.apply(this,arguments)}}();e.analyzeGraphics=function(){var f=u._asyncToGenerator(function*(k,p,m,b,h,n){if(!z.isAborted(n)){k=k.getCursor();for(m&&(yield m.analyze(this._idField,k.copy(),p,b,h,n));k.next();){p=k.getGroupId();if(null==p||-1===p)p=m.match(this._idField,k,k.geometryType,b,h),k.setGroupId(p);if(a.isDynamicId(p)){const r=
this._templateStore.getDynamicTemplateGroup(p);for(const x of r)x&&x.analyze&&x.analyze(this._templateStore,k,b,h)}k.setGroupId(p)}yield this._loadPromise;return this._templateStore.finalize(n)}});return function(k,p,m,b,h,n){return f.apply(this,arguments)}}();e.writeGraphic=function(f,k,p,m){const b=k.getGroupId(),h=k.getDisplayId(),n=this._templateStore.getTemplateGroup(b);f.featureStart(k.insertAfter,0);if(null!=h){if(a.isDynamicId(b))for(const r of n)r&&r.bindFeature(k,null,null);if(n){for(const r of n)r&&
r.write(f,k,p,m);f.featureEnd()}}};e.writeCursor=function(f,k,p,m,b,h,n){const r=k.getGroupId(),x=k.getDisplayId(),q=this._templateStore.getTemplateGroup(r),A=this._schema.mesh.sortKey;let E=0;D.isSome(A)&&(E=null!=A.fieldIndex?k.getComputedNumericAtIndex(A.fieldIndex):null!=A.field?k.readAttribute(A.field):k.readAttribute(this._idField),E*="asc"===A.order?1:-1);f.featureStart(0,null==E||isNaN(E)?0:E);if(null!=x&&q){if(a.isDynamicId(r))for(const F of q)F.bindFeature(k,p,m);for(const F of q)F.write(f,
k,b,n);D.isSome(h)&&f.hasRecords&&(p=h&&this._findLabelRef(q),this._writeLabels(f,k,h,p,b,n));f.featureEnd()}};e._findLabelRef=function(f){for(const k of f)if(k instanceof d)return k;return null};e._writeLabels=function(f,k,p,m,b,h){for(const n of p)if(D.isSome(n)&&n){const {glyphs:r,rtl:x,index:q}=n;p=this._labelTemplates.get(q);p.setZoomLevel(b);p.bindReferenceTemplate(m);p.bindTextInfo(r,x);p.write(f,k,null,h)}};u._createClass(c,[{key:"templates",get:function(){return this._templateStore}}]);return c}();
t.WGLMeshFactory=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/geometry/libtess":function(){define(["require","exports","../chunks/_rollupPluginBabelHelpers","../assets","../core/has"],function(t,u,B,D,z){function y(){y=B._asyncToGenerator(function*(){d||(d=l());return d});return y.apply(this,arguments)}function l(){return g.apply(this,arguments)}function g(){g=B._asyncToGenerator(function*(){a=yield(z("esri-csp-restrictions")?yield(new Promise((c,e)=>t(["../chunks/libtess-asm"],c,e))).then(c=>
c.libtessAsm):yield(new Promise((c,e)=>t(["../chunks/libtess"],c,e))).then(c=>c.libtess)).load({locateFile:()=>D.getAssetUrl("esri/core/libs/libtess/libtess.wasm")})});return g.apply(this,arguments)}let d=null,a=null;u.loadLibtess=function(){return y.apply(this,arguments)};u.triangulate=function(c,e){return a.triangulate(c,e,Math.max(c.length,128E3))};Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p){const m=B.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),b=(n,r="mapview-labeling")=>m.error(new u(r,n)),h=function(n){const r=new Map;return x=>{r.has(x)||r.set(x,n(x));return r.get(x)}}(n=>{let r=0;if(0===n)return Infinity;for(;!(n%2);)r++,n/=2;return r});return function(n){function r(q,A,E,F){var w,v,C;var G=n.call(this,q,E.font.size,E.haloSize||0,E.font.size,E.color&&d.premultiplyAlphaRGBAArray(E.color)||0,E.haloColor&&d.premultiplyAlphaRGBAArray(E.haloColor)||
0,E.horizontalAlignment,E.verticalAlignment,g.isMapAligned(A.labelPlacement)?l.Alignment.MAP:l.Alignment.SCREEN,E.font.decoration,!1,E.angle||0,E.xoffset,E.yoffset,E.lineWidth,E.lineHeight,null,null,null,null,null)||this;G._outLineLabelAngle=0;G._refPlacementPadding=0;G._refPlacementDirX=0;G._refPlacementDirY=0;G._refOffsetX=0;G._refOffsetY=0;G._zoomLevel=0;G.geometryType=c.WGLGeometryType.LABEL;G._allowOverrun=null!=(w=A.allowOverrun)?w:!1;G._repeatLabel=null!=(v=A.repeatLabel)?v:!0;G._labelPosition=
null!=(C=A.labelPosition)?C:"curved";w=!!A.minScale&&F.scaleToZoom(A.minScale)||0;w=D.clamp(w,0,25.5);F=!!A.maxScale&&F.scaleToZoom(A.maxScale)||255;F=D.clamp(F,0,25.5);const [H,L]=g.getAlignmentFromPlacement(A.labelPlacement);G._xAlignD=H;G._yAlignD=L;G._minZoom=w;G._maxZoom=F;G._refPlacementPadding=y.pt2px(E.haloSize)+a.TEXT_PLACEMENT_PADDING;G._repeatLabelDistance=A.repeatLabelDistance?y.pt2px(A.repeatLabelDistance):128;q=f.LabelMaterialKey.load(q);q.sdf=!0;G._materialKey=q.data;return G}t._inheritsLoose(r,
n);r.fromLabelClass=function(q,A){if("esriServerLinePlacementCenterAlong"===q.labelPlacement){const E=q.symbol;E.xoffset=0;E.yoffset=0;E.angle=0;E.font.decoration="none"}return new r(q.materialKey,q,q.symbol,A)};var x=r.prototype;x.setZoomLevel=function(q){this._zoomLevel=q};x.bindReferenceTemplate=function(q){let A=g.getXDirection(this._xAlignD),E=g.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(z.isNone(q))this._refSymbolAndPlacementOffset=e.i8888to32(0,0,Math.floor(127*A+127),
Math.floor(127*E+127));else{if("circle"===q.boundsType&&(A||E)){var F=Math.sqrt(A*A+E*E);A/=F;E/=F}F=Math.max(q.height,q.width);this._refSymbolAndPlacementOffset=e.i8888to32(4*this._refPlacementPadding,F,Math.floor(127*A+127),Math.floor(127*E+127));this._referenceSize=F;this._refPlacementDirX=A;this._refPlacementDirY=E;this._refOffsetX=q.xOffset;this._refOffsetY=q.yOffset}};x._write=function(q,A){if(!z.isNone(this._shapingInfo)){var E=this._shapingInfo,F=A.getDisplayId(),w="esriGeometryPolygon"===
A.geometryType?A.readLegacyCentroid():A.readLegacyGeometry();if(w)switch(this.current={out:q,inId:F,inShaping:E,zoomLevel:this._zoomLevel},A.geometryType){case "esriGeometryPolyline":this._placeLineLabels(w);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(w);break;default:b("mapview-labeling",`Geometry of type ${A.geometryType} is not supported`)}}};x._isVisible=function(q,A){const E=Math.floor(10*this.current.zoomLevel);return Math.floor(10*q)<=E&&E<=Math.floor(10*
A)};x._placePointLabels=function(q){const {out:A,inId:E,inShaping:F}=this.current;this._writeGlyphs(A,E,q,F)};x._placeLineLabels=function(q){q=k.smoothPaths(q.paths,this.current.inShaping.bounds.width);const A=this._placeSubdivGlyphs.bind(this),E=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const F of q)k.pathDivide(F,E,A,this._repeatLabel)};x._placeSubdivGlyphs=function(q,A,E,F){var w=h(A);E=Math.log2(Math.min(E,F-E)/(Math.sqrt(this._repeatLabelDistance)/2+this._shapedBox.width/2/2));
w=Math.max(this._minZoom,this.current.zoomLevel+1-(0===A?E:Math.min(w,E)));E=this.current.zoomLevel-w;F=this._shapedBox.width/2*2**E;this.current.inShaping.isMultiline?0===A&&this._placeStraight(q,w):this._allowOverrun&&0>E?this._placeStraightAlong(q,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(q,w):"curved"===this._labelPosition&&this._placeCurved(q,w,F)};x._placeStraight=function(q,A){const {out:E,inId:F,inShaping:w}=this.current;this._writeGlyphs(E,F,q,w,A)};x._placeCurved=
function(q,A,E){const {out:F,inId:w}=this.current;F.metricStart(w,A,q.x,q.y,0,0,0,0);const v=q.clone(),C=(180/Math.PI*q.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*q.angle%360*(254/360));this._placeFirst(v,A,1);this._placeBack(q,v,A,E,1);this._placeForward(q,v,A,E,1);this._outLineLabelAngle=Math.round(254/360*C);this._placeFirst(v,A,0);this._placeBack(q,v,A,E,0);this._placeForward(q,v,A,E,0);F.metricEnd()};x._placeStraightAlong=function(q,A){const {out:E,inId:F}=this.current;E.metricStart(F,
A,q.x,q.y,0,0,0,0);const w=q.clone(),v=(180/Math.PI*q.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*q.angle%360*(254/360));this._placeFirst(w,A,1,!0);this._outLineLabelAngle=Math.round(254/360*v);this._placeFirst(w,A,0,!0);E.metricEnd()};x._placeBack=function(q,A,E,F,w){const v=q.clone();for(q=q.backwardLength+0;v.prev()&&!(q>=F);)this._placeOnSegment(v,A,q,E,-1,w),q+=v.length+0};x._placeForward=function(q,A,E,F,w){const v=q.clone();for(q=q.remainingLength+0;v.next()&&!(q>=F);)this._placeOnSegment(v,
A,q,E,1,w),q+=v.length+0};x._placeFirst=function(q,A,E,F=!1){const w=this.current.inShaping;var v=w.glyphs;const C=this.current.zoomLevel,{out:G,inId:H}=this.current;for(const L of v)v=L.x>w.bounds.x?E:1-E,v=Math.max(0,C+Math.log2(Math.abs(L.x+L.width/2-w.bounds.x)/(v*q.remainingLength+(1-v)*q.backwardLength))),v=Math.max(A,F?0:v),L.maxZoom=25,L.angle=q.angle+(1-E)*Math.PI,L.minZoom=v,this._writeGlyph(G,H,q.x,q.y,L),E&&this._isVisible(L.minZoom,L.maxZoom)&&(v=L.bounds,G.metricBoxWrite(v.center[0],
v.center[1],v.width,v.height))};x._placeOnSegment=function(q,A,E,F,w,v){var C=this.current.inShaping.glyphs;const {out:G,inId:H}=this.current,L=this.current.inShaping,O=this.current.zoomLevel;var N=q.x+q.dx/q.length*-w*E,K=q.y+q.dy/q.length*-w*E;for(const M of C)if((C=M.x>L.bounds.x?v:1-v)&&1===w||!C&&-1===w){var I=Math.abs(M.x+M.width/2-L.bounds.x);C=Math.max(0,O+Math.log2(I/E)-.1);I=Math.max(F,O+Math.log2(I/(E+q.length+0)));0!==C&&(M.angle=q.angle+(1-v)*Math.PI,M.minZoom=I,M.maxZoom=C,this._writeGlyph(G,
H,N,K,M),v&&this._isVisible(M.minZoom,M.maxZoom)&&(C=M.bounds,G.metricBoxWrite(C.center[0]+(q.x-A.x),C.center[1]+(q.y-A.y),C.width,C.height)))}};x._writeGlyphs=function(q,A,E,F,w=this._minZoom){if(!(0>E.x||512<=E.x||0>E.y||512<=E.y)){var v=E.x+this._refOffsetX;E=E.y-this._refOffsetY;for(const C of F.glyphs)C.minZoom=w,C.maxZoom=this._maxZoom,this._writeGlyph(q,A,v,E,C);F=F.boundsT;q.metricStart(A,w,v,E,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);q.metricBoxWrite(F.center[0],
F.center[1],F.width,F.height);q.metricEnd()}};x._writeVertexCommon=function(q,A,E,F){const w=this._color,v=this._haloColor,C=e.i8888to32(0,0,this._size,this._haloSize);F=e.i8888to32(Math.floor(10*Math.max(F.minZoom,this._minZoom)),Math.floor(10*Math.min(F.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);q.vertexWrite(E);q.vertexWrite(A);q.vertexWrite(w);q.vertexWrite(v);q.vertexWrite(C);q.vertexWrite(this._refSymbolAndPlacementOffset);q.vertexWrite(F)};t._createClass(r,[{key:"_shapedBox",get:function(){return z.unwrap(this._shapingInfo).bounds}}]);
return r}(p)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(t,u,B,D){function z(a){return a.length-1}function y(a){let c=0;for(let e=0;e<z(a);e++)c+=l(a,e);return c}function l(a,c,e=1){const [f,k]=a[c+1];return Math.sqrt(f*f+k*k)*e}function g(a,c,e,f,k){if(!(e<c)){var p=f.clone().seek(e/2);B.isNone(p)||(a(p.clone(),e,k),e=(e-c)/2,p=B.unwrap(p.seek(c/2)),
g(a,c,e,f,k+1),g(a,c,e,p,k+1))}}let d=function(){function a(e,f,k,p,m){this._segments=e;this._index=f;this._distance=k;this._xStart=p;this._yStart=m;this._done=!1}a.create=function(e){return new a(e,0,0,e[0][0],e[0][1])};var c=a.prototype;c.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};c.equals=function(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||
0===e._distance)};c.leq=function(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance};c.geq=function(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance};c.hasPrev=function(){return 0<=this._index-1};c.hasNext=function(){return this._index+1<z(this._segments)};c.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};c.prev=function(){if(!this.hasPrev())return this._done=
!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};c._seekBackwards=function(e,f){var k=this.backwardLength;if(e<=k)return this._distance=(k-e)/this.length,this;for(k=this.backwardLength;this.prev();){if(k+this.length>e)return this._seekBackwards(e-k);k+=this.length}this._distance=0;return f?this:null};c.seek=function(e,f=!1){if(0>e)return this._seekBackwards(Math.abs(e),f);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,
this;let k=this.remainingLength;for(;this.next();){if(k+this.length>e)return this.seek(e-k,f);k+=this.length}this._distance=1;return f?this:null};u._createClass(a,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const e=this.dy;let f=Math.acos((0*e+-1*-this.dx)/(1*this.length));0<e&&(f=2*Math.PI-f);return f}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+
this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:e,dy:f}=this;return Math.sqrt(e*
e+f*f)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return a}();t.SegmentCursor=d;t.pathDivide=function(a,c,e,f=!0){const k=y(a);a=d.create(a);const p=k/2;if(f){f=Math.floor(Math.max((k-c)/2,0)/c);a.seek(p-f*c);for(let m=-f;m<=f;m++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&e(a.clone(),m,p+m*c,k),
a.seek(c)}else a.seek(p),e(a.clone(),0,p+0*c,k)};t.pathLength=y;t.pathSubdivide=function(a,c,e){g(e,c,y(a),d.create(a),0)};t.segmentAt=function(a,c){return a[c+1]};t.segmentCount=z;t.segmentLength=l;t.smoothPaths=function(a,c){for(let v=0;v<a.length;v++){var e=a[v];const C=[];C.push(e[0]);for(var f=1;f<e.length;f++){let [G,H]=C[f-1];G+=e[f][0];H+=e[f][1];C.push([G,H])}a:{e=C;f=c;if(0>=f)break a;const G=e.length;if(3>G)break a;const H=[];var k=0;H.push(0);for(var p=1;p<G;p++)k+=D.dist(e[p],e[p-1]),
H.push(k);f=Math.min(f,.2*k);k=[];k.push(e[0][0]);k.push(e[0][1]);p=e[G-1][0];const L=e[G-1][1];var m=D.sub([0,0],e[0],e[1]);D.normalize(m);e[0][0]+=f*m[0];e[0][1]+=f*m[1];D.sub(m,e[G-1],e[G-2]);D.normalize(m);e[G-1][0]+=f*m[0];e[G-1][1]+=f*m[1];for(m=1;m<G;m++)H[m]+=f;H[G-1]+=f;m=.5*f;for(let O=1;O<G-1;O++){let N=0,K=0,I=0;for(var b=O-1;0<=b&&!(H[b+1]<H[O]-m);b--){var h=m+H[b+1]-H[O],n=H[b+1]-H[b],r=H[O]-H[b]<m?1:h/n;if(1E-6>Math.abs(r))break;var x=r*r,q=r*h-.5*x*n,A=r*n/f,E=e[b+1],F=e[b][0]-E[0],
w=e[b][1]-E[1];N+=A/q*(E[0]*r*h+.5*x*(h*F-n*E[0])-x*r*n*F/3);K+=A/q*(E[1]*r*h+.5*x*(h*w-n*E[1])-x*r*n*w/3);I+=A}for(b=O+1;b<G&&!(H[b-1]>H[O]+m);b++){h=m-H[b-1]+H[O];n=H[b]-H[b-1];r=H[b]-H[O]<m?1:h/n;if(1E-6>Math.abs(r))break;x=r*r;q=r*h-.5*x*n;A=r*n/f;E=e[b-1];F=e[b][0]-E[0];w=e[b][1]-E[1];N+=A/q*(E[0]*r*h+.5*x*(h*F-n*E[0])-x*r*n*F/3);K+=A/q*(E[1]*r*h+.5*x*(h*w-n*E[1])-x*r*n*w/3);I+=A}k.push(N/I);k.push(K/I)}k.push(p);k.push(L);for(let O=0,N=0;O<G;O++)e[O][0]=k[N++],e[O][1]=k[N++]}e=[];e.push(C[0]);
for(f=1;f<C.length;f++){const [G,H]=C[f-1],[L,O]=C[f];e.push([Math.round(L-G),Math.round(O-H)])}a[v]=e}return a};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(t){function u(B,D){return Math.sqrt(B*B+D*D)}t.DEFAULT_MAX_ZOOM=100;t.DEFAULT_MIN_ZOOM=0;t.dist=function(B,D){return u(B[0]-D[0],B[1]-D[1])};t.getLimitCosine=function(B=2){return 1/Math.max(B,1)};t.getMinMaxZoom=function(B,D){const z=!!B.minScale&&
D.scaleToZoom(B.minScale)||0;B=!!B.maxScale&&D.scaleToZoom(B.maxScale)||100;return[z,B]};t.isExtent=function(B){return void 0!==B.xmin&&void 0!==B.ymin&&void 0!==B.xmax&&void 0!==B.ymax};t.isFunction=function(B){return"function"===typeof B};t.isMultipoint=function(B){return void 0!==B.points};t.isPoint=function(B){return void 0!==B.x&&void 0!==B.y};t.isPolygon=function(B){return void 0!==B.rings};t.isPolyline=function(B){return void 0!==B.paths};t.len=u;t.normalize=function(B){const D=u(B[0],B[1]);
B[0]/=D;B[1]/=D};t.sub=function(B,D,z){B[0]=D[0]-z[0];B[1]=D[1]-z[1];return B};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e){return function(f){function k(p,m,b,h,n,r,x,q,A,E,F,w,v,C,G,H,L,O,N=!1,K,I){var M=f.call(this)||this;M._xOffset=B.pt2px(v);M._yOffset=B.pt2px(C);M._decoration=E||"none";M._color=n;M._haloColor=r;M._haloSize=Math.min(Math.floor(5*B.pt2px(B.toPt(b))),127);M._size=Math.min(Math.round(B.pt2px(m)),127);m=Math.min(Math.round(B.pt2px(h||m)),127);M._referenceSize=Math.round(Math.sqrt(256*m));M._scale=M._size/l.GLYPH_SIZE;M._angle=w;M._justify=z.getJustification(x||"center");
M._xAlignD=z.getXAnchorDirection(x||"center");M._yAlignD=z.getYAnchorDirection(q||"baseline");M._baseline="baseline"===(q||"baseline");M._bitset=(A===D.Alignment.MAP?1:0)|(F?1:0)<<1;p=d.MaterialKeyBase.load(p);p.sdf=!0;M._materialKey=p.data;M._lineWidth=B.pt2px(G)||512;M._lineHeight=H||1;M._textPlacement=L;M._effects=O;M._isCIM=N;M._minMaxZoom=g.i1616to32(Math.round(K*l.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(I*l.MIN_MAX_ZOOM_PRECISION_FACTOR));return M}t._inheritsLoose(k,f);k.fromText=function(p,
m){const b=new k(p.materialKey,p.font.size,p.haloSize||0,p.font.size,p.color&&y.premultiplyAlphaRGBAArray(p.color)||0,p.haloColor&&y.premultiplyAlphaRGBAArray(p.haloColor)||0,p.horizontalAlignment,p.verticalAlignment,D.Alignment.SCREEN,p.font.decoration,!1,p.angle||0,p.xoffset,p.yoffset,p.lineWidth,p.lineHeight,null,null,!1,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM),[,h]=u.bidiText(p.text);b.bindTextInfo(m,h);b._vertexBoundsScale=p.maxVVSize?p.maxVVSize/p.font.size:1;return b};k.fromCIMText=function(p,
m,b){var h=p.scaleFactor||1;const n=p.size*p.sizeRatio*h,[r,x]=a.getMinMaxZoom(p.scaleInfo,b);b=new k(p.materialKey,n,p.outlineSize*p.sizeRatio,p.referenceSize,y.premultiplyAlphaRGBA(p.color),y.premultiplyAlphaRGBA(p.outlineColor),p.horizontalAlignment,p.verticalAlignment,p.alignment,p.decoration,p.colorLocked,p.angle,p.offsetX*p.sizeRatio*h,p.offsetY*p.sizeRatio*h,512,1,p.markerPlacement,p.effects,!0,r,x);[,h]=u.bidiText(p.text);b.bindTextInfo(m,h);b._vertexBoundsScale=p.maxVVSize?p.maxVVSize/n:
1;return b};return k}(c(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(t,u,B,D,z,y,l,g,d,a){return c=>function(e){function f(...p){p=
e.call(this,...p)||this;p._isCIM=!1;p._vertexBoundsScale=1;p.geometryType=l.WGLGeometryType.TEXT;p._aux=g.i8888to32(0,0,p._referenceSize,p._bitset);return p}t._inheritsLoose(f,e);var k=f.prototype;k.bindTextInfo=function(p,m){this._shapingInfo=p&&p.length?u.applySome(p,b=>a.shapeGlyphs(b,m,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:y.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};k._write=function(p,m,b,h){const n=m.getDisplayId();this._writeGeometry(p,m,n,b,h)};k._writeGeometry=function(p,m,b,h,n){const r=this._shapingInfo;if(!u.isNone(r)){if(u.isSome(this._textPlacement))return m=null!=n?n:m.readLegacyGeometryForDisplay(),this._writePlacedText(p,b,m,r,h);h=n?D.deltaDecodeGeometry(D.convertFromGeometry(n),2):"esriGeometryPolygon"===m.geometryType?m.readCentroid():m.readGeometryForDisplay();
if(!u.isNone(h)){if(h.isPoint){const [x,q]=h.coords;return!p.hasAggregates&&p.hasPixelBufferEnabled&&(0>x||512<=x||0>q||512<=q)?void 0:this._writeGlyphs(p,b,{x,y:q},r)}h.forEachVertex((x,q)=>this._writeGlyphs(p,b,{x,y:q},r))}}};k._writePlacedText=function(p,m,b,h,n){var r=u.unwrap(this._textPlacement);if(b=z.CIMMarkerPlacementHelper.getPlacement(b,r,B.pt2px(1),n.geometryEngine))for(var x=b.next();null!=x;)n=-x.getAngle(),h.setRotation(n),r=x.tx,x=-x.ty,0>r||512<=r||0>x||512<=x||(this._writeGlyphs(p,
m,{x:r,y:x},h),h.setRotation(-n)),x=b.next()};k._writeGlyphs=function(p,m,b,h){const n=d.MaterialKeyBase.load(this._materialKey),r=g.i1616to32(Math.round(8*b.x),Math.round(8*b.y)),x=this._vertexBoundsScale,q=h.bounds,A=2*Math.max(q.width,q.height);for(const E of h.glyphs)n.textureBinding=E.textureBinding,p.recordStart(m,n.data,this.geometryType,!0),p.vertexBounds(b.x+q.x+this._xOffset,b.y+q.y-this._yOffset,A*x,A*x),this._writeVertices(p,m,r,E),p.recordEnd()};k._writeGlyph=function(p,m,b,h,n){var r=
d.MaterialKeyBase.load(this._materialKey);const x=g.i1616to32(Math.round(8*b),Math.round(8*h));r.textureBinding=n.textureBinding;p.recordStart(m,r.data,this.geometryType,!0);r=n.bounds;const q=this._vertexBoundsScale;p.vertexBounds(b+r.x*q,h+r.y*q,r.width*q,r.height*q);this._writeVertices(p,m,x,n);p.recordEnd()};k._writeVertices=function(p,m,b,h){const n=p.vertexCount();this._writeVertexCommon(p,m,b,h);p.vertexWrite(h.offsets.upperLeft);p.vertexWrite(h.texcoords.upperLeft);p.vertexEnd();this._writeVertexCommon(p,
m,b,h);p.vertexWrite(h.offsets.upperRight);p.vertexWrite(h.texcoords.upperRight);p.vertexEnd();this._writeVertexCommon(p,m,b,h);p.vertexWrite(h.offsets.lowerLeft);p.vertexWrite(h.texcoords.lowerLeft);p.vertexEnd();this._writeVertexCommon(p,m,b,h);p.vertexWrite(h.offsets.lowerRight);p.vertexWrite(h.texcoords.lowerRight);p.vertexEnd();p.indexWrite(n+0);p.indexWrite(n+1);p.indexWrite(n+2);p.indexWrite(n+1);p.indexWrite(n+3);p.indexWrite(n+2)};k._writeVertexCommon=function(p,m,b,h){h=this._color;const n=
this._haloColor,r=g.i8888to32(0,0,this._referenceSize,this._bitset),x=g.i8888to32(0,0,this._size,this._haloSize);p.vertexWrite(b);p.vertexWrite(m);p.vertexWrite(h);p.vertexWrite(n);p.vertexWrite(x);p.vertexWrite(r);p.vertexWrite(this._minMaxZoom)};return f}(c)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(t,u,B){let D=function(){function z(){}z.getPlacement=function(y,l,g,d){const a=B.getPlacementOperator(l);if(!a)return null;
y=u.cloneAndDecodeGeometry(y);return a.execute(y,l,g,d)};return z}();t.CIMMarkerPlacementHelper=D;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(t,u){return function(){function B(){}var D=B.prototype;D.bindFeature=function(z,y,l){};D.write=function(z,y,l,g){var d;if(t.isNone(this._effects)||0===(null==(d=this._effects)?
void 0:d.length))return this._write(z,y,g);l=u.CIMEffectHelper.executeEffects(this._effects,y.readLegacyGeometryForDisplay(),g.geometryEngine);for(d=u.CIMEffectHelper.next(l);d;)this._write(z,y,g,d),d=u.CIMEffectHelper.next(l)};D._write=function(z,y,l,g){};return B}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(t,u,B,D,z){const y=96/72;let l=function(){function g(){}g.executeEffects=
function(d,a,c){a=B.cloneAndDecodeGeometry(a);a=new D.SimpleGeometryCursor(a);for(const e of d)(d=z.getEffectOperator(e))&&(a=d.execute(a,e,y,c));return a};g.next=function(d){d=d.next();B.deltaEncodeGeometry(d);return d};g.applyEffects=function(d,a,c){if(!d)return a;a=new D.SimpleGeometryCursor(a);for(var e of d)(d=z.getEffectOperator(e))&&(a=d.execute(a,e,1,c));for(c=null;e=a.next();)c?u.isPolyline(c)?u.isPolyline(e)&&c.paths.push(...e.paths):u.isPolygon(c)&&u.isPolygon(e)&&c.rings.push(...e.rings):
c=e;return c};return g}();t.CIMEffectHelper=l;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f){return function(k){function p(m,b,h,n,r,x,q,A,E,F,w,v,C,G,H,L,O,N,K,I,M,U,T){var Q=k.call(this)||this;Q.angle=n;Q.height=q;Q.width=x;Q.xOffset=b*K;Q.yOffset=h*K;Q._markerPlacement=I;Q._effects=M;Q._anchorX=.5-(.5+L)*H.width/H.width;Q._anchorY=.5-(.5+O)*H.height/H.height;Q._minMaxZoom=d.i1616to32(Math.round(U*g.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(T*g.MIN_MAX_ZOOM_PRECISION_FACTOR));b=(G===y.Alignment.MAP?g.BITSET_MARKER_ALIGNMENT_MAP:g.BITSET_MARKER_ALIGNMENT_SCREEN)|
(w?g.BITSET_GENERIC_LOCK_COLOR:0)|(C?g.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(v?g.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);h=H&&H.sdf;m=a.MarkerMaterialKey.load(m);m.sdf=h;m.pattern=!0;m.textureBinding=H.textureBinding;Q._materialKey=m.data;Q._fillColor=r;Q._outlineColor=E;Q._sizeOutlineWidth=d.i8888to32(Math.round(Math.min(Math.sqrt(128*x),255)),Math.round(Math.min(Math.sqrt(128*q),255)),Math.round(Math.min(Math.sqrt(128*F),255)),Math.round(Math.min(Math.sqrt(128*A),255)));r=H.rect.x+
g.SPRITE_PADDING;A=H.rect.y+g.SPRITE_PADDING;E=r+H.width;H=A+H.height;Q._offsets.xUpperLeft=r;Q._offsets.yUpperLeft=A;Q._offsets.xUpperRight=E;Q._offsets.yUpperRight=A;Q._offsets.xBottomLeft=r;Q._offsets.yBottomLeft=H;Q._offsets.xBottomRight=E;Q._offsets.yBottomRight=H;Q._texUpperLeft=d.i1616to32(r,A);Q._texUpperRight=d.i1616to32(E,A);Q._texBottomLeft=d.i1616to32(r,H);Q._texBottomRight=d.i1616to32(E,H);x=x*N*K;q=q*N*K;Q._bitestAndDistRatio=d.i1616to32(b,Math.round(64*N));Q._computedWidth=x;Q._computedHeight=
q;x=z.create();q=D.create();Q._applyTransformation(q,x);return Q}t._inheritsLoose(p,k);p.fromCIMMarker=function(m,b,h){const n=m.size,r=(b&&b.width||1)/(b&&b.height||1)*m.scaleX;var x=m.scaleSymbolsProportionally&&m.frameHeight?n/m.frameHeight:1;let q=l.premultiplyAlphaRGBA(m.color);const A=l.premultiplyAlphaRGBA(m.outlineColor),E=B.pt2px(n),F=E*r,w=B.pt2px(m.offsetX||0),v=B.pt2px(m.offsetY||0);x*=B.pt2px(m.outlineWidth||0);const C=m.alignment||y.Alignment.SCREEN,G=B.pt2px(m.referenceSize),[H,L]=
c.getMinMaxZoom(m.scaleInfo,h);b.sdf||0!==q||(q=-1);h=m.rotation||0;m.rotateClockwise||(h=-h);let O=0,N=0;const K=m.anchorPoint;K&&(m.isAbsoluteAnchorPoint?n&&(O=-K.x/(n*r),N=K.y/n):(O=K.x,N=K.y));b=new p(m.materialKey,w,v,h,q,F,E,G,A,x,m.colorLocked,m.scaleSymbolsProportionally,!1,C,b,O,N,m.sizeRatio,u.unwrapOr(m.scaleFactor,1),m.markerPlacement,m.effects,H,L);b._vertexBoundsScaleX=m.maxVVSize?m.maxVVSize/F:1;b._vertexBoundsScaleY=m.maxVVSize?m.maxVVSize/E:1;return b};p.fromPictureMarker=function(m,
b){const h=Math.round(B.pt2px(m.width)),n=Math.round(B.pt2px(m.height)),r=g.PICTURE_FILL_COLOR,x=Math.round(B.pt2px(m.xoffset||0)),q=Math.round(B.pt2px(m.yoffset||0));b=new p(m.materialKey,x,q,m.angle,r,h,n,n,0,0,!1,!1,!1,y.Alignment.SCREEN,b,0,0,1,1,null,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);b._vertexBoundsScaleX=m.maxVVSize?m.maxVVSize/m.width:1;b._vertexBoundsScaleY=m.maxVVSize?m.maxVVSize/m.height:1;return b};p.fromSimpleMarker=function(m,b){const h=l.premultiplyAlphaRGBAArray(m.color),
n=Math.round(B.pt2px(m.size)),r=Math.round(B.pt2px(m.xoffset||0)),x=Math.round(B.pt2px(m.yoffset||0)),q=m.style;var A=m.outline;const E=(A&&A.color&&l.premultiplyAlphaRGBAArray(A.color))|0;A=(A&&A.width&&Math.round(B.pt2px(A.width)))|0;b=new p(m.materialKey,r,x,m.angle,h,n,n,n,E,A,!1,!1,"esriSMSCross"===q||"esriSMSX"===q,y.Alignment.SCREEN,b,0,0,1.96875,1,null,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);b.boundsType="esriSMSCircle"===q?"circle":"square";b._vertexBoundsScaleX=m.maxVVSize?m.maxVVSize/
m.size:1;b._vertexBoundsScaleY=m.maxVVSize?m.maxVVSize/m.size:1;return b};p.fromLineSymbolMarker=function(m,b){const h=l.premultiplyAlphaRGBAArray(m.color),n=Math.round(B.pt2px(6*m.lineWidth)),r="cross"===m.style||"x"===m.style;switch(m.placement){case "begin-end":var x=y.ExtremityPlacement.Both;break;case "begin":x=y.ExtremityPlacement.JustBegin;break;case "end":x=y.ExtremityPlacement.JustEnd;break;default:x=y.ExtremityPlacement.None}x={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,
extremityPlacement:x,offsetAlongLine:0};b=new p(m.materialKey,0,0,0,h,n,n,n/6,h,r?Math.round(B.pt2px(m.lineWidth)):0,!1,!1,r,y.Alignment.MAP,b,0,0,1.96875,1,x,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);b.boundsType="circle"===m.style?"circle":"square";return b};return p}(e(f))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c){const e=3.14159265359/180;return f=>function(k){function p(...b){b=k.call(this,...b)||this;b.angle=0;b.xOffset=0;b.yOffset=0;b.width=0;b.height=0;b.boundsType="square";b._anchorX=0;b._anchorY=0;b._computedWidth=0;b._computedHeight=0;b._vertexBoundsScaleX=1;b._vertexBoundsScaleY=1;b._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};b.geometryType=a.WGLGeometryType.MARKER;return b}t._inheritsLoose(p,
k);var m=p.prototype;m._write=function(b,h,n,r){const x=h.getDisplayId();b.recordStart(x,this._materialKey,this.geometryType,!0);this._writeGeometry(b,h,x,n,r);b.recordEnd()};m._writeGeometry=function(b,h,n,r,x){if(u.isSome(this._markerPlacement))return this._writePlacedMarkers(b,h,r,x);if(!x&&"esriGeometryPoint"===h.geometryType)return r=h.getX(),h=h.getY(),!b.hasAggregates&&b.hasPixelBufferEnabled&&(0>r||513<=r||0>h||513<=h)?void 0:this._writeVertices(b,n,this._getPos(r,h),r,h);h=x?g.deltaDecodeGeometry(g.convertFromGeometry(x),
2):"esriGeometryPolygon"===h.geometryType?h.readCentroid():h.readGeometryForDisplay();if(!u.isNone(h)){if(h.isPoint){const [q,A]=h.coords;return!b.hasAggregates&&b.hasPixelBufferEnabled&&(0>q||512<=q||0>A||512<=A)?void 0:this._writeVertices(b,n,this._getPos(q,A),q,A)}h.forEachVertex((q,A)=>this._writeVertices(b,n,this._getPos(q,A),q,A))}};m._writePlacedMarkers=function(b,h,n,r){r=null!=r?r:h.readLegacyGeometryForDisplay();if(n=d.CIMMarkerPlacementHelper.getPlacement(r,u.unwrap(this._markerPlacement),
B.pt2px(1),n.geometryEngine)){h=h.getDisplayId();r=l.create();for(var x=z.create(),q=n.next();null!=q;){const A=q.tx,E=-q.ty;-128<=A&&640>=A&&-128<=E&&640>=E&&(this._applyTransformation(x,r,-q.getAngle()/e),this._writeVertices(b,h,this._getPos(A,E),A,E));q=n.next()}}};m._writeVertices=function(b,h,n,r,x){const q=b.vertexCount();if(this.angle){const A=Math.max(this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);b.vertexBounds(r+this.xOffset,x-this.yOffset,A,
A)}else b.vertexBounds(r+this.xOffset,x-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);b.vertexWrite(n);b.vertexWrite(this._offsetUpperLeft);b.vertexWrite(this._texUpperLeft);b.vertexWrite(this._bitestAndDistRatio);b.vertexWrite(h);b.vertexWrite(this._fillColor);b.vertexWrite(this._outlineColor);b.vertexWrite(this._sizeOutlineWidth);b.vertexWrite(this._minMaxZoom);b.vertexEnd();b.vertexWrite(n);b.vertexWrite(this._offsetUpperRight);b.vertexWrite(this._texUpperRight);
b.vertexWrite(this._bitestAndDistRatio);b.vertexWrite(h);b.vertexWrite(this._fillColor);b.vertexWrite(this._outlineColor);b.vertexWrite(this._sizeOutlineWidth);b.vertexWrite(this._minMaxZoom);b.vertexEnd();b.vertexWrite(n);b.vertexWrite(this._offsetBottomLeft);b.vertexWrite(this._texBottomLeft);b.vertexWrite(this._bitestAndDistRatio);b.vertexWrite(h);b.vertexWrite(this._fillColor);b.vertexWrite(this._outlineColor);b.vertexWrite(this._sizeOutlineWidth);b.vertexWrite(this._minMaxZoom);b.vertexEnd();
b.vertexWrite(n);b.vertexWrite(this._offsetBottomRight);b.vertexWrite(this._texBottomRight);b.vertexWrite(this._bitestAndDistRatio);b.vertexWrite(h);b.vertexWrite(this._fillColor);b.vertexWrite(this._outlineColor);b.vertexWrite(this._sizeOutlineWidth);b.vertexWrite(this._minMaxZoom);b.vertexEnd();b.indexWrite(q+0);b.indexWrite(q+1);b.indexWrite(q+2);b.indexWrite(q+1);b.indexWrite(q+3);b.indexWrite(q+2)};m._applyTransformation=function(b,h,n=0){D.fromTranslation(b,l.fromValues(this.xOffset,-this.yOffset));
0!==this.angle+n&&D.rotate(b,b,e*(this.angle+n));n=this._computedWidth;const r=this._computedHeight,x=(this._anchorX-.5)*n,q=(this._anchorY-.5)*r;y.set(h,x,q);y.transformMat2d(h,h,b);this._offsetUpperLeft=c.i1616to32(16*h[0],16*h[1]);this._offsets.xUpperLeft=h[0];this._offsets.yUpperLeft=h[1];y.set(h,x+n,q);y.transformMat2d(h,h,b);this._offsetUpperRight=c.i1616to32(16*h[0],16*h[1]);this._offsets.xUpperRight=h[0];this._offsets.yUpperRight=h[1];y.set(h,x,q+r);y.transformMat2d(h,h,b);this._offsetBottomLeft=
c.i1616to32(16*h[0],16*h[1]);this._offsets.xBottomLeft=h[0];this._offsets.yBottomLeft=h[1];y.set(h,x+n,q+r);y.transformMat2d(h,h,b);this._offsetBottomRight=c.i1616to32(16*h[0],16*h[1]);this._offsets.xBottomRight=h[0];this._offsets.yBottomRight=h[1]};m._getPos=function(b,h){return c.i1616to32(Math.round(8*b),Math.round(8*h))};return p}(f)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h,n,r){function x(G,H){const L=G.length;G.push(null);H.then(O=>G[L]=O);return G}function q(G){return!!(G&1)}const A=D.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),E=[];D={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:0};const F={...y.errorPointSymbolJSON,hash:JSON.stringify(y.errorPointSymbolJSON),materialKey:g.createMaterialKey(l.WGLGeometryType.MARKER,D)},w={...y.errorPolylineSymbolJSON,hash:JSON.stringify(y.errorPolylineSymbolJSON),
materialKey:g.createMaterialKey(l.WGLGeometryType.LINE,D)},v={...y.errorPolygonSymbolJSON,hash:JSON.stringify(y.errorPolygonSymbolJSON),materialKey:g.createMaterialKey(l.WGLGeometryType.FILL,D)};y=function(){function G(L,O){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new b.default;this._fetchResource=L;this._tileInfo=O}var H=G.prototype;
H.createTemplateGroup=function(L,O){this._initErrorTemplates();const N=L.hash;if(this._symbolToTemplate.has(N))return this._symbolToTemplate.get(N);const K=[];O&&this._createMeshTemplates(K,O,!0);this._createMeshTemplates(K,L,!1);L=this._createGroupId("expanded-cim"===L.type&&C(L));this._idToTemplateGroup.set(L,K);this._symbolToTemplate.set(N,L);return L};H.getTemplateGroup=function(L){return this._idToTemplateGroup.has(L)?this._idToTemplateGroup.get(L):E};H.getDynamicTemplateGroup=function(L){if(!this._idToTemplateGroup.has(L))return E;
q(L)||A.error("mapview-template-store",`Id ${L} does not refer to a dynamic template`);return this._idToTemplateGroup.get(L)};H.getMosaicItem=function(L,O){const N=this._createTemplateId(),K=new Promise(I=>this._idToResolver.set(N,I));this._fetchQueue.push({symbol:L,id:N,glyphIds:O});return K};H.finalize=function(L){return this._fetchQueue.length||this._lock.isHeld()?b.withLock(this._lock,this._fetchAllQueuedResources.bind(this),L):Promise.resolve()};H._initErrorTemplates=function(){this._errorTemplates||
(this._errorTemplates={fill:this._createMeshTemplates([],v,!1),marker:this._createMeshTemplates([],F,!1),line:this._createMeshTemplates([],w,!1)})};H._fetchAllQueuedResources=function(L){if(!this._fetchQueue.length)return Promise.resolve();const O=this._fetchQueue,N=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(N).then(()=>this._fetchResource(O,L).then(K=>{for(const {id:I,mosaicItem:M}of K)this._idToResolver.get(I)(M),this._idToResolver.delete(I)})).catch(K=>{z.isAbortError(K)?
this._fetchQueue=this._fetchQueue.concat(O):"worker:port-closed"!==K.name&&A.error(new B("mapview-template-store","Unable to fetch requested texture resources",K))})};H._createGroupId=function(L){return this._idCounter++<<1|(L?1:0)};H._createTemplateId=function(){return this._templateIdCounter++};H._createSMS=function(){var L=u._asyncToGenerator(function*(O){const {spriteMosaicItem:N}=yield this.getMosaicItem(O);return h.ok(N,A)?p.fromSimpleMarker(O,N):this._markerError});return function(O){return L.apply(this,
arguments)}}();H._createPMS=function(){var L=u._asyncToGenerator(function*(O){const {spriteMosaicItem:N}=yield this.getMosaicItem(O);return h.ok(N,A)?p.fromPictureMarker(O,N):this._markerError});return function(O){return L.apply(this,arguments)}}();H._createSFS=function(){var L=u._asyncToGenerator(function*(O,N){const {spriteMosaicItem:K}=yield this.getMosaicItem(O);return h.ok(K,A)?f.fromSimpleFill(O,K,N):this._fillError});return function(O,N){return L.apply(this,arguments)}}();H._createPFS=function(){var L=
u._asyncToGenerator(function*(O,N){const {spriteMosaicItem:K}=yield this.getMosaicItem(O);return h.ok(K,A)?f.fromPictureFill(O,K,N):this._fillError});return function(O,N){return L.apply(this,arguments)}}();H._createSLS=function(){var L=u._asyncToGenerator(function*(O,N){({spriteMosaicItem:N}=yield this.getMosaicItem(O));return h.ok(N,A)?k.fromSimpleLine(O,N):this._lineError});return function(O,N){return L.apply(this,arguments)}}();H._createLMS=function(){var L=u._asyncToGenerator(function*(O){const {spriteMosaicItem:N}=
yield this.getMosaicItem(O);return h.ok(N,A)?p.fromLineSymbolMarker(O,N):this._markerError});return function(O){return L.apply(this,arguments)}}();H._createTS=function(){var L=u._asyncToGenerator(function*(O){const {glyphMosaicItems:N}=yield this.getMosaicItem(O);return m.fromText(O,N)});return function(O){return L.apply(this,arguments)}}();H._createCIMText=function(){var L=u._asyncToGenerator(function*(O){const {glyphMosaicItems:N}=yield this.getMosaicItem(r.cimLayerToRasterizationInfo(O),n.codepoints(O.text));
return h.ok(N,A)?m.fromCIMText(O,N,this._tileInfo):this._textError});return function(O){return L.apply(this,arguments)}}();H._createCIMFill=function(){var L=u._asyncToGenerator(function*(O){const {spriteMosaicItem:N}=yield this.getMosaicItem(r.cimLayerToRasterizationInfo(O));return h.ok(N,A)?f.fromCIMFill(O,N,this._tileInfo):this._fillError});return function(O){return L.apply(this,arguments)}}();H._createCIMLine=function(){var L=u._asyncToGenerator(function*(O){const {spriteMosaicItem:N}=yield this.getMosaicItem(r.cimLayerToRasterizationInfo(O));
return h.ok(N,A)?k.fromCIMLine(O,N,this._tileInfo):this._lineError});return function(O){return L.apply(this,arguments)}}();H._createCIMMarker=function(){var L=u._asyncToGenerator(function*(O){const {spriteMosaicItem:N}=yield this.getMosaicItem(r.cimLayerToRasterizationInfo(O));return h.ok(N,A)?p.fromCIMMarker(O,N,this._tileInfo):this._markerError});return function(O){return L.apply(this,arguments)}}();H._createCIM=function(){var L=u._asyncToGenerator(function*(O){const N=O.templateHash;if(this._cimTemplateCache.has(N))return this._cimTemplateCache.get(N);
let K;switch(O.type){case "marker":K=yield this._createCIMMarker(O);break;case "line":K=yield this._createCIMLine(O);break;case "fill":K=yield this._createCIMFill(O);break;case "text":K=yield this._createCIMText(O)}this._cimTemplateCache.set(N,K);return K});return function(O){return L.apply(this,arguments)}}();H._createDynamicCIM=function(){var L=u._asyncToGenerator(function*(O){const N=O.templateHash;if(this._cimTemplateCache.has(N))return this._cimTemplateCache.get(N);let K;switch(O.type){case "marker":K=
c.fromCIMMarker(O,this._tileInfo);break;case "line":K=a.fromCIMLine(O,this._tileInfo);break;case "fill":K=d.fromCIMFill(O,this._tileInfo);break;case "text":K=e.fromCIMText(O,this._tileInfo)}this._cimTemplateCache.set(N,K);return K});return function(O){return L.apply(this,arguments)}}();H._createPrimitiveMeshTemplates=function(L,O,N){switch(O.type){case "esriSMS":return x(L,this._createSMS(O));case "esriPMS":return x(L,this._createPMS(O));case "esriSFS":return x(L,this._createSFS(O,N));case "line-marker":return x(L,
this._createLMS(O));case "esriPFS":return x(L,this._createPFS(O,N));case "esriSLS":return x(L,this._createSLS(O,!1));case "esriTS":return x(L,this._createTS(O));default:return A.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),L}};H._createMeshTemplates=function(L,O,N){if(-1!==O.type.indexOf("3d"))return A.error("3D symbols are not supported with MapView"),L;if("expanded-cim"===O.type){for(const K of O.layers)"function"===typeof K.materialHash?x(L,this._createDynamicCIM(K)):
x(L,this._createCIM(K));return L}if("composite-symbol"===O.type){for(const K of O.layers)this._createPrimitiveMeshTemplates(L,K,N);return L}return"cim"===O.type||"label"===O.type||"web-style"===O.type?L:this._createPrimitiveMeshTemplates(L,O,N)};u._createClass(G,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);
return G}();const C=G=>{if(!G.layers)return!1;for(const H of G.layers)if("function"===typeof H.materialHash)return!0;return!1};t.WGLTemplateStore=y;t.errorPointSchema2D=F;t.errorPolygonSchema2D=v;t.errorPolylineSchema2D=w;t.isDynamicId=q;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e){return function(f){function k(p,m,b){var h;var n=f.call(this,p)||this;n._minMaxZoom=l.i1616to32(Math.round(m*z.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(b*z.MIN_MAX_ZOOM_PRECISION_FACTOR));d.isFunction(p.color)?n._dynamicPropertyMap.set("fillColor",(F,w,v)=>(F=p.color(F,w,v))&&D.premultiplyAlphaRGBA(F)||0):(m=p.color,n.fillColor=m&&D.premultiplyAlphaRGBA(m)||0);const r="CIMMarkerPlacementInsidePolygon"===(null==(h=p.cim.placement)?void 0:h.type)&&p.cim.placement.shiftOddRows?
2:1,x=p.height;d.isFunction(x)?n._dynamicPropertyMap.set("_height",(F,w,v)=>x(F,w,v)*r):n._height=(x||0)*r;const q=p.offsetX;d.isFunction(q)?n._dynamicPropertyMap.set("_offsetX",(F,w,v)=>{F=B.pt2px(q(F,w,v))+128;255<F?F=255:0>F&&(F=0);return F}):(h=B.pt2px(q||0)+128,255<h?h=255:0>h&&(h=0),n._offsetX=h);const A=p.offsetY;d.isFunction(A)?n._dynamicPropertyMap.set("_offsetY",(F,w,v)=>{F=B.pt2px(-A(F,w,v))+128;255<F?F=255:0>F&&(F=0);return F}):(h=B.pt2px(-A||0)+128,255<h?h=255:0>h&&(h=0),n._offsetY=h);
h=p.scaleX;d.isFunction(h)?n._dynamicPropertyMap.set("_scaleX",h):n._scaleX=h||1;const E=p.angle;d.isFunction(E)?n._dynamicPropertyMap.set("_angle",(F,w,v)=>y.radToByte(E(F,w,v))):n._angle=y.radToByte(E)||0;u.isSome(p.effects)&&(h=p.effects,d.isFunction(h)?n._dynamicPropertyMap.set("_effects",h):n._effects=h);n._cimFillLayer=p;n._fillMaterialKey=g.FillMaterialKey.load(p.materialKey);return n}t._inheritsLoose(k,f);k.fromCIMFill=function(p,m){const [b,h]=d.getMinMaxZoom(p.scaleInfo,m);return new k(p,
b,h)};k.prototype.bindFeature=function(p,m,b){const h=p.readLegacyFeature();this._dynamicPropertyMap.forEach((x,q)=>{this[q]=x(h,m,b)});p=this._fillMaterialKey;var n=this._materialCache,r=this._cimFillLayer.materialHash;r=r(h,m,b);r=n.get(r);n=null;r&&e.ok(r.spriteMosaicItem)&&(n=r.spriteMosaicItem);if(n){const {rect:x,width:q,height:A}=n;r=x.x+z.SPRITE_PADDING;const E=x.y+z.SPRITE_PADDING,F=r+q,w=E+A;let v=Math.round(B.pt2px(this._height));255<v?v=255:0>=v&&(v=w-E);let C=Math.round(B.pt2px(this._height/
A*q||0));255<C?C=255:0>=C&&(C=F-r);const G=this._scaleX;this.tl=l.i1616to32(r,E);this.br=l.i1616to32(F,w);this.aux2=l.i8888to32(C,v,this._offsetX,this._offsetY);this.aux3=l.i8888to32(G,1,this._angle,0);p.sdf=n.sdf;p.pattern=!0;p.textureBinding=n.textureBinding}else this.aux3=this.aux2=this.br=this.tl=0,p.sdf=!1,p.pattern=!1,p.textureBinding=0;this._materialKey=p.data};return k}(a(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(t,u,B,D,z,y,l,g){return d=>function(a){function c(...f){f=a.call(this,...f)||this;f.forceLibtess=!1;f._bitset=0;f._lineTemplate=null;f.geometryType=D.WGLGeometryType.FILL;return f}t._inheritsLoose(c,a);var e=c.prototype;e._maybeAddLineTemplate=function(f){this._lineTemplate=g.fromFillOutline(f)};e._write=function(f,k,p,m){p="esriGeometryPoint"===k.geometryType;const b=y.FillMaterialKey.load(this._materialKey);f.recordStart(k.getDisplayId(),this._materialKey,this.geometryType,p);this._writeGeometry(f,
k,b,m,p);b.outlinedFill&&u.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(f,k,m,p);f.recordEnd()};e._writeGeometry=function(f,k,p,m,b){m=this._getGeometry(k,m,b);u.isNone(m)||(b=[],100<m.maxLength||this.forceLibtess||!l.triangulate(b,m)?(m=l.triangulateLibtess(m),this._writeVertices(f,k,m,[m.length/2],p)):b.length&&this._writeVertices(f,k,m.coords,m.lengths,p,b))};e._writeVertex=function(f,k,p,m,b,h){const n=z.i1616to32(1*m,1*b);f.vertexBounds(m,b,0,0);f.vertexWrite(n);f.vertexWrite(k);
p.dotDensity?f.vertexWriteF32(1/Math.abs(h.readGeometryArea())):(f.vertexWrite(this.fillColor),p.simple||(f.vertexWrite(this.tl),f.vertexWrite(this.br)),f.vertexWrite(this.aux2),f.vertexWrite(this.aux3),p.simple||f.vertexWrite(this._minMaxZoom))};e._writeVertices=function(f,k,p,m,b,h){var n=k.getDisplayId();n|=this._bitset<<24;var r=m.reduce((q,A)=>q+A);const x=b.dotDensity?4:10;m=f.vertexCount();f.vertexEnsureSize(x*r);r=0;if(h)for(const q of h)this._writeVertex(f,n,b,p[2*q],p[2*q+1],k),r++;else for(h=
0;h<p.length;h+=2)this._writeVertex(f,n,b,Math.round(p[h]),Math.round(p[h+1]),k),r++;f.indexEnsureSize(r);for(k=0;k<r;k++)f.indexWrite(k+m)};e._getGeometry=function(f,k,p){return(f=k?B.deltaDecodeGeometry(B.convertFromGeometry(k),2):f.readGeometryForDisplay())?l.clipMarshall(f,p?256:8):null};return c}(d)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../Geometry ../../TileClipper ../bufcut".split(" "),
function(t,u,B,D,z,y,l,g,d){function a(k,p,m){let b=0;for(let h=1;h<m;h++)b+=(k[2*(p+h)]-k[2*(p+h-1)])*(k[2*(p+h)+1]+k[2*(p+h-1)+1]);return b}function c(k,p,m,b,h){let n=0;for(;m<b;m+=3){const r=2*(k[m]-h),x=2*(k[m+1]-h),q=2*(k[m+2]-h);n+=Math.abs((p[r]-p[q])*(p[x+1]-p[r+1])-(p[r]-p[x])*(p[q+1]-p[r+1]))}return n}const e=new g.TileClipper(0,0,0,1,0),f=new g.TileClipper(0,0,0,1,0);e.setExtent(y.TILE_SIZE);f.setExtent(y.TILE_SIZE);t.area=a;t.clipLinesMarshall=function(k,p){f.setPixelMargin(p);const m=
-p;p=y.TILE_SIZE+p;let b=[];var h=!1;let n=0;for(;n<k.length;){const r=[],x=k[n];if(!x)return null;f.reset(l.GeometryType.LineString);let [q,A]=x[0];if(h)f.moveTo(q,A);else{if(q<m||q>p||A<m||A>p){h=!0;continue}r.push({x:q,y:A})}let E=!1;const F=x.length;for(let w=1;w<F;++w)if(q+=x[w][0],A+=x[w][1],h)f.lineTo(q,A);else{if(q<m||q>p||A<m||A>p){E=!0;break}r.push({x:q,y:A})}if(E)h=!0;else{if(h){if(h=f.resultWithStarts())for(const w of h)b.push(w)}else b.push({line:r,start:0});n++;h=!1}}b=b.filter(r=>1<
r.line.length);return 0===b.length?null:b};t.clipMarshall=function(k,p){if(u.isNone(k))return null;a:{var m=y.TILE_SIZE+128;var b=0;for(var h=0;h<k.lengths.length;h++){var n=k.lengths[h];for(var r=0;r<n;r++){const x=k.coords[2*(r+b)],q=k.coords[2*(r+b)+1];if(-128>x||x>m||-128>q||q>m){m=!0;break a}}b+=n}m=!1}if(!m)return k;e.setPixelMargin(p);e.reset(l.GeometryType.Polygon);p=0;for(m=0;m<k.lengths.length;m++){b=k.lengths[m];h=k.coords[2*(0+p)];n=k.coords[2*(0+p)+1];e.moveTo(h,n);for(r=1;r<b;r++)h=
k.coords[2*(r+p)],n=k.coords[2*(r+p)+1],e.lineTo(h,n);e.close();p+=b}m=e.result(!1);if(!m)return null;k=[];p=[];for(const x of m){m=0;for(const q of x)p.push(q.x),p.push(q.y),m++;k.push(m)}return new z(k,p)};t.triangleArea=function(k,p,m,b,h){let n=0;for(;m<b;m+=3){const r=2*(k.getValue(m)-h),x=2*(k.getValue(m+1)-h),q=2*(k.getValue(m+2)-h);n+=Math.abs((p[r]-p[q])*(p[x+1]-p[r+1])-(p[r]-p[x])*(p[q+1]-p[r+1]))}return n};t.triangleAreaArray=c;t.triangulate=function(k,p){const {coords:m,lengths:b,hasIndeterminateRingOrder:h}=
p;if(h)return!1;p=0;for(var n=0;n<b.length;){let q=n,A=b[n];n=a(m,p,A);for(var r=[];++q<b.length;){var x=b[q];const E=a(m,p+A,x);if(!(0<E))break;n+=E;r.push(p+A);A+=x}x=k.length;d.bufcut(k,m,p,p+A,r,2,0);r=c(k,m,x,k.length,0);n=Math.abs(n);if(1E-5<Math.abs((r-n)/Math.max(1E-7,n)))return k.length=0,!1;n=q;p+=A}return!0};t.triangulateEarcut=function(k,p,m){const {coords:b,lengths:h,hasIndeterminateRingOrder:n}=p;if(n)return!1;let r=0;for(var x=0;x<h.length;){let A=x,E=h[x];for(x=[];++A<h.length;){var q=
h[A];if(!(0<a(b,r+E,q)))break;x.push(r+E-r);E+=q}q=p.coords.slice(2*r,2*(r+E));x=B.earcut(q,x,2);for(const F of x)k.push(F+m+r);x=A;r+=E}return!0};t.triangulateLibtess=function(k){const {coords:p,lengths:m}=k;({buffer:k}=D.triangulate(p,m));return k};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/chunks/earcut":function(){define(["exports"],function(t){var u={exports:{}};(function(B){(function(D){D=D();void 0!==D&&(B.exports=D)})(function(){function D(w,v,C){C=C||2;var G=v&&v.length,H=
G?v[0]*C:w.length,L=z(w,0,H,C,!0),O=[];if(!L||L.next===L.prev)return O;var N;if(G){var K=L;var I=C;L=[];var M;G=0;for(M=v.length;G<M;G++){var U=v[G]*I;var T=G<M-1?v[G+1]*I:w.length;U=z(w,U,T,I,!1);U===U.next&&(U.steiner=!0);L.push(f(U))}L.sort(d);for(G=0;G<L.length;G++)I=L[G],v=K,(K=c(I,v))?(M=x(K,I),I=y(K,K.next),M=a(M),y(M,M.next),I=a(I),K=a(v===K?I:v)):K=v,K=y(K,K.next);L=K}if(w.length>80*C){var Q=N=w[0];var J=G=w[1];for(I=C;I<H;I+=C)v=w[I],K=w[I+1],v<Q&&(Q=v),K<J&&(J=K),v>N&&(N=v),K>G&&(G=K);
N=Math.max(N-Q,G-J);N=0!==N?1/N:0}l(L,O,C,Q,J,N);return O}function z(w,v,C,G,H){if(H===0<F(w,v,C,G))for(H=v;H<C;H+=G)var L=q(H,w[H],w[H+1],L);else for(H=C-G;H>=v;H-=G)L=q(H,w[H],w[H+1],L);L&&m(L,L.next)&&(w=L.next,A(L),L=w);return L}function y(w,v){if(!w)return w;v||(v=w);do{var C=!1;if(w.steiner||!m(w,w.next)&&0!==p(w.prev,w,w.next))w=w.next;else{v=w.prev;A(w);w=v;if(w===w.next)break;C=!0}}while(C||w!==v);return v}function l(w,v,C,G,H,L,O){if(w){if(!O&&L){var N=w,K=N;do null===K.z&&(K.z=e(K.x,K.y,
G,H,L)),K.prevZ=K.prev,K=K.nextZ=K.next;while(K!==N);K.prevZ.nextZ=null;K.prevZ=null;N=K;var I,M,U,T,Q=1;do{K=N;var J=N=null;for(M=0;K;){M++;var P=K;for(I=U=0;I<Q&&(U++,P=P.nextZ,P);I++);for(T=Q;0<U||0<T&&P;)0!==U&&(0===T||!P||K.z<=P.z)?(I=K,K=K.nextZ,U--):(I=P,P=P.nextZ,T--),J?J.nextZ=I:N=I,I.prevZ=J,J=I;K=P}J.nextZ=null;Q*=2}while(1<M)}for(N=w;w.prev!==w.next;){K=w.prev;P=w.next;if(L)J=g(w,G,H,L);else a:if(J=w,M=J.prev,U=J,Q=J.next,0<=p(M,U,Q))J=!1;else{for(I=J.next.next;I!==J.prev;){if(k(M.x,M.y,
U.x,U.y,Q.x,Q.y,I.x,I.y)&&0<=p(I.prev,I,I.next)){J=!1;break a}I=I.next}J=!0}if(J)v.push(K.i/C),v.push(w.i/C),v.push(P.i/C),A(w),N=w=P.next;else if(w=P,w===N){if(!O)l(y(w),v,C,G,H,L,1);else if(1===O){w=y(w);O=v;N=C;K=w;do P=K.prev,J=K.next.next,!m(P,J)&&b(P,K,K.next,J)&&r(P,J)&&r(J,P)&&(O.push(P.i/N),O.push(K.i/N),O.push(J.i/N),A(K),A(K.next),K=w=J),K=K.next;while(K!==w);w=y(K);l(w,v,C,G,H,L,2)}else if(2===O)a:{O=w;do{for(N=O.next.next;N!==O.prev;){if(K=O.i!==N.i){J=J=J=J=void 0;K=O;P=N;if(J=K.next.i!==
P.i&&K.prev.i!==P.i){b:{J=K;do{if(J.i!==K.i&&J.next.i!==K.i&&J.i!==P.i&&J.next.i!==P.i&&b(J,J.next,K,P)){J=!0;break b}J=J.next}while(J!==K);J=!1}J=!J}if(J){if(J=r(K,P)&&r(P,K)){J=K;M=!1;U=(K.x+P.x)/2;Q=(K.y+P.y)/2;do J.y>Q!==J.next.y>Q&&J.next.y!==J.y&&U<(J.next.x-J.x)*(Q-J.y)/(J.next.y-J.y)+J.x&&(M=!M),J=J.next;while(J!==K);J=M}J=J&&(p(K.prev,K,P.prev)||p(K,P.prev,P))||m(K,P)&&0<p(K.prev,K,K.next)&&0<p(P.prev,P,P.next)}K=J}if(K){w=x(O,N);O=y(O,O.next);w=y(w,w.next);l(O,v,C,G,H,L);l(w,v,C,G,H,L);
break a}N=N.next}O=O.next}while(O!==w)}break}}}}function g(w,v,C,G){var H=w.prev,L=w.next;if(0<=p(H,w,L))return!1;var O=H.x>w.x?H.x>L.x?H.x:L.x:w.x>L.x?w.x:L.x,N=H.y>w.y?H.y>L.y?H.y:L.y:w.y>L.y?w.y:L.y,K=e(H.x<w.x?H.x<L.x?H.x:L.x:w.x<L.x?w.x:L.x,H.y<w.y?H.y<L.y?H.y:L.y:w.y<L.y?w.y:L.y,v,C,G);v=e(O,N,v,C,G);C=w.prevZ;for(G=w.nextZ;C&&C.z>=K&&G&&G.z<=v;){if(C!==w.prev&&C!==w.next&&k(H.x,H.y,w.x,w.y,L.x,L.y,C.x,C.y)&&0<=p(C.prev,C,C.next))return!1;C=C.prevZ;if(G!==w.prev&&G!==w.next&&k(H.x,H.y,w.x,w.y,
L.x,L.y,G.x,G.y)&&0<=p(G.prev,G,G.next))return!1;G=G.nextZ}for(;C&&C.z>=K;){if(C!==w.prev&&C!==w.next&&k(H.x,H.y,w.x,w.y,L.x,L.y,C.x,C.y)&&0<=p(C.prev,C,C.next))return!1;C=C.prevZ}for(;G&&G.z<=v;){if(G!==w.prev&&G!==w.next&&k(H.x,H.y,w.x,w.y,L.x,L.y,G.x,G.y)&&0<=p(G.prev,G,G.next))return!1;G=G.nextZ}return!0}function d(w,v){return w.x-v.x}function a(w){if(w.next.prev===w)return w;let v=w;do{const C=v.next;if(C.prev===v||C===v||C===w)break;v=C}while(1);return v}function c(w,v){var C=v,G=w.x,H=w.y,
L=-Infinity;do{if(H<=C.y&&H>=C.next.y&&C.next.y!==C.y){var O=C.x+(H-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(O<=G&&O>L){L=O;if(O===G){if(H===C.y)return C;if(H===C.next.y)return C.next}var N=C.x<C.next.x?C:C.next}}C=C.next}while(C!==v);if(!N)return null;if(G===L)return N;v=N;O=N.x;var K=N.y,I=Infinity;C=N;do{if(G>=C.x&&C.x>=O&&G!==C.x&&k(H<K?G:L,H,O,K,H<K?L:G,H,C.x,C.y)){var M=Math.abs(H-C.y)/(G-C.x);var U;if((U=r(C,w))&&!(U=M<I)&&(U=M===I)&&!(U=C.x>N.x)&&(U=C.x===N.x)){U=N;var T=C;U=0>p(U.prev,U,T.prev)&&
0>p(T.next,U,U.next)}U&&(N=C,I=M)}C=C.next}while(C!==v);return N}function e(w,v,C,G,H){w=32767*(w-C)*H;v=32767*(v-G)*H;w=(w|w<<8)&16711935;w=(w|w<<4)&252645135;w=(w|w<<2)&858993459;v=(v|v<<8)&16711935;v=(v|v<<4)&252645135;v=(v|v<<2)&858993459;return(w|w<<1)&1431655765|((v|v<<1)&1431655765)<<1}function f(w){var v=w,C=w;do{if(v.x<C.x||v.x===C.x&&v.y<C.y)C=v;v=v.next}while(v!==w);return C}function k(w,v,C,G,H,L,O,N){return 0<=(H-O)*(v-N)-(w-O)*(L-N)&&0<=(w-O)*(G-N)-(C-O)*(v-N)&&0<=(C-O)*(L-N)-(H-O)*
(G-N)}function p(w,v,C){return(v.y-w.y)*(C.x-v.x)-(v.x-w.x)*(C.y-v.y)}function m(w,v){return w.x===v.x&&w.y===v.y}function b(w,v,C,G){var H=n(p(w,v,C)),L=n(p(w,v,G)),O=n(p(C,G,w)),N=n(p(C,G,v));return H!==L&&O!==N||0===H&&h(w,C,v)||0===L&&h(w,G,v)||0===O&&h(C,w,G)||0===N&&h(C,v,G)?!0:!1}function h(w,v,C){return v.x<=Math.max(w.x,C.x)&&v.x>=Math.min(w.x,C.x)&&v.y<=Math.max(w.y,C.y)&&v.y>=Math.min(w.y,C.y)}function n(w){return 0<w?1:0>w?-1:0}function r(w,v){return 0>p(w.prev,w,w.next)?0<=p(w,v,w.next)&&
0<=p(w,w.prev,v):0>p(w,v,w.prev)||0>p(w,w.next,v)}function x(w,v){var C=new E(w.i,w.x,w.y),G=new E(v.i,v.x,v.y),H=w.next,L=v.prev;w.next=v;v.prev=w;C.next=H;H.prev=C;G.next=C;C.prev=G;L.next=G;G.prev=L;return G}function q(w,v,C,G){w=new E(w,v,C);G?(w.next=G.next,w.prev=G,G.next.prev=w,G.next=w):(w.prev=w,w.next=w);return w}function A(w){w.next.prev=w.prev;w.prev.next=w.next;w.prevZ&&(w.prevZ.nextZ=w.nextZ);w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function E(w,v,C){this.i=w;this.x=v;this.y=C;this.nextZ=this.prevZ=
this.z=this.next=this.prev=null;this.steiner=!1}function F(w,v,C,G){for(var H=0,L=C-G;v<C;v+=G)H+=(w[L]-w[v])*(w[v+1]+w[L+1]),L=v;return H}D.deviation=function(w,v,C,G){var H=v&&v.length,L=Math.abs(F(w,0,H?v[0]*C:w.length,C));if(H){H=0;for(var O=v.length;H<O;H++)L-=Math.abs(F(w,v[H]*C,H<O-1?v[H+1]*C:w.length,C))}for(H=v=0;H<G.length;H+=3){O=G[H]*C;var N=G[H+1]*C,K=G[H+2]*C;v+=Math.abs((w[O]-w[K])*(w[N+1]-w[O+1])-(w[O]-w[N])*(w[K+1]-w[O+1]))}return 0===L&&0===v?0:Math.abs((v-L)/L)};D.flatten=function(w){for(var v=
w[0][0].length,C={vertices:[],holes:[],dimensions:v},G=0,H=0;H<w.length;H++){for(var L=0;L<w[H].length;L++)for(var O=0;O<v;O++)C.vertices.push(w[H][L][O]);0<H&&(G+=w[H-1].length,C.holes.push(G))}return C};return D})})(u);t.earcut=u.exports})},"esri/views/2d/engine/webgl/Geometry":function(){define(["exports"],function(t){let u=function(){function B(z,y){this.x=z;this.y=y}var D=B.prototype;D.clone=function(){return new B(this.x,this.y)};D.equals=function(z,y){return z===this.x&&y===this.y};D.isEqual=
function(z){return z.x===this.x&&z.y===this.y};D.setCoords=function(z,y){this.x=z;this.y=y};D.normalize=function(){var z=this.x;const y=this.y;z=Math.sqrt(z*z+y*y);this.x/=z;this.y/=z};D.rightPerpendicular=function(){const z=this.x;this.x=this.y;this.y=-z};D.move=function(z,y){this.x+=z;this.y+=y};D.assign=function(z){this.x=z.x;this.y=z.y};D.assignAdd=function(z,y){this.x=z.x+y.x;this.y=z.y+y.y};D.assignSub=function(z,y){this.x=z.x-y.x;this.y=z.y-y.y};D.rotate=function(z,y){const l=this.x,g=this.y;
this.x=l*z-g*y;this.y=l*y+g*z};D.scale=function(z){this.x*=z;this.y*=z};D.length=function(){const z=this.x,y=this.y;return Math.sqrt(z*z+y*y)};B.distance=function(z,y){const l=y.x-z.x;z=y.y-z.y;return Math.sqrt(l*l+z*z)};B.add=function(z,y){return new B(z.x+y.x,z.y+y.y)};B.sub=function(z,y){return new B(z.x-y.x,z.y-y.y)};return B}();t.GeometryType=void 0;(function(B){B[B.Unknown=0]="Unknown";B[B.Point=1]="Point";B[B.LineString=2]="LineString";B[B.Polygon=3]="Polygon"})(t.GeometryType||(t.GeometryType=
{}));t.Point=u;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./Geometry","./GeometryUtils"],function(t,u,B,D,z){let y=function(c,e,f){this.ratio=c;this.x=e;this.y=f},l=function(){function c(f,k,p,m=8,b=8){this.lines=[];this.starts=[];this.validateTessellation=!0;this.pixelRatio=m;this.pixelMargin=b;this.tileSize=B.TILE_SIZE*m;this.dz=f;this.yPos=k;this.xPos=p}
var e=c.prototype;e.setPixelMargin=function(f){f!==this.pixelMargin&&(this.pixelMargin=f,this.setExtent(this._extent))};e.setExtent=function(f){this._extent=f;this.finalRatio=this.tileSize/f*(1<<this.dz);let k=this.pixelRatio*this.pixelMargin;k/=this.finalRatio;f>>=this.dz;k>f&&(k=f);this.margin=k;this.xmin=f*this.xPos-k;this.ymin=f*this.yPos-k;this.xmax=this.xmin+f+2*k;this.ymax=this.ymin+f+2*k};e.reset=function(f){this.type=f;this.lines=[];this.starts=[];this.line=null;this.start=0};e.moveTo=function(f,
k){this._pushLine();this._prevIsIn=this._isIn(f,k);this._moveTo(f,k,this._prevIsIn);this._prevPt=new D.Point(f,k);this._firstPt=new D.Point(f,k);this._dist=0};e.lineTo=function(f,k){const p=this._isIn(f,k),m=new D.Point(f,k),b=D.Point.distance(this._prevPt,m);if(p)if(this._prevIsIn)this._lineTo(f,k,!0);else{var h=this._prevPt;var n=m;f=this._intersect(n,h);this.start=this._dist+b*(1-this._r);this._lineTo(f.x,f.y,!0);this._lineTo(n.x,n.y,!0)}else if(this._prevIsIn)n=this._prevPt,h=m,f=this._intersect(n,
h),this._lineTo(f.x,f.y,!0),this._lineTo(h.x,h.y,!1);else{const x=this._prevPt;if(!(x.x<=this.xmin&&m.x<=this.xmin||x.x>=this.xmax&&m.x>=this.xmax||x.y<=this.ymin&&m.y<=this.ymin||x.y>=this.ymax&&m.y>=this.ymax)){f=[];if(x.x<this.xmin&&m.x>this.xmin||x.x>this.xmin&&m.x<this.xmin){k=(this.xmin-x.x)/(m.x-x.x);var r=x.y+k*(m.y-x.y);r<=this.ymin?n=!1:r>=this.ymax?n=!0:f.push(new y(k,this.xmin,r))}if(x.x<this.xmax&&m.x>this.xmax||x.x>this.xmax&&m.x<this.xmax)k=(this.xmax-x.x)/(m.x-x.x),r=x.y+k*(m.y-x.y),
r<=this.ymin?n=!1:r>=this.ymax?n=!0:f.push(new y(k,this.xmax,r));if(x.y<this.ymin&&m.y>this.ymin||x.y>this.ymin&&m.y<this.ymin)k=(this.ymin-x.y)/(m.y-x.y),r=x.x+k*(m.x-x.x),r<=this.xmin?h=!1:r>=this.xmax?h=!0:f.push(new y(k,r,this.ymin));if(x.y<this.ymax&&m.y>this.ymax||x.y>this.ymax&&m.y<this.ymax)k=(this.ymax-x.y)/(m.y-x.y),r=x.x+k*(m.x-x.x),r<=this.xmin?h=!1:r>=this.xmax?h=!0:f.push(new y(k,r,this.ymax));if(0===f.length)h?n?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,
!0):n?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<f.length&&f[0].ratio>f[1].ratio)this.start=this._dist+b*f[1].ratio,this._lineTo(f[1].x,f[1].y,!0),this._lineTo(f[0].x,f[0].y,!0);else for(this.start=this._dist+b*f[0].ratio,h=0;h<f.length;h++)this._lineTo(f[h].x,f[h].y,!0)}this._lineTo(m.x,m.y,!1)}this._dist+=b;this._prevIsIn=p;this._prevPt=m};e.close=function(){if(2<this.line.length){var f=this._firstPt,k=this._prevPt;f.x===k.x&&f.y===k.y||this.lineTo(f.x,f.y);
f=this.line;for(k=f.length;4<=k;)if(f[0].x===f[1].x&&f[0].x===f[k-2].x||f[0].y===f[1].y&&f[0].y===f[k-2].y)f.pop(),f[0].x=f[k-2].x,f[0].y=f[k-2].y,--k;else break}};e.result=function(f=!0){this._pushLine();if(0===this.lines.length)return null;this.type===D.GeometryType.Polygon&&f&&a.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};e.resultWithStarts=function(){if(this.type!==D.GeometryType.LineString)throw Error("Only valid for lines");this._pushLine();const f=this.lines,
k=f.length;if(0===k)return null;const p=[];for(let m=0;m<k;m++)p.push({line:f[m],start:this.starts[m]||0});return p};e._isIn=function(f,k){return f>=this.xmin&&f<=this.xmax&&k>=this.ymin&&k<=this.ymax};e._intersect=function(f,k){let p,m,b;if(k.x>=this.xmin&&k.x<=this.xmax)m=k.y<=this.ymin?this.ymin:this.ymax,b=(m-f.y)/(k.y-f.y),p=f.x+b*(k.x-f.x);else if(k.y>=this.ymin&&k.y<=this.ymax)p=k.x<=this.xmin?this.xmin:this.xmax,b=(p-f.x)/(k.x-f.x),m=f.y+b*(k.y-f.y);else{m=k.y<=this.ymin?this.ymin:this.ymax;
p=k.x<=this.xmin?this.xmin:this.xmax;const h=(p-f.x)/(k.x-f.x),n=(m-f.y)/(k.y-f.y);h<n?(b=h,m=f.y+h*(k.y-f.y)):(b=n,p=f.x+n*(k.x-f.x))}this._r=b;return new D.Point(p,m)};e._pushLine=function(){this.line&&(this.type===D.GeometryType.Point?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):this.type===D.GeometryType.LineString?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):this.type===D.GeometryType.Polygon&&3<this.line.length&&(this.lines.push(this.line),
this.starts.push(this.start)));this.line=[];this.start=0};e._moveTo=function(f,k,p){this.type!==D.GeometryType.Polygon?p&&(f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),k=Math.round((k-(this.ymin+this.margin))*this.finalRatio),this.line.push(new D.Point(f,k))):(p||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),k<this.ymin&&(k=this.ymin),k>this.ymax&&(k=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),k=Math.round((k-(this.ymin+this.margin))*this.finalRatio),
this.line.push(new D.Point(f,k)),this._is_v=this._is_h=!1)};e._lineTo=function(f,k,p){if(this.type!==D.GeometryType.Polygon)if(p){f=Math.round((f-(this.xmin+this.margin))*this.finalRatio);k=Math.round((k-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(p=this.line[this.line.length-1],p.equals(f,k)))return;this.line.push(new D.Point(f,k))}else this.line&&0<this.line.length&&this._pushLine();else if(p||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),k<this.ymin&&(k=this.ymin),
k>this.ymax&&(k=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),k=Math.round((k-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){p=this.line[this.line.length-1];const m=p.x===f,b=p.y===k;m&&b||(this._is_h&&m?(p.x=f,p.y=k,p=this.line[this.line.length-2],p.x===f&&p.y===k?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(p=this.line[this.line.length-2],this._is_h=p.x===f,this._is_v=p.y===k)):(this._is_h=p.x===f,this._is_v=p.y===k)):this._is_v&&
b?(p.x=f,p.y=k,p=this.line[this.line.length-2],p.x===f&&p.y===k?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(p=this.line[this.line.length-2],this._is_h=p.x===f,this._is_v=p.y===k)):(this._is_h=p.x===f,this._is_v=p.y===k)):(this.line.push(new D.Point(f,k)),this._is_h=m,this._is_v=b))}else this.line.push(new D.Point(f,k))};return c}(),g=function(){function c(){}var e=c.prototype;e.setExtent=function(f){this._ratio=4096===f?1:4096/f};e.reset=function(f){this.lines=[];this.line=null};
e.moveTo=function(f,k){this.line&&this.lines.push(this.line);this.line=[];const p=this._ratio;this.line.push(new D.Point(f*p,k*p))};e.lineTo=function(f,k){const p=this._ratio;this.line.push(new D.Point(f*p,k*p))};e.close=function(){const f=this.line;f&&!f[0].isEqual(f[f.length-1])&&f.push(f[0])};e.result=function(){this.line&&this.lines.push(this.line);return 0===this.lines.length?null:this.lines};u._createClass(c,[{key:"validateTessellation",get:function(){return 1>this._ratio}}]);return c}();var d;
(function(c){c[c.sideLeft=0]="sideLeft";c[c.sideRight=1]="sideRight";c[c.sideTop=2]="sideTop";c[c.sideBottom=3]="sideBottom"})(d||(d={}));let a=function(){function c(){}c.simplify=function(e,f,k){if(k){var p=-f,m=e+f,b=-f,h=e+f;e=[];f=[];var n=k.length;for(let r=0;r<n;++r){const x=k[r];if(!x||2>x.length)continue;let q=x[0],A;const E=x.length;for(let F=1;F<E;++F)A=x[F],q.x===A.x&&(q.x<=p&&(q.y>A.y?(e.push(r),e.push(F),e.push(d.sideLeft),e.push(-1)):(f.push(r),f.push(F),f.push(d.sideLeft),f.push(-1))),
q.x>=m&&(q.y<A.y?(e.push(r),e.push(F),e.push(d.sideRight),e.push(-1)):(f.push(r),f.push(F),f.push(d.sideRight),f.push(-1)))),q.y===A.y&&(q.y<=b&&(q.x<A.x?(e.push(r),e.push(F),e.push(d.sideTop),e.push(-1)):(f.push(r),f.push(F),f.push(d.sideTop),f.push(-1))),q.y>=h&&(q.x>A.x?(e.push(r),e.push(F),e.push(d.sideBottom),e.push(-1)):(f.push(r),f.push(F),f.push(d.sideBottom),f.push(-1)))),q=A}0!==e.length&&0!==f.length&&(c.fillParent(k,f,e),c.fillParent(k,e,f),p=[],c.calcDeltas(p,f,e),c.calcDeltas(p,e,f),
c.addDeltas(p,k))}};c.fillParent=function(e,f,k){const p=k.length,m=f.length;for(let x=0;x<m;x+=4){var b=f[x],h=f[x+1];const q=f[x+2],A=e[b][h-1];b=e[b][h];h=8092;let E=-1;for(let F=0;F<p;F+=4){if(k[F+2]!==q)continue;var n=k[F];const w=k[F+1];var r=e[n][w-1];n=e[n][w];switch(q){case d.sideLeft:case d.sideRight:z.between(A.y,r.y,n.y)&&z.between(b.y,r.y,n.y)&&(r=Math.abs(n.y-r.y),r<h&&(h=r,E=F));break;case d.sideTop:case d.sideBottom:z.between(A.x,r.x,n.x)&&z.between(b.x,r.x,n.x)&&(r=Math.abs(n.x-r.x),
r<h&&(h=r,E=F))}}f[x+3]=E}};c.calcDeltas=function(e,f,k){const p=f.length;for(let m=0;m<p;m+=4){const b=c.calcDelta(m,f,k,[]);e.push(f[m]);e.push(f[m+1]);e.push(f[m+2]);e.push(b)}};c.calcDelta=function(e,f,k,p){e=f[e+3];if(-1===e)return 0;const m=p.length;if(1<m&&p[m-2]===e)return 0;p.push(e);return c.calcDelta(e,k,f,p)+1};c.addDeltas=function(e,f){const k=e.length;let p=0;for(var m=0;m<k;m+=4){var b=e[m+3];b>p&&(p=b)}for(m=0;m<k;m+=4){b=f[e[m]];const h=e[m+1],n=p-e[m+3];switch(e[m+2]){case d.sideLeft:b[h-
1].x-=n;b[h].x-=n;1===h&&(b[b.length-1].x-=n);h===b.length-1&&(b[0].x-=n);break;case d.sideRight:b[h-1].x+=n;b[h].x+=n;1===h&&(b[b.length-1].x+=n);h===b.length-1&&(b[0].x+=n);break;case d.sideTop:b[h-1].y-=n;b[h].y-=n;1===h&&(b[b.length-1].y-=n);h===b.length-1&&(b[0].y-=n);break;case d.sideBottom:b[h-1].y+=n,b[h].y+=n,1===h&&(b[b.length-1].y+=n),h===b.length-1&&(b[0].y+=n)}}};return c}();t.SimpleBuilder=g;t.TileClipper=l;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],
function(t){function u(q,A,E,F,w,v,C){let G;E=0;for(let H=F,L=w-v;H<w;H+=v)E+=(q[L+A*v]-q[H+A*v])*(q[H+1+A*v]+q[L+1+A*v]),L=H;if(C===0<E)for(;F<w;F+=v)G=y(F+A*v,q[F+A*v],q[F+1+A*v],G);else for(w-=v;w>=F;w-=v)G=y(w+A*v,q[w+A*v],q[w+1+A*v],G);G&&m(G,G.next)&&(l(G),G=G.next);return G}function B(q,A=q){if(!q)return q;let E;do if(E=!1,q.steiner||!m(q,q.next)&&0!==c(q.prev,q,q.next))q=q.next;else{l(q);q=A=q.prev;if(q===q.next)break;E=!0}while(E||q!==A);return A}function D(q,A,E,F,w,v,C,G){if(q){!G&&v&&
(q=a(q,F,w,v));for(var H=q;q.prev!==q.next;){var L=q.prev,O=q.next;if(v)var N=z(q,F,w,v);else a:{N=q;var K=N.prev,I=N;const M=N.next;if(0<=c(K,I,M)){N=!1;break a}let U=N.next.next;const T=U;let Q=0;for(;U!==N.prev&&(0===Q||U!==T);){Q++;if(f(K.x,K.y,I.x,I.y,M.x,M.y,U.x,U.y)&&0<=c(U.prev,U,U.next)){N=!1;break a}U=U.next}N=!0}if(N)A.push(L.index/E+C),A.push(q.index/E+C),A.push(O.index/E+C),l(q),H=q=O.next;else if(q=O,q===H){if(!G)D(B(q),A,E,F,w,v,C,1);else if(1===G){G=A;H=E;L=C;O=q;do N=O.prev,K=O.next.next,
!m(N,K)&&e(N,O,O.next,K)&&k(N,K)&&k(K,N)&&(G.push(N.index/H+L),G.push(O.index/H+L),G.push(K.index/H+L),l(O),l(O.next),O=q=K),O=O.next;while(O!==q);q=O;D(q,A,E,F,w,v,C,2)}else if(2===G)a:{G=q;do{for(H=G.next.next;H!==G.prev;){if(L=G.index!==H.index){N=N=N=void 0;L=G;O=H;if(N=L.next.index!==O.index&&L.prev.index!==O.index){b:{N=L;do{if(N.index!==L.index&&N.next.index!==L.index&&N.index!==O.index&&N.next.index!==O.index&&e(N,N.next,L,O)){N=!0;break b}N=N.next}while(N!==L);N=!1}N=!N}if(N=N&&k(L,O)&&k(O,
L)){N=L;K=!1;I=(L.x+O.x)/2;O=(L.y+O.y)/2;do N.y>O!==N.next.y>O&&N.next.y!==N.y&&I<(N.next.x-N.x)*(O-N.y)/(N.next.y-N.y)+N.x&&(K=!K),N=N.next;while(N!==L);N=K}L=N}if(L){q=h(G,H);G=B(G,G.next);q=B(q,q.next);D(G,A,E,F,w,v,C,0);D(q,A,E,F,w,v,C,0);break a}H=H.next}G=G.next}while(G!==q)}break}}}}function z(q,A,E,F){const w=q.prev,v=q.next;if(0<=c(w,q,v))return!1;const C=w.x>q.x?w.x>v.x?w.x:v.x:q.x>v.x?q.x:v.x,G=w.y>q.y?w.y>v.y?w.y:v.y:q.y>v.y?q.y:v.y,H=p(w.x<q.x?w.x<v.x?w.x:v.x:q.x<v.x?q.x:v.x,w.y<q.y?
w.y<v.y?w.y:v.y:q.y<v.y?q.y:v.y,A,E,F);A=p(C,G,A,E,F);E=q.prevZ;for(F=q.nextZ;E&&E.z>=H&&F&&F.z<=A;){if(E!==q.prev&&E!==q.next&&f(w.x,w.y,q.x,q.y,v.x,v.y,E.x,E.y)&&0<=c(E.prev,E,E.next))return!1;E=E.prevZ;if(F!==q.prev&&F!==q.next&&f(w.x,w.y,q.x,q.y,v.x,v.y,F.x,F.y)&&0<=c(F.prev,F,F.next))return!1;F=F.nextZ}for(;E&&E.z>=H;){if(E!==q.prev&&E!==q.next&&f(w.x,w.y,q.x,q.y,v.x,v.y,E.x,E.y)&&0<=c(E.prev,E,E.next))return!1;E=E.prevZ}for(;F&&F.z<=A;){if(F!==q.prev&&F!==q.next&&f(w.x,w.y,q.x,q.y,v.x,v.y,F.x,
F.y)&&0<=c(F.prev,F,F.next))return!1;F=F.nextZ}return!0}function y(q,A,E,F){q=n.create(q,A,E);F?(q.next=F.next,q.prev=F,F.next.prev=q,F.next=q):(q.prev=q,q.next=q);return q}function l(q){q.next.prev=q.prev;q.prev.next=q.next;q.prevZ&&(q.prevZ.nextZ=q.nextZ);q.nextZ&&(q.nextZ.prevZ=q.prevZ)}function g(q){let A=q,E=q;do{if(A.x<E.x||A.x===E.x&&A.y<E.y)E=A;A=A.next}while(A!==q);return E}function d(q,A){let E=A;const F=q.x,w=q.y;let v=-Infinity,C;do{if(w<=E.y&&w>=E.next.y&&E.next.y!==E.y){var G=E.x+(w-
E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(G<=F&&G>v){v=G;if(G===F){if(w===E.y)return E;if(w===E.next.y)return E.next}C=E.x<E.next.x?E:E.next}}E=E.next}while(E!==A);if(!C)return null;if(F===v)return C.prev;A=C;G=C.x;const H=C.y;let L=Infinity,O;for(E=C.next;E!==A;)F>=E.x&&E.x>=G&&F!==E.x&&f(w<H?F:v,w,G,H,w<H?v:F,w,E.x,E.y)&&(O=Math.abs(w-E.y)/(F-E.x),(O<L||O===L&&E.x>C.x)&&k(E,q)&&(C=E,L=O)),E=E.next;return C}function a(q,A,E,F){for(var w;w!==q;w=w.next){w=w||q;null===w.z&&(w.z=p(w.x,w.y,A,E,F));if(w.prev.next!==
w||w.next.prev!==w)return w.prev.next=w,w.next.prev=w,a(q,A,E,F);w.prevZ=w.prev;w.nextZ=w.next}q.prevZ.nextZ=null;q.prevZ=null;a:for(E=1;;){F=q;A=q=null;let v=0;for(;F;){v++;w=F;let C=0;for(;C<E&&w;C++)w=w.nextZ;let G=E;for(;0<C||0<G&&w;){let H;0===C?(H=w,w=w.nextZ,G--):0!==G&&w?F.z<=w.z?(H=F,F=F.nextZ,C--):(H=w,w=w.nextZ,G--):(H=F,F=F.nextZ,C--);A?A.nextZ=H:q=H;H.prevZ=A;A=H}F=w}A.nextZ=null;E*=2;if(2>v)break a}return q}function c(q,A,E){return(A.y-q.y)*(E.x-A.x)-(A.x-q.x)*(E.y-A.y)}function e(q,
A,E,F){return m(q,A)&&m(E,F)||m(q,F)&&m(E,A)?!0:0<c(q,A,E)!==0<c(q,A,F)&&0<c(E,F,q)!==0<c(E,F,A)}function f(q,A,E,F,w,v,C,G){return 0<=(w-C)*(A-G)-(q-C)*(v-G)&&0<=(q-C)*(F-G)-(E-C)*(A-G)&&0<=(E-C)*(v-G)-(w-C)*(F-G)}function k(q,A){return 0>c(q.prev,q,q.next)?0<=c(q,A,q.next)&&0<=c(q,q.prev,A):0>c(q,A,q.prev)||0>c(q,q.next,A)}function p(q,A,E,F,w){q=32767*(q-E)*w;A=32767*(A-F)*w;q=(q|q<<8)&16711935;q=(q|q<<4)&252645135;q=(q|q<<2)&858993459;A=(A|A<<8)&16711935;A=(A|A<<4)&252645135;A=(A|A<<2)&858993459;
return(q|q<<1)&1431655765|((A|A<<1)&1431655765)<<1}function m(q,A){return q.x===A.x&&q.y===A.y}function b(q,A){return q.x-A.x}function h(q,A){const E=n.create(q.index,q.x,q.y),F=n.create(A.index,A.x,A.y),w=q.next,v=A.prev;q.next=A;A.prev=q;E.next=w;w.prev=E;F.next=E;E.prev=F;v.next=F;F.prev=v;return F}let n=function(){function q(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}q.create=function(A,E,F){const w=x<r.length?r[x++]:new q;w.index=A;w.x=
E;w.y=F;w.prev=null;w.next=null;w.z=null;w.prevZ=null;w.nextZ=null;w.steiner=!1;return w};return q}();const r=[];let x=0;for(let q=0;8096>q;q++)r.push(new n);t.bufcut=function(q,A,E,F,w,v,C){x=0;var G=(F-E)*v,H=w&&w.length;const L=H?(w[0]-E)*v:G;var O=u(A,E,F,0,L,v,!0);if(O&&O.next!==O.prev){var N;if(H){H=[];for(let U=0,T=w.length;U<T;U++){const Q=u(A,E,F,w[U]*v,U<T-1?w[U+1]*v:F*v,v,!1);Q===Q.next&&(Q.steiner=!0);H.push(g(Q))}H.sort(b);for(var K of H){F=K;w=O;if(w=d(F,w))F=h(w,F),B(F,F.next);O=B(O,
O.next)}}if(G>80*v){var I=G=A[E*v];var M=N=A[1+E*v];for(K=v;K<L;K+=v)F=A[K+E*v],w=A[K+1+E*v],I=Math.min(I,F),M=Math.min(M,w),G=Math.max(G,F),N=Math.max(N,w);N=Math.max(G-I,N-M);N=0!==N?1/N:0}D(O,q,v,I,M,N,C,0)}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e){const f=u.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(k){function p(m,b,h,n,r,x,q,A,E,F,w,v,C,G,H,L,O,N,K){var I=k.call(this)||this;m=d.LineMaterialKey.load(m);b&&(m.sdf=b.sdf,m.pattern=!0,m.textureBinding=b.textureBinding);I._capType=n;I._joinType=r;I._miterLimitCosine=a.getLimitCosine(x);I.tessellationProperties._fillColor=q;I.tessellationProperties._tl=A;I.tessellationProperties._br=E;I._hasPattern=F;I._isDashed=w;I._zOrder=L;I._effects=
O;I._minMaxZoom=l.i1616to32(Math.round(N*y.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(K*y.MIN_MAX_ZOOM_PRECISION_FACTOR));I._materialKey=m.data;I.tessellationProperties._bitset=(C?y.BITSET_GENERIC_LOCK_COLOR:0)|(G?y.BITSET_TYPE_FILL_OUTLINE:0)|(v?y.BITSET_LINE_SCALE_DASH:0);I.tessellationProperties._halfWidth=.5*h;I.tessellationProperties._halfReferenceWidth=.5*H;I.tessellationProperties.offset=0;I._initializeTessellator(!1);return I}t._inheritsLoose(p,k);p.fromCIMLine=function(m,b,h){var n=m.color,
r=m.scaleFactor||1;const x=!!m.dashTemplate;let q=m.cap;x&&q===D.CapType.ROUND&&(q=D.CapType.SQUARE);const A=m.join;r*=B.pt2px(m.width);const E=B.pt2px(m.referenceWidth),F=B.pt2px(m.miterLimit);n=n&&z.premultiplyAlphaRGBA(n)||0;const [w,v]=a.getMinMaxZoom(m.scaleInfo,h);if(!b)return new p(m.materialKey,b,r,q,A,F,n,0,0,!1,x,m.scaleDash,m.colorLocked,!1,E,m.zOrder,m.effects,w,v);const {rect:C,width:G,height:H}=b;var L=C.x+y.SPRITE_PADDING;const O=C.y+y.SPRITE_PADDING;h=L+G;const N=O+H;L=l.i1616to32(L,
O);h=l.i1616to32(h,N);return new p(m.materialKey,b,r,q,A,F,n,L,h,!0,x,m.scaleDash,m.colorLocked,!1,E,m.zOrder,m.effects,w,v)};p.fromFillOutline=function(m){var b;return m.isOutlinedFill&&m.outline&&"esriSLSSolid"===(null==(b=m.outline)?void 0:b.style)?p.fromSimpleLine({hash:"",materialKey:m.materialKey,...m.outline},null,!0):null};p.fromSimpleLine=function(m,b,h=!1){var {color:n}=m;const r="esriSLSSolid"!==m.style&&"esriSLSNull"!==m.style,x=g.getCapType(m.cap||"round"),q=g.getJoinType(m.join||"round");
n=n&&"esriSLSNull"!==m.style&&z.premultiplyAlphaRGBAArray(n)||0;"esriSLSNull"===m.style&&(n=0);const A=B.pt2px(m.width),E=m.miterLimit;if(!b)return new p(m.materialKey,b,A,x,q,E,n,0,0,!1,r,!0,!1,h,A,0,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);const {rect:F,width:w,height:v}=b;var C=F.x+y.SPRITE_PADDING;const G=F.y+y.SPRITE_PADDING;var H=C+w;const L=G+v;C=l.i1616to32(C,G);H=l.i1616to32(H,L);return new p(m.materialKey,b,A,x,q,E,n,C,H,!0,r,!0,!1,h,A,0,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM)};p.fromPictureLineSymbol=
function(m,b,h,n){f.error("PictureLineSymbol support does not exist!");return null};return p}(c(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(t,u,B,D,z,y,l,g){const d=(e,f,k)=>(p,m,b,h,n,r,x,q,A,E,F)=>{b=z.i1616to32(F,Math.ceil(16*e._halfWidth));x=z.i8888to32(Math.round(16*
x),Math.round(16*q),Math.round(16*A),Math.round(16*E));n=z.i8888to32(16*n,16*r,0,e._bitset);r=e.out;r.vertexBounds(p,m,f,k);r.vertexWrite(z.i1616to32(8*p,8*m));r.vertexWrite(e.id);r.vertexWrite(e._fillColor);r.vertexWrite(x);r.vertexWrite(b);r.vertexWrite(e._tl);r.vertexWrite(e._br);r.vertexWrite(n);r.vertexWrite(z.i1616to32(Math.ceil(16*e._halfReferenceWidth),0));r.vertexWrite(e.minMaxZoom);r.vertexEnd();return e.offset+e.vertexCount++},a=(e,f,k)=>(p,m,b,h,n,r,x,q,A,E,F)=>{b=z.i8888to32(0,0,16*e._halfWidth,
16*e._halfReferenceWidth);x=z.i8888to32(16*x+128,16*q+128,16*A+128,16*E+128);q=e.out;A=e._bitset<<24|e.id;q.vertexBounds(p,m,f,k);q.vertexWrite(z.i1616to32(8*p,8*m));q.vertexWrite(A);q.vertexWrite(e._fillColor);e.key.simple||(q.vertexWrite(0),q.vertexWrite(0));q.vertexWrite(b);q.vertexWrite(x);e.key.simple||q.vertexWrite(e.minMaxZoom);q.vertexEnd();return e.offset+e.vertexCount++},c=e=>(f,k,p)=>{const m=e.out;m.indexWrite(f);m.indexWrite(k);m.indexWrite(p);e.indexCount+=3};return e=>function(f){function k(...m){m=
f.call(this,...m)||this;m.tessellationProperties={};m._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};m.geometryType=D.WGLGeometryType.LINE;return m}t._inheritsLoose(k,f);var p=k.prototype;p.writeGeometry=function(m,b,h,n){this._writeGeometry(m,b,h,n)};p._initializeTessellator=function(m){var b=l.LineMaterialKey.load(this._materialKey);const h=l.FillMaterialKey.load(this._materialKey);var n=this._tessellationOptions;b=b.vvSizeFieldStops||b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue;
m=this.tessellationProperties._halfWidth<B.THIN_LINE_HALF_WIDTH_THRESHOLD&&!m&&!b;this.tessellationProperties.minMaxZoom=this._minMaxZoom;n.wrapDistance=65535;n.textured=this._isDashed||this._hasPattern;n.offset=this.tessellationProperties.offset;n.halfWidth=this.tessellationProperties._halfWidth;n=m?0:1;this._lineTessellator=new y.LineTessellation((h.outlinedFill?a:d)(this.tessellationProperties,n,n),c(this.tessellationProperties),m)};p._write=function(m,b,h,n){h="esriGeometryPoint"===b.geometryType;
m.recordStart(b.getDisplayId(),this._materialKey,this.geometryType,h);this._writeGeometry(m,b,n,h);m.recordEnd()};p._writeGeometry=function(m,b,h,n){h=null!=h?h:b.readLegacyGeometryForDisplay();n=this._getLines(h,n);u.isNone(n)||this._writeVertices(m,b,n)};p._getLines=function(m,b){if(u.isNone(m))return null;m=m.paths||m.rings;return u.isNone(m)?null:g.clipLinesMarshall(m,b?256:16)};p._writeVertices=function(m,b,h){const n=b.getDisplayId(),r=m.vertexCount(),x=this.tessellationProperties;b=this._tessellationOptions;
x.out=m;x.id=n;x.indexCount=0;x.vertexCount=0;x.offset=r;b.capType=this._capType;b.joinType=this._joinType;m=l.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=m.outlinedFill?m:l.LineMaterialKey.load(this._materialKey);for(const {line:q,start:A}of h)b.initialDistance=A%65535,this._lineTessellator.tessellate(q,b)};return k}(e)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","../../../../symbols/cim/enums","./definitions"],function(t,u,B){function D(e,f){return e.x===
f.x&&e.y===f.y}function z(e,f){e.x=f.y;e.y=-f.x;return e}function y(e,f){e.x=-f.y;e.y=f.x;return e}function l(e,f){e.x=f.x;e.y=f.y;return e}function g(e,f){e.x=-f.x;e.y=-f.y;return e}function d(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function a(e,f,k,p){e.x=f.x*k+f.y*p;e.y=f.x*p-f.y*k;return e}let c=function(){function e(k,p,m){this.writeVertex=k;this.writeTriangle=p;this.canUseThinTessellation=m;this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.textureNormalLeft={x:0,y:1};
this.textureNormalRight={x:0,y:-1};this.textureNormal={x:void 0,y:void 0};this.joinNormal={x:void 0,y:void 0};this.inner={x:void 0,y:void 0};this.outer={x:void 0,y:void 0};this.roundStart={x:void 0,y:void 0};this.roundEnd={x:void 0,y:void 0};this.startBreak={x:void 0,y:void 0};this.endBreak={x:void 0,y:void 0};this.innerPrev={x:void 0,y:void 0};this.innerNext={x:void 0,y:void 0};this.bevelStart={x:void 0,y:void 0};this.bevelEnd={x:void 0,y:void 0};this.bevelMiddle={x:void 0,y:void 0}}var f=e.prototype;
f.tessellate=function(k,p){if(k){var m=k.length;if(!(1>=m)){var b=0;for(let h=1;h<m;h++)D(k[h],k[b])||++b===h||(k[b]=k[h]);k.length=b+1}}this.canUseThinTessellation&&p.halfWidth<B.THIN_LINE_HALF_WIDTH_THRESHOLD&&!p.offset?this._tessellateThin(k,p):this._tessellate(k,p)};f._tessellateThin=function(k,p){if(!(2>k.length)){var m=p.wrapDistance||65535;p=p.initialDistance||0;var b=!1,h=k[0].x,n=k[0].y,r=k.length;for(let E=1;E<r;++E){b&&(b=!1,p=0);let F=k[E].x,w=k[E].y;var x=F-h;let v=w-n;var q=Math.sqrt(x*
x+v*v);x/=q;v/=q;if(p+q>m){b=!0;var A=(m-p)/q;q=m-p;F=(1-A)*h+A*F;w=(1-A)*n+A*w;--E}A=this.writeVertex(h,n,0,0,x,v,v,-x,0,-1,p);h=this.writeVertex(h,n,0,0,x,v,-v,x,0,1,p);p+=q;q=this.writeVertex(F,w,0,0,x,v,v,-x,0,-1,p);x=this.writeVertex(F,w,0,0,x,v,-v,x,0,1,p);this.writeTriangle(A,h,q);this.writeTriangle(h,q,x);h=F;n=w}}};f._tessellate=function(k,p){var m=k[k.length-1];const b=D(k[0],m);if(!(k.length<(b?3:2))){var h=p.pixelCoordRatio,n=null!=p.capType?p.capType:u.CapType.BUTT,r=null!=p.joinType?
p.joinType:u.JoinType.MITER,x=null!=p.miterLimit?Math.min(p.miterLimit,4):2,q=null!=p.roundLimit?Math.min(p.roundLimit,1.05):1.05,A=null!=p.halfWidth?p.halfWidth:2,E=!!p.textured,F=null,w=null,v=this.prevNormal,C=this.nextNormal,G=-1,H=-1,L=this.joinNormal,O=this.textureNormalLeft,N=this.textureNormalRight,K=this.textureNormal,I=-1,M=-1,U=p.wrapDistance||65535,T=p.initialDistance||0,Q=this.writeVertex,J=this.writeTriangle;p=function(fa,ka,la,pa,ja,ma){fa=Q(P,S,V,Y,la,pa,fa,ka,ja,ma,T);0<=I&&0<=M&&
0<=fa&&J(I,M,fa);I=M;return M=fa};b&&(F=k[k.length-2],C.x=m.x-F.x,C.y=m.y-F.y,H=d(C),C.x/=H,C.y/=H);m=!1;for(let fa=0;fa<k.length;++fa){m&&(m=!1,T=0);F&&(v.x=-C.x,v.y=-C.y,G=H,T+G>U&&(m=!0));m?(w=(U-T)/G,G=U-T,F={x:(1-w)*F.x+w*k[fa].x,y:(1-w)*F.y+w*k[fa].y},--fa):F=k[fa];var P=F.x;var S=F.y;var W=0>=fa&&!m,Z=fa===k.length-1;W||(T+=G);(w=Z?b?k[1]:null:k[fa+1])?(C.x=w.x-P,C.y=w.y-S,H=d(C),C.x/=H,C.y/=H):(C.x=void 0,C.y=void 0);if(!b){if(W){y(L,C);var V=L.x;var Y=L.y;n===u.CapType.SQUARE&&(p(-C.y-C.x,
C.x-C.y,C.x,C.y,0,-1),p(C.y-C.x,-C.x-C.y,C.x,C.y,0,1));n===u.CapType.ROUND&&(p(-C.y-C.x,C.x-C.y,C.x,C.y,-1,-1),p(C.y-C.x,-C.x-C.y,C.x,C.y,-1,1));if(n===u.CapType.ROUND||n===u.CapType.BUTT)p(-C.y,C.x,C.x,C.y,0,-1),p(C.y,-C.x,C.x,C.y,0,1);continue}if(Z){z(L,v);V=L.x;Y=L.y;if(n===u.CapType.ROUND||n===u.CapType.BUTT)p(v.y,-v.x,-v.x,-v.y,0,-1),p(-v.y,v.x,-v.x,-v.y,0,1);n===u.CapType.SQUARE&&(p(v.y-v.x,-v.x-v.y,-v.x,-v.y,0,-1),p(-v.y-v.x,v.x-v.y,-v.x,-v.y,0,1));n===u.CapType.ROUND&&(p(v.y-v.x,-v.x-v.y,
-v.x,-v.y,1,-1),p(-v.y-v.x,v.x-v.y,-v.x,-v.y,1,1));continue}}var X=void 0;W=-(v.x*C.y-v.y*C.x);.01>Math.abs(W)?0<v.x*C.x+v.y*C.y?(L.x=v.x,L.y=v.y,W=1,X=Number.MAX_VALUE,w=!0):(y(L,C),X=W=1,w=!1):(L.x=(v.x+C.x)/W,L.y=(v.y+C.y)/W,X=d(L),w=(X-1)*A*h,w=4<X||w>G&&w>H);V=L.x;Y=L.y;var R=r;switch(r){case u.JoinType.BEVEL:1.05>X&&(R=u.JoinType.MITER);break;case u.JoinType.ROUND:X<q&&(R=u.JoinType.MITER);break;case u.JoinType.MITER:X>x&&(R=u.JoinType.BEVEL)}switch(R){case u.JoinType.MITER:p(L.x,L.y,-v.x,-v.y,
0,-1);p(-L.x,-L.y,-v.x,-v.y,0,1);if(Z)break;E&&(w=m?0:T,I=this.writeVertex(P,S,V,Y,C.x,C.y,L.x,L.y,0,-1,w),M=this.writeVertex(P,S,V,Y,C.x,C.y,-L.x,-L.y,0,1,w));break;case u.JoinType.BEVEL:W=0>W;var aa=void 0;W?(R=I,I=M,M=R,aa=O,R=N):(aa=N,R=O);var ba=void 0,ca=void 0;w?(ba=W?y(this.innerPrev,v):z(this.innerPrev,v),ca=W?z(this.innerNext,C):y(this.innerNext,C)):ba=ca=W?g(this.inner,L):l(this.inner,L);X=W?z(this.bevelStart,v):y(this.bevelStart,v);p(ba.x,ba.y,-v.x,-v.y,aa.x,aa.y);ba=p(X.x,X.y,-v.x,-v.y,
R.x,R.y);if(Z)break;Z=W?y(this.bevelEnd,C):z(this.bevelEnd,C);w?(w=this.writeVertex(P,S,V,Y,-v.x,-v.y,0,0,0,0,T),I=this.writeVertex(P,S,V,Y,C.x,C.y,ca.x,ca.y,aa.x,aa.y,T),M=this.writeVertex(P,S,V,Y,C.x,C.y,Z.x,Z.y,R.x,R.y,T),this.writeTriangle(ba,w,M)):(E?(w=this.bevelMiddle,w.x=(X.x+Z.x)/2,w.y=(X.y+Z.y)/2,a(K,w,-v.x,-v.y),p(w.x,w.y,-v.x,-v.y,K.x,K.y),a(K,w,C.x,C.y),I=this.writeVertex(P,S,V,Y,C.x,C.y,w.x,w.y,K.x,K.y,T),M=this.writeVertex(P,S,V,Y,C.x,C.y,ca.x,ca.y,aa.x,aa.y,T)):(w=I,I=M,M=w),p(Z.x,
Z.y,C.x,C.y,R.x,R.y));W&&(w=I,I=M,M=w);break;case u.JoinType.ROUND:{W=0>W;var da=void 0;W?(R=I,I=M,M=R,R=O,da=N):(R=N,da=O);var ea=W?g(this.inner,L):l(this.inner,L);w?(ca=W?y(this.innerPrev,v):z(this.innerPrev,v),aa=W?z(this.innerNext,C):y(this.innerNext,C)):aa=ca=ea;ba=W?z(this.roundStart,v):y(this.roundStart,v);var ia=W?y(this.roundEnd,C):z(this.roundEnd,C);ca=p(ca.x,ca.y,-v.x,-v.y,R.x,R.y);ba=p(ba.x,ba.y,-v.x,-v.y,da.x,da.y);if(Z)break;Z=this.writeVertex(P,S,V,Y,-v.x,-v.y,0,0,0,0,T);w||this.writeTriangle(I,
M,Z);ea=g(this.outer,ea);da=this.writeVertex(P,S,V,Y,C.x,C.y,ia.x,ia.y,da.x,da.y,T);let ka,la;if(ia=2<X){var ha=void 0;X!==Number.MAX_VALUE?(ea.x/=X,ea.y/=X,ha=v.x*ea.x+v.y*ea.y,ha=(X*(ha*ha-1)+1)/ha):ha=-1;ka=W?z(this.startBreak,v):y(this.startBreak,v);ka.x+=v.x*ha;ka.y+=v.y*ha;la=W?y(this.endBreak,C):z(this.endBreak,C);la.x+=C.x*ha;la.y+=C.y*ha}a(K,ea,-v.x,-v.y);X=this.writeVertex(P,S,V,Y,-v.x,-v.y,ea.x,ea.y,K.x,K.y,T);a(K,ea,C.x,C.y);ea=E?this.writeVertex(P,S,V,Y,C.x,C.y,ea.x,ea.y,K.x,K.y,T):X;
ha=Z;const pa=E?this.writeVertex(P,S,V,Y,C.x,C.y,0,0,0,0,T):Z;let ja=-1,ma=-1;ia&&(a(K,ka,-v.x,-v.y),ja=this.writeVertex(P,S,V,Y,-v.x,-v.y,ka.x,ka.y,K.x,K.y,T),a(K,la,C.x,C.y),ma=this.writeVertex(P,S,V,Y,C.x,C.y,la.x,la.y,K.x,K.y,T));E?ia?(this.writeTriangle(ha,ba,ja),this.writeTriangle(ha,ja,X),this.writeTriangle(pa,ea,ma),this.writeTriangle(pa,ma,da)):(this.writeTriangle(ha,ba,X),this.writeTriangle(pa,ea,da)):ia?(this.writeTriangle(Z,ba,ja),this.writeTriangle(Z,ja,ma),this.writeTriangle(Z,ma,da)):
(this.writeTriangle(Z,ba,X),this.writeTriangle(Z,ea,da));w?I=this.writeVertex(P,S,V,Y,C.x,C.y,aa.x,aa.y,R.x,R.y,T):(I=E?this.writeVertex(P,S,V,Y,C.x,C.y,aa.x,aa.y,R.x,R.y,T):ca,this.writeTriangle(I,pa,da));M=da;W&&(w=I,I=M,M=w)}}}}};return e}();t.LineTessellation=c;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer",
"../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(t,u,B,D,z){const y=u.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(l){function g(d){var a=l.call(this)||this;a._ongoingMaterialRequestMap=new Map;a._materialCache=new Map;a._dynamicPropertyMap=new Map;a._cimLayer=d;return a}t._inheritsLoose(g,l);g.prototype.analyze=function(d,a,c,e,f){if(f&&0===f.length)return null;const k=f&&0<f.length;a=a.readLegacyFeature();const p=this._materialCache;var m=this._cimLayer.materialHash;
if(!m)return y.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const b="function"===typeof m?m(a,c,e):m;if(p.has(b))return d=p.get(b),Promise.resolve(d);if(m=this._ongoingMaterialRequestMap.get(b))return m;m=this._cimLayer;var h=B.analyzeCIMResource(m.cim,this._cimLayer.materialOverrides);h.mosaicHash=b;const {type:n,url:r}=m;h={cim:h,type:n,mosaicHash:b,url:r,size:null,dashTemplate:null,text:null,fontName:null};switch(n){case "marker":h.size=D.evaluateValueOrFunction(m.size,
a,c,e);break;case "line":h.dashTemplate=m.dashTemplate;break;case "text":h.text=D.evaluateValueOrFunction(m.text,a,c,e),h.fontName=D.evaluateValueOrFunction(m.fontName,a,c,e)}d=d.getMosaicItem(h,f).then(x=>{k||(this._ongoingMaterialRequestMap.delete(b),p.set(b,x));return x}).catch(x=>{this._ongoingMaterialRequestMap.delete(b);y.error(".analyze()",x.message);return null});k||this._ongoingMaterialRequestMap.set(b,d);return d};return g}(z)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/fontUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m){function b(R){switch(R){case "Butt":return c.CapType.BUTT;case "Square":return c.CapType.SQUARE;default:return c.CapType.ROUND}}function h(R){switch(R){case "Bevel":return c.JoinType.BEVEL;case "Miter":return c.JoinType.MITER;default:return c.JoinType.ROUND}}function n(R){switch(R){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function r(R){switch(R){default:return"top";case "Center":return"middle";
case "Baseline":return"baseline";case "Bottom":return"bottom"}}function x(R){let aa="",ba="";R&&(R=R.toLowerCase(),-1!==R.indexOf("italic")?aa="italic":-1!==R.indexOf("oblique")&&(aa="oblique"),-1!==R.indexOf("bold")?ba="bold":-1!==R.indexOf("light")&&(ba="lighter"));return{style:aa,weight:ba}}function q(R,aa,ba,ca){let da;R[aa]?da=R[aa]:(da={},R[aa]=da);da[ba]=ca}function A(R){return(R=R.markerPlacement)&&R.angleToLine?c.Alignment.MAP:c.Alignment.SCREEN}function E(){E=u._asyncToGenerator(function*(R,
aa,ba,ca,da){ca=null!=ca?ca:[];if(!R)return ca;let ea;const ia={};if("CIMSymbolReference"===R.type){if(ea=R.symbol,R=R.primitiveOverrides){var ha=[];for(const ka of R){var fa=ka.valueExpressionInfo;fa&&aa?(fa=d.createRendererExpression(fa.expression,aa.spatialReference,aa.fields).then(la=>{la&&q(ia,ka.primitiveName,ka.propertyName,la)}),ha.push(fa)):null!=ka.value&&q(ia,ka.primitiveName,ka.propertyName,ka.value)}0<ha.length&&(yield Promise.all(ha))}}else return Y.error("Expect cim type to be 'CIMSymbolReference'"),
ca;ha=[];Z(ea,ba,ha);0<ha.length&&(yield Promise.all(ha));switch(ea.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":F(ea,R,ia,aa,ca,ba,da)}return ca});return E.apply(this,arguments)}function F(R,aa,ba,ca,da,ea,ia){if(R){var ha=R.symbolLayers;if(ha){var fa=R.effects,ka=a.CIMSymbolHelper.getSize(R);if("CIMPointSymbol"===R.type&&"Map"===R.angleAlignment)var la=c.Alignment.MAP;for(var pa=ha.length;pa--;){var ja=ha[pa];if(!ja||!1===ja.enable)continue;let ua;fa&&fa.length&&(ua=
[...fa]);var ma=ja.effects;ma&&ma.length&&(fa?ua.push(...ma):ua=[...ma]);ma=[];a.OverrideHelper.findEffectOverrides(ua,aa,ma);ma=0<ma.length?J(ua,ma,ba,ca):ua;var na=[];a.OverrideHelper.findApplicableOverrides(ja,aa,na);switch(ja.type){case "CIMSolidFill":w(ja,ma,ba,na,ca,da);break;case "CIMPictureFill":v(ja,ma,ba,na,ca,ea,da);break;case "CIMHatchFill":C(ja,ma,ba,na,ca,da);break;case "CIMGradientFill":{var oa=ba,qa=ca,sa=da;const [wa,Da]=W(na,ja.primitiveName,ma,null);var ra=g.numericHash(JSON.stringify(ja)+
Da).toString();sa.push({type:"fill",templateHash:ra,materialHash:wa?S(ra,oa,na,qa):ra,cim:ja,materialOverrides:null,colorLocked:ja.colorLocked,effects:ma,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}break;case "CIMSolidStroke":G(ja,ma,ba,na,ca,da,"CIMPolygonSymbol"===R.type,ka);break;case "CIMPictureStroke":H(ja,ma,ba,na,ca,da,"CIMPolygonSymbol"===R.type,ka);break;case "CIMGradientStroke":{oa=ba;qa=ca;sa=da;ra="CIMPolygonSymbol"===R.type;var ta=ka,va=ja.primitiveName,
xa=void 0!==ja.width?ja.width:4,za=b(ja.capStyle),Ba=h(ja.joinStyle),ya=ja.miterLimit;const [wa,Da]=W(na,va,ma,null),Aa=g.numericHash(JSON.stringify(ja)+Da).toString();sa.push({type:"line",templateHash:Aa,materialHash:wa?S(Aa,oa,na,qa):Aa,cim:ja,materialOverrides:null,isOutline:ra,colorLocked:ja.colorLocked,effects:ma,color:{r:128,g:128,b:128,a:1},width:Q(va,oa,"Width",qa,xa),cap:Q(va,oa,"CapStyle",qa,za),join:Q(va,oa,"JoinStyle",qa,Ba),miterLimit:Q(va,oa,"MiterLimit",qa,ya),referenceWidth:ta,zOrder:U(ja.name),
dashTemplate:null,scaleDash:!1})}break;case "CIMCharacterMarker":L(ja,ma,ba,na,ca,da);break;case "CIMPictureMarker":if(L(ja,ma,ba,na,ca,da))break;"CIMLineSymbol"===R.type&&(la=A(ja));O(ja,ma,ba,na,ca,ea,da,la,ka);break;case "CIMVectorMarker":if(L(ja,ma,ba,na,ca,da))break;"CIMLineSymbol"===R.type&&(la=A(ja));oa=ba;qa=ca;sa=da;ra=ea;ta=la;va=ka;xa=ia;if(Ba=ja.markerGraphics){za=0;ja.scaleSymbolsProportionally&&(ya=ja.frame)&&(za=ya.ymax-ya.ymin);ya=P(ja.markerPlacement,na,oa,qa);for(const wa of Ba)if(wa&&
(Ba=wa.symbol))switch(Ba.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":K(ja,ma,ya,wa,na,oa,qa,sa,ra,ta,va,za,xa);break;case "CIMTextSymbol":N(ja,ma,ya,wa,oa,na,qa,sa,ta,va,za)}}break;default:Y.error("Cannot analyze CIM layer",ja.type)}}}}}function w(R,aa,ba,ca,da,ea){const ia=R.primitiveName,ha=f.fromCIMColor(R.color),[fa,ka]=W(ca,ia,aa,null),la=g.numericHash(JSON.stringify(R)+ka).toString();ea.push({type:"fill",templateHash:la,materialHash:fa?()=>la:la,cim:R,materialOverrides:null,
colorLocked:R.colorLocked,color:Q(ia,ba,"Color",da,ha,T),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:aa})}function v(R,aa,ba,ca,da,ea,ia){const ha=R.primitiveName,fa=R.tintColor?f.fromCIMColor(R.tintColor):{r:255,g:255,b:255,a:1},[ka,la]=W(ca,ha,aa,null);ca=g.numericHash(JSON.stringify(R)+la).toString();const pa=g.numericHash(`${R.url}${JSON.stringify(R.colorSubstitutions)}`).toString();let ja=f.getValue(R.scaleX);if("width"in R){const ma=R.width;let na=1;ea=ea.getResource(R.url);y.isSome(ea)&&
(na=ea.width/ea.height);ja/=R.height/ma*na}ia.push({type:"fill",templateHash:ca,materialHash:ka?()=>pa:pa,cim:R,materialOverrides:null,colorLocked:R.colorLocked,effects:aa,color:Q(ha,ba,"TintColor",da,fa,T),height:Q(ha,ba,"Height",da,R.height),scaleX:Q(ha,ba,"ScaleX",da,ja),angle:Q(ha,ba,"Rotation",da,f.getValue(R.rotation)),offsetX:Q(ha,ba,"OffsetX",da,f.getValue(R.offsetX)),offsetY:Q(ha,ba,"OffsetY",da,f.getValue(R.offsetY)),url:R.url})}function C(R,aa,ba,ca,da,ea){const ia=["Rotation","OffsetX",
"OffsetY"],ha=ca.filter(ja=>ja.primitiveName!==R.primitiveName&&-1===ia.indexOf(ja.propertyName)),fa=R.primitiveName,[ka,la]=W(ca,fa,aa,null);ca=g.numericHash(JSON.stringify(R)+la).toString();const pa=g.numericHash(`${R.separation}${JSON.stringify(R.lineSymbol)}`).toString();ea.push({type:"fill",templateHash:ca,materialHash:ka?S(pa,ba,ha,da):pa,cim:R,materialOverrides:ha,colorLocked:R.colorLocked,effects:aa,color:{r:255,g:255,b:255,a:1},height:Q(fa,ba,"Separation",da,R.separation),scaleX:1,angle:Q(fa,
ba,"Rotation",da,f.getValue(R.rotation)),offsetX:Q(fa,ba,"OffsetX",da,f.getValue(R.offsetX)),offsetY:Q(fa,ba,"OffsetY",da,f.getValue(R.offsetY))})}function G(R,aa,ba,ca,da,ea,ia,ha){const fa=R.primitiveName,ka=f.fromCIMColor(R.color),la=void 0!==R.width?R.width:4,pa=b(R.capStyle),ja=h(R.joinStyle),ma=R.miterLimit,[na,oa]=W(ca,fa,aa,null),qa=g.numericHash(JSON.stringify(R)+oa).toString();let sa;if(aa&&aa instanceof Array&&0<aa.length&&(ca=aa[aa.length-1],"CIMGeometricEffectDashes"===ca.type&&"NoConstraint"===
ca.lineDashEnding&&null===ca.offsetAlongLine)){aa=[...aa];var ra=aa.pop();sa=ra.dashTemplate;ra=ra.scaleDash}ea.push({type:"line",templateHash:qa,materialHash:na?()=>qa:qa,cim:R,materialOverrides:null,isOutline:ia,colorLocked:R.colorLocked,effects:aa,color:Q(fa,ba,"Color",da,ka,T),width:Q(fa,ba,"Width",da,la),cap:Q(fa,ba,"CapStyle",da,pa),join:Q(fa,ba,"JoinStyle",da,ja),miterLimit:Q(fa,ba,"MiterLimit",da,ma),referenceWidth:ha,zOrder:U(R.name),dashTemplate:sa,scaleDash:ra})}function H(R,aa,ba,ca,da,
ea,ia,ha){const fa=g.numericHash(`${R.url}${JSON.stringify(R.colorSubstitutions)}`).toString(),ka=R.primitiveName,la=f.fromCIMColor(R.tintColor),pa=void 0!==R.width?R.width:4,ja=b(R.capStyle),ma=h(R.joinStyle),na=R.miterLimit,[oa,qa]=W(ca,ka,aa,null);ca=g.numericHash(JSON.stringify(R)+qa).toString();ea.push({type:"line",templateHash:ca,materialHash:oa?()=>fa:fa,cim:R,materialOverrides:null,isOutline:ia,colorLocked:R.colorLocked,effects:aa,color:Q(ka,ba,"TintColor",da,la,T),width:Q(ka,ba,"Width",da,
pa),cap:Q(ka,ba,"CapStyle",da,ja),join:Q(ka,ba,"JoinStyle",da,ma),miterLimit:Q(ka,ba,"MiterLimit",da,na),referenceWidth:ha,zOrder:U(R.name),dashTemplate:null,scaleDash:!1,url:R.url})}function L(R,aa,ba,ca,da,ea){const ia=R.markerPlacement;if(!ia||"CIMMarkerPlacementInsidePolygon"!==ia.type)return!1;const ha=["Rotation","OffsetX","OffsetY"],fa=ca.filter(oa=>oa.primitiveName!==R.primitiveName&&-1===ha.indexOf(oa.propertyName)),ka="url"in R?R.url:null,[la,pa]=W(ca,ia.primitiveName,aa,null);ca=g.numericHash(JSON.stringify(R)+
pa).toString();let ja=ia.stepY,ma=null,na=1;ia.shiftOddRows&&(ja*=2,ma=function(oa){return oa?2*oa:0},na=.5);ea.push({type:"fill",templateHash:ca,materialHash:la?S(ca,ba,fa,da):ca,cim:R,materialOverrides:fa,colorLocked:R.colorLocked,effects:aa,color:{r:255,g:255,b:255,a:1},height:Q(ia.primitiveName,ba,"StepY",da,ja,ma),scaleX:na,angle:Q(ia.primitiveName,ba,"GridAngle",da,ia.gridAngle),offsetX:Q(ia.primitiveName,ba,"OffsetX",da,f.getValue(ia.offsetX)),offsetY:Q(ia.primitiveName,ba,"OffsetY",da,f.getValue(ia.offsetY)),
url:ka});return!0}function O(R,aa,ba,ca,da,ea,ia,ha,fa){var ka;const la=R.primitiveName,pa=f.getValue(R.size);let ja=f.getValue(R.scaleX);const ma=f.getValue(R.rotation),na=f.getValue(R.offsetX),oa=f.getValue(R.offsetY),qa=R.tintColor?f.fromCIMColor(R.tintColor):{r:255,g:255,b:255,a:1},sa=g.numericHash(`${R.url}${JSON.stringify(R.colorSubstitutions)}`).toString();var ra=P(R.markerPlacement,ca,ba,da);const [ta,va]=W(ca,la,aa,ra);ca=g.numericHash(JSON.stringify(R)+va).toString();ra=null!=(ka=R.anchorPoint)?
ka:{x:0,y:0};if("width"in R){ka=R.width;let xa=1;ea=ea.getResource(R.url);y.isSome(ea)&&(xa=ea.width/ea.height);ja/=pa/ka*xa}ia.push({type:"marker",templateHash:ca,materialHash:ta?()=>sa:sa,cim:R,materialOverrides:null,colorLocked:R.colorLocked,effects:aa,scaleSymbolsProportionally:!1,alignment:ha,size:Q(la,ba,"Size",da,pa),scaleX:Q(la,ba,"ScaleX",da,ja),rotation:Q(la,ba,"Rotation",da,ma),offsetX:Q(la,ba,"OffsetX",da,na),offsetY:Q(la,ba,"OffsetY",da,oa),color:Q(la,ba,"TintColor",da,qa,T),anchorPoint:{x:ra.x,
y:-ra.y},isAbsoluteAnchorPoint:"Relative"!==R.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:R.rotateClockwise,referenceSize:fa,sizeRatio:1,markerPlacement:R.markerPlacement,url:R.url})}function N(R,aa,ba,ca,da,ea,ia,ha,fa,ka,la){a.OverrideHelper.findApplicableOverrides(ca,ea,[]);var pa=ca.geometry;if("x"in pa&&"y"in pa){var ja=ca.symbol;var ma=ja.underline?"underline":ja.strikethrough?"line-through":"none";var na=x(ja.fontStyleName),oa=m.getFontFamily(ja.fontFamilyName);
ja.font={family:oa,decoration:ma,...na};var qa=R.frame,sa=pa.x-.5*(qa.xmin+qa.xmax),ra=pa.y-.5*(qa.ymin+qa.ymax),ta=R.size/la;la=R.primitiveName;pa=f.getValue(ja.height)*ta;qa=f.getValue(ja.angle);sa=f.getValue(R.offsetX)+(f.getValue(ja.offsetX)+sa)*ta;ra=f.getValue(R.offsetY)+(f.getValue(ja.offsetY)+ra)*ta;var va=f.fromCIMColor(a.CIMSymbolHelper.getFillColor(ja)),xa=f.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(ja)),za=a.CIMSymbolHelper.getStrokeWidth(ja);za||(xa=f.fromCIMColor(a.CIMSymbolHelper.getFillColor(ja.haloSymbol)),
za=ja.haloSize*ta);var [Ba,ya]=W(ea,la,aa,ba);ea=JSON.stringify(R.effects)+Number(R.colorLocked)+JSON.stringify(R.anchorPoint)+R.anchorPointUnits+JSON.stringify(R.markerPlacement);ea=g.numericHash(JSON.stringify(ca)+ea+ya).toString();var ua=Q(ca.primitiveName,da,"TextString",ia,ca.textString,f._adjustTextCase,ja.textCase);if(null!=ua){({fontStyleName:ca}=ja);var wa=oa+(ca?"-"+ca.toLowerCase():"-regular");"string"===typeof ua&&-1<ua.indexOf("[")&&ja.fieldMap&&(ua=f.createLabelOverrideFunction(ja.fieldMap,
ua,ja.textCase));ha.push({type:"text",templateHash:ea,materialHash:Ba||"function"===typeof ua||ua.match(/\[(.*?)\]/)?(Da,Aa,Fa)=>wa+"-"+f.evaluateValueOrFunction(ua,Da,Aa,Fa):wa+"-"+g.numericHash(ua),cim:ja,materialOverrides:null,colorLocked:R.colorLocked,effects:aa,alignment:fa,anchorPoint:{x:R.anchorPoint?R.anchorPoint.x:0,y:R.anchorPoint?R.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==R.anchorPointUnits,fontName:wa,decoration:ma,weight:Q(la,da,"Weight",ia,na.weight),style:Q(la,da,"Size",
ia,na.style),size:Q(la,da,"Size",ia,pa),angle:Q(la,da,"Rotation",ia,qa),offsetX:Q(la,da,"OffsetX",ia,sa),offsetY:Q(la,da,"OffsetY",ia,ra),horizontalAlignment:n(ja.horizontalAlignment),verticalAlignment:r(ja.verticalAlignment),text:ua,color:va,outlineColor:xa,outlineSize:za,referenceSize:ka,sizeRatio:1,markerPlacement:ba})}}}function K(R,aa,ba,ca,da,ea,ia,ha,fa,ka,la,pa,ja){var ma=ca.symbol;const na=ma.symbolLayers;if(na)if(ja)M(R,aa,ba,ca,ea,da,ia,ha,fa,ka,la,pa);else if(ja=na.length,na&&2===na.length&&
na[0].enable&&na[1].enable&&"CIMSolidStroke"===na[0].type&&"CIMSolidFill"===na[1].type&&!na[0].effects&&!na[1].effects)I(R,aa,ba,ca,na,da,ea,ia,ha,ka,la,pa);else if(ma=k.CIMEffectHelper.applyEffects(ma.effects,ca.geometry,fa.geometryEngine))for(;ja--;){var oa=na[ja];if(oa&&!1!==oa.enable)switch(oa.type){case "CIMSolidFill":case "CIMSolidStroke":{var qa,sa=k.CIMEffectHelper.applyEffects(oa.effects,ma,fa.geometryEngine),ra=e.getExtent(sa);if(!ra)continue;const [xa,za,Ba]=e.getSDFMetrics(ra,R.frame,
R.size,R.anchorPoint,"Relative"!==R.anchorPointUnits);var ta="CIMSolidFill"===oa.type;sa={type:"sdf",geom:sa,asFill:ta};var va=R.primitiveName;ra=null!=(qa=f.getValue(R.size))?qa:10;const ya=f.getValue(R.rotation),ua=f.getValue(R.offsetX),wa=f.getValue(R.offsetY),Da=oa.path,Aa=oa.primitiveName,Fa=ta?f.fromCIMColor(a.CIMSymbolHelper.getFillColor(oa)):f.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(oa)),Ga=ta?{r:0,g:0,b:0,a:0}:f.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(oa)),Ca=a.CIMSymbolHelper.getStrokeWidth(oa);
if(!ta&&!Ca)break;ta=!1;let Ha="";for(const Ea of da)if(Ea.primitiveName===Aa||Ea.primitiveName===va)void 0!==Ea.value?Ha+=`-${Ea.primitiveName}-${Ea.propertyName}-${JSON.stringify(Ea.value)}`:Ea.valueExpressionInfo&&(ta=!0);y.isSome(aa)&&"function"===typeof aa&&(ta=!0);va=JSON.stringify({...R,markerGraphics:null});const Ia=g.numericHash(JSON.stringify(sa)+Da).toString();oa={type:"marker",templateHash:g.numericHash(JSON.stringify(ca)+JSON.stringify(oa)+va+Ha).toString(),materialHash:ta?()=>Ia:Ia,
cim:sa,materialOverrides:null,colorLocked:R.colorLocked,effects:aa,scaleSymbolsProportionally:R.scaleSymbolsProportionally,alignment:ka,anchorPoint:{x:za,y:Ba},isAbsoluteAnchorPoint:!1,size:Q(R.primitiveName,ea,"Size",ia,ra),rotation:Q(R.primitiveName,ea,"Rotation",ia,ya),offsetX:Q(R.primitiveName,ea,"OffsetX",ia,ua),offsetY:Q(R.primitiveName,ea,"OffsetY",ia,wa),scaleX:1,frameHeight:pa,rotateClockwise:R.rotateClockwise,referenceSize:la,sizeRatio:xa,color:Q(Aa,ea,"Color",ia,Fa,T),outlineColor:Q(Aa,
ea,"Color",ia,Ga,T),outlineWidth:Q(Aa,ea,"Width",ia,Ca),markerPlacement:ba,path:Da};ha.push(oa);break}default:M(R,aa,ba,ca,ea,da,ia,ha,fa,ka,la,pa)}}}function I(R,aa,ba,ca,da,ea,ia,ha,fa,ka,la,pa){var ja=ca.geometry;const ma=da[0];da=da[1];var na=e.getExtent(ja);if(na){var [oa,qa,sa]=e.getSDFMetrics(na,R.frame,R.size,R.anchorPoint,"Relative"!==R.anchorPointUnits);ja={type:"sdf",geom:ja,asFill:!0};var ra=R.primitiveName;na=f.getValue(R.size);var ta=f.getValue(R.rotation),va=f.getValue(R.offsetX),xa=
f.getValue(R.offsetY),za=da.path,Ba=da.primitiveName,ya=ma.primitiveName,ua=f.fromCIMColor(a.CIMSymbolHelper.getFillColor(da)),wa=f.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(ma)),Da=a.CIMSymbolHelper.getStrokeWidth(ma),Aa=!1,Fa="";for(const Ca of ea)if(Ca.primitiveName===Ba||Ca.primitiveName===ya||Ca.primitiveName===ra)void 0!==Ca.value?Fa+=`-${Ca.primitiveName}-${Ca.propertyName}-${JSON.stringify(Ca.value)}`:Ca.valueExpressionInfo&&(Aa=!0);ea=JSON.stringify({...R,markerGraphics:null});var Ga=
g.numericHash(JSON.stringify(ja)+za).toString();R={type:"marker",templateHash:g.numericHash(JSON.stringify(ca)+JSON.stringify(da)+JSON.stringify(ma)+ea+Fa).toString(),materialHash:Aa?()=>Ga:Ga,cim:ja,materialOverrides:null,colorLocked:R.colorLocked,effects:aa,scaleSymbolsProportionally:R.scaleSymbolsProportionally,alignment:ka,anchorPoint:{x:qa,y:sa},isAbsoluteAnchorPoint:!1,size:Q(R.primitiveName,ia,"Size",ha,na),rotation:Q(R.primitiveName,ia,"Rotation",ha,ta),offsetX:Q(R.primitiveName,ia,"OffsetX",
ha,va),offsetY:Q(R.primitiveName,ia,"OffsetY",ha,xa),scaleX:1,frameHeight:pa,rotateClockwise:R.rotateClockwise,referenceSize:la,sizeRatio:oa,color:Q(Ba,ia,"Color",ha,ua,T),outlineColor:Q(ya,ia,"Color",ha,wa,T),outlineWidth:Q(ya,ia,"Width",ha,Da),markerPlacement:ba,path:za};fa.push(R)}}function M(R,aa,ba,ca,da,ea,ia,ha,fa,ka,la,pa){ca={type:R.type,enable:!0,name:R.name,colorLocked:R.colorLocked,primitiveName:R.primitiveName,anchorPoint:R.anchorPoint,anchorPointUnits:R.anchorPointUnits,offsetX:0,offsetY:0,
rotateClockwise:R.rotateClockwise,rotation:0,size:R.size,billboardMode3D:R.billboardMode3D,depth3D:R.depth3D,frame:R.frame,markerGraphics:[ca],scaleSymbolsProportionally:R.scaleSymbolsProportionally,respectFrame:R.respectFrame,clippingPath:R.clippingPath};let ja=[];const ma=["Rotation","OffsetX","OffsetY"];ja=ea.filter(xa=>xa.primitiveName!==R.primitiveName||-1===ma.indexOf(xa.propertyName));var na="";for(var oa of ea)void 0!==oa.value&&(na+=`-${oa.primitiveName}-${oa.propertyName}-${JSON.stringify(oa.value)}`);
const [qa,sa,ra]=a.CIMSymbolHelper.getTextureAnchor(ca,fa);ea=R.primitiveName;fa=f.getValue(R.rotation);oa=f.getValue(R.offsetX);const ta=f.getValue(R.offsetY);na=g.numericHash(JSON.stringify(ca)+na).toString();const va=0<ja.length||y.isSome(aa)&&"function"===typeof aa;aa={type:"marker",templateHash:na,materialHash:va?S(na,da,ja,ia):na,cim:ca,materialOverrides:ja,colorLocked:R.colorLocked,effects:aa,scaleSymbolsProportionally:R.scaleSymbolsProportionally,alignment:ka,anchorPoint:{x:qa,y:sa},isAbsoluteAnchorPoint:!1,
size:R.size,rotation:Q(ea,da,"Rotation",ia,fa),offsetX:Q(ea,da,"OffsetX",ia,oa),offsetY:Q(ea,da,"OffsetY",ia,ta),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:pa,rotateClockwise:R.rotateClockwise,referenceSize:la,sizeRatio:ra/l.pt2px(R.size),markerPlacement:ba};ha.push(aa)}function U(R){return R&&0===R.indexOf("Level_")&&(R=parseInt(R.substr(6),10),!isNaN(R))?R:0}function T(R){if(!R||0===R.length)return null;R=(new B(R)).toRgba();return{r:R[0],g:R[1],
b:R[2],a:R[3]}}function Q(R,aa,ba,ca,da,ea,ia){if(R=aa[R]){const ha=R[ba];if("string"===typeof ha||"number"===typeof ha||ha instanceof Array)return ea?ea.call(null,ha,ia):ha;if(null!=ha&&ha instanceof d.ArcadeExpression)return(fa,ka,la)=>{fa=p(ha,fa,{$view:la},ca.geometryType,ka);null!==fa&&ea&&(fa=ea.call(null,fa,ia));return null!==fa?fa:da}}return da}function J(R,aa,ba,ca){for(const da of aa)if(da.valueExpressionInfo){const ea=ba[da.primitiveName]&&ba[da.primitiveName][da.propertyName];ea instanceof
d.ArcadeExpression&&(da.fn=(ia,ha,fa)=>p(ea,ia,{$view:fa},ca.geometryType,ha))}return(da,ea,ia)=>{for(var ha of aa)ha.fn&&(ha.value=ha.fn(da,ea,ia));da=[];for(let ka of R){var fa;if(ea=null==(fa=ka)?void 0:fa.primitiveName){ia=!1;for(const la of aa)la.primitiveName===ea&&(ha=(ha=la.propertyName)?ha.charAt(0).toLowerCase()+ha.substr(1):ha,null!=la.value&&la.value!==ka[ha]&&(ia||(ka=D.clone(ka),ia=!0),ka[ha]=la.value))}da.push(ka)}return da}}function P(R,aa,ba,ca){const da=[];a.OverrideHelper.findApplicableOverrides(R,
aa,da);if(0===da.length)return R;for(const ea of da)if(ea.valueExpressionInfo){const ia=ba[ea.primitiveName]&&ba[ea.primitiveName][ea.propertyName];ia instanceof d.ArcadeExpression&&(ea.fn=(ha,fa,ka)=>p(ia,ha,{$view:ka},ca.geometryType,fa))}return(ea,ia,ha)=>{for(const fa of da)fa.fn&&(fa.value=fa.fn(ea,ia,ha));ea=D.clone(R);ia=R.primitiveName;for(const fa of da)fa.primitiveName===ia&&(ha=(ha=fa.propertyName)?ha.charAt(0).toLowerCase()+ha.substr(1):ha,null!=fa.value&&fa.value!==ea[ha]&&(ea[ha]=fa.value));
return ea}}function S(R,aa,ba,ca){for(const da of ba)if(da.valueExpressionInfo){const ea=aa[da.primitiveName]&&aa[da.primitiveName][da.propertyName];ea instanceof d.ArcadeExpression&&(da.fn=(ia,ha,fa)=>p(ea,ia,{$view:fa},ca.geometryType,ha))}return(da,ea,ia)=>{for(const ha of ba)ha.fn&&(ha.value=ha.fn(da,ea,ia));return g.numericHash(R+a.OverrideHelper.buildOverrideKey(ba)).toString()}}function W(R,aa,ba,ca){let da=!1,ea="";for(const ia of R)ia.primitiveName===aa&&(void 0!==ia.value?ea+=`-${ia.primitiveName}-${ia.propertyName}-${JSON.stringify(ia.value)}`:
ia.valueExpressionInfo&&(da=!0));y.isSome(ba)&&"function"===typeof ba&&(da=!0);y.isSome(ca)&&"function"===typeof ca&&(da=!0);return[da,ea]}function Z(R,aa,ba){if(R&&aa)switch(R.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(R=R.symbolLayers)for(const ca of R)switch(V(ca,aa,ba),ca.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in ca&&ca.url&&ba.push(aa.fetchResource(ca.url,
null));break;case "CIMVectorMarker":if(R=ca.markerGraphics)for(const da of R)da&&(R=da.symbol)&&Z(R,aa,ba)}}}function V(R,aa,ba){R.effects&&!y.isSome(aa.geometryEngine)&&(X?ba.push(X):f.isGeometryEngineRequired(R.effects)&&(X=f.importGeometryEngine(),ba.push(X),X.then(ca=>aa.geometryEngine=ca)))}const Y=z.getLogger("esri.symbols.cim.cimAnalyzer");let X;t.analyzeCIMResource=function(R,aa){if(!aa||0===aa.length)return R;R=JSON.parse(JSON.stringify(R));a.OverrideHelper.applyOverrides(R,aa);return R};
t.analyzeCIMSymbol=function(R,aa,ba,ca,da){return E.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(t,u,B){function D(y){const l={};switch(y){case "esriGeometryPoint":return(g,d,a,c)=>B.unquantizePoint(d,l,g,a,c);case "esriGeometryPolygon":return(g,d,a,c)=>B.unquantizePolygon(d,l,g,a,c);case "esriGeometryPolyline":return(g,
d,a,c)=>B.unquantizePolyline(d,l,g,a,c);case "esriGeometryMultipoint":return(g,d,a,c)=>B.unquantizeMultipoint(d,l,g,a,c);default:return u.getLogger("esri.views.2d.support.arcadeOnDemand").error(new t("mapview-arcade",`Unable to handle geometryType: ${y}`)),g=>g}}const z=new Map;return function(y,l,g,d,a){if(y.referencesGeometry()&&a){{const {transform:c,hasZ:e,hasM:f}=a;z.has(d)||z.set(d,D(d));d=z.get(d)(l.geometry,c,e,f);l={...l,geometry:d}}}l=y.repurposeFeature(l);try{return y.evaluate({...g,$feature:l})}catch(c){return u.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",
c),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(t,u,B){function D({scale:v,translate:C},G){return Math.round((G-C[0])/v[0])}function z({scale:v,translate:C},G){return Math.round((C[1]-G)/v[1])}function y(v,C,G){const H=[];let L,O,N,K;for(let I=0;I<G.length;I++){const M=G[I];if(0<I){if(N=D(v,M[0]),K=z(v,M[1]),N!==L||K!==O)H.push(C(M,N-L,K-O)),L=N,O=K}else L=D(v,M[0]),O=z(v,M[1]),H.push(C(M,L,O))}return 0<H.length?H:null}
function l(v,C,G,H){return y(v,G?H?w:F:H?F:E,C)}function g(v,C,G,H){const L=[];G=G?H?w:F:H?F:E;for(H=0;H<C.length;H++){const O=y(v,G,C[H]);O&&3<=O.length&&L.push(O)}return L.length?L:null}function d(v,C,G,H){const L=[];G=G?H?w:F:H?F:E;for(H=0;H<C.length;H++){const O=y(v,G,C[H]);O&&2<=O.length&&L.push(O)}return L.length?L:null}function a({scale:v,translate:C},G){return G*v[0]+C[0]}function c({scale:v,translate:C},G){return C[1]-G*v[1]}function e(v,C,G){const H=Array(G.length);if(!G.length)return H;
const [L,O]=v.scale;let N=a(v,G[0][0]);v=c(v,G[0][1]);H[0]=C(G[0],N,v);for(let K=1;K<G.length;K++){const I=G[K];N+=I[0]*L;v-=I[1]*O;H[K]=C(I,N,v)}return H}function f(v,C,G){const H=Array(G.length);for(let L=0;L<G.length;L++)H[L]=e(v,C,G[L]);return H}function k(v,C,G,H){return e(v,G?H?w:F:H?F:E,C)}function p(v,C,G,H){return f(v,G?H?w:F:H?F:E,C)}function m(v,C,G,H){return f(v,G?H?w:F:H?F:E,C)}function b(v,C,G){let [H,L]=G[0],O=Math.min(H,C[0]),N=Math.min(L,C[1]),K=Math.max(H,C[2]);C=Math.max(L,C[3]);
for(let I=1;I<G.length;I++){const [M,U]=G[I];H+=M;L+=U;0>M&&(O=Math.min(O,H));0<M&&(K=Math.max(K,H));0>U?N=Math.min(N,L):0<U&&(C=Math.max(C,L))}v[0]=O;v[1]=N;v[2]=K;v[3]=C;return v}function h(v,C){if(!C.length)return null;v[0]=v[1]=Number.POSITIVE_INFINITY;v[2]=v[3]=Number.NEGATIVE_INFINITY;for(let G=0;G<C.length;G++)b(v,v,C[G]);return v}function n(v,C,G,H,L){C.xmin=D(v,G.xmin);C.ymin=z(v,G.ymin);C.xmax=D(v,G.xmax);C.ymax=z(v,G.ymax);C!==G&&(H&&(C.zmin=G.zmin,C.zmax=G.zmax),L&&(C.mmin=G.mmin,C.mmax=
G.mmax));return C}function r(v,C,G,H,L){C.points=l(v,G.points,H,L);return C}function x(v,C,G,H,L){C.x=D(v,G.x);C.y=z(v,G.y);C!==G&&(H&&(C.z=G.z),L&&(C.m=G.m));return C}function q(v,C,G,H,L){v=g(v,G.rings,H,L);if(!v)return null;C.rings=v;return C}function A(v,C,G,H,L){v=d(v,G.paths,H,L);if(!v)return null;C.paths=v;return C}const E=(v,C,G)=>[C,G],F=(v,C,G)=>[C,G,v[2]],w=(v,C,G)=>[C,G,v[2],v[3]];t.equals=function(v,C){if(v===C||null==v&&null==C)return!0;if(null==v||null==C)return!1;let G,H,L,O;v&&"upperLeft"===
v.originPosition?(G=v.translate[0],H=v.translate[1],v=v.scale[0]):(G=u.isSome(v.extent)?v.extent.xmin:0,H=u.isSome(v.extent)?v.extent.ymax:0,v=v.tolerance);C&&"upperLeft"===C.originPosition?(L=C.translate[0],O=C.translate[1],C=C.scale[0]):(L=u.isSome(C.extent)?C.extent.xmin:0,O=u.isSome(C.extent)?C.extent.ymax:0,C=C.tolerance);return G===L&&H===O&&v===C};t.getQuantizedBoundsCoordsArray=b;t.getQuantizedBoundsCoordsArrayArray=h;t.getQuantizedBoundsPaths=function(v){return h([0,0,0,0],v)};t.getQuantizedBoundsPoints=
function(v){const C=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return b(C,C,v)};t.getQuantizedBoundsRings=function(v){return h([0,0,0,0],v)};t.quantizeBounds=function(v,C,G){C[0]=D(v,G[0]);C[3]=z(v,G[1]);C[2]=D(v,G[2]);C[1]=z(v,G[3]);return C};t.quantizeExtent=n;t.quantizeGeometry=function(v,C){return v&&C?B.isPoint(C)?x(v,{},C,!1,!1):B.isPolyline(C)?A(v,{},C,!1,!1):B.isPolygon(C)?q(v,{},C,!1,!1):B.isMultipoint(C)?r(v,{},C,!1,!1):B.isExtent(C)?
n(v,{},C,!1,!1):null:null};t.quantizeMultipoint=r;t.quantizePaths=d;t.quantizePoint=x;t.quantizePoints=l;t.quantizePolygon=q;t.quantizePolyline=A;t.quantizeRings=g;t.quantizeX=D;t.quantizeY=z;t.toQuantizationTransform=function(v){return v?{originPosition:"upper-left"===v.originPosition?"upperLeft":"lower-left"===v.originPosition?"lowerLeft":v.originPosition,scale:v.tolerance?[v.tolerance,v.tolerance]:[1,1],translate:u.isSome(v.extent)?[v.extent.xmin,v.extent.ymax]:[0,0]}:null};t.unquantizeBounds=
function(v,C,G){return G?(C[0]=a(v,G[0]),C[1]=c(v,G[3]),C[2]=a(v,G[2]),C[3]=c(v,G[1]),C):[a(v,C[0]),c(v,C[3]),a(v,C[2]),c(v,C[1])]};t.unquantizeCoordsArray=e;t.unquantizeCoordsArrayArray=f;t.unquantizeExtent=function(v,C,G,H,L){C.xmin=a(v,G.xmin);C.ymin=c(v,G.ymin);C.xmax=a(v,G.xmax);C.ymax=c(v,G.ymax);C!==G&&(H&&(C.zmin=G.zmin,C.zmax=G.zmax),L&&(C.mmin=G.mmin,C.mmax=G.mmax));return C};t.unquantizeMultipoint=function(v,C,G,H,L){u.isSome(G)&&(C.points=k(v,G.points,H,L));return C};t.unquantizePaths=
p;t.unquantizePoint=function(v,C,G,H,L){if(u.isNone(G))return C;C.x=a(v,G.x);C.y=c(v,G.y);C!==G&&(H&&(C.z=G.z),L&&(C.m=G.m));return C};t.unquantizePoints=k;t.unquantizePolygon=function(v,C,G,H,L){u.isSome(G)&&(C.rings=m(v,G.rings,H,L));return C};t.unquantizePolyline=function(v,C,G,H,L){u.isSome(G)&&(C.paths=p(v,G.paths,H,L));return C};t.unquantizeRings=m;t.unquantizeX=a;t.unquantizeY=c;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c){return function(e){function f(k,p,m){var b=e.call(this,k)||this;b._minMaxZoom=y.i1616to32(Math.round(p*z.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(m*z.MIN_MAX_ZOOM_PRECISION_FACTOR));b._cimLineLayer=k;let h=0;g.isFunction(k.width)||(h=.5*B.pt2px(k.width));b._dynamicPropertyMap.set("_halfWidth",(x,q,A)=>g.isFunction(k.width)?.5*B.pt2px(k.width(x,q,A)):h);g.isFunction(k.cap)?b._dynamicPropertyMap.set("_capType",k.cap):b._capType=k.cap;g.isFunction(k.join)?b._dynamicPropertyMap.set("_joinType",
k.join):b._joinType=k.join;const n=k.color;g.isFunction(n)?b._dynamicPropertyMap.set("_fillColor",(x,q,A)=>D.premultiplyAlphaRGBA(n(x,q,A))):b._fillColor=n&&D.premultiplyAlphaRGBA(n)||0;const r=k.miterLimit;g.isFunction(r)?b._dynamicPropertyMap.set("_miterLimitCosine",(x,q,A)=>g.getLimitCosine(r(x,q,A))):b._miterLimitCosine=g.getLimitCosine(r);u.isSome(k.effects)&&(p=k.effects,g.isFunction(p)?b._dynamicPropertyMap.set("_effects",p):b._effects=p);b._scaleFactor=k.scaleFactor||1;b._isDashed=null!=k.dashTemplate;
b.tessellationProperties._bitset=(k.colorLocked?1:0)|(k.scaleDash?1:0)<<1;b._materialKey=k.materialKey;b._initializeTessellator(!0);return b}t._inheritsLoose(f,e);f.fromCIMLine=function(k,p){const [m,b]=g.getMinMaxZoom(k.scaleInfo,p);return new f(k,m,b)};f.prototype.bindFeature=function(k,p,m){const b=k.readLegacyFeature();this._dynamicPropertyMap.forEach((n,r)=>{this[r]=n(b,p,m)});this._halfWidth*=this._scaleFactor;k=this._materialCache;var h=this._cimLineLayer.materialHash;h=h(b,p,m);h=k.get(h);
k=null;h&&c.ok(h.spriteMosaicItem)&&(k=h.spriteMosaicItem);if(k){this._hasPattern=!0;const {rect:n,width:r,height:x}=k;h=n.x+z.SPRITE_PADDING;const q=n.y+z.SPRITE_PADDING,A=h+r,E=q+x;this.tessellationProperties._tl=y.i1616to32(h,q);this.tessellationProperties._br=y.i1616to32(A,E)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=
0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;h=l.LineMaterialKey.load(this._materialKey);k&&(h.sdf=k.sdf,h.pattern=!0,h.textureBinding=k.textureBinding);this._materialKey=h.data};return f}(d(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m){const b=l.create(),h=y.create(),n=B.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(r){function x(q,A,E){var F=r.call(this,q)||this;F._cimMarkerLayer=q;F._minMaxZoom=c.i1616to32(Math.round(A*a.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(E*a.MIN_MAX_ZOOM_PRECISION_FACTOR));const w=q.color;f.isFunction(w)?F._dynamicPropertyMap.set("_fillColor",(O,N,K)=>d.premultiplyAlphaRGBA(w(O,N,K))):F._fillColor=d.premultiplyAlphaRGBA(w);const v=
q.outlineColor;f.isFunction(v)?F._dynamicPropertyMap.set("_outlineColor",(O,N,K)=>d.premultiplyAlphaRGBA(v(O,N,K))):F._outlineColor=d.premultiplyAlphaRGBA(v);const C=q.size;f.isFunction(C)?F._dynamicPropertyMap.set("_size",(O,N,K)=>z.pt2px(C(O,N,K))):F._size=z.pt2px(C)||0;A=q.scaleX;f.isFunction(A)?F._dynamicPropertyMap.set("_scaleX",A):F._scaleX=A||1;const G=q.offsetX;f.isFunction(G)?F._dynamicPropertyMap.set("xOffset",(O,N,K)=>z.pt2px(G(O,N,K))):F.xOffset=z.pt2px(G)||0;const H=q.offsetY;f.isFunction(H)?
F._dynamicPropertyMap.set("yOffset",(O,N,K)=>z.pt2px(H(O,N,K))):F.yOffset=z.pt2px(H)||0;const L=q.outlineWidth;f.isFunction(L)?F._dynamicPropertyMap.set("_outlineWidth",(O,N,K)=>z.pt2px(L(O,N,K))):F._outlineWidth=z.pt2px(L)||0;A=q.rotation;f.isFunction(A)?F._dynamicPropertyMap.set("_angle",A):F._angle=A||0;D.isSome(q.effects)&&(A=q.effects,f.isFunction(A)?F._dynamicPropertyMap.set("_effects",A):F._effects=A);D.isSome(q.markerPlacement)&&(A=q.markerPlacement,f.isFunction(A)?F._dynamicPropertyMap.set("_markerPlacement",
A):F._markerPlacement=A);F._scaleFactor=D.unwrapOr(q.scaleFactor,1);F._bitSet=(q.alignment===g.Alignment.MAP?1:0)|(q.colorLocked?1:0)<<1|(q.scaleSymbolsProportionally?1:0)<<3;F._materialKey=q.materialKey;return F}t._inheritsLoose(x,r);x.fromCIMMarker=function(q,A){const [E,F]=f.getMinMaxZoom(q.scaleInfo,A);return new x(q,E,F)};x.prototype.bindFeature=function(q,A,E){const F=q.readLegacyFeature();this._dynamicPropertyMap.forEach((T,Q)=>{this[Q]=T(F,A,E)});q=this._cimMarkerLayer.materialHash;q="function"===
typeof q?q(F,A,E):q;if((q=this._materialCache.get(q))&&m.ok(q.spriteMosaicItem)&&q.spriteMosaicItem){q=q.spriteMosaicItem;var w=this._cimMarkerLayer.sizeRatio,v=q.width/q.height*this._scaleX,C=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,G=this._size,H=G*v,L=this.xOffset,O=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var N=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/z.pt2px(this._cimMarkerLayer.frameHeight):
1,K=this._outlineWidth*N,I=z.pt2px(this._cimMarkerLayer.referenceSize),M=N=0,U=this._cimMarkerLayer.anchorPoint;U&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(N=-U.x/(this._size*v),M=U.y/this._size):(N=U.x,M=U.y));this._sizeOutlineWidth=c.i8888to32(Math.round(Math.min(Math.sqrt(128*H),255)),Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*K),255)),Math.round(Math.min(Math.sqrt(128*I),255)));this.angle=C;this._bitestAndDistRatio=c.i1616to32(this._bitSet,Math.round(64*
w));v=q.rect.x+a.SPRITE_PADDING;C=q.rect.y+a.SPRITE_PADDING;K=v+q.width;I=C+q.height;this._texUpperLeft=c.i1616to32(v,C);this._texUpperRight=c.i1616to32(K,C);this._texBottomLeft=c.i1616to32(v,I);this._texBottomRight=c.i1616to32(K,I);v=e.MarkerMaterialKey.load(this._materialKey);v.sdf=q.sdf;v.pattern=!0;v.textureBinding=q.textureBinding;this._materialKey=v.data;this._anchorX=.5-(.5+N)*q.width/q.width;this._anchorY=.5-(.5+M)*q.height/q.height;H=H*w*this._scaleFactor;G=G*w*this._scaleFactor;H*=q.rect.width/
q.width;G*=q.rect.height/q.height;this._computedWidth=H;this._computedHeight=G;this._applyTransformation(h,b);this.xOffset=L;this.yOffset=O}else n.error(new u("mapview-cim","Encountered an error when binding feature"))};return x}(k(p))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f){return function(k){function p(b,h,n){var r=k.call(this,b)||this;r._horizontalAlignment="center";r._verticalAlignment="middle";r._textToGlyphs=new Map;r._minMaxZoom=g.i1616to32(Math.round(h*l.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(n*l.MIN_MAX_ZOOM_PRECISION_FACTOR));h=b.scaleFactor||1;r._cimTextLayer=b;const x=b.color;a.isFunction(x)?r._dynamicPropertyMap.set("_color",(w,v,C)=>y.premultiplyAlphaRGBA(x(w,v,C))):r._color=y.premultiplyAlphaRGBA(x);const q=b.outlineColor;
a.isFunction(q)?r._dynamicPropertyMap.set("_haloColor",(w,v,C)=>y.premultiplyAlphaRGBA(q(w,v,C))):r._haloColor=y.premultiplyAlphaRGBA(q);let A;a.isFunction(b.size)||(A=Math.min(Math.round(B.pt2px(b.size*b.sizeRatio)),127));r._dynamicPropertyMap.set("_size",(w,v,C)=>a.isFunction(b.size)?Math.min(Math.round(B.pt2px(b.size(w,v,C)*b.sizeRatio)),127):A);a.isFunction(b.outlineSize)?r._dynamicPropertyMap.set("_haloSize",(w,v,C)=>Math.min(Math.floor(5*B.pt2px(b.outlineSize(w,v,C)*b.sizeRatio)),127)):r._haloSize=
Math.min(Math.floor(5*B.pt2px(b.outlineSize*b.sizeRatio)),127);let E;a.isFunction(b.offsetX)||(E=Math.round(B.pt2px(b.offsetX*b.sizeRatio)));r._dynamicPropertyMap.set("_xOffset",(w,v,C)=>a.isFunction(b.offsetX)?Math.round(B.pt2px(b.offsetX(w,v,C)*b.sizeRatio)):E);let F;a.isFunction(b.offsetY)||(F=Math.round(B.pt2px(b.offsetY*b.sizeRatio)));r._dynamicPropertyMap.set("_yOffset",(w,v,C)=>a.isFunction(b.offsetY)?Math.round(B.pt2px(b.offsetY(w,v,C)*b.sizeRatio)):F);a.isFunction(b.angle)?r._dynamicPropertyMap.set("_angle",
b.angle):r._angle=b.angle;a.isFunction(b.horizontalAlignment)?r._dynamicPropertyMap.set("_horizontalAlignment",b.horizontalAlignment):r._horizontalAlignment=b.horizontalAlignment;a.isFunction(b.verticalAlignment)?r._dynamicPropertyMap.set("_verticalAlignment",b.verticalAlignment):r._verticalAlignment=b.verticalAlignment;u.isSome(b.effects)&&(n=b.effects,a.isFunction(n)?r._dynamicPropertyMap.set("_effects",n):r._effects=n);u.isSome(b.markerPlacement)&&(n=b.markerPlacement,a.isFunction(n)?r._dynamicPropertyMap.set("_markerPlacement",
n):r._textPlacement=n);a.isFunction(b.text)?r._dynamicPropertyMap.set("_text",b.text):r._text=b.text;r._scaleFactor=h;h=Math.min(Math.round(B.pt2px(b.referenceSize*b.sizeRatio)),127);r._referenceSize=Math.round(Math.sqrt(256*h));r._materialKey=b.materialKey;h=d.TextMaterialKey.load(r._materialKey);h.sdf=!0;r._bitset=(b.alignment===D.Alignment.MAP?1:0)|(b.colorLocked?1:0)<<1;r._materialKey=h.data;r._decoration="none";r._lineHeight=1;r._lineWidth=512;r._isCIM=!0;return r}t._inheritsLoose(p,k);p.fromCIMText=
function(b,h){const [n,r]=a.getMinMaxZoom(b.scaleInfo,h);return new p(b,n,r)};var m=p.prototype;m.analyze=function(){var b=t._asyncToGenerator(function*(h,n,r,x){var q=n.readLegacyFeature();var A=this._cimTextLayer;q="string"===typeof A.text?A.text:"function"===typeof A.text?A.text(q,r,x):"";(h=yield k.prototype.analyze.call(this,h,n,r,x,f.codepoints(q)))&&h.glyphMosaicItems&&this._textToGlyphs.set(q,h.glyphMosaicItems);return h});return function(h,n,r,x){return b.apply(this,arguments)}}();m.bindFeature=
function(b,h,n){const r=b.readLegacyFeature();this._dynamicPropertyMap.forEach((x,q)=>{this[q]=x(r,h,n)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/l.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=z.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=z.getYAnchorDirection(this._verticalAlignment||"baseline"),b=this._textToGlyphs.get(this._text),this.bindTextInfo(b,!1)):this._shapingInfo=null};
return p}(c(e))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(t){t.codepoints=function(u){const B=Array(u.length);for(let D=0;D<u.length;D++)B[D]=u.charCodeAt(D);return B};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(t,u,B,D,z,y,l,g,d,a){return function(c){function e(f,k,p,m,b,h,n,r,x,q,A,E,F,w,v,C){var G=c.call(this)||this;G._effects=w;f=l.FillMaterialKey.load(f);k&&(f.sdf=k.sdf,f.pattern=!0,f.textureBinding=k.textureBinding);G.fillColor=p;G.tl=m;G.br=b;G.aux2=y.i8888to32(h,n,r,x);G.aux3=y.i8888to32(q,A,E,0);G._bitset=F;G._minMaxZoom=y.i1616to32(Math.round(v*D.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(C*D.MIN_MAX_ZOOM_PRECISION_FACTOR));G._materialKey=f.data;return G}t._inheritsLoose(e,c);e.fromCIMFill=
function(f,k,p){var m=f.color;m=m&&B.premultiplyAlphaRGBA(m)||0;const b=f.materialKey,[h,n]=g.getMinMaxZoom(f.scaleInfo,p);if(!k)return new e(b,null,m,0,0,0,0,0,0,0,0,0,f.colorLocked?D.BITSET_GENERIC_LOCK_COLOR:0,f.effects,h,n);const {rect:r,width:x,height:q}=k;var A=f.scaleX||1,E=r.x+D.SPRITE_PADDING;const F=r.y+D.SPRITE_PADDING;var w=E+x;const v=F+q;var C=f.height;p=Math.round(C);255<p?p=255:0>=p&&(p=v-F);A=Math.round(A*C);255<A?A=255:0>=A&&(A=w-E);C=u.pt2px(f.offsetX||0)+128;255<C&&(C=255);let G=
u.pt2px(-f.offsetY||0)+128;255<G&&(G=255);E=y.i1616to32(E,F);w=y.i1616to32(w,v);return new e(b,k,m,E,w,A,p,C,G,128,128,z.degToByte(f.angle),f.colorLocked?D.BITSET_GENERIC_LOCK_COLOR:0,f.effects,h,n)};e.fromSimpleFill=function(f,k,p=!1){var {color:m}=f;m=m&&"esriSFSNull"!==f.style&&B.premultiplyAlphaRGBAArray(m)||0;p=p?D.BITSET_GENERIC_LOCK_COLOR:0;const b=f.materialKey;if(k){const {rect:r,width:x,height:q}=k;var h=r.x+D.SPRITE_PADDING;const A=r.y+D.SPRITE_PADDING;var n=h+x;const E=A+q;h=y.i1616to32(h,
A);n=y.i1616to32(n,E);k=new e(b,k,m,h,n,x,q,0,0,128,128,0,p,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM)}else k=new e(b,null,m,0,0,0,0,0,0,0,0,0,p,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM);k._maybeAddLineTemplate(f);return k};e.fromPictureFill=function(f,k,p=!1){const m=D.PICTURE_FILL_COLOR,{rect:b,width:h,height:n}=k;var r=b.x+D.SPRITE_PADDING,x=b.y+D.SPRITE_PADDING,q=r+h,A=x+n;r=y.i1616to32(r,x);q=y.i1616to32(q,A);A=Math.round(u.pt2px(f.width));255<A&&(A=255);x=Math.round(u.pt2px(f.height));255<
x&&(x=255);let E=u.pt2px(f.xoffset)+128;255<E&&(E=255);let F=u.pt2px(-f.yoffset)+128;255<F&&(F=255);k=new e(f.materialKey,k,m,r,q,A,x,E,F,128*f.xscale,128*f.yscale,0,p?D.BITSET_GENERIC_LOCK_COLOR:0,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM);k._maybeAddLineTemplate(f);return k};return e}(d(a))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(t,u,B){function D(){D=u._asyncToGenerator(function*(y,
l,g){try{yield y.acquire(),yield l(g),y.release()}catch(d){throw y.release(),d;}});return D.apply(this,arguments)}let z=function(){function y(){this._resolver=null}var l=y.prototype;l.isHeld=function(){return!!this._resolver};l.acquire=function(){var g=u._asyncToGenerator(function*(){if(!this._resolver)return this._resolver=B.createResolver(),Promise.resolve();yield this._resolver.promise;yield this.acquire()});return function(){return g.apply(this,arguments)}}();l.release=function(){const g=this._resolver;
this._resolver=null;g.resolve()};return y}();t.default=z;t.withLock=function(y,l,g){return D.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(t,u,B,D,z){const y=function(){var d=u._asyncToGenerator(function*(a,c,e,f){return Promise.all(a.map(k=>g(k,
c,e,f)))});return function(a,c,e,f){return d.apply(this,arguments)}}(),l=function(){var d=u._asyncToGenerator(function*(a,c,e){return new D.ExpandedCIM(yield B.analyzeCIMSymbol(a.data,c,e),a.data,a.rendererKey,a.maxVVSize)});return function(a,c,e){return d.apply(this,arguments)}}(),g=function(){var d=u._asyncToGenerator(function*(a,c,e,f){return a?"cim"===a.type?l(a,c,e):"web-style"===a.type?(a={type:"cim",data:yield z.fetchCIMSymbolReference(a,null,f),rendererKey:a.rendererKey,maxVVSize:a.maxVVSize},
l(a,c,e)):a:null});return function(a,c,e,f){return d.apply(this,arguments)}}();t.cimLayerToRasterizationInfo=function(d){if(!d)return null;const {type:a,cim:c,url:e,materialHash:f}=d,k={cim:c,type:a,mosaicHash:f,url:e,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(a){case "marker":k.size=d.size;k.path=d.path;break;case "line":k.dashTemplate=d.dashTemplate;break;case "text":k.text=d.text,k.fontName=d.fontName}return k};t.expandSymbol=g;t.expandSymbols=y;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(t,u,B,D){const z={marker:B.WGLGeometryType.MARKER,fill:B.WGLGeometryType.FILL,line:B.WGLGeometryType.LINE,text:B.WGLGeometryType.TEXT};B=function(){function y(l,g,d,a){const c={minScale:null==g?void 0:g.minScale,maxScale:null==g?void 0:g.maxScale};var e=c.minScale||c.maxScale?
c.minScale+"-"+c.maxScale:"";this.layers=l;this.data=g;this.hash=this._createHash()+e;this.rendererKey=d;g={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:d};for(const f of l)f.materialKey=D.createMaterialKey(z[f.type],g),f.maxVVSize=a,f.scaleInfo=c,f.templateHash+=e}y.prototype._createHash=function(){let l="";for(const g of this.layers)l+=g.templateHash;return l};u._createClass(y,[{key:"type",get:function(){return"expanded-cim"}}]);return y}();t.ExpandedCIM=B;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),function(t,u,B,D,z,y,l,g,d){function a(){a=u._asyncToGenerator(function*(p,m,b){if(!p.name)return Promise.reject(new D("style-symbol-reference-name-missing",
"Missing name in style symbol reference"));if(p.styleName&&"Esri2DPointSymbolsStyle"===p.styleName)return c(p,b);try{const h=yield d.fetchStyle(p,m,b);return f(h,p.name,m,b)}catch(h){return z.throwIfAborted(h),null}});return a.apply(this,arguments)}function c(p,m){return e.apply(this,arguments)}function e(){e=u._asyncToGenerator(function*(p,m){p=d.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,p.name);try{const b=yield d.requestJSON(p,m);return d.makeCIMSymbolRef(b.data)}catch(b){return z.throwIfAborted(b),
null}});return e.apply(this,arguments)}function f(p,m,b,h){return k.apply(this,arguments)}function k(){k=u._asyncToGenerator(function*(p,m,b,h){var n=p.data;p={portal:b&&b.portal||l.getDefault(),url:y.urlToObject(p.baseUrl),origin:"portal-item"};n=n.items.find(r=>r.name===m);if(!n)throw new D("symbolstyleutils:symbol-name-not-found",`The symbol name '${m}' could not be found`,{symbolName:m});n=g.fromJSON(d.symbolUrlFromStyleItem(n,"cimRef"),p);B.isDevEnvironment()&&(n=B.adjustStaticAGOUrl(n));try{const r=
yield d.requestJSON(n,h);return d.makeCIMSymbolRef(r.data)}catch(r){return z.throwIfAborted(r),null}});return k.apply(this,arguments)}t.fetchCIMSymbolReference=function(p,m,b){return a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(t){const u=/^devext.arcgis.com$/,B=/^qaext.arcgis.com$/,D=/^[\w-]*\.mapsdevext.arcgis.com$/,z=/^[\w-]*\.mapsqa.arcgis.com$/,y=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,
u,B,/^jsapps.esri.com$/,D,z];t.adjustStaticAGOUrl=function(l,g){return l?(g=g||globalThis.location.hostname)?null!=g.match(u)||null!=g.match(D)?l.replace("static.arcgis.com","staticdev.arcgis.com"):null!=g.match(B)||null!=g.match(z)?l.replace("static.arcgis.com","staticqa.arcgis.com"):l:l:l};t.isDevEnvironment=function(l){l=l||globalThis.location.hostname;return y.some(g=>{var d;return null!=(null==(d=l)?void 0:d.match(g))})};t.isTelemetryDevEnvironment=function(l){l=l||globalThis.location.hostname;
return[/^zrh-.+?\.esri\.com$/].concat(y).some(g=>{var d;return null!=(null==(d=l)?void 0:d.match(g))})};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),function(t,
u,B,D,z,y,l,g,d){function a(A,E,F,w){return c.apply(this,arguments)}function c(){c=B._asyncToGenerator(function*(A,E,F,w){switch(A.type){case "simple":return b.fromBasicRenderer(A,E,F,w);case "map":return r.fromUVRenderer(A,E,F,w);case "interval":return n.fromCBRenderer(A,E,F,w);case "dictionary":return q.fromDictionaryRenderer(A,E,F,w);case "subtype":return h.fromSubtypes(A,E,F,w)}});return c.apply(this,arguments)}function e(A,E){return f.apply(this,arguments)}function f(){f=B._asyncToGenerator(function*(A,
E){const F=A||1;if("number"===typeof F)return(v,C,G)=>F;const w=yield l.createRendererExpression(F,E.spatialReference,E.fields);return(v,C,G)=>g(w,v,{$view:G},E.geometryType,C)||1});return f.apply(this,arguments)}function k(){return p.apply(this,arguments)}function p(){p=B._asyncToGenerator(function*(){x||(x=new Promise((A,E)=>t(["../../../layers/features/createSymbolSchema"],A,E)));return x});return p.apply(this,arguments)}const m=z.getLogger("esri/views/2d/engine/webgl/util/Matcher");let b=function(){function A(){this.type=
"feature";this._defaultResult=null}A.fromBasicRenderer=function(){var F=B._asyncToGenerator(function*(w,v,C,G){const H=new A;w.symbol&&(w=yield d.expandSymbol(w.symbol,C,G),v=v.createTemplateGroup(w,null),H.setDefault(v));return H});return function(w,v,C,G){return F.apply(this,arguments)}}();var E=A.prototype;E.size=function(){return 1};E.getDefault=function(){return this._defaultResult};E.setDefault=function(F){this._defaultResult=F};E.match=function(F,w,v,C,G){return this.getDefault()};E.analyze=
function(){var F=B._asyncToGenerator(function*(w,v,C,G,H,L){return null});return function(w,v,C,G,H,L){return F.apply(this,arguments)}}();return A}(),h=function(A){function E(F,w){var v=A.call(this)||this;v._subMatchers=F;v._subtypeField=w;return v}B._inheritsLoose(E,A);E.fromSubtypes=function(){var F=B._asyncToGenerator(function*(w,v,C,G){const H=new Map,L=[];for(const O in w.renderers){const N=parseInt(O,10),K=a(w.renderers[O],v,C,G).then(I=>H.set(N,I));L.push(K)}yield Promise.all(L);return new E(H,
w.subtypeField)});return function(w,v,C,G){return F.apply(this,arguments)}}();E.prototype.match=function(F,w,v,C,G){var H=w.readAttribute(this._subtypeField);return(H=this._subMatchers.get(H))?H.match(F,w,v,C,G):null};return E}(b),n=function(A){function E(w,v,C,G){var H=A.call(this)||this;H.type="interval";H._intervals=[];H._isMaxInclusive=v;H._fieldIndex=G;H._field=w;H._normalizationInfo=C;return H}B._inheritsLoose(E,A);E.fromCBRenderer=function(){var w=B._asyncToGenerator(function*(v,C,G,H){const {isMaxInclusive:L,
normalizationField:O,normalizationTotal:N,normalizationType:K}=v,I=new E(v.field,L,{normalizationField:O,normalizationTotal:N,normalizationType:K},v.fieldIndex),M=yield d.expandSymbol(v.backgroundFillSymbol,G,H);yield Promise.all(v.intervals.map(function(){var U=B._asyncToGenerator(function*(T){var Q=yield d.expandSymbol(T.symbol,G,H);Q=yield C.createTemplateGroup(Q,M);I.add({min:T.min,max:T.max},Q)});return function(T){return U.apply(this,arguments)}}()));if(v=yield d.expandSymbol(v.defaultSymbol,
G,H))v=yield C.createTemplateGroup(v,M),I.setDefault(v);return I});return function(v,C,G,H){return w.apply(this,arguments)}}();var F=E.prototype;F.add=function(w,v){this._intervals.push({interval:w,result:v});this._intervals.sort((C,G)=>C.interval.min-G.interval.min)};F.size=function(){return A.prototype.size.call(this)+this._intervals.length};F.match=function(w,v,C,G,H){if(null==this._fieldIndex&&!this._field)return this.getDefault();w=null!=this._fieldIndex?v.getComputedNumericAtIndex(this._fieldIndex):
this._getValueFromField(v);if(!w&&(null===w||void 0===w||isNaN(w)))return this.getDefault();for(v=0;v<this._intervals.length;v++){const {interval:L,result:O}=this._intervals[v];C=this._isMaxInclusive?w<=L.max:w<L.max;if(w>=L.min&&C)return O}return this.getDefault()};F._needsNormalization=function(){const w=this._normalizationInfo;return w&&(w.normalizationField||w.normalizationTotal||w.normalizationType)};F._getValueFromField=function(w){const v=w.readAttribute(this._field);if(!this._needsNormalization()||
null==v)return v;const {normalizationField:C,normalizationTotal:G,normalizationType:H}=this._normalizationInfo;w=!!C&&w.readAttribute(C);if(H)switch(H){case "esriNormalizeByField":return(w||void 0)&&v/w;case "esriNormalizeByLog":return Math.log(v)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return v/G*100;default:m.error(`Found unknown normalization type: ${H}`)}else m.error("Normalization is required, but no type was set!")};return E}(b),r=function(A){function E(w,v,C){var G=A.call(this)||this;
G.type="map";G._nullResult=null;G._resultsMap=new Map;G._fieldsIndex=C;G._fields=w;G._seperator=v||"";return G}B._inheritsLoose(E,A);E.fromUVRenderer=function(){var w=B._asyncToGenerator(function*(v,C,G,H){const L=v.fieldDelimiter,O=[v.field];v.field2&&O.push(v.field2);v.field3&&O.push(v.field3);const N=yield d.expandSymbol(v.backgroundFillSymbol,G,H),K=new E(O,L,v.fieldIndex);yield Promise.all(v.map.map(function(){var I=B._asyncToGenerator(function*(M){var U=yield d.expandSymbol(M.symbol,G,H);U=
yield C.createTemplateGroup(U,N);"\x3cNull\x3e"===M.value?K.setNullResult(U):K.add(M.value,U)});return function(M){return I.apply(this,arguments)}}()));if(v=yield d.expandSymbol(v.defaultSymbol,G,H))v=yield C.createTemplateGroup(v,N),K.setDefault(v);return K});return function(v,C,G,H){return w.apply(this,arguments)}}();var F=E.prototype;F.setNullResult=function(w){this._nullResult=w};F.add=function(w,v){this._resultsMap.set(w.toString(),v)};F.size=function(){return A.prototype.size.call(this)+this._resultsMap.size};
F.match=function(w,v,C,G,H){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();w=null!=this._fieldsIndex?v.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(v);if(null!==this._nullResult&&(null==w||""===w||"\x3cNull\x3e"===w))return this._nullResult;if(!w&&null==w)return this.getDefault();w=w.toString();return this._resultsMap.has(w)?this._resultsMap.get(w):this.getDefault()};F._getValueFromFields=function(w){const v=[];for(const C of this._fields){const G=w.readAttribute(C);
null==G||""===G?v.push("\x3cNull\x3e"):v.push(G)}return v.join(this._seperator)};return E}(b),x,q=function(A){function E(w,v,C,G,H,L){var O=A.call(this)||this;O.type="dictionary";O._groupIdCache=new y(100);O._loader=w;O._fieldMap=w.fieldMap;O._symbolFields=w.getSymbolFields();O._templates=v;O._info=C;O._scaleFn=G;O._schemaUtilsModule=H;O._symbolOptions=L;return O}B._inheritsLoose(E,A);E.fromDictionaryRenderer=function(){var w=B._asyncToGenerator(function*(v,C,G,H){const [{DictionaryLoader:L},O]=yield Promise.all([new Promise((K,
I)=>t(["../../../../../renderers/support/DictionaryLoader"],K,I)),k()]);H=new L(v.url,v.config,v.fieldMap);yield H.fetchResources({spatialReference:G.spatialReference,fields:G.fields});const N=yield e(v.scaleExpression,G);return new E(H,C,G,N,O,v.symbolOptions)});return function(v,C,G,H){return w.apply(this,arguments)}}();var F=E.prototype;F._analyzeFeature=function(){var w=B._asyncToGenerator(function*(v,C,G,H,L){v=v.readLegacyFeature();const O=this._scaleFn(v,G,H);G=this._attributeHash(v)+"-"+O;
const N=this._groupIdCache.get(G);if(N)return N;H=yield this._loader.getSymbolAsync(v,{...H,spatialReference:this._info.spatialReference,abortOptions:L,fields:this._info.fields});H=this._schemaUtilsModule.createSymbolSchema(H,this._symbolOptions);C=d.expandSymbol(H,this._info,C,L).then(K=>{if("expanded-cim"!==K.type)return m.error(new D("mapview-bad-type",`Found unexpected type ${K.type} in dictionary response`)),null;K.hash+="-"+O;for(const I of K.layers)I.scaleFactor=O,I.templateHash+="-"+O;return this._templates.createTemplateGroup(K,
null)});this._groupIdCache.put(G,C,1);return C});return function(v,C,G,H,L){return w.apply(this,arguments)}}();F.analyze=function(){var w=B._asyncToGenerator(function*(v,C,G,H,L,O){v=C.getCursor();for(C=[];v.next();)C.push(this._analyzeFeature(v,G,H,L,O));return Promise.all(C)});return function(v,C,G,H,L,O){return w.apply(this,arguments)}}();F.match=function(w,v,C,G,H){return null};F._attributeHash=function(w){let v="";for(const C of this._symbolFields){const G=this._fieldMap[C];G&&(v+=w.attributes[G]+
"-")}return v};return E}(b);u.DictionaryMatcher=q;u.FeatureMatcher=b;u.IntervalMatcher=n;u.MapMatcher=r;u.SubtypeMatcher=h;u.createMatcher=a;Object.defineProperty(u,"__esModule",{value:!0})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../engine/webgl/Utils ../../engine/webgl/util/vvFlagUtils ./createSymbolSchema ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k){function p(T){let Q=0,J=0,P=!1,S=!0,W=!0;if(y.isSome(T)){J=c.getPtMaxVVSize(T);"visualVariables"in T&&(Q=d.getVVFlags(T.visualVariables||[]),P="dot-density"===T.type);if("dictionary"===T.type)return{maxVVSize:J,supportsOutlineFills:!1,vvFlags:Q,stride:{fill:"default"}};if(!P){var Z=T.getSymbols();"backgroundFillSymbol"in T&&T.backgroundFillSymbol&&Z.push(T.backgroundFillSymbol);for(const V of Z)if("cim"===V.type&&(S=!1),"simple-fill"===V.type||"picture-fill"===
V.type)if((T=V.outline)&&"none"!==T.style&&"solid"!==T.style&&(W=!1),T=T&&"none"!==T.style&&"solid"!==T.style,Z="simple-fill"===V.type&&"none"!==V.style&&"solid"!==V.style,"picture-fill"===V.type||Z||T)S=!1}}P&&(W=!1);return{vvFlags:Q,maxVVSize:J,supportsOutlineFills:W,stride:{fill:P?"dot-density":S?"simple":"default"}}}function m(T,Q){const J=T.labelPlacement;var P=U[Q];if(!T.symbol)return M.warn("No ILabelClass symbol specified."),!0;if(!P)return M.error(new u("mapview-labeling:unsupported-geometry-type",
`Unable to create labels for Feature Layer, ${Q} is not supported`)),!0;P.some(S=>S===J)||(P=P[0],J&&M.warn(`Found invalid label placement type ${J} for ${Q}. Defaulting to ${P}`),T.labelPlacement=P);return!1}function b(T,Q){T=D.clone(T);return T.some(J=>m(J,Q))?[]:T}function h(T,Q=!1){try{var J,P;const S=E(T,Q),W={};S.map(Z=>{a:{switch(Z.target){case "feature":x(W,r(T),Z);Z=void 0;break a;case "aggregate":if(!("featureReduction"in T)){Z=void 0;break a}var V=T.featureReduction;if("selection"===V.type)throw new u("ValidationError",
"Mapview does not support `selection` reduction type",V);x(W,r(T),Z);W.aggregate||(W.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:l.pt2px(V.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(l.pt2px(V.clusterMaxSize)/64),fields:Z.aggregateFields}});n(W.aggregate,Z.attributes.fields);Z=void 0;break a}Z=void 0}return Z});return{source:{definitionExpression:T.definitionExpression,fields:T.fields.map(Z=>Z.toJSON()),gdbVersion:T.gdbVersion,historicMoment:null==
(J=T.historicMoment)?void 0:J.getTime(),outFields:T.availableFields,pixelBuffer:T.pixelBuffer,spatialReference:T.spatialReference.toJSON(),timeExtent:null==(P=T.timeExtent)?void 0:P.toJSON(),customParameters:T.customParameters},attributes:{fields:{},indexCount:0},processors:S,targets:W}}catch(S){if("ValidationError"===S.fieldName)return M.error(S),null;throw S;}}function n(T,Q){for(const J in Q){const P=Q[J];if(P.target!==T.name)continue;const S=T.attributes[J];S?(S.context.mesh=S.context.mesh||P.context.mesh,
S.context.storage=S.context.storage||P.context.storage):T.attributes[J]=P}return T}function r(T){var Q,J,P,S,W;return[null!=(Q=null==(J=y.unwrap(T.filter))?void 0:J.toJSON())?Q:null,null!=(P=null==(S=y.unwrap(null==(W=y.unwrap(T.featureEffect))?void 0:W.filter))?void 0:S.toJSON())?P:null]}function x(T,Q,J){T.feature||(T.feature={name:"feature",input:"source",filters:Q,attributes:{}});n(T.feature,J.attributes.fields);return T}function q(T,Q){return Q.field?A(T,{...Q,type:"field",field:Q.field}):Q.valueExpression?
A(T,{...Q,type:"expression",valueExpression:Q.valueExpression}):{field:null,fieldIndex:null}}function A(T,Q){switch(Q.type){case "expression":var J=Q.valueExpression;if(!T.fields[J]){var P=T.indexCount++;T.fields[J]={...Q,name:J,fieldIndex:P}}return{fieldIndex:T.fields[J].fieldIndex};case "label-expression":return J=JSON.stringify(Q.label),T.fields[J]||(P=T.indexCount++,T.fields[J]={...Q,name:J,fieldIndex:P}),{fieldIndex:T.fields[J].fieldIndex};case "field":J=Q.field;if("aggregate"===Q.target&&T.fields[J])return{field:J};
T.fields[J]={...Q,name:J};return{field:J};case "statistic":return T.fields[Q.name]={...Q},{field:Q.name}}}function E(T,Q=!1){const J=[];let P=0;J.push(w(T,P++,Q));return J}function F(T,Q,J,P,S,W=!1){Q=A(Q,{type:"label-expression",target:P,context:{mesh:!0},resultType:"string",label:{labelExpression:J.labelExpression,labelExpressionInfo:J.labelExpressionInfo?{expression:J.labelExpressionInfo.expression}:null,symbol:!!J.symbol,where:J.where}});({fieldIndex:Q}=Q);T=p(T);return{...a.createSymbolSchema(J,
T,W),fieldIndex:Q,target:P,index:S}}function w(T,Q,J=!1){const P={indexCount:0,fields:{}};var S="featureReduction"in T&&T.featureReduction;Q=S?"aggregate":"feature";if("sublayers"in T){var W={type:"subtype",subtypeField:T.subtypeField,renderers:{},stride:{fill:"default"}},Z={type:"subtype",mapping:{},target:"feature"},V={type:"subtype",classes:{}},Y={type:"symbol",target:"feature",aggregateFields:[],attributes:P,storage:Z,mesh:{matcher:W,aggregateMatcher:null,labels:V,sortKey:null}};S=new Set;let aa=
0;for(const {renderer:ba,subtypeCode:ca,labelingInfo:da,labelsVisible:ea}of T.sublayers){T=O(P,Q,ba,J);var X=G(P,Q,ba),R=ea&&da;if("visualVariables"in ba&&ba.visualVariables&&ba.visualVariables.length)throw new u("ValidationError","Visual variables are currently not supported for subtype layers");if("dictionary"===T.type)throw new u("ValidationError","Dictionary renderer is not supported in subtype layers");if("subtype"===T.type)throw new u("ValidationError","Nested subtype renderers is not supported");
if(y.isSome(X)&&"subtype"===X.type)throw new u("ValidationError","Nested subtype storage is not supported");if(y.isSome(X)&&"dot-density"===X.type)throw new u("ValidationError","Dot density attributes are not supported in subtype layers");if(S.has(ca))throw new u("ValidationError","Subtype codes for sublayers must be unique");S.add(ca);W.renderers[ca]=T;Z.mapping[ca]=X;R&&(V.classes[ca]=R.map(ia=>F(ba,P,ia,"feature",aa++,J)))}return Y}switch(T.renderer.type){case "heatmap":{const {blurRadius:aa,fieldOffset:ba,
field:ca}=T.renderer;return{type:"heatmap",aggregateFields:[],attributes:P,target:Q,storage:null,mesh:{blurRadius:aa,fieldOffset:ba,field:q(P,{target:Q,field:ca,resultType:"numeric"}).field}}}default:{W=[];const aa="aggregate"===Q?f.createClusterRenderer(W,T.renderer,S,null):T.renderer;C(P,W);Z=O(P,Q,aa,J);Y=null;V=G(P,Q,aa);X=k.toJSONGeometryType(T.geometryType);R=T.labelsVisible&&T.labelingInfo||[];let ba=[];if(S){if("selection"===S.type)throw new u("ValidationError","Mapview does not support `selection` reduction type",
S);S.symbol&&(Y=p(aa),Y={type:"simple",symbol:a.createSymbolSchema(S.symbol,Y,J),stride:Y.stride});ba=S&&S.labelsVisible&&S.labelingInfo||[]}R=b(R,X);ba=b(ba,X);let ca=0;S=[...R.map(da=>F(aa,P,da,"feature",ca++,J)),...ba.map(da=>F(aa,P,da,"aggregate",ca++,J))];T=v(P,T.orderBy);return{type:"symbol",target:Q,attributes:P,aggregateFields:W,storage:V,mesh:{matcher:Z,labels:{type:"simple",classes:S},aggregateMatcher:Y,sortKey:T}}}}}function v(T,Q){if(y.isNone(Q)||!Q.length)return null;1<Q.length&&M.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${Q.length}. All but the first will be discarded`);
Q=Q[0];const J="ascending"===Q.order?"asc":"desc";if(Q.field)return{field:Q.field,order:J};if(Q.valueExpression)return{fieldIndex:A(T,{type:"expression",target:"feature",valueExpression:Q.valueExpression,resultType:"numeric"}).fieldIndex,order:J};M.error(new u("ValidationError","Expected to find a field or valueExpression for OrderByInfo",Q));return null}function C(T,Q){const J={mesh:!0,storage:!0};for(const P of Q){const {name:S,outStatistic:W}=P,{statisticType:Z,onStatisticField:V}=W;let Y=Q=null,
X=null;"onStatisticValueExpression"in W?Y=A(T,{type:"expression",target:"feature",valueExpression:W.onStatisticValueExpression,resultType:"numeric"}).fieldIndex:"onStatisticNormalizationField"in W?(Q=A(T,{type:"field",target:"feature",field:V,resultType:"numeric"}).field,X=W.onStatisticNormalizationField):Q=A(T,{type:"field",target:"feature",field:V,resultType:"numeric"}).field;A(T,{type:"statistic",target:"aggregate",name:S,context:J,inField:Q,inNormalizationField:X,inFieldIndex:Y,statisticType:Z})}}
function G(T,Q,J){switch(J.type){case "dot-density":return H(T,Q,J.attributes);case "simple":case "class-breaks":case "unique-value":case "dictionary":return L(T,Q,J.visualVariables);case "heatmap":return null}}function H(T,Q,J){return J&&J.length?{type:"dot-density",mapping:J.map((P,S)=>{const {field:W,fieldIndex:Z}=q(T,{valueExpression:P.valueExpression,field:P.field,resultType:"numeric",target:Q});return{binding:S,field:W,fieldIndex:Z}}),target:Q}:{type:"dot-density",mapping:[],target:Q}}function L(T,
Q,J){if(!J||!J.length)return{type:"visual-variable",mapping:[],target:Q};const P={storage:!0};return{type:"visual-variable",mapping:e.simplifyVisualVariables(J).map(S=>{var W;const Z=g.getVVType(S.type),{field:V,fieldIndex:Y}=q(T,{target:Q,valueExpression:S.valueExpression,field:S.field,context:P,resultType:"numeric"});switch(S.type){case "size":return"$view.scale"===S.valueExpression?null:{type:"size",binding:Z,field:V,fieldIndex:Y,normalizationField:q(T,{target:Q,field:S.normalizationField,context:P,
resultType:"numeric"}).field,valueRepresentation:null!=(W=S.valueRepresentation)?W:null};case "color":return{type:"color",binding:Z,field:V,fieldIndex:Y,normalizationField:q(T,{target:Q,field:S.normalizationField,context:P,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:Z,field:V,fieldIndex:Y,normalizationField:q(T,{target:Q,field:S.normalizationField,context:P,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:Z,field:V,fieldIndex:Y}}}).filter(S=>
S),target:Q}}function O(T,Q,J,P=!1){T=y.unwrapOr(T,{indexCount:0,fields:{}});switch(J.type){case "simple":case "dot-density":return N(T,J,P);case "class-breaks":return K(T,Q,J,P);case "unique-value":return I(T,Q,J,P);case "dictionary":return Q=p(J),J={type:"dictionary",config:J.config,fieldMap:J.fieldMap,scaleExpression:J.scaleExpression,url:J.url,symbolOptions:Q,stride:Q.stride}}}function N(T,Q,J=!1){T=Q.getSymbols();T=T.length?T[0]:null;Q=p(Q);return{type:"simple",symbol:a.createSymbolSchema(T,
Q,J),stride:Q.stride}}function K(T,Q,J,P=!1){const S=J.backgroundFillSymbol,{field:W,fieldIndex:Z}=q(T,{target:Q,field:J.field,valueExpression:J.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});Q=J.normalizationType;Q="log"===Q?"esriNormalizeByLog":"percent-of-total"===Q?"esriNormalizeByPercentOfTotal":"field"===Q?"esriNormalizeByField":null;const V=p(J),Y=J.classBreakInfos.map(X=>({symbol:a.createSymbolSchema(X.symbol,V,P),min:X.minValue,max:X.maxValue})).sort((X,R)=>
X.min-R.min);return{type:"interval",attributes:T.fields,field:W,fieldIndex:Z,backgroundFillSymbol:a.createSymbolSchema(S,V,P),defaultSymbol:a.createSymbolSchema(J.defaultSymbol,V,P),intervals:Y,normalizationField:J.normalizationField,normalizationTotal:J.normalizationTotal,normalizationType:Q,isMaxInclusive:J.isMaxInclusive,stride:V.stride}}function I(T,Q,J,P=!1){const S=[],W=J.backgroundFillSymbol;Q={target:Q,context:{mesh:!0},resultType:"string"};if(J.field&&"string"!==typeof J.field)throw new u("ValidationError",
"Expected renderer.field to be a string",J);const {field:Z,fieldIndex:V}=q(T,{...Q,field:J.field,valueExpression:J.valueExpression}),Y=p(J);for(const X of J.uniqueValueInfos)S.push({value:""+X.value,symbol:a.createSymbolSchema(X.symbol,Y,P)});return{type:"map",attributes:T.fields,field:Z,fieldIndex:V,field2:q(T,{...Q,field:J.field2}).field,field3:q(T,{...Q,field:J.field3}).field,fieldDelimiter:J.fieldDelimiter,backgroundFillSymbol:a.createSymbolSchema(W,Y),defaultSymbol:a.createSymbolSchema(J.defaultSymbol,
Y),map:S,stride:Y.stride}}const M=z.getLogger("esri.views.2d.layers.features.schemaUtils"),U={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};t.createSymbolSchema=a.createSymbolSchema;t.addAggregateFields=C;t.createMatcherSchema=O;t.createSchema=function(T){B("esri-2d-update-debug")&&console.debug("Created new schema",
h(T,!0));return h(T)};t.createSymbolSchemaOptions=p;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(t,u,B){t.getVVFlags=function(D){if(!D)return u.WGLVVFlag.NONE;let z=0;for(const y of D)"size"===y.type?(D=B.getTypeOfSizeVisualVariable(y),z|=D,"outline"===y.target&&(z|=D<<4)):"color"===y.type?z|=u.WGLVVFlag.COLOR:"opacity"===y.type?z|=u.WGLVVFlag.OPACITY:"rotation"===y.type&&
(z|=u.WGLVVFlag.ROTATION);return z};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(t,u,B,D,z){const y=B.getLogger("esri.views.2d.engine.webgl");t.getTypeOfSizeVisualVariable=function(l){if(z.isNumber(l.minDataValue)&&z.isNumber(l.maxDataValue)&&null!=l.minSize&&null!=l.maxSize)return D.WGLVVFlag.SIZE_MINMAX_VALUE;if((l.expression&&"view.scale"===
l.expression||l.valueExpression&&"$view.scale"===l.valueExpression)&&Array.isArray(l.stops))return D.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=l.field||l.expression&&"view.scale"!==l.expression||l.valueExpression&&"$view.scale"!==l.valueExpression)&&(Array.isArray(l.stops)||"levels"in l&&l.levels))return D.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=l.field||l.expression&&"view.scale"!==l.expression||l.valueExpression&&"$view.scale"!==l.valueExpression)&&null!=l.valueUnit)return D.WGLVVFlag.SIZE_UNIT_VALUE;y.error(new u("mapview-bad-type",
"Found invalid size VisualVariable",l));return D.WGLVVFlag.NONE};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/createSymbolSchema":function(){define(["exports","../../engine/webgl/enums","../../engine/webgl/materialKey/MaterialKey"],function(t,u,B){function D(l){switch(l.type){case "line-marker":var g;return{type:"line-marker",color:null==(g=l.color)?void 0:g.toJSON(),placement:l.placement,style:l.style};default:return l.constructor.fromJSON(l.toJSON()).toJSON()}}
function z(l,g,d){var a=B.createMaterialKey(u.WGLGeometryType.FILL,{...g,isOutlinedFill:g.supportsOutlineFills});a=d?hydrateKey(a):a;var c=l.clone();l=c.outline;g.supportsOutlineFills||(c.outline=null);c={materialKey:a,hash:c.hash(),isOutlinedFill:!!g.supportsOutlineFills,...D(c)};if(g.supportsOutlineFills)return c;a=[];a.push(c);l&&(g=B.createMaterialKey(u.WGLGeometryType.LINE,{...g,isOutline:!0}),d={materialKey:d?hydrateKey(g):g,hash:l.hash(),...D(l)},a.push(d));return{type:"composite-symbol",layers:a,
hash:a.reduce((e,f)=>f.hash+e,"")}}function y(l,g,d){var a=B.createMaterialKey(u.WGLGeometryType.LINE,g);const c=d?hydrateKey(a):a;l=l.clone();a=l.marker;l.marker=null;const e=[];e.push({materialKey:c,hash:l.hash(),...D(l)});if(a){var f;g=B.createMaterialKey(u.WGLGeometryType.MARKER,g);d=d?hydrateKey(g):g;a.color=null!=(f=a.color)?f:l.color;e.push({materialKey:d,hash:a.hash(),lineWidth:l.width,...D(a)})}return{type:"composite-symbol",layers:e,hash:e.reduce((k,p)=>p.hash+k,"")}}t.createSymbolSchema=
function(l,g,d){if(!l)return null;switch(l.type){case "simple-fill":case "picture-fill":return z(l,g,d);case "simple-marker":case "picture-marker":var a=B.createMaterialKey(u.WGLGeometryType.MARKER,g);d=d?hydrateKey(a):a;a=D(l);return l={materialKey:d,hash:l.hash(),...a,angle:l.angle,maxVVSize:g.maxVVSize};case "simple-line":return y(l,g,d);case "text":return a=B.createMaterialKey(u.WGLGeometryType.TEXT,g),d=d?hydrateKey(a):a,a=D(l),l={materialKey:d,hash:l.hash(),...a,angle:l.angle,maxVVSize:g.maxVVSize};
case "label":return a=l.toJSON(),g=B.createMaterialKey(u.WGLGeometryType.LABEL,{...g,placement:a.labelPlacement}),l={materialKey:d?hydrateKey(g):g,hash:l.hash(),...a,labelPlacement:a.labelPlacement};case "cim":return{type:"cim",rendererKey:g.vvFlags,data:l.data,maxVVSize:g.maxVVSize};case "CIMSymbolReference":return{type:"cim",rendererKey:g.vvFlags,data:l,maxVVSize:g.maxVVSize};case "web-style":return{...D(l),type:"web-style",hash:l.hash(),rendererKey:g.vvFlags,maxVVSize:g.maxVVSize};default:throw Error(`symbol not supported ${l.type}`);
}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils ../../support/cimSymbolUtils".split(" "),function(t,u,B,D,z,y,l,g){function d(x){if(!("visualVariables"in x&&x.hasVisualVariables("size")))return 0;
x=x.getVisualVariablesForType("size");if(!x[0])return 0;x=x[0];if("outline"===x.target)return 0;if("stops"===x.transformationType)return x.stops.map(q=>q.size).reduce(b,0);if("clamped-linear"===x.transformationType){let q=-Infinity,A=-Infinity;q="number"===typeof x.maxSize?x.maxSize:x.maxSize.stops.map(E=>E.size).reduce(b,0);A="number"===typeof x.minSize?x.minSize:x.minSize.stops.map(E=>E.size).reduce(b,0);return Math.max(q,A)}if("real-world-size"===x.transformationType)return 30}function a(){a=u._asyncToGenerator(function*(x,
q,A,E,F,w){if(!x||w&&"cluster"===w.type)return 0;if("heatmap"===x.type)return Math.round(3*x.blurRadius);if("dot-density"===x.type)return 0;if("dictionary"===x.type)return"esriGeometryPoint"===q||"esriGeometryMultipoint"===q?100:200;w=x.getSymbols();x=d(x);const v=[];for(const C of w)v.push(k(C,x,A,q,E,F));q=yield Promise.all(v);return B.pt2px(q.reduce(b,0))});return a.apply(this,arguments)}function c(x,q){return null==x?q:x}function e(x,q,A,E,F,w){return f.apply(this,arguments)}function f(){f=u._asyncToGenerator(function*(x,
q,A,E,F,w){if("simple-marker"===x.type)return q=Math.max(c(x.size,12),q),m(x)+.707*q;if("picture-marker"===x.type)return A=Math.max(c(x.height,12),q),q=c(x.width,12)*(A/c(x.height,12))/2,A/=2,m(x)+Math.sqrt(q*q+A*A);if("text"===x.type){if(A=x.text&&x.text.length){q=[];for(E=0;E<A;E++)q.push({...r,code:x.text.charCodeAt(E)});q={glyphMosaicItems:q}}else q={glyphMosaicItems:[r]};l.getTextSymbolSize(n,x.toJSON(),q);return Math.max(Math.abs(n[0]),Math.abs(n[1]))+Math.max(n[2],n[3])}return"simple-line"===
x.type?(A=Math.max(c(x.width,.75),q)/2,x.marker?Math.max(6*x.width,2*q):A):"simple-fill"===x.type||"picture-fill"===x.type?Math.max(null==x.outline?0:c(x.outline.width,0),q)/2:"cim"===x.type?(yield g.expandSymbol({type:"cim",rendererKey:0,data:x.data,maxVVSize:q},{geometryType:E,fields:F,spatialReference:w},A),(x=D.CIMSymbolHelper.getEnvelope(x.data,A))?Math.sqrt(x.width*x.width+x.height*x.height):0):"web-style"===x.type?e(yield x.fetchCIMSymbol(),q,A,E,F,w):0});return f.apply(this,arguments)}function k(x,
q,A,E,F,w){return p.apply(this,arguments)}function p(){p=u._asyncToGenerator(function*(x,q,A,E,F,w){return x.type in h?Math.min(yield e(x,q,A,E,F,w),75):0});return p.apply(this,arguments)}function m(x){const q=c(x.xoffset,0);x=c(x.yoffset,0);return Math.sqrt(q*q+x*x)}function b(x,q){return Math.max(x,q)}const h={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},n=[0,0,0,0],r={sdf:!0,code:99,metrics:y.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,
rect:new z(0,0,24,24),page:0,textureBinding:2};t.computePxBuffer=function(x,q,A,E,F,w){return a.apply(this,arguments)};t.getPtMaxVVSize=d;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/BidiText ../../../../core/maybe ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/normalizeUtilsCommon ../../engine/webgl/alignmentUtils ../../engine/webgl/definitions ../../engine/webgl/mesh/templates/shapingUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a){t.PIXEL_BUFFER=50;t.TILE_SIZE=512;t.getTextSymbolSize=function(c,e,f){var k,p,m;if(!f||0===f.glyphMosaicItems.length)return c;const b=u.bidiText(e.text)[1];e=a.shapeGlyphs(f.glyphMosaicItems,b,{scale:D.pt2px(e.font.size)/d.GLYPH_SIZE,angle:null!=(k=e.angle)?k:0,xOffset:null!=(p=e.xoffset)?p:0,yOffset:null!=(m=e.yoffset)?m:0,hAlign:g.getXAnchorDirection(e.horizontalAlignment||"center"),vAlign:g.getYAnchorDirection(e.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,
Math.min(e.lineWidth||512,512)),lineHeight:d.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(e.lineHeight||1,4)),decoration:e.font.decoration||"none",isCIM:!1}).bounds;c[0]=D.pt2px(e.x-e.halfWidth);c[1]=D.pt2px(e.y-e.halfHeight);c[2]=D.pt2px(e.width);c[3]=D.pt2px(e.height);return c};t.graphicGeometryToNumber=function(c){switch(B.unwrap(c.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};t.intersectingInternationalDateline=function(c,e){if(!e.isWrappable)return null;
const [f,k]=l.getSpatialReferenceMinMaxX(e);return c[2]>k?[y.create([c[0],c[1],k,c[3]]),y.create([f,c[1],f+c[2]-k,c[3]])]:c[0]<f?[y.create([f,c[1],c[2],c[3]]),y.create([k-(f-c[0]),c[1],k,c[3]])]:null};t.isMarkerSymbol=function(c){return"simple-marker"===c||"picture-marker"===c||"esriSMS"===c||"esriPMS"===c};t.isTextSymbol=function(c){return"text"===c||"esriTS"===c};t.polygonFromExtent=function(c){if(!c)return null;const {xmin:e,ymin:f,xmax:k,ymax:p,spatialReference:m}=c;return new z({rings:[[[e,f],
[e,p],[k,p],[k,f],[e,f]]],spatialReference:m})};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["exports","../../../../../core/Logger","../../../../../core/screenUtils"],function(t,u,B){function D(l){return("size"===l.type||"color"===l.type||"opacity"===l.type)&&null!=l.stops}function z(l){var g=l.type;var d=l.stops;if(8>=d.length)g=d;else if(y.warn(`Found ${d.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),
16<d.length){{const [h,...n]=d;var a=n.pop(),c=n[0].value,e=n[n.length-1].value,f=(e-c)/6;const r=[];for(;c<e;c+=f){for(var k=0;c>=n[k].value;)k++;var p=n[k],m=d[k-1],b=c-m.value;p=p.value===m.value?1:b/(p.value-m.value);"color"===g?(m=n[k],k=d[k-1],b=m.color.clone(),b.r=(1-p)*k.color.r+p*b.r,b.g=(1-p)*k.color.g+p*b.g,b.b=(1-p)*k.color.b+p*b.b,b.a=(1-p)*k.color.a+p*b.a,r.push({value:c,color:b,label:m.label})):"size"===g?(m=n[k],b=d[k-1],k=B.toPt(m.size),b=B.toPt(b.size),r.push({value:c,size:(1-p)*
b+p*k,label:m.label})):(m=n[k],r.push({value:c,opacity:(1-p)*d[k-1].opacity+p*m.opacity,label:m.label}))}g=[h,...r,a]}}else{{const [h,...n]=d;for(g=n.pop();6<n.length;){a=d=0;for(e=1;e<n.length;e++)f=Math.abs(n[e].value-n[e-1].value),f>a&&(a=f,d=e);n.splice(d,1)}g=[h,...n,g]}}l.stops=g;return l}const y=u.getLogger("esri.renderers.visualVariables.support.utils");t.simplifyVVRenderer=l=>{if(!("visualVariables"in l&&l.visualVariables&&l.visualVariables.length))return l;l=l.clone();const g=l.visualVariables.map(d=>
D(d)?z(d):d);l.visualVariables=g;return l};t.simplifyVisualVariables=function(l){return l.map(g=>D(g)?z(g.clone()):g)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/support/clusterUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine/LevelDependentSizeVariable".split(" "),
function(t,u,B,D,z,y,l,g,d){function a(r,x,q){switch(r){case "avg":case "avg_angle":return`cluster_avg_${x}`;case "mode":return`cluster_type_${x}`;case "norm":return r=x.toLowerCase()+",norm:field,"+q.toLowerCase(),"cluster_avg_"+y.createMD5Hash(r)}}function c(r,x){const {name:q,outStatistic:A}=x,{onStatisticField:E,onStatisticValueExpression:F,statisticType:w}=A;F?(x=y.createMD5Hash(F.toLowerCase()),r.push({name:q,outStatistic:{onStatisticField:x,onStatisticValueExpression:F,statisticType:w}})):
E?r.push({name:q,outStatistic:{onStatisticField:E,statisticType:w}}):k.error(new u("mapview-unsupported-field","Unable to handle field",{field:x}))}function e(r,x,q){const A=y.createMD5Hash(x),E="mode"===q?`cluster_type_${A}`:`cluster_avg_${A}`;r.some(F=>F.name===E)||r.push({name:E,outStatistic:{onStatisticField:A,onStatisticValueExpression:x,statisticType:q}});return E}function f(r,x,q,A){if("cluster_count"===x||r.some(F=>F.name===x))return x;const E=a(q,x,A);r.some(F=>F.name===E)||("norm"===q?r.push({name:E,
outStatistic:{onStatisticField:x,onStatisticNormalizationField:A,statisticType:q}}):r.push({name:E,outStatistic:{onStatisticField:x,statisticType:q}}));return E}const k=D.getLogger("esri.views.2d.layers.support.clusterUtils");B.add("esri-cluster-arcade-enabled",!0);const p=B("esri-cluster-arcade-enabled"),m=r=>{for(const x of r)if("size"===x.type)return x;return null},b=r=>{for(const x of r)if("cluster_count"===x.field)return!0;return!1},h=(r,x)=>{const q=[new g({value:0,size:0}),new g({value:1})];
if(z.isNone(x))return new l({field:"cluster_count",stops:[...q,new g({value:2,size:0})]});const A=Object.keys(x).reduce((E,F)=>({...E,[F]:[...q,new g({value:Math.max(2,x[F].minValue),size:r.clusterMinSize}),new g({value:Math.max(3,x[F].maxValue),size:r.clusterMaxSize})]}),{});return new d.LevelDependentSizeVariable({field:"cluster_count",levels:A})},n=r=>{const x=q=>k.error(new u("Unsupported-renderer",q,{renderer:r}));if("unique-value"===r.type){if(r.field2||r.field3)return x("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),
!1}else if("class-breaks"===r.type){if(r.normalizationField){const q=r.normalizationType;if("field"!==q)return x(`FeatureReductionCluster does not support a normalizationType of ${q}`),!1}}else if("simple"!==r.type)return x(`FeatureReductionCluster does not support renderers of type ${r.type}`),!1;if(!p){if("valueExpression"in r&&r.valueExpression)return x("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in
r&&r.visualVariables||[]).some(q=>!!("valueExpression"in q&&q.valueExpression)))return x("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};t.createClusterCountSizeVariable=h;t.createClusterRenderer=(r,x,q,A)=>{x=x.clone();if(!n(x))return x;if(q.fields)for(var E of q.fields)c(r,E);if("visualVariables"in x){E=(x.visualVariables||[]).filter(w=>"$view.scale"!==w.valueExpression);const F=m(E);E.forEach(w=>
{"rotation"===w.type?w.field?w.field=f(r,w.field,"avg_angle"):w.valueExpression&&(w.field=e(r,w.valueExpression,"avg_angle"),w.valueExpression=null):w.normalizationField?(w.field=f(r,w.field,"norm",w.normalizationField),w.normalizationField=null):w.field?w.field=f(r,w.field,"avg"):(w.field=e(r,w.valueExpression,"avg"),w.valueExpression=null)});z.isNone(F)&&!b(E)&&(E.push(h(q,A)),x.dynamicClusterSize=!0);x.visualVariables=E}switch(x.type){case "unique-value":x.field?x.field=f(r,x.field,"mode"):x.valueExpression&&
(x.field=e(r,x.valueExpression,"mode"),x.valueExpression=null);break;case "class-breaks":x.normalizationField?(x.field=f(r,x.field,"norm",x.normalizationField),x.normalizationField=null):x.field?x.field=f(r,x.field,"avg"):(x.field=e(r,x.valueExpression,"avg"),x.valueExpression=null)}return x};t.findSizeVV=m;t.hasClusterCountVV=b;t.isClusterCompatibleRenderer=n;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/MD5":function(){define(["exports"],function(t){function u(g,d){const a=(g&65535)+
(d&65535);return(g>>16)+(d>>16)+(a>>16)<<16|a&65535}function B(g,d,a,c,e,f){g=u(u(d,g),u(c,f));return u(g<<e|g>>>32-e,a)}function D(g,d,a,c,e,f,k){return B(d&a|~d&c,g,d,e,f,k)}function z(g,d,a,c,e,f,k){return B(d&c|a&~c,g,d,e,f,k)}function y(g,d,a,c,e,f,k){return B(a^(d|~c),g,d,e,f,k)}const l={Base64:0,Hex:1,String:2,Raw:3};t.createMD5Hash=function(g,d=l.Hex){d=d||l.Base64;var a=[];for(let e=0,f=8*g.length;e<f;e+=8)a[e>>5]|=(g.charCodeAt(e/8)&255)<<e%32;{g=8*g.length;a[g>>5]|=128<<g%32;a[(g+64>>>
9<<4)+14]=g;g=1732584193;var c=-271733879;let e=-1732584194,f=271733878;for(let k=0;k<a.length;k+=16){const p=g,m=c,b=e,h=f;g=D(g,c,e,f,a[k+0],7,-680876936);f=D(f,g,c,e,a[k+1],12,-389564586);e=D(e,f,g,c,a[k+2],17,606105819);c=D(c,e,f,g,a[k+3],22,-1044525330);g=D(g,c,e,f,a[k+4],7,-176418897);f=D(f,g,c,e,a[k+5],12,1200080426);e=D(e,f,g,c,a[k+6],17,-1473231341);c=D(c,e,f,g,a[k+7],22,-45705983);g=D(g,c,e,f,a[k+8],7,1770035416);f=D(f,g,c,e,a[k+9],12,-1958414417);e=D(e,f,g,c,a[k+10],17,-42063);c=D(c,e,
f,g,a[k+11],22,-1990404162);g=D(g,c,e,f,a[k+12],7,1804603682);f=D(f,g,c,e,a[k+13],12,-40341101);e=D(e,f,g,c,a[k+14],17,-1502002290);c=D(c,e,f,g,a[k+15],22,1236535329);g=z(g,c,e,f,a[k+1],5,-165796510);f=z(f,g,c,e,a[k+6],9,-1069501632);e=z(e,f,g,c,a[k+11],14,643717713);c=z(c,e,f,g,a[k+0],20,-373897302);g=z(g,c,e,f,a[k+5],5,-701558691);f=z(f,g,c,e,a[k+10],9,38016083);e=z(e,f,g,c,a[k+15],14,-660478335);c=z(c,e,f,g,a[k+4],20,-405537848);g=z(g,c,e,f,a[k+9],5,568446438);f=z(f,g,c,e,a[k+14],9,-1019803690);
e=z(e,f,g,c,a[k+3],14,-187363961);c=z(c,e,f,g,a[k+8],20,1163531501);g=z(g,c,e,f,a[k+13],5,-1444681467);f=z(f,g,c,e,a[k+2],9,-51403784);e=z(e,f,g,c,a[k+7],14,1735328473);c=z(c,e,f,g,a[k+12],20,-1926607734);g=B(c^e^f,g,c,a[k+5],4,-378558);f=B(g^c^e,f,g,a[k+8],11,-2022574463);e=B(f^g^c,e,f,a[k+11],16,1839030562);c=B(e^f^g,c,e,a[k+14],23,-35309556);g=B(c^e^f,g,c,a[k+1],4,-1530992060);f=B(g^c^e,f,g,a[k+4],11,1272893353);e=B(f^g^c,e,f,a[k+7],16,-155497632);c=B(e^f^g,c,e,a[k+10],23,-1094730640);g=B(c^e^
f,g,c,a[k+13],4,681279174);f=B(g^c^e,f,g,a[k+0],11,-358537222);e=B(f^g^c,e,f,a[k+3],16,-722521979);c=B(e^f^g,c,e,a[k+6],23,76029189);g=B(c^e^f,g,c,a[k+9],4,-640364487);f=B(g^c^e,f,g,a[k+12],11,-421815835);e=B(f^g^c,e,f,a[k+15],16,530742520);c=B(e^f^g,c,e,a[k+2],23,-995338651);g=y(g,c,e,f,a[k+0],6,-198630844);f=y(f,g,c,e,a[k+7],10,1126891415);e=y(e,f,g,c,a[k+14],15,-1416354905);c=y(c,e,f,g,a[k+5],21,-57434055);g=y(g,c,e,f,a[k+12],6,1700485571);f=y(f,g,c,e,a[k+3],10,-1894986606);e=y(e,f,g,c,a[k+10],
15,-1051523);c=y(c,e,f,g,a[k+1],21,-2054922799);g=y(g,c,e,f,a[k+8],6,1873313359);f=y(f,g,c,e,a[k+15],10,-30611744);e=y(e,f,g,c,a[k+6],15,-1560198380);c=y(c,e,f,g,a[k+13],21,1309151649);g=y(g,c,e,f,a[k+4],6,-145523070);f=y(f,g,c,e,a[k+11],10,-1120210379);e=y(e,f,g,c,a[k+2],15,718787259);c=y(c,e,f,g,a[k+9],21,-343485551);g=u(g,p);c=u(c,m);e=u(e,b);f=u(f,h)}a=[g,c,e,f]}switch(d){case l.Raw:return a;case l.Hex:d=[];for(let e=0,f=4*a.length;e<f;e++)d.push("0123456789abcdef".charAt(a[e>>2]>>e%4*8+4&15)+
"0123456789abcdef".charAt(a[e>>2]>>e%4*8&15));return d=d.join("");case l.String:d=[];for(let e=0,f=32*a.length;e<f;e+=8)d.push(String.fromCharCode(a[e>>5]>>>e%32&255));return d=d.join("");case l.Base64:d=[];for(let e=0,f=4*a.length;e<f;e+=3)for(g=(a[e>>2]>>e%4*8&255)<<16|(a[e+1>>2]>>(e+1)%4*8&255)<<8|a[e+2>>2]>>(e+2)%4*8&255,c=0;4>c;c++)8*e+6*c>32*a.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>6*(3-c)&63));return d=d.join("")}};t.outputTypes=
l;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a){var c;t.LevelDependentSizeVariable=c=function(e){function f(){return e.apply(this,arguments)||this}u._inheritsLoose(f,e);var k=f.prototype;k.writeLevels=function(p,m,b){for(const h in p){m.stops=this.levels[h];break}};k.clone=function(){return new c({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:a.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:a.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(p=>p.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:D.clone(this.levels)})};return f}(d);B.__decorate([z.property()],t.LevelDependentSizeVariable.prototype,"levels",void 0);
B.__decorate([g.writer("levels")],t.LevelDependentSizeVariable.prototype,"writeLevels",null);t.LevelDependentSizeVariable=c=B.__decorate([l.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],t.LevelDependentSizeVariable);Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(t,u){const B=new u.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",
esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});t.analyzeRings=function(D,z,y){const l=[],g=[];let d=0,a=0;for(const c of D){D=a;let e=c[0][0],f=c[0][1];l[a++]=e;l[a++]=f;let k=0;for(let p=1;p<c.length;++p){const m=e,b=f;e=c[p][0];f=c[p][1];k+=f*m-e*b;l[a++]=e;l[a++]=f}z(k/2);0<k?(0<D-d&&(y(d,D,l,g),d=D),g.length=0):0>k?0<D-d?g.push(.5*(D-d)):a=D:a=D}0<a-d&&y(d,a,l,g)};t.canUseMajorityInterpolationOnDataSource=function(D){const {bandCount:z,attributeTable:y,colormap:l,
pixelType:g}=D.rasterInfo;return 1===z&&(null!=y||null!=l||"u8"===g||"s8"===g)};t.toJSONGeometryType=function(D){return B.toJSON(D)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m){function b(A,E){return F=>E(A(F))}const h=z.getLogger("esri.views.layers.2d.features.support.AttributeStore"),n=k.createDebugLogger(k.DEBUG_ATTR_UPDATES,h);var r=D("esri-shared-array-buffer"),x=D("esri-atomics");let q=function(){function A(F,w,v,C){this.size=0;this.texelSize=4;const {pixelType:G,layout:H,textureOnly:L}=C;this.textureOnly=L||!1;this.pixelType=G;this._ctype=w;this.layout=H;this._resetRange();this._shared=F;this.size=v;L||(this.data=this._initData(G,
v,F,w))}var E=A.prototype;E.unsetComponentAllTexels=function(F,w){const v=l.unwrap(this.data);for(let C=0;C<this.size*this.size;C++)v[C*this.texelSize+F]&=~w;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};E.setComponentAllTexels=function(F,w){const v=l.unwrap(this.data);for(let C=0;C<this.size*this.size;C++)v[C*this.texelSize+F]|=255&w;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};E.setComponent=function(F,w,v){const C=l.unwrap(this.data);for(const G of v)C[G*this.texelSize+F]|=w,
this.dirtyStart=Math.min(this.dirtyStart,G),this.dirtyEnd=Math.max(this.dirtyEnd,G)};E.setComponentTexel=function(F,w,v){l.unwrap(this.data)[v*this.texelSize+F]|=w;this.dirtyStart=Math.min(this.dirtyStart,v);this.dirtyEnd=Math.max(this.dirtyEnd,v)};E.unsetComponentTexel=function(F,w,v){l.unwrap(this.data)[v*this.texelSize+F]&=~w;this.dirtyStart=Math.min(this.dirtyStart,v);this.dirtyEnd=Math.max(this.dirtyEnd,v)};E.getData=function(F,w){F=e.getDisplayIdTexel(F);return l.unwrap(this.data)[F*this.texelSize+
w]};E.setData=function(F,w,v){F=e.getDisplayIdTexel(F);0===(this.layout&1<<w)?h.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[F*this.texelSize+w]=v,this.dirtyStart=Math.min(this.dirtyStart,F),this.dirtyEnd=Math.max(this.dirtyEnd,F))};E.lock=function(){this.pixelType===m.PixelType.UNSIGNED_BYTE&&this._shared&&x&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};E.unlock=function(){this.pixelType===m.PixelType.UNSIGNED_BYTE&&this._shared&&x&&
"local"!==this._ctype&&Atomics.store(this.data,0,0)};E.expand=function(F){this.size=F;if(!this.textureOnly){F=this._initData(this.pixelType,F,this._shared,this._ctype);const w=l.unwrap(this.data);F.set(w);this.data=F}};E.toMessage=function(){const F=this.dirtyStart,w=this.dirtyEnd;var v=this.texelSize;if(F>w)return null;this._resetRange();const C=!this._shared&&"local"!==this._ctype,G=this.pixelType,H=this.layout,L=l.unwrap(this.data);v=C&&L.slice(F*v,(w+1)*v)||null;return{start:F,end:w,data:v,pixelType:G,
layout:H}};E._initData=function(F,w,v,C){v=v&&"local"!==C?SharedArrayBuffer:ArrayBuffer;F=f.getPixelArrayCtor(F);w=new F(new v(w*w*4*F.BYTES_PER_ELEMENT));for(F=0;F<w.length;F+=4)w[F+1]=255;return w};E._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};u._createClass(A,[{key:"buffer",get:function(){return l.applySome(this.data,F=>F.buffer)}}]);return A}();return function(){function A(F,w){this._client=F;this.config=w;this._attributeComputeMap=new Map;this._blocks=[];this._filters=
Array(c.MAX_FILTERS);this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;F=w.supportsTextureFloat?m.PixelType.FLOAT:m.PixelType.UNSIGNED_BYTE;n(`Creating AttributeStore ${r?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:m.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:m.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:m.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:F,layout:15},
{pixelType:F,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var E=A.prototype;E.destroy=function(){this._abortController.abort()};E.update=function(F,w){this.config=w;w=w.schema.processors[0].storage;const v=d.diff(this._schema,w);if(F.targets.feature||F.targets.aggregate)F.storage.data=!0;if(v&&(D("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",v),F.storage.data=!0,this._schema=w,this._attributeComputeMap.clear(),!l.isNone(w))){switch(w.target){case "feature":this._targetType=
e.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=e.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===w.type)for(const C in w.mapping){if(F=w.mapping[C],l.isSome(F))for(const G of F.mapping)this._bindAttribute(G)}else for(const C of w.mapping)this._bindAttribute(C)}};E.onTileData=function(F,w){if(!l.isNone(w.addOrUpdate))for(F=w.addOrUpdate.getCursor();F.next();)w=F.getDisplayId(),this.setAttributeData(w,F)};E.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();
this._abortController=new AbortController};E.setHighlight=function(){var F=u._asyncToGenerator(function*(w,v){const C=this._getBlock(0);v=v.map(G=>e.getDisplayIdTexel(G));C.lock();C.unsetComponentAllTexels(0,1);C.setComponent(0,1,v);C.unlock();this._idsToHighlight.clear();for(const G of w)this._idsToHighlight.add(G);yield this.sendUpdates()});return function(w,v){return F.apply(this,arguments)}}();E.updateFilters=function(){var F=u._asyncToGenerator(function*(w,v){const {config:C,service:G,spatialReference:H}=
v;({filters:v}=C);v=v.map((L,O)=>this._updateFilter(L,O,G,H));(yield Promise.all(v)).some(L=>L)&&(w.storage.filters=!0,D("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(w,v){return F.apply(this,arguments)}}();E.setData=function(F,w,v,C){const G=e.getDisplayIdTexel(F);this._ensureSizeForTexel(G);this._getBlock(w).setData(F,v,C)};E.getData=function(F,w,v){return this._getBlock(w).getData(F,v)};E.getHighlightFlag=function(F){return this._idsToHighlight.has(F)?
c.HIGHLIGHT_FLAG:0};E.unsetAttributeData=function(F){F=e.getDisplayIdTexel(F);this._getBlock(0).setData(F,0,0)};E.setAttributeData=function(F,w){const v=e.getDisplayIdTexel(F);this._ensureSizeForTexel(v);this._getBlock(0).setData(v,0,this.getFilterFlags(w));if(this._targetType===e.getDisplayIdType(F)){F=this._attributeComputeMap;var C=this.config.supportsTextureFloat?1:2;F.size&&F.forEach((G,H)=>{const L=H*C%4;H=this._getBlock(Math.floor(H*C/4)+c.ATTRIBUTE_DATA_VV);G=G(w);if(this.config.supportsTextureFloat)H.setData(v,
L,G);else if(G===c.NAN_MAGIC_NUMBER)H.setData(v,L,255),H.setData(v,L+1,255);else{G=y.clamp(Math.round(G),-32767,32766)+32768;const O=(G&65280)>>8;H.setData(v,L,G&255);H.setData(v,L+1,O)}})}};E.sendUpdates=function(){if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=g.createResolver(),this._nextUpdate.promise;const F={blocks:this._blocks.map(w=>l.isSome(w)?w.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var w=()=>{this._currUpdate=
null;if(this._nextUpdate){const v=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>v.resolve())}};w=this._client.update(F,this._signal).then(w).catch(w);this._client.render(this._signal);return w}).catch(w=>{if(g.isAbortError(w))return this._createResourcesPromise=null,this._createResources();h.error(new B("mapview-attribute-store","Encountered an error during client update",w));return Promise.resolve()})};E._ensureSizeForTexel=function(F){for(;F>=this._size*this._size&&!this._expand(););
};E._bindAttribute=function(F){function w(){return F.normalizationField?G=>{const H=G.readAttribute(F.normalizationField);return H?G.readAttribute(F.field)/H:null}:G=>G.readAttribute(F.field)}function v(){F.normalizationField&&h.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return G=>G.getComputedNumericAtIndex(F.fieldIndex)}let C;if(null!=F.fieldIndex)C=v();else if(F.field)C=w();else return;F.valueRepresentation&&(C=b(C,G=>p.getVisualVariableSizeValueRepresentationRatio(G,
F.valueRepresentation)));this._attributeComputeMap.set(F.binding,b(C,G=>null===G||isNaN(G)||Infinity===G?c.NAN_MAGIC_NUMBER:G))};E._createResources=function(){if(l.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(c.ATTRIBUTE_DATA_ANIMATION);this._getBlock(c.ATTRIBUTE_DATA_GPGPU);n("Initializing AttributeStore");var F={shared:r&&"local"!==this._client.type,size:this._size,blocks:l.mapMany(this._blocks,w=>({textureOnly:w.textureOnly,buffer:w.buffer,pixelType:w.pixelType}))};
this._createResourcesPromise=F=this._client.initialize(F,this._signal).catch(w=>{g.isAbortError(w)?this._createResourcesPromise=null:h.error(new B("mapview-attribute-store","Encountered an error during client initialization",w))});F.then(()=>l.isNone(this._createResourcesPromise)?this._createResources():void 0);return F};E._getBlock=function(F){var w=this._blocks[F];if(l.isSome(w))return w;n(`Initializing AttributeBlock at index ${F}`);w=new q(r,this._client.type,this._size,this._blockDescriptors[F]);
this._blocks[F]=w;this._createResourcesPromise=null;return w};E._expand=function(){if(this._size<this.config.maxTextureSize){const F=this._size<<=1;n("Expanding block size to",F,this._blocks);l.forEachSome(this._blocks,w=>w.expand(F));this._createResourcesPromise=null;this._size=F;return 0}h.error(new B("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};E._updateFilter=function(){var F=u._asyncToGenerator(function*(w,v,C,G){const H=this._filters[v],L=l.isSome(H)&&H.hash;
if(!H&&!w||L===JSON.stringify(w))return!1;if(l.isNone(w)){if(!H)return!1;w=1<<v+1;C=this._getBlock(0);this._filters[v]=null;C.setComponentAllTexels(0,w);this.sendUpdates();return!0}yield(yield this._getFilter(v,C)).update(w,G);return!0});return function(w,v,C,G){return F.apply(this,arguments)}}();E._getFilter=function(){var F=u._asyncToGenerator(function*(w,v){var C=this._filters[w];if(l.isSome(C))return C;({default:C}=yield new Promise((G,H)=>t(["./FeatureFilter"],L=>G(Object.freeze({__proto__:null,
default:L})),H)));v=new C({geometryType:v.geometryType,hasM:!1,hasZ:!1,timeInfo:v.timeInfo,fieldsIndex:new a(v.fields)});return this._filters[w]=v});return function(w,v){return F.apply(this,arguments)}}();E.isVisible=function(F){return!!(this._getBlock(0).getData(F,0)&2)};E.getFilterFlags=function(F){let w=0;var v=e.getDisplayIdFilterMask(F.getDisplayId());for(let G=0;G<this._filters.length;G++){var C=this._filters[G];C=!(v&1<<G)||l.isNone(C)||C.check(F);w|=(C?1:0)<<G}v=0;this._idsToHighlight.size&&
(F=F.getObjectId(),v=this.getHighlightFlag(F));return w<<1|v};u._createClass(A,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return A}()})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(t){t.DEBUG_ATTR_UPDATES=!1;t.createDebugLogger=(u,B)=>u&&((...D)=>B.warn("DEBUG:",...D))||(()=>null);Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),function(t,u,B,D,z,y,l){function g(p){return{value:p.value,size:B.toPt(p.size)}}function d(p){return p.map(m=>g(m))}function a(p){return"string"===typeof p||
"number"===typeof p?B.toPt(p):{type:"size",expression:p.expression,stops:d(p.stops)}}function c(p){const m={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof p.field)if(p.stops){if(8<p.stops.length)return null;p=p.stops;for(var b=0;8>b;++b){const h=p[Math.min(b,p.length-1)];m.values[b]=h.value;m.opacities[b]=h.opacity}}else return null;else if(p.stops&&0<=p.stops.length)for(p=p.stops&&0<=p.stops.length&&p.stops[0].opacity,b=0;8>b;b++)m.values[b]=Infinity,m.opacities[b]=p;
else return null;return m}function e(p,m,b){p[4*m]=b.r/255;p[4*m+1]=b.g/255;p[4*m+2]=b.b/255;p[4*m+3]=b.a}function f(p){if(u.isNone(p)||p.normalizationField)return null;const m={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof p.field)if(p.stops){if(8<p.stops.length)return null;m.field=p.field;p=p.stops;for(var b=0;8>b;++b){const h=p[Math.min(b,p.length-1)];m.values[b]=h.value;e(m.colors,b,h.color)}}else return null;
else if(p.stops&&0<=p.stops.length)for(p=p.stops&&0<=p.stops.length&&p.stops[0].color,b=0;8>b;b++)m.values[b]=Infinity,e(m.colors,b,p);else return null;for(p=0;32>p;p+=4)D.premultiplyAlpha(m.colors,p,!0);return m}const k=p=>{const m=[],b=[];p=d(p);const h=p.length;for(let n=0;6>n;n++){const r=p[Math.min(n,h-1)];m.push(r.value);b.push(null==r.size?z.NAN_MAGIC_NUMBER:B.pt2px(r.size))}return{values:new Float32Array(m),sizes:new Float32Array(b)}};t.convertColorVariable=f;t.convertVisualVariables=function(p){const m=
p&&0<p.length?{}:null,b=m?{}:null;if(!m)return{vvFields:m,vvRanges:b};for(const h of p)if(h.field&&(m[h.type]=h.field),"size"===h.type)switch(b.size||(b.size={}),p=h,l.getTypeOfSizeVisualVariable(p)){case y.WGLVVFlag.SIZE_MINMAX_VALUE:b.size.minMaxValue={minDataValue:p.minDataValue,maxDataValue:p.maxDataValue,minSize:a(p.minSize),maxSize:a(p.maxSize)};break;case y.WGLVVFlag.SIZE_SCALE_STOPS:b.size.scaleStops={stops:d(p.stops)};break;case y.WGLVVFlag.SIZE_FIELD_STOPS:if(p.levels){const n={};for(const r in p.levels)n[r]=
k(p.levels[r]);b.size.fieldStops={type:"level-dependent",levels:n}}else b.size.fieldStops={type:"static",...k(p.stops)};break;case y.WGLVVFlag.SIZE_UNIT_VALUE:b.size.unitValue={unit:p.valueUnit,valueRepresentation:p.valueRepresentation}}else"color"===h.type?b.color=f(h):"opacity"===h.type?b.opacity=c(h):"rotation"===h.type&&(b.rotation={type:h.rotationType});return{vvFields:m,vvRanges:b}};t.getVisualVariableSizeValueRepresentationRatio=function(p,m){if(!p||!m)return p;switch(m){case "radius":case "distance":return 2*
p;case "area":return Math.sqrt(p)}return p};t.getVisualVariablesFields=function(p){const m=p&&0<p.length?{}:null;m&&p.forEach(b=>{const h=b.type;b.field&&(m[h]=b.field)});return m};t.normalizeSizeElement=a;t.normalizeSizeStops=d;t.stopToSizeStop=g;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(t,u,B,D){function z(l,g,
d){if(!(l.length>g))for(;l.length<=g;)l.push(d)}let y=function(){function l(){this._numerics=[];this._strings=[];this._idGenerator=new B.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var g=l.prototype;g.createBitset=function(){const d=this._bitsets.length;this._bitsets.push(D.StaticBitSet.create(this._allocatedSize,u.DISPLAY_ID_TEXEL_MASK));return d+1};g.getBitset=function(d){return this._bitsets[d-1]};g._expand=function(){this._allocatedSize<<=1;
for(const d of this._bitsets)d.resize(this._allocatedSize)};g._ensureNumeric=function(d,a){this._numerics[d]||(this._numerics[d]=[]);z(this._numerics[d],a,0)};g._ensureInstanceId=function(d){z(this._instanceIds,d,0)};g._ensureString=function(d,a){this._strings[d]||(this._strings[d]=[]);z(this._strings[d],a,null)};g.createDisplayId=function(d=!1){const a=this._idGenerator.createId();a>this._allocatedSize&&this._expand();return u.createDisplayId(a,d)};g.releaseDisplayId=function(d){for(const a of this._bitsets)a.unset(d);
return this._idGenerator.releaseId(d&u.DISPLAY_ID_TEXEL_MASK)};g.getComputedNumeric=function(d,a){return this.getComputedNumericAtIndex(d&u.DISPLAY_ID_TEXEL_MASK,0)};g.setComputedNumeric=function(d,a,c){return this.setComputedNumericAtIndex(d&u.DISPLAY_ID_TEXEL_MASK,c,0)};g.getComputedString=function(d,a){return this.getComputedStringAtIndex(d&u.DISPLAY_ID_TEXEL_MASK,0)};g.setComputedString=function(d,a,c){return this.setComputedStringAtIndex(d&u.DISPLAY_ID_TEXEL_MASK,0,c)};g.getComputedNumericAtIndex=
function(d,a){d&=u.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,d);return this._numerics[a][d]};g.setComputedNumericAtIndex=function(d,a,c){d&=u.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,d);this._numerics[a][d]=c};g.getInstanceId=function(d){d&=u.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(d);return this._instanceIds[d]};g.setInstanceId=function(d,a){d&=u.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(d);this._instanceIds[d]=a};g.getComputedStringAtIndex=function(d,a){d&=u.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,
d);return this._strings[a][d]};g.setComputedStringAtIndex=function(d,a,c){d&=u.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,d);this._strings[a][d]=c};g.getXMin=function(d){return this._bounds[4*(d&u.DISPLAY_ID_TEXEL_MASK)]};g.getYMin=function(d){return this._bounds[4*(d&u.DISPLAY_ID_TEXEL_MASK)+1]};g.getXMax=function(d){return this._bounds[4*(d&u.DISPLAY_ID_TEXEL_MASK)+2]};g.getYMax=function(d){return this._bounds[4*(d&u.DISPLAY_ID_TEXEL_MASK)+3]};g.setBounds=function(d,a){a=a.readHydratedGeometry();
if(!a||!a.coords.length)return!1;let c=Infinity,e=Infinity,f=-Infinity,k=-Infinity;a.forEachVertex((p,m)=>{c=Math.min(c,p);e=Math.min(e,m);f=Math.max(f,p);k=Math.max(k,m)});d&=u.DISPLAY_ID_TEXEL_MASK;z(this._bounds,4*d+4,0);this._bounds[4*d]=c;this._bounds[4*d+1]=e;this._bounds[4*d+2]=f;this._bounds[4*d+3]=k;return!0};return l}();t.ComputedAttributeStorage=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports",
"../../../engine/webgl/DisplayId"],function(t,u){let B=function(){function D(){this._freeIds=[];this._idCounter=1}var z=D.prototype;z.createId=function(y=!1){return u.createDisplayId(this._getFreeId(),y)};z.releaseId=function(y){this._freeIds.push(y)};z._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return D}();t.DisplayIdGenerator=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),
function(t,u,B,D,z,y){y=function(l){function g(a,c){return l.call(this,a,c,null)||this}u._inheritsLoose(g,l);g.from=function(a){const c=z.FeatureSetReader.createInstance(),e=[];a=a.filter(f=>!!f.geometry);for(const f of a)a=B.getJsonType(f.geometry),D.convertFromGraphics(e,[f],a,!1,!1,"uid");return new g(c,e)};var d=g.prototype;d.readGraphic=function(){return this._current};d.getCursor=function(){return this.copy()};d.copy=function(){const a=new g(this.instance,this._features);this.copyInto(a);return a};
u._createClass(g,[{key:"geometryType",get:function(){const a=this._current;return a?a.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return g}(y.FeatureSetReaderJSON);t.GraphicsReader=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a){var c,e,f;let k=0;B=null!=(c=D("featurelayer-simplify-thresholds"))?c:[.5,.5,.5,.5];const p=B[0],m=B[1],b=B[2],h=B[3];c=null!=(e=D("featurelayer-simplify-payload-size-factors"))?e:[1,2,4];const n=c[0],r=c[1],x=c[2],q=null!=(f=D("featurelayer-simplify-mobile-factor"))?f:2,A=D("esri-mobile");D=function(){function E(w,v){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=
null;this._joined=[];this._objectIdToIndex=null;this._level=0;this.instance=w;this._layerSchema=v}E.createInstance=function(){k++;return k=65535<k?0:k};var F=E.prototype;F.getAreaSimplificationThreshold=function(w,v){let C=1;const G=A?q:1;4E6<v?C=x*G:1E6<v?C=r*G:5E5<v?C=n*G:1E5<v&&(C=G);v=0;4E3<w?v=h*C:2E3<w?v=b*C:100<w?v=m:15<w&&(v=p);w=8;4>this._level?w=1:5>this._level?w=2:6>this._level&&(w=4);return v*w};F.setArcadeSpatialReference=function(w){this._arcadeSpatialReference=w};F.attachStorage=function(w){this._storage=
w};F.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};F.getStorage=function(){return this._storage};F.getComputedNumeric=function(w){return this.getComputedNumericAtIndex(0)};F.setComputedNumeric=function(w,v){return this.setComputedNumericAtIndex(v,0)};F.getComputedString=function(w){return this.getComputedStringAtIndex(0)};F.setComputedString=function(w,v){return this.setComputedStringAtIndex(0,v)};F.getComputedNumericAtIndex=function(w){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),
w)};F.setComputedNumericAtIndex=function(w,v){this._storage.setComputedNumericAtIndex(this.getDisplayId(),w,v)};F.getComputedStringAtIndex=function(w){return this._storage.getComputedStringAtIndex(this.getDisplayId(),w)};F.setComputedStringAtIndex=function(w,v){return this._storage.setComputedStringAtIndex(this.getDisplayId(),w,v)};F.transform=function(w,v,C,G){const H=this.copy();H._tx+=w;H._ty+=v;H._sx*=C;H._sy*=G;return H};F.readAttribute=function(w,v=!1){var C=this._readAttribute(w,v);if(void 0!==
C)return C;for(const G of this._joined)if(G.setIndex(this.getIndex()),C=G._readAttribute(w,v),void 0!==C)return C};F.readAttributes=function(){const w=this._readAttributes();for(const v of this._joined){v.setIndex(this.getIndex());const C=v._readAttributes();for(const G of Object.keys(C))w[G]=C[G]}return w};F.joinAttributes=function(w){this._joined.push(w)};F.readArcadeFeature=function(){return this};F.geometry=function(){var w=this.readHydratedGeometry();w=l.convertToGeometry(w,this.geometryType,
this.hasZ,this.hasM);if(w=a.fromJSON(w))w.spatialReference=this._arcadeSpatialReference;return w};F.field=function(w){if(this.hasField(w))return this.readAttribute(w,!0);for(const v of this._joined)if(v.setIndex(this.getIndex()),v.hasField(w))return v._readAttribute(w,!0);throw Error(`Field ${w} does not exist`);};F.setField=function(w,v){throw Error("Unable to update feature attribute values, feature is readonly");};F.keys=function(){return this.getFieldNames()};F.castToText=function(){return JSON.stringify(this.readLegacyFeature())};
F.gdbVersion=function(){return null};F.fullSchema=function(){return this._layerSchema};F.castAsJson=function(w=null){return{attributes:this._readAttributes(),geometry:!0===(null==w?void 0:w.keepGeometryType)?this.geometry():this.geometry().toJSON()}};F.castAsJsonAsync=function(w,v=null){return Promise.resolve(this.castAsJson(v))};F.removeIds=function(w){if(z.isNone(this._objectIdToIndex)){var v=new Map;const C=this.getCursor();for(;C.next();)v.set(C.getObjectId(),C.getIndex());this._objectIdToIndex=
v}v=this._objectIdToIndex;for(const C of w)v.has(C)&&this.removeAtIndex(v.get(C))};F.removeAtIndex=function(w){z.isNone(this._deleted)&&(this._deleted=d.StaticBitSet.create(this.getSize()));this._deleted.set(w)};F.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};F.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};F.features=function*(){const w=this.getCursor();for(;w.next();)yield w.readOptimizedFeature()};F._getExists=function(){return z.isNone(this._deleted)||
!this._deleted.has(this.getIndex())};F._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const w=this.readUnquantizedGeometry();if(!w||w.hasIndeterminateRingOrder)return null;const v=z.unwrapOr(this.getQuantizationTransform(),null);return y.getCentroidOptimizedGeometry(new g,w,this.hasM,this.hasZ,v)};F.copyInto=function(w){w.seen=this.seen;w._storage=this._storage;w._arcadeSpatialReference=this._arcadeSpatialReference;w._joined=this._joined;w._tx=this._tx;w._ty=
this._ty;w._sx=this._sx;w._sy=this._sy;w._deleted=this._deleted;w._objectIdToIndex=this._objectIdToIndex};u._createClass(E,[{key:"isEmpty",get:function(){return z.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(w){this._level=w}}]);return E}();t.FeatureSetReader=D;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(t,u){function B(z,y,l,g,d,a,c=1){a=d?a?4:3:a?3:2;
let e=l,f=l+a,k=0,p=0,m=l=0,b=0;for(let h=0,n=g-1;h<n;h++,e+=a,f+=a){g=y[e];const r=y[e+1],x=y[e+2],q=y[f],A=y[f+1],E=y[f+2];let F=g*A-q*r;m+=F;k+=(g+q)*F;p+=(r+A)*F;d&&(F=g*E-q*x,l+=(x+E)*F,b+=F);g<z[0]&&(z[0]=g);g>z[1]&&(z[1]=g);r<z[2]&&(z[2]=r);r>z[3]&&(z[3]=r);d&&(x<z[4]&&(z[4]=x),x>z[5]&&(z[5]=x))}0<m*c&&(m*=-1);0<b*c&&(b*=-1);if(!m)return null;z=[k,p,.5*m];d&&(z[3]=l,z[4]=.5*b);return z}function D(z,y,l,g,d){d=g?d?4:3:d?3:2;let a=y,c=y+d,e=0,f=0,k=0,p=0;for(let n=0,r=l-1;n<r;n++,a+=d,c+=d){var m=
z[a];const x=z[a+1],q=z[a+2],A=z[c],E=z[c+1],F=z[c+2];if(g){{var b=A-m;var h=E-x;const w=F-q;b=Math.sqrt(b*b+h*h+w*w)}}else b=A-m,h=E-x,b=Math.sqrt(b*b+h*h);b&&(e+=b,g?(m=[m+.5*(A-m),x+.5*(E-x),q+.5*(F-q)],f+=b*m[0],k+=b*m[1],p+=b*m[2]):(m=[m+.5*(A-m),x+.5*(E-x)],f+=b*m[0],k+=b*m[1]))}return 0<e?g?[f/e,k/e,p/e]:[f/e,k/e]:0<l?g?[z[y],z[y+1],z[y+2]]:[z[y],z[y+1]]:null}t.getCentroidOptimizedGeometry=function(z,y,l,g,d){if(u.isNone(y)||!y.lengths.length)return null;const a="upperLeft"===(null==d?void 0:
d.originPosition)?-1:1;z.lengths.length&&(z.lengths.length=0);z.coords.length&&(z.coords.length=0);d=z.coords;const c=[],e=l?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:k}=y,p=l?g?4:3:g?3:2;let m=0;for(var b of f){const h=B(e,k,m,b,l,g,a);h&&c.push(h);m+=b*p}c.sort((h,n)=>
{let r=a*h[2]-a*n[2];0===r&&l&&(r=h[4]-n[4]);return r});c.length&&(b=6*c[0][2],d[0]=c[0][0]/b,d[1]=c[0][1]/b,l&&(b=6*c[0][4],d[2]=0!==b?c[0][3]/b:0),d[0]<e[0]||d[0]>e[1]||d[1]<e[2]||d[1]>e[3]||l&&(d[2]<e[4]||d[2]>e[5]))&&(d.length=0);if(!d.length)if(y=y.lengths[0]?D(k,0,f[0],l,g):null)d[0]=y[0],d[1]=y[1],l&&2<y.length&&(d[2]=y[2]);else return null;return z};t.lineCentroid=D;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),
function(t,u,B,D,z,y){function l({coords:d,lengths:a}){let c=0;for(const e of a){for(a=1;a<e;a++)d[2*(c+a)]+=d[2*(c+a)-2],d[2*(c+a)+1]+=d[2*(c+a)-1];c+=e}}let g=function(d){function a(e,f,k){e=d.call(this,e,k)||this;e._featureIndex=-1;e._dateFields=new Set;e._geometryType=null==k?void 0:k.geometryType;e._features=f;return e}u._inheritsLoose(a,d);a.fromFeatures=function(e,f){const {objectIdField:k,geometryType:p}=f,m=D.convertFromFeatures([],e,p,!1,!1,k);for(let b=0;b<m.length;b++)m[b].displayId=e[b].displayId;
return a.fromOptimizedFeatures(m,f)};a.fromFeatureSet=function(e,f){e=D.convertFromFeatureSet(e,f.objectIdField);return a.fromOptimizedFeatureSet(e,f)};a.fromOptimizedFeatureSet=function(e,f){const {features:k}=e;f=a.fromOptimizedFeatures(k,f);f._exceededTransferLimit=e.exceededTransferLimit;f._transform=e.transform;for(const p of e.fields)"esriFieldTypeDate"===p.type&&f._dateFields.add(p.name);return f};a.fromOptimizedFeatures=function(e,f,k){const p=y.FeatureSetReader.createInstance();e=new a(p,
e,f);e._transform=k;return e};var c=a.prototype;c.removeIds=function(e){const f=new Set(e);this._features=this._features.filter(k=>!f.has(k.objectId))};c.append=function(e){for(const f of e)this._features.push(f)};c.getSize=function(){return this._features.length};c.getCursor=function(){return this.copy()};c.getQuantizationTransform=function(){return this._transform};c.getAttributeHash=function(){let e="";for(const f in this._current.attributes)e+=this._current.attributes[f];return e};c.getIndex=
function(){return this._featureIndex};c.setIndex=function(e){this._featureIndex=e};c.getObjectId=function(){return this._current.objectId};c.getDisplayId=function(){return this._current.displayId};c.setDisplayId=function(e){this._current.displayId=e};c.getGroupId=function(){return this._current.groupId};c.setGroupId=function(e){this._current.groupId=e};c.copy=function(){const e=new a(this.instance,this._features,this.fullSchema());this.copyInto(e);return e};c.next=function(){for(;++this._featureIndex<
this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};c.readLegacyFeature=function(){return D.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};c.readOptimizedFeature=function(){return this._current};c.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};c.readLegacyGeometry=function(){const e=this.readGeometry();return D.convertToGeometry(e,this.geometryType,this.hasZ,this.hasM)};c.readLegacyCentroid=
function(){const e=this.readCentroid();return B.isNone(e)?null:{x:e.coords[0]*this._sx+this._tx,y:e.coords[1]*this._sy+this._ty}};c.readGeometryArea=function(){return z.hasGeometry(this._current)?D.getQuantizedArea(this._current.geometry,2):0};c.readUnquantizedGeometry=function(){var e=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!e)return e;e=e.clone();l(e);return e};c.readHydratedGeometry=function(){var e=this._current.geometry;if(B.isNone(e))return null;e=e.clone();B.isSome(this._transform)&&
D.unquantizeOptimizedGeometry(e,e,this.hasZ,this.hasM,this._transform);return e};c.getXHydrated=function(){if(!z.hasGeometry(this._current))return 0;const e=this._current.geometry.coords[0],f=this.getQuantizationTransform();return B.isNone(f)?e:e*f.scale[0]+f.translate[0]};c.getYHydrated=function(){if(!z.hasGeometry(this._current))return 0;const e=this._current.geometry.coords[1],f=this.getQuantizationTransform();return B.isNone(f)?e:f.translate[1]-e*f.scale[1]};c.getX=function(){return z.hasGeometry(this._current)?
this._current.geometry.coords[0]*this._sx+this._tx:0};c.getY=function(){return z.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};c.readGeometry=function(){if(!z.hasGeometry(this._current))return null;const e=this._current.geometry.clone();if(e.isPoint)return e.coords[0]=e.coords[0]*this._sx+this._tx,e.coords[1]=e.coords[1]*this._sy+this._ty,e;let f=0;for(const k of e.lengths)e.coords[2*f]=e.coords[2*f]*this._sx+this._tx,e.coords[2*f+1]=e.coords[2*f+1]*this._sy+this._ty,
f+=k;return e};c.readCentroid=function(){if(!z.hasGeometry(this._current))return null;if(B.isNone(this._current.centroid)){var e=this._computeCentroid();if(B.isNone(e))return null;e.coords[0]=(e.coords[0]-this._tx)/this._sx;e.coords[1]=(e.coords[1]-this._ty)/this._sy;this._current.centroid=e}e=this._current.centroid.clone();e.coords[0]=e.coords[0]*this._sx+this._tx;e.coords[1]=e.coords[1]*this._sx+this._ty;return e};c.hasField=function(e){return e in this._current.attributes?!0:this.getFieldNames().map(f=>
f.toLowerCase()).includes(e.toLowerCase())};c.getFieldNames=function(){return Object.keys(this._current.attributes)};c._readAttribute=function(e,f){var k=this._current.attributes[e];if(void 0!==k)return null!=k&&f&&this._dateFields.has(e)?new Date(k):k;k=this.readAttributes();e=e.toLocaleLowerCase().trim();for(const p in k)if(p.toLocaleLowerCase().trim()===e)return e=this._current.attributes[p],null!=e&&f&&this._dateFields.has(p)?new Date(e):e};c.copyInto=function(e){d.prototype.copyInto.call(this,
e);e._featureIndex=this._featureIndex;e._transform=this._transform;e._dateFields=this._dateFields};c._readAttributes=function(){return this._current.attributes};u._createClass(a,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},
{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return a}(y.FeatureSetReader);t.FeatureSetReaderJSON=g;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../symbols/cim/CIMSymbolDrawHelper ../../../../symbols/cim/CIMSymbolHelper ./GraphicStoreItem ./graphicsUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c){function e(b,h,n,r,x){k.minX=h;k.minY=n;k.maxX=r;k.maxY=x;return b.search(k)}function f(b){return{minX:b.bounds[0],minY:b.bounds[1],maxX:b.bounds[2],maxY:b.bounds[3]}}const k={minX:0,minY:0,maxX:0,maxY:0},p=D.create(),m=(b,h)=>{const n=c.graphicGeometryToNumber(b.graphic),r=c.graphicGeometryToNumber(h.graphic);return n===r?h.zorder-b.zorder:n-r};return function(){function b(n,r,x,q,A,E,F){this._graphics=q;this._onAdd=A;this._onRemove=E;this._hashToCIM=F;this._index=
B.rbush(9,f);this._itemByGraphic=new Map;this._inflatedSizeHelper=new d.CIMSimbolInflatedSizeHelper;this._tileInfoView=n;this._uidFieldName=x;if(n=n.getClosestInfoForScale(r))this._resolution=this._tileInfoView.getTileResolution(n.level)}var h=b.prototype;h.setResourceManager=function(n){this._cimResourceManager=n;this._hittestDrawHelper=new g.HittestDrawHelper(n)};h.hitTest=function(n,r,x,q,A){n=y.normalizeMapX(n,this._tileInfoView.spatialReference);var E=.5*q*window.devicePixelRatio*x;p[0]=n-E;
p[1]=r-E;p[2]=n+E;p[3]=r+E;x=.5*q*(x+c.PIXEL_BUFFER);r=e(this._index,n-x,r-x,n+x,r+x);if(!r||0===r.length)return[];n=[];x=D.create();E=D.create();for(var F of r){const {geometry:w,symbolResource:v}=F;this._getSymbolBounds(x,v,w,E,A);E[3]=E[2]=E[1]=E[0]=0;D.intersects(x,p)&&F.graphic.visible&&n.push(F)}if(0===n.length)return[];F=this._hittestDrawHelper;r=[];for(const w of n){const {geometry:v,symbolResource:C}=w,{hash:G,textInfo:H}=C;(n=this._hashToCIM.get(G))&&F.hitTest(p,n.symbol,v,H,A,q)&&r.push(w)}r.sort(m);
return r.map(w=>w.graphic)};h.getGraphicsData=function(n,r,x){const q=this._searchForItems(r);if(0===q.length||0===x.length)return[];q.sort((G,H)=>G.zorder-H.zorder);q[0].insertAfter=-1;for(var A=1;A<q.length;A++)q[A].insertAfter=q[A-1].graphic.uid;q.sort((G,H)=>G.graphic.uid-H.graphic.uid);x.sort((G,H)=>G.uid-H.uid);let E=A=0,F;const w=r.resolution,v=[],C={originPosition:"upperLeft",scale:[w,w],translate:[r.bounds[0],r.bounds[3]]};for(const G of x){for(E=-2;A<q.length;)if(F=q[A],A++,G.uid===F.graphic.uid){E=
F.insertAfter;break}if(!F.geometry||-2===E)continue;x=F.getGeometryQuantized(C,r.bounds,this._tileInfoView.spatialReference,w);const H={...F.graphic.attributes};H[this._uidFieldName]=G.uid;null==F.groupId&&(F.groupId=n.createTemplateGroup(F.symbol,null));v.push({centroid:a.getCentroidQuantized(F,C),geometry:x,attributes:H,symbol:F.symbol,groupId:F.groupId,insertAfter:E,zorder:F.zorder})}v.sort((G,H)=>G.zorder-H.zorder);return v};h.queryTileData=function(n,r){if(0===this._graphics.length)return[];
const {bounds:x,resolution:q}=r,A=this._searchForItems(r),E=[];if(0===A.length)return E;this._createTileGraphics(E,n,A,{originPosition:"upperLeft",scale:[q,q],translate:[x[0],x[3]]},r);return E};h.has=function(n){return this._itemByGraphic.has(n)};h.getBounds=function(n){return(n=this._itemByGraphic.get(n))?n.bounds:null};h.getAllBounds=function(){return Array.from(this._itemByGraphic.values()).filter(n=>n.graphic.visible).map(n=>n.bounds)};h.addOrModify=function(n,r,x){if(n&&!t.isNone(r)){this.has(n)&&
this.remove(n);this._onAdd(n);var q=[0,0,0,0],A=this._getSymbolBounds(null,r,x,q,0);r=a.acquire(n,r,x,t.isSome(A)?A:null,q);this._itemByGraphic.set(n,r);x&&this._index.insert(r);return r.bounds}};h.remove=function(n){if(this._itemByGraphic.has(n)){this._onRemove(n);var r=this._itemByGraphic.get(n);r.bounds&&this._index.remove(r);this._itemByGraphic.delete(n)}};h.updateZ=function(){const n=this._graphics.items;for(let x=0;x<n.length;x++){var r=n[x];if(r=this._itemByGraphic.get(r))r.zorder=x}};h.update=
function(n,r,x){const q=this._itemByGraphic.get(n);q.groupId=null;const A=D.clone(q.bounds);this._index.remove(q);const E=this._getSymbolBounds(q.bounds,r,x,q.size,0);t.isSome(E)&&q.set(n,r,x,E,q.size);x&&this._index.insert(q);return{oldBounds:A,newBounds:q.bounds}};h.updateLevel=function(n){if(this._resolution!==n){this._resolution=n;this._index.clear();var r=this._itemByGraphic;n=[];for(const [,x]of r)r=this._getSymbolBounds(x.bounds,x.symbolResource,x.geometry,x.size,0),x.geometry&&t.isSome(r)&&
(x.bounds=r,n.push(x));this._index.load(n)}};h.clear=function(){this._itemByGraphic.clear();this._index.clear()};h._createTileGraphics=function(n,r,x,q,A){const E=this._uidFieldName,F=this._tileInfoView.spatialReference,{bounds:w,resolution:v}=A;x.sort((L,O)=>L.zorder-O.zorder);let C,G,H;for(let L=0;L<x.length;L++){G=x[L];A=G.graphic;C=G.getGeometryQuantized(q,w,F,v);H=0===L?-1:x[L-1].graphic.uid;const O={...G.graphic.attributes};O[E]=A.uid;null==G.groupId&&(G.groupId=r.createTemplateGroup(G.symbol,
null));n.push({centroid:a.getCentroidQuantized(G,q),geometry:C,attributes:O,symbol:G.symbol,groupId:G.groupId,insertAfter:H,zorder:G.zorder})}};h._searchForItems=function(n){var r=this._tileInfoView.spatialReference,x=n.bounds;if(r.isWrappable){const [q,A]=l.getSpatialReferenceMinMaxX(r);r=1E-5>Math.abs(x[2]-A);const E=1E-5>Math.abs(x[0]-q);if(!(r&&E||!r&&!E))return n=n.resolution,n=r?D.create([q,x[1],q+n*c.PIXEL_BUFFER,x[3]]):D.create([A-n*c.PIXEL_BUFFER,x[1],A,x[3]]),x=e(this._index,x[0],x[1],x[2],
x[3]),n=e(this._index,n[0],n[1],n[2],n[3]),[...new Set([...x,...n])]}return e(this._index,x[0],x[1],x[2],x[3])};h._getSymbolBounds=function(n,r,x,q,A){if(!r||!r.symbol||!x)return null;n||(n=D.create());z.getBoundsXY(n,x);if(!q||0===q[0]&&0===q[1]&&0===q[2]&&0===q[3]){const {hash:E,textInfo:F}=r;r=this._hashToCIM.get(E);if(!r)return null;q||(q=[0,0,0,0]);A=this._inflatedSizeHelper.getSymbolInflateSize(q,r.symbol,this._cimResourceManager,A,F);q[0]=u.pt2px(A[0]);q[1]=u.pt2px(A[1]);q[2]=u.pt2px(A[2]);
q[3]=u.pt2px(A[3])}A=this._resolution;q=d.CIMSimbolInflatedSizeHelper.safeSize(q);n[0]-=q*A;n[1]-=q*A;n[2]+=q*A;n[3]+=q*A;return n};return b}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/quantizationUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./graphicsUtils".split(" "),
function(t,u,B,D,z,y,l,g,d,a){function c(k){k.coords.length=0;k.lengths.length=0}const e=new d,f=new d;d=function(){function k(){this.bounds=B.create();this.graphic=null}k.acquire=function(m=null,b,h,n,r){let x;0===k._pool.length?x=new k:(x=k._pool.pop(),this._set.delete(x));x.acquire(m,b,h,n,r);return x};k.release=function(m){m&&!this._set.has(m)&&(m.release(),this._pool.push(m),this._set.add(m))};k.getCentroidQuantized=function(m,b){if(z.isPolygon(m.geometry)){const h=m.symbol;if(u.isNone(h))return null;
if(a.isMarkerSymbol(h.type)||a.isTextSymbol(h.type))return m=D.polygonCentroid(m.geometry),l.quantizePoint(b,{},{x:m[0],y:m[1]},!1,!1)}return null};var p=k.prototype;p.acquire=function(m=null,b,h,n,r){m&&this.set(m,b,h,n,r)};p.release=function(){this.geometry=this.symbolResource=this.graphic=null};p.set=function(m,b,h,n,r){this.graphic=m;this.geometry=h;this.symbolResource=b;this.bounds=n;r&&(this.size=r)};p.getGeometryQuantized=function(m,b,h,n){const r=this.geometry;if(z.isPolygon(r)){if(h=r.rings,
1===h.length&&2===h[0].length)return l.quantizeGeometry(m,{paths:[[h[0][0],h[0][1]]]})}else{if(z.isPolyline(r))return c(e),c(f),g.convertFromPolyline(e,r),g.generalizeOptimizedGeometry(f,e,r.hasZ,r.hasM,"esriGeometryPolyline",m.scale[0]),g.quantizeOptimizedGeometry(e,f,r.hasZ,r.hasM,"esriGeometryPolyline",m),g.convertToPolyline(e,r.hasZ,r.hasM);if(z.isMultipoint(r)){const x=.5*n*Math.max(Math.abs(this.size[0])+this.size[2]-this.size[0],Math.abs(this.size[1])+this.size[3]-this.size[1]),[q,A]=y.getSpatialReferenceMinMaxX(h),
E=A-q;h=r.points.filter(F=>{if(F[0]+x>A||F[0]-x<q){const w=[...F];w[0]=F[0]+x>A?w[0]-E:w[0]+E;return B.containsPointWithMargin(b,F,x)||B.containsPointWithMargin(b,w,x)}return B.containsPointWithMargin(b,F,x)});return 0===h.length?{points:h}:l.quantizeGeometry(m,{points:h})}}return l.quantizeGeometry(m,this.geometry)};t._createClass(k,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return k}();d._pool=[];d._set=new Set;return d})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(t,u,B,D,z,y,l,g,d){t.GraphicsView=a=>{a=function(c){function e(){var f=c.apply(this,arguments)||this;f.graphics=null;f.renderer=null;return f}u._inheritsLoose(e,c);return e}(D.IdentifiableMixin(a));B.__decorate([z.property()],a.prototype,"graphics",void 0);B.__decorate([z.property()],a.prototype,"renderer",void 0);B.__decorate([z.property()],a.prototype,"updating",void 0);B.__decorate([z.property()],a.prototype,"view",void 0);return a=B.__decorate([d.subclass("esri.views.layers.GraphicsView")],
a)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/webgl/enums","./BaseGraphicContainer"],function(t,u,B){return function(D){function z(){return D.apply(this,arguments)||this}t._inheritsLoose(z,D);var y=z.prototype;y.renderChildren=function(l){this.attributeView.bindTextures(l.context,!1);this.children.some(g=>g.hasData)&&(D.prototype.renderChildren.call(this,l),l.drawPhase===
u.WGLDrawPhase.MAP&&this._renderChildren(l),this.hasHighlight()&&l.drawPhase===u.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(l),this._boundsRenderer&&this._boundsRenderer.doRender(l))};y._renderHighlight=function(l){var {painter:g}=l;g=g.effects.highlight;g.bind(l);this._renderChildren(l,g.defines);g.draw(l);g.unbind()};return z}(B)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/FeatureContainer","./GraphicBoundsRenderer",
"../../../webgl/enums"],function(t,u,B,D){return function(z){function y(g){g=z.call(this,g)||this;g.hasHighlight=()=>!0;return g}t._inheritsLoose(y,z);var l=y.prototype;l.destroy=function(){z.prototype.destroy.call(this);this._boundsRenderer&&(this._boundsRenderer.destroy(),this._boundsRenderer=null)};l.enableRenderingBounds=function(g){this._boundsRenderer=new B(g);this.requestRender()};l.onTileData=function(g,d){g.patch(d);this.contains(g)||this.addChild(g);this.requestRender()};l.onTileError=function(g){g.clear();
this.contains(g)||this.addChild(g)};l._renderChildren=function(g,d){for(const a of this.children)a.isReady&&a.hasData&&(a.commit(g),g.context.setStencilFunction(D.CompareFunction.EQUAL,a.stencilRef,255),a._displayList.replay(g,a,d))};t._createClass(y,[{key:"hasLabels",get:function(){return!1}}]);return y}(u.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),
function(t,u,B,D,z,y,l){y=function(g){function d(c){var e=g.call(this,c)||this;e._rendererInfo=new l.WGLRendererInfo;e._materialItemsRequestQueue=new D;e.attributeView=new z.AttributeStoreView(()=>e.onAttributeStoreUpdate());return e}u._inheritsLoose(d,g);var a=d.prototype;a.destroy=function(){this.removeAllChildren();this.children.forEach(c=>c.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};a.setRendererInfo=function(c,e,f){this._rendererInfo.setInfo(c,e,f);this.requestRender()};
a.getMaterialItems=function(){var c=u._asyncToGenerator(function*(e,f){if(!e||0===e.length)return null;const k=B.createResolver();this._materialItemsRequestQueue.push({items:e,abortOptions:f,resolver:k});this.requestRender();return k.promise});return function(e,f){return c.apply(this,arguments)}}();a.doRender=function(c){c.context.capabilities.enable("textureFloat");c.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let e=this._materialItemsRequestQueue.pop();for(;e;)this._processMaterialItemRequest(c,
e),e=this._materialItemsRequestQueue.pop()}g.prototype.doRender.call(this,c)};a.renderChildren=function(c){for(const e of this.children)e.commit(c);this._rendererInfo.update(c.state);g.prototype.renderChildren.call(this,c)};a.createRenderParams=function(c){c=g.prototype.createRenderParams.call(this,c);c.rendererInfo=this._rendererInfo;c.attributeView=this.attributeView;return c};a.onAttributeStoreUpdate=function(){};a._processMaterialItemRequest=function(c,{items:e,abortOptions:f,resolver:k}){const {painter:p,
pixelRatio:m}=c;c=e.map(b=>p.textureManager.rasterizeItem(b.symbol,m,b.glyphIds,f));Promise.all(c).then(b=>{this.stage?(b=b.map((h,n)=>({id:e[n].id,mosaicItem:h})),k.resolve(b)):k.reject()},k.reject)};return d}(y.default);t.FeatureContainer=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ./definitions ./DisplayId ./Utils ./util/debug ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Texture".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k){const p=z.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),m=c.createDebugLogger(c.DEBUG_ATTR_UPDATES,p);let b=function(){function h(r,x,q){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:A,pixelType:E,textureOnly:F}=r;r=a.getPixelArrayCtor(E);this.shared=q;this.pixelType=E;this.size=x;this.textureOnly=F;F||(this.data=new r(y.unwrap(A)));this._resetRange()}var n=h.prototype;n.destroy=function(){y.applySome(this._texture,
r=>r.dispose());for(const r in this._fbos)y.applySome(this._fbos[r],x=>{"0"===r&&x.detachColorTexture();x.dispose()}),this._fbos[r]=null;this._texture=null};n.setData=function(r,x,q){r=d.getDisplayIdTexel(r);const A=y.unwrap(this.data);x=r*this.texelSize+x;!A||x>=A.length||(A[x]=q,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r))};n.getData=function(r,x){if(y.isNone(this.data))return null;r=d.getDisplayIdTexel(r)*this.texelSize+x;return!this.data||r>=this.data.length?
null:this.data[r]};n.getTexture=function(r){return y.unwrapOr(this._texture,()=>this._initTexture(r))};n.getFBO=function(r,x=0){if(y.isNone(this._fbos[x])){const q={colorTarget:e.TargetType.TEXTURE,depthStencilTarget:e.DepthStencilTargetType.NONE},A=0===x?this.getTexture(r):this._textureDesc;this._fbos[x]=new f.FramebufferObject(r,q,A)}return this._fbos[x]};n.updateTexture=function(r,x){if(!this.locked){try{const q=this.dirtyStart,A=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const E=
y.unwrap(this.data).buffer,F=this.getTexture(r),w=(q-q%this.size)/this.size,v=(A-A%this.size)/this.size,C=w*this.size*4,G=4*(this.size+v*this.size)-C,H=a.getPixelArrayCtor(this.pixelType),L=new H(E,C*H.BYTES_PER_ELEMENT,G),O=this.size;r=v-w+1;if(r>this.size){p.error(new B("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}F.updateData(0,0,w,O,r,L)}catch(q){}x()}};n.update=function(r){const {data:x,start:q,end:A}=r;if(y.isSome(x)){const E=this.data,F=q*this.texelSize;for(let w=
0;w<x.length;w++)r.layout&1<<w%this.texelSize&&(E[F+w]=x[w])}this.dirtyStart=Math.min(this.dirtyStart,q);this.dirtyEnd=Math.max(this.dirtyEnd,A)};n.resize=function(r,x){const q=this.size;this.size=x;this.textureOnly?q!==this.size&&(this._lastTexture=this._texture,this._texture=null):(x=a.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new x(y.unwrap(r.buffer)))};n._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};n._initTexture=function(r){const x=new k.Texture(r,this._textureDesc,
y.unwrapOr(this.data,void 0));if(y.isSome(this._lastTexture)&&this._fbos[0]){const E=this._lastTexture.descriptor.width,F=this._lastTexture.descriptor.height,w=this._lastTexture.descriptor.dataType,v=this._lastTexture.descriptor.pixelFormat,C=this.getFBO(r);var q=a.getPixelBytes(w),A=a.getPixelArrayCtor(w);q=new ArrayBuffer(E*F*q*this.texelSize);A=new A(q);q=r.getBoundFramebufferObject();const {x:G,y:H,width:L,height:O}=r.getViewport();r.bindFramebuffer(C);C.readPixels(0,0,E,F,v,w,A);x.updateData(0,
0,0,2*E,F/2,A);r.setViewport(G,H,L,O);r.bindFramebuffer(q)}this.destroy();return this._texture=x};u._createClass(h,[{key:"_textureDesc",get:function(){return{target:e.TextureType.TEXTURE_2D,wrapMode:e.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:e.PixelFormat.RGBA,dataType:this.pixelType,samplingMode:e.TextureSamplingMode.NEAREST,width:this.size,height:this.size}}},{key:"locked",get:function(){return this.pixelType===e.PixelType.UNSIGNED_BYTE&&this.shared&&!this.textureOnly&&D("esri-atomics")&&this.data?
1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return h}();z=function(){function h(r){this._onUpdate=r;this._locked=this._forceNextUpload=this._initialized=!1}var n=h.prototype;n.initialize=function(r){const {blocks:x,shared:q,size:A}=r;this.shared=q;this.size=A;m("Initializing AttributeStoreView",r);if(y.isNone(this._data))this._data=y.mapMany(x,E=>new b(E,A,q));else for(r=0;r<this._data.length;r++){const E=this._data[r],F=x[r];y.isSome(F)&&
(y.isNone(E)?this._data[r]=new b(F,A,q):E.resize(F,A))}this._initialized=!0};n.destroy=function(){y.applySome(this._data,r=>y.mapMany(r,x=>x.destroy()));y.applySome(this._defaultTexture,r=>r.dispose())};n.isEmpty=function(){return y.isNone(this._data)};n.isUpdating=function(){const r=y.isSome(this._pendingAttributeUpdate);D("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${r}\n  -> hasPendingUpdate ${r}`);return r};n.getBlock=function(r){return y.isNone(this._data)?null:this._data[r]};
n.setLabelMinZoom=function(r,x){this.setData(r,0,1,x)};n.getLabelMinZoom=function(r){return this.getData(r,0,1,255)};n.getFilterFlags=function(r){return this.getData(r,0,0,0)};n.getVVSize=function(r){return this.getData(r,g.ATTRIBUTE_DATA_VV,0,0)};n.getData=function(r,x,q,A){if(!this._data)return 0;x=y.unwrap(this._data)[x];if(y.isNone(x))return 0;r=x.getData(r,q);return y.isSome(r)?r:A};n.setData=function(r,x,q,A){x=y.unwrap(this._data)[x];y.unwrap(x).setData(r,q,A)};n.lockTextureUpload=function(){this._locked=
!0};n.unlockTextureUpload=function(){this._locked=!1};n.forceTextureUpload=function(){this._forceNextUpload=!0};n.requestUpdate=function(){var r=u._asyncToGenerator(function*(x){if(this._pendingAttributeUpdate)p.error(new B("mapview-webgl","Tried to update attribute data with a pending update"));else{var q=l.createResolver();m("AttributeStoreView Update Requested",x);this._pendingAttributeUpdate={data:x,resolver:q};return q.promise}});return function(x){return r.apply(this,arguments)}}();n.update=
function(){if(this._initialized&&y.isSome(this._pendingAttributeUpdate)){const {data:r,resolver:x}=this._pendingAttributeUpdate,q=y.unwrap(this._data);for(let A=0;A<r.blocks.length;A++){const E=r.blocks[A];y.applySome(q[A],F=>y.applySome(E,w=>{m(`Updating block ${A}`,w);F.update(w)}))}this._pendingAttributeUpdate=null;x();this._onUpdate()}};n.bindTextures=function(r,x=!0){this.update();const q=this._getDefaultTexture(r);if(this._initialized){var A=y.unwrap(this._data);if(!this._locked||this._forceNextUpload)y.forEachSome(A,
E=>E.updateTexture(r,()=>this._onUpdate())),this._forceNextUpload=!1;r.bindTexture(y.mapOr(A[g.ATTRIBUTE_DATA_FILTER_FLAGS],q,E=>E.getTexture(r)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_0);x&&(r.bindTexture(y.mapOr(A[g.ATTRIBUTE_DATA_GPGPU],q,E=>E.getTexture(r)),g.TEXTURE_BINDING_GPGPU),r.bindTexture(y.mapOr(A[g.ATTRIBUTE_DATA_ANIMATION],q,E=>E.getTexture(r)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_1),r.bindTexture(y.mapOr(A[g.ATTRIBUTE_DATA_VV],q,E=>E.getTexture(r)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_2),r.bindTexture(y.mapOr(A[g.ATTRIBUTE_DATA_DD1],
q,E=>E.getTexture(r)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_3))}else r.bindTexture(q,g.TEXTURE_BINDING_ATTRIBUTE_DATA_0),x&&(r.bindTexture(q,g.TEXTURE_BINDING_ATTRIBUTE_DATA_1),r.bindTexture(q,g.TEXTURE_BINDING_ATTRIBUTE_DATA_2),r.bindTexture(q,g.TEXTURE_BINDING_ATTRIBUTE_DATA_3),r.bindTexture(q,g.TEXTURE_BINDING_GPGPU))};n._getDefaultTexture=function(r){y.isNone(this._defaultTexture)&&(this._defaultTexture=new k.Texture(r,{wrapMode:e.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:e.PixelFormat.RGBA,dataType:e.PixelType.UNSIGNED_BYTE,
samplingMode:e.TextureSamplingMode.NEAREST,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return h}();t.AttributeStoreView=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(t,u,B,D,z,y,l){const g=(d,a)=>0!==d.key.level-a.key.level?d.key.level-a.key.level:
0!==d.key.row-a.key.row?d.key.row-a.key.row:d.key.col-a.key.col;z=function(d){function a(e){var f=d.call(this)||this;f._tileInfoView=e;return f}u._inheritsLoose(a,d);var c=a.prototype;c.renderChildren=function(e){this.sortChildren(g);this.setStencilReference(e);d.prototype.renderChildren.call(this,e)};c.createRenderParams=function(e){const {state:f}=e;e=d.prototype.createRenderParams.call(this,e);e.requiredLevel=this._tileInfoView.getClosestInfoForScale(f.scale).level;e.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(f.scale);
return e};c.prepareRenderPasses=function(e){const f=d.prototype.prepareRenderPasses.call(this,e);f.push(e.registerRenderPass({name:"stencil",brushes:[l],drawPhase:D.WGLDrawPhase.DEBUG|D.WGLDrawPhase.MAP|D.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));B("esri-tiles-debug")&&f.push(e.registerRenderPass({name:"tileInfo",brushes:[y],drawPhase:D.WGLDrawPhase.DEBUG,target:()=>this.children}));return f};c.getStencilTarget=function(){return this.children};c.updateTransforms=function(e){for(const f of this.children){const k=
this._tileInfoView.getTileResolution(f.key);f.setTransform(e,k)}};c.setStencilReference=function(e){e=1;for(const f of this.children)f.stencilRef=e++};u._createClass(a,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return a}(z);t.default=z;t.sortByLevel=g;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3f32 ../brushes ../Container ./ClippingInfo ./enums".split(" "),
function(t,u,B,D,z,y,l,g){return function(d){function a(){var e=d.apply(this,arguments)||this;e.name=e.constructor.name;return e}t._inheritsLoose(a,d);var c=a.prototype;c._createTransforms=function(){return{dvs:D.create()}};c.doRender=function(e){const f=this.createRenderParams(e),{painter:k,globalOpacity:p,profiler:m,drawPhase:b}=f,h=b===g.WGLDrawPhase.LABEL||b===g.WGLDrawPhase.HIGHLIGHT?1:p*this.computedOpacity;m.recordContainerStart(this.name);k.beforeRenderLayer(f,this._clippingInfos?255:0,h);
this.updateTransforms(e.state);this.renderChildren(f);k.compositeLayer(f,h);m.recordContainerEnd()};c.renderChildren=function(e){B.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));for(const f of this.children)f.beforeRender(e);for(const f of this._renderPasses)try{f.render(e)}catch(k){}for(const f of this.children)f.afterRender(e)};c.createRenderParams=function(e){e.requireFBO=this.requiresDedicatedFBO;return e};c.prepareRenderPasses=function(e){return[e.registerRenderPass({name:"clip",
brushes:[z.brushes.clip],target:()=>this._clippingInfos,drawPhase:g.WGLDrawPhase.MAP|g.WGLDrawPhase.LABEL|g.WGLDrawPhase.LABEL_ALPHA|g.WGLDrawPhase.DEBUG|g.WGLDrawPhase.HIGHLIGHT})]};c.updateTransforms=function(e){for(const f of this.children)f.setTransform(e)};c.onAttach=function(){d.prototype.onAttach.call(this);this._updateClippingInfo()};c.onDetach=function(){d.prototype.onDetach.call(this);this._updateClippingInfo()};c._updateClippingInfo=function(){B.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(f=>
f.destroy()),this._clippingInfos=null);if(this.stage){var e=this._clips;B.isSome(e)&&e.length&&(this._clippingInfos=e.items.map(f=>l.fromClipArea(this.stage,f)));this.requestRender()}};t._createClass(a,[{key:"clips",set:function(e){this._clips=e;this.children.forEach(f=>f.clips=e);this._updateClippingInfo()}}]);return a}(y.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/mat3f32 ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(t,u,B,D,z,y,l,g){const d=B.getLogger("esri.views.2d.engine.webgl.ClippingInfo");return function(a){function c(f,k){var p=a.call(this)||this;p._clip=k;p._cache={};p.stage=f;p._handle=k.watch("version",()=>p._invalidate());p.ready();return p}t._inheritsLoose(c,a);c.fromClipArea=function(f,k){return new c(f,k)};var e=c.prototype;e._destroyGL=function(){D.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);D.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=
null)};e.destroy=function(){this._destroyGL();this._handle.remove()};e.getVAO=function(f,k,p,m){const [b,h]=k.size;if("geometry"===this._clip.type||this._lastWidth!==b||this._lastHeight!==h)this._lastWidth=b,this._lastHeight=h,this._destroyGL();if(D.isNone(this._cache.vao)){k=this._createMesh(k,this._clip);const n=k.getIndexBuffer(f),r=k.getVertexBuffers(f);this._cache.mesh=k;this._cache.vao=new g.VertexArrayObject(f,p,m,r,n)}return this._cache.vao};e._createTransforms=function(){return{dvs:z.create()}};
e._invalidate=function(){this._destroyGL();this.requestRender()};e._createScreenRect=function(f,k){const [p,m]=f.size;f="string"===typeof k.left?parseFloat(k.left)/100*p:k.left;const b="string"===typeof k.right?parseFloat(k.right)/100*p:k.right,h="string"===typeof k.top?parseFloat(k.top)/100*m:k.top;k="string"===typeof k.bottom?parseFloat(k.bottom)/100*m:k.bottom;return{x:f,y:h,width:Math.max(p-b-f,0),height:Math.max(m-k-h,0)}};e._createMesh=function(f,k){switch(k.type){case "rect":return l.fromRect(this._createScreenRect(f,
k));case "path":return l.fromPath(k);case "geometry":return l.fromGeometry(f,k);default:return d.error(new u("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),l.fromRect({x:0,y:0,width:1,height:1})}};return c}(y.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject ../../../webgl/enums".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e){const f=B.getLogger("esri.views.2d.engine.webgl.Mesh2D"),k=({coords:p,lengths:m},b)=>{const h=[];for(let x=0,q=0;x<m.length;q+=m[x],x+=1){const A=q;for(var n=[];x<m.length-1;x+=1,q+=m[x]){{var r=q+m[x];let E=0;for(let F=1;F<m[x+1];F++)E+=(p[2*(r+F)]-p[2*(r+F-1)])*(p[2*(r+F)+1]+p[2*(r+F-1)+1]);r=b?0<E:0>E}if(!r)break;n.push(q+m[x]-A)}r=p.slice(2*A,2*(q+m[x]));n=z.earcut(r,n,2);for(const E of n)h.push(E+A)}return h};return function(){function p(b,h,n,r=!1){this._cache=
{};this.vertices=b;this.indices=h;this.primitiveType=n;this.isMapSpace=r}p.fromRect=function({x:b,y:h,width:n,height:r}){return p.fromScreenExtent({xmin:b,ymin:h,xmax:b+n,ymax:h+r})};p.fromPath=function(b){var h=g.convertFromNestedArray(new d,b.path,!1,!1);b=h.coords;h=new Uint32Array(k(h,!0));const n=new Uint32Array(b.length/2);for(let r=0;r<n.length;r++)n[r]=a.i1616to32(Math.floor(b[2*r]),Math.floor(b[2*r+1]));return new p({geometry:n},h,e.PrimitiveType.TRIANGLES)};p.fromGeometry=function(b,h){const n=
h.geometry.type;switch(n){case "polygon":return p.fromPolygon(b,h.geometry);case "extent":return p.fromMapExtent(b,h.geometry);default:return f.error(new u("mapview-bad-type",`Unable to create a mesh from type ${n}`,h)),p.fromRect({x:0,y:0,width:1,height:1})}};p.fromPolygon=function(b,h){var n=g.convertFromPolygon(new d,h,!1,!1);h=n.coords;n=new Uint32Array(k(n,!1));const r=new Uint32Array(h.length/2),x=l.create(),q=l.create();for(let A=0;A<r.length;A++)y.set(x,h[2*A],h[2*A+1]),b.toScreen(q,x),r[A]=
a.i1616to32(Math.floor(q[0]),Math.floor(q[1]));return new p({geometry:r},n,e.PrimitiveType.TRIANGLES,!0)};p.fromScreenExtent=function({xmin:b,xmax:h,ymin:n,ymax:r}){b={geometry:new Uint32Array([a.i1616to32(b,n),a.i1616to32(h,n),a.i1616to32(b,r),a.i1616to32(b,r),a.i1616to32(h,n),a.i1616to32(h,r)])};h=new Uint32Array([0,1,2,3,4,5]);return new p(b,h,e.PrimitiveType.TRIANGLES)};p.fromMapExtent=function(b,h){const [n,r]=b.toScreen([0,0],[h.xmin,h.ymin]),[x,q]=b.toScreen([0,0],[h.xmax,h.ymax]);b={geometry:new Uint32Array([a.i1616to32(n,
r),a.i1616to32(x,r),a.i1616to32(n,q),a.i1616to32(n,q),a.i1616to32(x,r),a.i1616to32(x,q)])};h=new Uint32Array([0,1,2,3,4,5]);return new p(b,h,e.PrimitiveType.TRIANGLES)};var m=p.prototype;m.destroy=function(){D.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const b in this._cache.vertexBuffers)D.isSome(this._cache.vertexBuffers[b])&&this._cache.vertexBuffers[b].dispose()};m.getIndexBuffer=function(b,h=e.Usage.STATIC_DRAW){this._cache.indexBuffer||(this._cache.indexBuffer=c.BufferObject.createIndex(b,
h,this.indices));return this._cache.indexBuffer};m.getVertexBuffers=function(b,h=e.Usage.STATIC_DRAW){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((n,r)=>({...n,[r]:c.BufferObject.createVertex(b,h,this.vertices[r])}),{}));return this._cache.vertexBuffers};t._createClass(p,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var b=e.DataType.UNSIGNED_BYTE;break a;case 2:b=e.DataType.UNSIGNED_SHORT;break a;case 4:b=e.DataType.UNSIGNED_INT;
break a;default:throw new u("Cannot get DataType of array");}return b}}]);return p}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../Color ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./definitions ./Utils ../../../webgl/capabilities".split(" "),function(t,u,B,D,z,y,l,g,d,a){function c(k,p){const m=p.length;if(k<p[0].value||1===m)return p[0].size;
for(let b=1;b<m;b++)if(k<p[b].value)return p[b-1].size+(k-p[b-1].value)/(p[b].value-p[b-1].value)*(p[b].size-p[b-1].size);return p[m-1].size}function e(k,p,m=0){if(D.isNone(p))k[m+0]=0,k[m+1]=0,k[m+2]=0,k[m+3]=0;else{var {r:b,g:h,b:n,a:r}=p;k[m+0]=b*r/255;k[m+1]=h*r/255;k[m+2]=n*r/255;k[m+3]=r}}let f=function(){function k(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=
new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1}}var p=k.prototype;p.getSizeVVFieldStops=function(m){const b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return D.unwrapOr(b.levels[m],()=>{var h=Infinity,n=0;for(var r in b.levels){const x=parseFloat(r),
q=Math.abs(m-x);q<h&&(h=q,n=x)}if(Infinity===h)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};h=2**((m-n)/2);n=D.unwrap(b.levels[n]);r=new Float32Array(n.values);r[2]*=h;r[3]*=h;return{sizes:D.unwrap(n.sizes),values:r}})}};p.update=function(m){D.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,m)};p.setInfo=function(m,b,h){this._updateEffects(h);this._vvInfo=b;switch(m.type){case "dot-density":this._updateDotDensityInfo(m)}};p.getVariation=
function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,oesTextureFloat:a.getWebGL1Capabilities().supportsTextureFloat}};p.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1};p._updateEffects=function(m){D.isSome(m)?this.outsideLabelsVisible=m.excludedLabelsVisible:this.outsideLabelsVisible=!1};p._updateVisualVariables=function(m,b){const h=this._vvMaterialParameters;h.vvOpacityEnabled=!1;h.vvSizeEnabled=!1;h.vvColorEnabled=
!1;h.vvRotationEnabled=!1;if(m){var n=m.size;if(n){h.vvSizeEnabled=!0;if(n.minMaxValue){const x=n.minMaxValue;let q;if(d.isDefined(x.minSize)&&d.isDefined(x.maxSize))if(d.isNumber(x.minSize)&&d.isNumber(x.maxSize)){q=z.pt2px(x.minSize);var r=z.pt2px(x.maxSize)}else r=b.scale,q=z.pt2px(c(r,x.minSize.stops)),r=z.pt2px(c(r,x.maxSize.stops));this.vvSizeMinMaxValue.set([x.minDataValue,x.maxDataValue,q,r])}n.scaleStops&&(this.vvSizeScaleStopsValue=z.pt2px(c(b.scale,n.scaleStops.stops)));n.unitValue&&(this.vvSizeUnitValueToPixelsRatio=
y.getMetersPerUnitForSR(b.spatialReference)/l.meterIn[n.unitValue.unit]/b.resolution);n.fieldStops&&(this._vvSizeFieldStops=n.fieldStops)}if(b=m.color)h.vvColorEnabled=!0,this.vvColorValues.set(b.values),this.vvColors.set(b.colors);if(b=m.opacity)h.vvOpacityEnabled=!0,this.vvOpacityValues.set(b.values),this.vvOpacities.set(b.opacities);if(m=m.rotation)h.vvRotationEnabled=!0,h.vvRotationType=m.type}};p._updateDotDensityInfo=function(m){var b=m.attributes;this.ddDotValue=m.dotValue;this.ddDotScale=
m.referenceScale;this.ddDotSize=m.dotSize;this.ddDotBlending=m.dotBlendingEnabled;this.ddSeed=m.seed;for(let h=0;h<g.DOT_DENSITY_MAX_FIELDS;h++){const n=h>=b.length?new B([0,0,0,0]):b[h].color;e(this.ddColors,n,4*h)}for(b=0;8>b;b++)this.ddActiveDots[b]=b<m.attributes.length?1:0;e(this.ddBackgroundColor,m.backgroundColor)};u._createClass(k,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);return k}();t.WGLRendererInfo=f;Object.defineProperty(t,"__esModule",{value:!0})})},
"esri/views/2d/layers/graphics/GraphicBoundsRenderer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../chunks/vec3f32 ../../../../geometry/support/normalizeUtils ../../engine/DisplayObject ../../engine/webgl/Utils ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),function(t,u,B,D,z,y,l,g,d,a,c){const e=Math.PI/180,f=()=>g.createProgramDescriptor("bounds",
{geometry:[{location:0,name:"a_position",count:2,type:a.DataType.FLOAT}]});return function(k){function p(b){var h=k.call(this)||this;h._dvsMat3=B.create();h._localOrigin={x:0,y:0};h._getBounds=b;return h}t._inheritsLoose(p,k);var m=p.prototype;m.destroy=function(){this._vao&&(this._vao.dispose(!0),this._indexBuffer=this._vertexBuffer=this._vao=null);this._program&&(this._program.dispose(),this._program=null)};m.doRender=function(b){const {context:h}=b,n=this._getBounds();1>n.length||(this._createShaderProgram(h),
this._updateMatricesAndLocalOrigin(b),this._updateBufferData(h,n),h.setBlendingEnabled(!0),h.setDepthTestEnabled(!1),h.setStencilWriteMask(0),h.setStencilTestEnabled(!1),h.setBlendFunction(a.BlendFactor.ONE,a.BlendFactor.ONE_MINUS_SRC_ALPHA),h.setColorMask(!0,!0,!0,!0),b=this._program,h.bindVAO(this._vao),h.useProgram(b),b.setUniformMatrix3fv("u_dvsMat3",this._dvsMat3),h.gl.lineWidth(1),h.drawElements(a.PrimitiveType.LINES,8*n.length,a.DataType.UNSIGNED_INT,0),h.bindVAO())};m._createTransforms=function(){return{dvs:B.create()}};
m._createShaderProgram=function(b){this._program||(this._program=b.programCache.acquire("precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos \x3d u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n        }","precision mediump float;\n      void main() {\n        gl_FragColor \x3d vec4(0.75, 0.0, 0.0, 0.75);\n      }",f().attributes))};m._updateMatricesAndLocalOrigin=
function(b){var {state:h}=b;const {displayMat3:n,size:r,resolution:x,pixelRatio:q,rotation:A,viewpoint:E}=h;b=e*A;const {x:F,y:w}=E.targetGeometry;h=y.normalizeMapX(F,h.spatialReference);this._localOrigin.x=h;this._localOrigin.y=w;h=q*r[0];const v=q*r[1],C=x*h,G=x*v,H=u.identity(this._dvsMat3);u.multiply(H,H,n);u.translate(H,H,D.fromValues(h/2,v/2));u.scale(H,H,z.fromValues(r[0]/C,-v/G,1));u.rotate(H,H,-b)};m._updateBufferData=function(b,h){const {x:n,y:r}=this._localOrigin,x=new Float32Array(8*h.length),
q=new Uint32Array(8*h.length);let A=0,E=0;for(const F of h)F&&(x[2*A]=F[0]-n,x[2*A+1]=F[1]-r,x[2*A+2]=F[0]-n,x[2*A+3]=F[3]-r,x[2*A+4]=F[2]-n,x[2*A+5]=F[3]-r,x[2*A+6]=F[2]-n,x[2*A+7]=F[1]-r,q[E+0]=A+0,q[E+1]=A+3,q[E+2]=A+3,q[E+3]=A+2,q[E+4]=A+2,q[E+5]=A+1,q[E+6]=A+1,q[E+7]=A+0,A+=4,E+=8);this._vertexBuffer?this._vertexBuffer.setData(x.buffer):this._vertexBuffer=d.BufferObject.createVertex(b,a.Usage.DYNAMIC_DRAW,x.buffer);this._indexBuffer?this._indexBuffer.setData(q):this._indexBuffer=d.BufferObject.createIndex(b,
a.Usage.DYNAMIC_DRAW,q);this._vao||(h=f(),this._vao=new c.VertexArrayObject(b,h.attributes,h.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer))};return p}(l.DisplayObject)})},"esri/chunks/vec3f32":function(){define(["exports"],function(t){function u(){return new Float32Array(3)}function B(b){const h=new Float32Array(3);h[0]=b[0];h[1]=b[1];h[2]=b[2];return h}function D(b,h,n){const r=new Float32Array(3);r[0]=b;r[1]=h;r[2]=n;return r}function z(b,h){return new Float32Array(b,h,3)}function y(){return u()}
function l(){return D(1,1,1)}function g(){return D(1,0,0)}function d(){return D(0,1,0)}function a(){return D(0,0,1)}const c=u(),e=l(),f=g(),k=d(),p=a(),m=Object.freeze({__proto__:null,create:u,clone:B,fromValues:D,createView:z,zeros:y,ones:l,unitX:g,unitY:d,unitZ:a,ZEROS:c,ONES:e,UNIT_X:f,UNIT_Y:k,UNIT_Z:p});t.ONES=e;t.UNIT_X=f;t.UNIT_Y=k;t.UNIT_Z=p;t.ZEROS=c;t.clone=B;t.create=u;t.createView=z;t.fromValues=D;t.ones=l;t.unitX=g;t.unitY=d;t.unitZ=a;t.vec3f32=m;t.zeros=y})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p){const m=new B({targetGeometry:new a}),b=[0,0];B=function(h){function n(x){x=h.call(this,x)||this;x._endTimer=null;x.animationManager=null;return x}t._inheritsLoose(n,h);var r=n.prototype;r.initialize=function(){this.pan=new f({navigation:this});this.rotate=new p({navigation:this});this.pinch=new k({navigation:this});this.zoomBox=new e({view:this.view,navigation:this})};r.destroy=function(){this.pan.destroy();this.rotate.destroy();this.pinch.destroy();this.zoomBox.destroy();
this.pan=this.rotate=this.pinch=this.zoomBox=this.animationManager=null};r.begin=function(){this._set("interacting",!0)};r.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};r.zoom=function(){var x=t._asyncToGenerator(function*(q,A=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>q?this.zoomIn(A):this.zoomOut(A);this.setViewpoint(A,q,0,[0,0])});return function(q){return x.apply(this,arguments)}}();
r.zoomIn=function(){var x=t._asyncToGenerator(function*(q){var A=this.view;A=A.constraints.snapToNextScale(A.scale);return this._zoomToScale(A,q)});return function(q){return x.apply(this,arguments)}}();r.zoomOut=function(){var x=t._asyncToGenerator(function*(q){var A=this.view;A=A.constraints.snapToPreviousScale(A.scale);return this._zoomToScale(A,q)});return function(q){return x.apply(this,arguments)}}();r.setViewpoint=function(x,q,A,E){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,
x,q,A,E);this.end()};r.setViewpointImmediate=function(x,q=0,A=[0,0],E=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,E,x,q,A)};r.continousRotateClockwise=function(){const x=this.get("view.viewpoint");this.animationManager.animateContinous(x,q=>{c.rotateBy(q,q,-1)})};r.continousRotateCounterclockwise=function(){const x=this.get("view.viewpoint");this.animationManager.animateContinous(x,q=>{c.rotateBy(q,q,1)})};r.resetRotation=function(){this.view.rotation=
0};r.continousPanLeft=function(){this._continuousPan([-10,0])};r.continousPanRight=function(){this._continuousPan([10,0])};r.continousPanUp=function(){this._continuousPan([0,10])};r.continousPanDown=function(){this._continuousPan([0,-10])};r.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};r._continuousPan=function(x){this.animationManager.animateContinous(this.view.viewpoint,
q=>{c.translateBy(q,q,x);this.view.constraints.constrainByGeometry(q)})};r._startTimer=function(x){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const q=performance.now()-this._lastEventTimestamp;250>q?this._endTimer=this._startTimer(q):this._set("interacting",!1)},x)};r._getDefaultAnchor=function(){const {size:x,padding:{left:q,right:A,top:E,bottom:F}}=this.view;b[0]=.5*(x[0]-A+q);b[1]=.5*(x[1]-F+E);return b};r._zoomToScale=function(){var x=t._asyncToGenerator(function*(q,
A=this._getDefaultAnchor()){const {view:E}=this,{constraints:F,scale:w,viewpoint:v,size:C,padding:G}=E,H=F.canZoomInTo(q),L=F.canZoomOutTo(q);if(!(q<w&&!H||q>w&&!L))return c.padAndScaleAndRotateBy(m,v,q/w,0,A,C,G),F.constrainByGeometry(m),E.goTo(m,{animate:!0})});return function(q){return x.apply(this,arguments)}}();r._scaleRotateTranslateViewpoint=function(x,q,A,E,F){var {view:w}=this;const {size:v,padding:C,constraints:G,scale:H,viewpoint:L}=w;var O=H*A;w=G.canZoomInTo(O);O=G.canZoomOutTo(O);if(1>
A&&!w||1<A&&!O)A=1;c.translateBy(L,L,F);c.padAndScaleAndRotateBy(x,L,A,E,q,v,C);return G.constrainByGeometry(x)};return n}(D);u.__decorate([z.property()],B.prototype,"animationManager",void 0);u.__decorate([z.property({type:Boolean,readOnly:!0})],B.prototype,"interacting",void 0);u.__decorate([z.property()],B.prototype,"pan",void 0);u.__decorate([z.property()],B.prototype,"pinch",void 0);u.__decorate([z.property()],B.prototype,"rotate",void 0);u.__decorate([z.property()],B.prototype,"view",void 0);
u.__decorate([z.property()],B.prototype,"zoomBox",void 0);return B=u.__decorate([d.subclass("esri.views.2d.navigation.MapViewNavigation")],B)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(t,u,B,D,z,y,l,g,d,a){B=function(c){function e(k){k=c.call(this,k)||this;k._container=null;k._overlay=null;k._backgroundShape=null;k._boxShape=null;k._box={x:0,y:0,width:0,height:0};k._redraw=k._redraw.bind(t._assertThisInitialized(k));return k}t._inheritsLoose(e,c);var f=e.prototype;f.destroy=function(){this.view=null};f._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};f._update=function(k,p,m,b){this._box.x=k;this._box.y=p;this._box.width=m;this._box.height=
b;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};f._end=function(k,p,m,b,h){const n=this.view;k=n.toMap(D.createScreenPoint(k+.5*m,p+.5*b));m=Math.max(m/n.width,b/n.height);-1===h&&(m=1/m);this._destroyOverlay();this.navigation.end();n.goTo({center:k,scale:n.scale*m})};f._updateBox=function(k,p,m,b){const h=this._boxShape;h.setAttributeNS(null,"x",""+k);h.setAttributeNS(null,"y",""+p);h.setAttributeNS(null,"width",""+m);h.setAttributeNS(null,"height",""+b);h.setAttributeNS(null,"class",
"esri-zoom-box__outline")};f._updateBackground=function(k,p,m,b){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(k,p,m,b,this.view.width,this.view.height))};f._createContainer=function(){const k=document.createElement("div");k.className="esri-zoom-box__container";this.view.root.appendChild(k);this._container=k};f._createOverlay=function(){var k=this.view.width,p=this.view.height;const m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M 0 0 L "+
k+" 0 L "+k+" "+p+" L 0 "+p+" Z");m.setAttributeNS(null,"class","esri-zoom-box__overlay-background");k=document.createElementNS("http://www.w3.org/2000/svg","rect");p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");p.setAttributeNS(null,"class","esri-zoom-box__overlay");p.appendChild(m);p.appendChild(k);this._container.appendChild(p);this._backgroundShape=m;this._boxShape=k;this._overlay=p};
f._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};f._toSVGPath=function(k,p,m,b,h,n){m=k+m;b=p+b;return"M 0 0 L "+h+" 0 L "+h+" "+n+" L 0 "+n+" ZM "+k+" "+p+" L "+k+" "+b+" L "+m+" "+b+" L "+m+" "+p+" Z"};f._handleDrag=function(k,p){var m=k.x,b=k.y,h=k.origin.x;const n=k.origin.y;let r;m>h?(r=h,h=m-h):(r=m,h-=m);b>n?(m=n,b-=n):(m=b,b=n-b);switch(k.action){case "start":this._start();
break;case "update":this._update(r,m,h,b);break;case "end":this._end(r,m,h,b,p)}k.stopPropagation()};f._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:k,y:p,width:m,height:b}=this._box;this._updateBox(k,p,m,b);this._updateBackground(k,p,m,b);this._rafId=requestAnimationFrame(this._redraw)}};t._createClass(e,[{key:"view",set:function(k){this._handles&&this._handles.forEach(p=>{p.remove()});this._handles=null;this._destroyOverlay();this._set("view",k);k&&(k.on("drag",["Shift"],
p=>this._handleDrag(p,1),a.ViewEventPriorities.INTERNAL),k.on("drag",["Shift","Ctrl"],p=>this._handleDrag(p,-1),a.ViewEventPriorities.INTERNAL))}}]);return e}(B);u.__decorate([z.property()],B.prototype,"navigation",void 0);u.__decorate([z.property()],B.prototype,"view",null);return B=u.__decorate([d.subclass("esri.views.2d.navigation.ZoomBox")],B)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b){B=function(h){function n(x){var q=h.call(this,x)||this;q.animationTime=0;q.momentumEstimator=new m.PanPlanarMomentumEstimator(500,6,.92);q.momentum=null;q.tmpMomentum=k.create();q.momentumFinished=!1;q.viewpoint=new D({targetGeometry:new b,scale:0,rotation:0});y.when(()=>q.momentumFinished,()=>q.navigation.stop());return q}t._inheritsLoose(n,h);var r=n.prototype;r.begin=function(x,q){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(q);
this.previousDrag=q};r.update=function(x,q){this.addToEstimator(q);let A=q.center.x,E=q.center.y;const F=this.previousDrag;A=F?F.center.x-A:-A;E=F?E-F.center.y:E;x.viewpoint=p.translateBy(this.viewpoint,x.viewpoint,[A||0,E||0]);this.previousDrag=q};r.end=function(x,q){this.addToEstimator(q);this.momentum=x.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(x);this.previousDrag=null;this.navigation.end()};r.addToEstimator=
function(x){var q=x.center.x;const A=x.center.y,E=l.createScreenPointArray(-q,A);q=k.fromValues(-q,A,0);this.momentumEstimator.add(E,q,.001*x.timestamp)};r.onAnimationUpdate=function(x){this.navigation.animationManager.animateContinous(x.viewpoint,(q,A)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);A*=.001;if(!this.momentumFinished){const E=this.momentum.valueDelta(this.animationTime,A);f.scale(this.tmpMomentum,this.momentum.direction,E);p.translateBy(q,q,this.tmpMomentum);
x.constraints.constrainByGeometry(q)}this.animationTime+=A})};r.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return n}(z);u.__decorate([g.property()],B.prototype,"momentumFinished",void 0);u.__decorate([g.property()],B.prototype,"viewpoint",void 0);u.__decorate([g.property()],B.prototype,"navigation",void 0);return B=u.__decorate([e.subclass("esri.views.2d.navigation.actions.Pan")],B)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(t,u,B,D,z,y){let l=function(g){function d(a,c,e,f,k){a=g.call(this,a,c,e)||this;a.sceneVelocity=f;a.direction=k;return a}u._inheritsLoose(d,g);d.prototype.value=function(a){return g.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,a)};return d}(y.Momentum);y=function(){function g(a=300,c=12,e=.84){this.minimumInitialVelocity=a;this.stopVelocity=c;this.friction=e;this.enabled=!0;this.time=new z.FilteredFiniteDifference(.6);this.screen=[new z.FilteredFiniteDifference(.4),new z.FilteredFiniteDifference(.4)];
this.scene=[new z.FilteredFiniteDifference(.6),new z.FilteredFiniteDifference(.6),new z.FilteredFiniteDifference(.6)];this.tmpDirection=D.create()}var d=g.prototype;d.add=function(a,c,e){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(e)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(c[0]),this.scene[1].update(c[1]),this.scene[2].update(c[2]),this.time.update(e))};d.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();
this.scene[1].reset();this.scene[2].reset();this.time.reset()};d.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var a=this.screen[0].filteredDelta;const c=this.screen[1].filteredDelta;a=Math.sqrt(a*a+c*c)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};d.createMomentum=function(a,c,e){B.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);
const f=B.length(this.tmpDirection);0<f&&B.scale(this.tmpDirection,this.tmpDirection,1/f);return new l(a,c,e,f/this.time.filteredDelta,this.tmpDirection)};return g}();t.PanPlanarMomentum=l;t.PanPlanarMomentumEstimator=y;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(t,u){let B=function(){function D(y){this.gain=y}var z=D.prototype;z.update=function(y){if(this.hasLastValue){const l=
this.computeDelta(y);this._updateDelta(l)}this.lastValue=y};z.reset=function(){this.filteredDelta=this.lastValue=void 0};z.computeDelta=function(y){return y-this.lastValue};z._updateDelta=function(y){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*y:y};u._createClass(D,[{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}}]);return D}();t.FilteredFiniteDifference=B;Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(t,u){let B=function(){function D(y,l,g){this._initialVelocity=y;this._stopVelocity=l;this._friction=g;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var z=D.prototype;z.isFinished=function(y){return y>this.duration};z.value=function(y){return this.valueFromInitialVelocity(this._initialVelocity,
y)};z.valueDelta=function(y,l){const g=this.value(y);return this.value(y+l)-g};z.valueFromInitialVelocity=function(y,l){l=Math.min(l,this.duration);const g=1-this.friction;return y*(g**l-1)/Math.log(g)};u._createClass(D,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return D}();t.Momentum=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m){B=function(b){function h(r){var x=b.call(this,r)||this;x._animationTime=0;x._momentumFinished=!1;x._rotationMomentumEstimator=new k.RotationMomentumEstimator(.6,.15,.95);x._rotationDirection=1;x._zoomDirection=1;x._zoomMomentumEstimator=new p.ZoomMomentumEstimator;x._zoomOnly=null;x.zoomMomentum=null;x.rotateMomentum=null;x.viewpoint=new D({targetGeometry:new m,scale:0,rotation:0});x.watch("_momentumFinished",q=>{q&&x.navigation.stop()});return x}t._inheritsLoose(h,
b);var n=h.prototype;n.begin=function(r,x){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=x.angle;this._previousRadius=this._startRadius=x.radius;this._previousCenter=x.center;this._updateTimestamp=null;r.constraints.rotationEnabled&&this.addToRotateEstimator(0,x.timestamp);this.addToZoomEstimator(x,1)};n.update=function(r,x){null===this._updateTimestamp&&(this._updateTimestamp=x.timestamp);
const q=x.angle,A=x.radius,E=x.center,F=Math.abs(180*(q-this._startAngle)/Math.PI),w=Math.abs(A-this._startRadius),v=this._startRadius/A;if(this._previousRadius){const C=A/this._previousRadius;let G=180*(q-this._previousAngle)/Math.PI;this._rotationDirection=0<=G?1:-1;this._zoomDirection=1<=C?1:-1;r.constraints.rotationEnabled?(null===this._zoomOnly&&200<x.timestamp-this._updateTimestamp&&(this._zoomOnly=0<w-F),null===this._zoomOnly||this._zoomOnly?G=0:this.addToRotateEstimator(q-this._startAngle,
x.timestamp)):G=0;this.addToZoomEstimator(x,v);this.navigation.setViewpoint([E.x,E.y],1/C,G,[this._previousCenter.x-E.x,E.y-this._previousCenter.y])}this._previousAngle=q;this._previousRadius=A;this._previousCenter=E};n.end=function(r){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(r);this.navigation.end()};n.addToRotateEstimator=
function(r,x){this._rotationMomentumEstimator.add(r,.001*x)};n.addToZoomEstimator=function(r,x){this._zoomMomentumEstimator.add(x,.001*r.timestamp)};n.canZoomIn=function(r){const x=r.scale;r=r.constraints.effectiveMaxScale;return 0===r||x>r};n.canZoomOut=function(r){const x=r.scale;r=r.constraints.effectiveMinScale;return 0===r||x<r};n.onAnimationUpdate=function(r){this.navigation.animationManager.animateContinous(r.viewpoint,(x,q)=>{var A=!this.canZoomIn(r)&&1<this._zoomDirection||!this.canZoomOut(r)&&
1>this._zoomDirection,E=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);A=A||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);q*=.001;this._momentumFinished=E&&A;if(!this._momentumFinished){E=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,q))*this._rotationDirection*180/Math.PI:0;A=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,q)):1;const w=e.create();var F=e.create();if(this._previousCenter){c.set(w,
this._previousCenter.x,this._previousCenter.y);f.getPaddingScreenTranslation(F,r.size,r.padding);c.add(w,w,F);const {constraints:v,scale:C}=r;F=C*A;1>A&&!v.canZoomInTo(F)?(A=C/v.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<A&&!v.canZoomOutTo(F)&&(A=C/v.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);f.scaleAndRotateBy(x,r.viewpoint,A,E,w,r.size);r.constraints.constrainByGeometry(x)}}this._animationTime+=q})};n.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return h}(z);u.__decorate([y.property()],B.prototype,"_momentumFinished",void 0);u.__decorate([y.property()],B.prototype,"viewpoint",void 0);u.__decorate([y.property()],B.prototype,"navigation",void 0);return B=u.__decorate([a.subclass("esri.views.2d.navigation.actions.Pinch")],B)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(t,u,B){B=function(D){function z(y=3,l=.01,g=.95,d=12){return D.call(this,y,l,g,d)||this}u._inheritsLoose(z,D);z.prototype.add=function(y,l){if(this.value.hasLastValue){const g=this.value.lastValue;for(y-=g;y>Math.PI;)y-=2*Math.PI;for(;y<-Math.PI;)y+=2*Math.PI;y=g+y}D.prototype.add.call(this,y,l)};return z}(B.MomentumEstimator);t.RotationMomentumEstimator=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/navigation/MomentumEstimator":function(){define(["exports",
"../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(t,u,B,D){let z=function(){function y(g=2.5,d=.01,a=.95,c=12){this.minimumInitialVelocity=g;this.stopVelocity=d;this.friction=a;this.maxVelocity=c;this.enabled=!0;this.value=new B.FilteredFiniteDifference(.8);this.time=new B.FilteredFiniteDifference(.3)}var l=y.prototype;l.add=function(g,d){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(d))return;if(this.value.hasFilteredDelta){const a=this.value.computeDelta(g);
0>this.value.filteredDelta*a&&this.value.reset()}}this.time.update(d);this.value.update(g)}};l.reset=function(){this.value.reset();this.time.reset()};l.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;let g=this.value.filteredDelta/this.time.filteredDelta;g=u.clamp(g,-this.maxVelocity,this.maxVelocity);return Math.abs(g)<this.minimumInitialVelocity?null:this.createMomentum(g,this.stopVelocity,this.friction)};l.createMomentum=function(g,d,a){return new D.Momentum(g,
d,a)};return y}();t.MomentumEstimator=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(t,u,B,D){let z=function(y){function l(d,a,c){return y.call(this,d,a,c)||this}u._inheritsLoose(l,y);var g=l.prototype;g.value=function(d){d=y.prototype.value.call(this,d);return Math.exp(d)};g.valueDelta=function(d,a){const c=y.prototype.value.call(this,
d);d=y.prototype.value.call(this,d+a);return Math.exp(d-c)};return l}(B.Momentum);B=function(y){function l(d=2.5,a=.01,c=.95,e=12){return y.call(this,d,a,c,e)||this}u._inheritsLoose(l,y);var g=l.prototype;g.add=function(d,a){y.prototype.add.call(this,Math.log(d),a)};g.createMomentum=function(d,a,c){return new z(d,a,c)};return l}(D.MomentumEstimator);t.ZoomMomentum=z;t.ZoomMomentumEstimator=B;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k){const p=e.create(),m=e.create();B=function(b){function h(r){r=b.call(this,r)||this;r._previousCenter=e.create();r.viewpoint=new D({targetGeometry:new k,scale:0,rotation:0});return r}t._inheritsLoose(h,b);var n=h.prototype;n.begin=function(r,x){this.navigation.begin();c.set(this._previousCenter,x.center.x,x.center.y)};n.update=function(r,x){const {state:{size:q,padding:A}}=r;c.set(p,x.center.x,x.center.y);f.getAnchor(m,q,A);r.viewpoint=f.rotateBy(this.viewpoint,
r.state.paddedViewState.viewpoint,f.angleBetween(m,this._previousCenter,p));c.copy(this._previousCenter,p)};n.end=function(){this.navigation.end()};return h}(z);u.__decorate([y.property()],B.prototype,"viewpoint",void 0);u.__decorate([y.property()],B.prototype,"navigation",void 0);return B=u.__decorate([a.subclass("esri.views.2d.actions.Rotate")],B)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../chunks/mat3f32 ../engine/DisplayObject ../engine/webgl/DefaultVertexAttributeLayouts ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources ../../webgl/BufferObject ../../webgl/enums ../../webgl/Texture ../../webgl/VertexArrayObject".split(" "),
function(t,u,B,D,z,y,l,g,d,a,c,e,f,k,p,m,b,h){return function(n){function r(){var q=n.call(this)||this;q._handles=new B;q._resourcePixelRatio=1;q.visible=!1;return q}t._inheritsLoose(r,n);var x=r.prototype;x.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};x._createTransforms=function(){return{dvs:d.create()}};x.doRender=function(q){const A=q.context;if(!this._resourcesTask)this._reloadResources();
else if(q.drawPhase===e.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(q);var E=this._magnifier;if(!z.isNone(E.position)){var F=q.pixelRatio,w=E.size*F,v=Math.ceil(1/E.factor*w);this._readbackTexture.resize(v,v);var {size:C}=q.state;q=F*C[0];C=F*C[1];var G=.5*v,H=.5*v,L=D.clamp(F*E.position.x,G,q-G-1),O=D.clamp(C-F*E.position.y,H,C-H-1);A.setBlendingEnabled(!0);G=L-G;H=O-H;var N=this._readbackTexture;A.bindTexture(N,0);A.gl.copyTexImage2D(N.descriptor.target,0,N.descriptor.pixelFormat,
G,H,v,v,0);var K=(v=null==(K=this.background)?void 0:K.color)?[v.a*v.r/255,v.a*v.g/255,v.a*v.b/255,v.a]:[1,1,1,1];v=-1+(L+E.offset.x*F)/q*2;F=-1+(O-E.offset.y*F)/C*2;q=w/q*2;w=w/C*2;C=this._program;A.bindVAO(this._vertexArrayObject);A.bindTexture(this._overlayTexture,6);A.bindTexture(this._maskTexture,7);A.useProgram(C);C.setUniform4fv("u_background",K);C.setUniform1i("u_readbackTexture",0);C.setUniform1i("u_overlayTexture",6);C.setUniform1i("u_maskTexture",7);C.setUniform4f("u_drawPos",v,F,q,w);
C.setUniform1i("u_maskEnabled",E.maskEnabled?1:0);C.setUniform1i("u_overlayEnabled",E.overlayEnabled?1:0);A.setStencilTestEnabled(!1);A.setColorMask(!0,!0,!0,!0);A.drawArrays(m.PrimitiveType.TRIANGLE_STRIP,0,4);A.bindVAO()}}};x._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};x._reloadResources=function(){var q=this;this._resourcesTask&&this._resourcesTask.abort();const A=z.isSome(this._magnifier)?this._magnifier.maskUrl:null,E=z.isSome(this._magnifier)?this._magnifier.overlayUrl:
null;this._resourcesTask=y.createTask(function(){var F=t._asyncToGenerator(function*(w){const v=z.isNone(A)||z.isNone(E)?k.loadMagnifierResources(w):null,C=z.isSome(A)?u(A,{responseType:"image",signal:w}).then(L=>L.data):v.then(L=>L.mask);w=z.isSome(E)?u(E,{responseType:"image",signal:w}).then(L=>L.data):v.then(L=>L.overlay);const [G,H]=yield Promise.all([C,w]);q.mask=G;q.overlay=H;q._disposeRenderResources();q.requestRender()});return function(w){return F.apply(this,arguments)}}())};x._disposeRenderResources=
function(){this._readbackTexture=z.disposeMaybe(this._readbackTexture);this._overlayTexture=z.disposeMaybe(this._overlayTexture);this._maskTexture=z.disposeMaybe(this._maskTexture);this._vertexArrayObject=z.disposeMaybe(this._vertexArrayObject);this._program=z.disposeMaybe(this._program)};x._updateResources=function(q){q.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var A=q.context;this._resourcePixelRatio=q.pixelRatio;var E=Math.ceil(this._magnifier.size*
q.pixelRatio);this._program=f.createMagnifierProgram(A);var F=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new h.VertexArrayObject(A,f.magnifierProgramTemplate.attributes,c.Pos2us,{geometry:p.BufferObject.createVertex(A,m.Usage.STATIC_DRAW,F)});this.overlay.width=E;this.overlay.height=E;this._overlayTexture=new b.Texture(A,{target:m.TextureType.TEXTURE_2D,pixelFormat:m.PixelFormat.RGBA,internalFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE,
samplingMode:m.TextureSamplingMode.NEAREST,flipped:!0,preMultiplyAlpha:l.isSVG(this.overlay.src)&&q.context.driverTest.svgAlwaysPremultipliesAlpha?!1:!0},this.overlay);this.mask.width=E;this.mask.height=E;this._maskTexture=new b.Texture(A,{target:m.TextureType.TEXTURE_2D,pixelFormat:m.PixelFormat.ALPHA,internalFormat:m.PixelFormat.ALPHA,dataType:m.PixelType.UNSIGNED_BYTE,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:m.TextureSamplingMode.NEAREST,flipped:!0},this.mask);q=1/this._magnifier.factor;
this._readbackTexture=new b.Texture(A,{target:m.TextureType.TEXTURE_2D,pixelFormat:m.PixelFormat.RGBA,internalFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:m.TextureSamplingMode.LINEAR,flipped:!1,width:Math.ceil(q*E),height:Math.ceil(q*E)})}};t._createClass(r,[{key:"background",get:function(){return this._background},set:function(q){this._background=q;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},
set:function(q){this._magnifier=q;this._handles.removeAll();this._handles.add([g.init(q,"version",()=>{this.visible=q.visible&&z.isSome(q.position)&&0<q.size;this.requestRender()}),q.watch(["mask","overlay"],()=>this._reloadResources()),q.watch("size",()=>{this._disposeRenderResources();this.requestRender()})])}}]);return r}(a.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/ProgramTemplate"],function(t,u,
B){const D={shaders:{vertexShader:u.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:u.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};t.createMagnifierProgram=function(z){return B.createProgram(z,D)};t.magnifierProgramTemplate=D;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../support/requestImageUtils"],function(t,
u,B,D,z){function y(){y=B._asyncToGenerator(function*(l){var g=new Promise((a,c)=>t(["./mask-svg"],e=>a(Object.freeze({__proto__:null,default:e})),c)),d=new Promise((a,c)=>t(["./overlay-svg"],e=>a(Object.freeze({__proto__:null,default:e})),c));g=z.requestImage((yield g).default,{signal:l});d=z.requestImage((yield d).default,{signal:l});d={mask:yield g,overlay:yield d};D.throwIfAborted(l);return d});return y.apply(this,arguments)}u.loadMagnifierResources=function(l){return y.apply(this,arguments)};
Object.defineProperty(u,"__esModule",{value:!0})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(t,u,B){function D(){D=u._asyncToGenerator(function*(z,y){({data:z}=yield B(z,{responseType:"image",...y}));return z});return D.apply(this,arguments)}t.requestImage=function(z,y){return D.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports","../../../chunks/mat4"],
function(t,u){t.mat4=u.mat4;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(t,u){t.mat4f32=u.mat4f32;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],function(t,u){t.vec3f32=u.vec3f32;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports",
"../../../chunks/vec4f32"],function(t,u){t.vec4f32=u.vec4f32;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ./DisplayObject ./ImageryBitmapSource ../../webgl/enums ../../webgl/Texture".split(" "),function(t,u,B,D,z,y,l,g,d,a){function c(k){return k&&"render"in k}function e(k){const p=document.createElement("canvas");
p.width=k.width;p.height=k.height;k.render(p.getContext("2d"));return p}function f(k,p,m){const b={target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,internalFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE};p&&m&&(b.width=p,b.height=m);return new a.Texture(k,b)}l=function(k){function p(b=null,h,n=!0){var r=k.call(this)||this;r.requestRenderOnSourceChangedEnabled=n;r._textureInvalidated=!0;r.stencilRef=0;r.coordScale=[1,1];r._height=
void 0;r.pixelRatio=1;r.resolution=0;r.rotation=0;r._source=null;r._width=void 0;r.x=0;r.y=0;r.blendFunction=h;r.source=b;r.requestRender=r.requestRender.bind(u._assertThisInitialized(r));return r}u._inheritsLoose(p,k);var m=p.prototype;m.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)};m.beforeRender=function(b){k.prototype.beforeRender.call(this,b);this.updateTexture(b.context)};m.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,
this.requestRenderOnSourceChangedEnabled&&this.requestRender())};m._createTransforms=function(){return{dvs:z.create()}};m.setTransform=function(b){const h=D.identity(this.transforms.dvs),[n,r]=b.toScreenNoRotation([0,0],[this.x,this.y]);var x=this.resolution/this.pixelRatio/b.resolution;const q=x*this.width;x*=this.height;const A=Math.PI*this.rotation/180;D.translate(h,h,y.fromValues(n,r));D.translate(h,h,y.fromValues(q/2,x/2));D.rotate(h,h,-A);D.translate(h,h,y.fromValues(-q/2,-x/2));D.scaleByVec2(h,
h,y.fromValues(q,x));D.multiply(this.transforms.dvs,b.displayViewMat3,h)};m.setSamplingProfile=function(b){this._texture&&(b.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(b.samplingMode))};m.bind=function(b,h){this._texture&&b.bindTexture(this._texture,h)};m.updateTexture=function(b){if(this.stage)this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||(this._texture=this.source?f(b,this.sourceWidth,this.sourceHeight):f(b)),(b=
this.source)?(this._texture.resize(this.sourceWidth,this.sourceHeight),c(b)?b instanceof g?(b=b.getRenderedRasterPixels(),this._texture.setData(B.isSome(b)?b.renderedRasterPixels:null)):this._texture.setData(e(b)):!b||"render"in b||this._texture.setData(b),this.ready()):this._texture.setData(null));else{var h;null==(h=this._texture)?void 0:h.dispose();this._texture=null}};m.onAttach=function(){this.invalidateTexture()};m.onDetach=function(){this.invalidateTexture()};u._createClass(p,[{key:"isSourceScaled",
get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(b){this._height=b}},{key:"source",get:function(){return this._source},set:function(b){this._source=b;this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof
HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(b){this._width=b}}]);return p}(l.DisplayObject);t.Bitmap=l;t.isImageSource=c;t.rasterize=e;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe"],function(t,u){return function(){function B(z,y,l){this.pixelBlock=
z;this.extent=y;this.originalPixelBlock=l}var D=B.prototype;D.render=function(z){var y=this.pixelBlock;if(!u.isNone(y)){var l=this.filter({pixelBlock:y});u.isNone(l.pixelBlock)||(y=l.pixelBlock.getAsRGBA(),l=z.createImageData(l.pixelBlock.width,l.pixelBlock.height),l.data.set(y),z.putImageData(l,0,0))}};D.getRenderedRasterPixels=function(){const z=this.filter({pixelBlock:this.pixelBlock});return u.isNone(z.pixelBlock)?null:{width:z.pixelBlock.width,height:z.pixelBlock.height,renderedRasterPixels:new Uint8Array(z.pixelBlock.getAsRGBA().buffer)}};
t._createClass(B,[{key:"width",get:function(){return u.isSome(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return u.isSome(this.pixelBlock)?this.pixelBlock.height:0}}]);return B}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],function(t,u,B,D,z){z=function(y){function l(){return y.apply(this,arguments)||this}u._inheritsLoose(l,y);l.prototype.prepareRenderPasses=
function(g){const d=g.registerRenderPass({name:"bitmap",brushes:[B.brushes.bitmap],target:()=>this.children,drawPhase:D.WGLDrawPhase.MAP});return[...y.prototype.prepareRenderPasses.call(this,g),d]};u._createClass(l,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(g=>"additive"===g.blendFunction)}}]);return l}(z);t.BitmapContainer=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../../../chunks/mat3f32","./Bitmap","./webgl/TiledDisplayObject"],function(t,u,B,D,z){z=function(y){function l(d,a,c,e,f,k=null){var p=y.call(this,d,a,c,e,f)||this;p.bitmap=new D.Bitmap(k,"standard",!1);p.bitmap.coordScale=[e,f];p.bitmap.once("isReady",()=>p.ready());return p}u._inheritsLoose(l,y);var g=l.prototype;g.destroy=function(){y.prototype.destroy.call(this);this.bitmap.destroy()};g.beforeRender=function(d){y.prototype.beforeRender.call(this,d);this.bitmap.beforeRender(d)};g.afterRender=
function(d){y.prototype.afterRender.call(this,d);this.bitmap.afterRender(d)};g._createTransforms=function(){return{dvs:B.create(),tileMat3:B.create()}};g.setTransform=function(d,a){y.prototype.setTransform.call(this,d,a);this.bitmap.transforms.dvs=this.transforms.dvs};g.onAttach=function(){this.bitmap.stage=this.stage};g.onDetach=function(){this.bitmap&&(this.bitmap.stage=null)};u._createClass(l,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(d){this.bitmap.stencilRef=
d}}]);return l}(z.TiledDisplayObject);t.BitmapTile=z;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),function(t,u,B,D,z,y,l){l=function(g){function d(){return g.apply(this,arguments)||this}u._inheritsLoose(d,g);var a=d.prototype;a.createTile=function(c){const e=this._tileInfoView.getTileBounds(B.create(),
c),[f,k]=this._tileInfoView.tileInfo.size;return new D.BitmapTile(c,e[0],e[3],f,k)};a.prepareRenderPasses=function(c){const e=c.registerRenderPass({name:"bitmap (tile)",brushes:[z.brushes.bitmap],target:()=>this.children.map(f=>f.bitmap),drawPhase:y.WGLDrawPhase.MAP});return[...g.prototype.prepareRenderPasses.call(this,c),e]};a.doRender=function(c){this.visible&&c.drawPhase===y.WGLDrawPhase.MAP&&g.prototype.doRender.call(this,c)};u._createClass(d,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(c=>
"additive"===c.bitmap.blendFunction)}}]);return d}(l.default);t.BitmapTileContainer=l;Object.defineProperty(t,"__esModule",{value:!0})})},"*noref":1}});
define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(t,u,B,D,z,y,l){t.Stage=u.Stage;t.LabelManager=B;t.GraphicsView2D=D;t.GraphicContainer=z;t.MapViewNavigation=y;t.MagnifierView2D=l;Object.defineProperty(t,"__esModule",{value:!0})});