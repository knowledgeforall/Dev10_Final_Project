(window.webpackJsonp_ember_auto_import_=window.webpackJsonp_ember_auto_import_||[]).push([[21],{1024:function(t,e,a){"use strict";(function(t){a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return i}))
var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}
function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e,a){return t(a={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},a.exports),a.exports}function i(t){if(t.__esModule)return t
var e=Object.defineProperty({},"__esModule",{value:!0})
return Object.keys(t).forEach((function(a){var n=Object.getOwnPropertyDescriptor(t,a)
Object.defineProperty(e,a,n.get?n:{enumerable:!0,get:function(){return t[a]}})})),e}}).call(this,a(76))},1025:function(t,e,a){"use strict"
a.d(e,"a",(function(){return n}))
const n=(t,...e)=>{e.forEach(e=>{if("function"!=typeof t[e])throw new Error(`Cannot bind context. ${e} must be a function`)
t[e]=t[e].bind(t)})}},1033:function(t,e,a){"use strict"
a.d(e,"a",(function(){return d}))
var n=a(1024)
const o={category:{content:{action:{delete:{category:"Content",action:"Delete"},create:{category:"Content",action:"Create",label:{upload:{category:"Content",action:"Create",label:"Upload"},url:{category:"Content",action:"Create",label:"URL"}}},update:{category:"Content",action:"Update",label:{groups:{category:"Content",action:"Update",label:"Groups"}}}}},interaction:{action:{open:{label:{popover:{details:{share:{category:"Interaction",action:"Open",label:"Popover",details:"Share"},details:{category:"Interaction",action:"Open",label:"Popover",details:"Details"},options:{category:"Interaction",action:"Open",label:"Popover",details:"Options"},help:{category:"Interaction",action:"Open",label:"Popover",details:"Help"}}},postList:{category:"Interaction",action:"Open",label:"Post List"},panel:{details:{legend:{category:"Interaction",action:"Open",label:"Panel",details:"Legend"}}},search:{category:"Interaction",action:"Open",label:"Search"},thread:{category:"Interaction",action:"Open",label:"Thread"},editor:{category:"Interaction",action:"Open",label:"Editor"},table:{category:"Interaction",action:"Open",label:"Table"},modal:{details:{newContent:{category:"Interaction",action:"Open",label:"Modal",details:"New Content"},addExistingContent:{category:"Interaction",action:"Open",label:"Modal",details:"Add Existing Content"},addContent:{category:"Interaction",action:"Open",label:"Modal",details:"Add Content"}}},locations:{category:"Interaction",action:"Open",label:"Locations"}}},download:{category:"Interaction",action:"Download",details:{cache:{category:"Interaction",action:"Download",details:"Cache"},export:{category:"Interaction",action:"Download",details:"Export"}}},share:{label:{link:{category:"Interaction",action:"Share",label:"Link"}}},zoom:{label:{in:{category:"Interaction",action:"Zoom",label:"In"},out:{category:"Interaction",action:"Zoom",label:"Out"},to:{category:"Interaction",action:"Zoom",label:"To"}}},close:{label:{postList:{category:"Interaction",action:"Close",label:"Post List"},thread:{category:"Interaction",action:"Close",label:"Thread"},panel:{details:{legend:{category:"Interaction",action:"Close",label:"Panel",details:"Legend"}}},search:{category:"Interaction",action:"Close",label:"Search"},editor:{category:"Interaction",action:"Close",label:"Editor",details:{addPost:{category:"Interaction",action:"Close",label:"Editor",details:"Add Post"}}},table:{category:"Interaction",action:"Close",label:"Table"},modal:{details:{addContent:{category:"Interaction",action:"Close",label:"Modal",details:"Add Content"},newContent:{category:"Interaction",action:"Close",label:"Modal",details:"New Content"},addExistingContent:{category:"Interaction",action:"Close",label:"Modal",details:"Add Existing Content"}}},locations:{category:"Interaction",action:"Close",label:"Locations"}}},search:{label:{query:{category:"Interaction",action:"Search",label:"Query",details:{focus:{category:"Interaction",action:"Search",label:"Query",details:"Focus"},loseFocus:{category:"Interaction",action:"Search",label:"Query",details:"Lose Focus"}}},filter:{category:"Interaction",action:"Search",label:"Filter",details:{clear:{category:"Interaction",action:"Search",label:"Filter",details:"Clear"}}},click:{category:"Interaction",action:"Search",label:"Click"},loadMore:{category:"Interaction",action:"Search",label:"Load More"}}},update:{label:{categoryCard:{category:"Interaction",action:"Update",label:"Category Card"}}},viewed:{label:{recents:{category:"Interaction",action:"Viewed",label:"Recents"},empty:{category:"Interaction",action:"Viewed",label:"Empty"},post:{details:{thread:{category:"Interaction",action:"Viewed",label:"Post",details:"Thread"},postList:{category:"Interaction",action:"Viewed",label:"Post",details:"Post List"}}},filters:{details:{hostedDownloadsDisabled:{category:"Interaction",action:"Viewed",label:"Filters",details:"Hosted Downloads Disabled"},hostedDownloadsEnabled:{category:"Interaction",action:"Viewed",label:"Filters",details:"Hosted Downloads Enabled"}}}}},enable:{label:{draw:{category:"Interaction",action:"Enable",label:"Draw",details:{update:{category:"Interaction",action:"Enable",label:"Draw",details:"Update"}}},select:{category:"Interaction",action:"Enable",label:"Select"}}},disable:{label:{draw:{category:"Interaction",action:"Disable",label:"Draw",details:{update:{category:"Interaction",action:"Disable",label:"Draw",details:"Update"}}},select:{category:"Interaction",action:"Disable",label:"Select"}}},select:{label:{content:{category:"Interaction",action:"Select",label:"Content",details:{selectTool:{category:"Interaction",action:"Select",label:"Content",details:"Select Tool"}}},groups:{category:"Interaction",action:"Select",label:"Groups",details:{recents:{category:"Interaction",action:"Select",label:"Groups",details:"Recents"}}}}},draw:{label:{start:{details:{polygon:{category:"Interaction",action:"Draw",label:"Start",details:"Polygon"},polyline:{category:"Interaction",action:"Draw",label:"Start",details:"Polyline"},point:{category:"Interaction",action:"Draw",label:"Start",details:"Point"}}},complete:{details:{polygon:{category:"Interaction",action:"Draw",label:"Complete",details:"Polygon"},polyline:{category:"Interaction",action:"Draw",label:"Complete",details:"Polyline"},point:{category:"Interaction",action:"Draw",label:"Complete",details:"Point"}}},delete:{details:{polygon:{category:"Interaction",action:"Draw",label:"Delete",details:"Polygon"},polyline:{category:"Interaction",action:"Draw",label:"Delete",details:"Polyline"},point:{category:"Interaction",action:"Draw",label:"Delete",details:"Point"}}},update:{details:{polygon:{category:"Interaction",action:"Draw",label:"Update",details:"Polygon"},polyline:{category:"Interaction",action:"Draw",label:"Update",details:"Polyline"},point:{category:"Interaction",action:"Draw",label:"Update",details:"Point"}}}}},deselect:{label:{groups:{category:"Interaction",action:"Deselect",label:"Groups"}}}}},groups:{},navigation:{action:{view:{label:{content:{details:{dcat:{category:"Navigation",action:"View",label:"Content",details:"DCAT"},dcatUs11:{category:"Navigation",action:"View",label:"Content",details:"DCAT-US-1.1"},dcatAp201:{category:"Navigation",action:"View",label:"Content",details:"DCAT-AP-2.0.1"},about:{category:"Navigation",action:"View",label:"Content",details:"About"},library:{category:"Navigation",action:"View",label:"Content",details:"Library"}}},users:{details:{profile:{category:"Navigation",action:"View",label:"Users",details:"Profile"}}},groups:{details:{profile:{category:"Navigation",action:"View",label:"Groups",details:"Profile"},about:{category:"Navigation",action:"View",label:"Groups",details:"About"}}},search:{details:{sourceProjectSearch:{category:"Navigation",action:"View",label:"Search",details:"Source: Project Search"}}}}},external:{label:{hubStatus:{category:"Navigation",action:"External",label:"Hub Status"},itemDetails:{category:"Navigation",action:"External",label:"Item Details"},link:{category:"Navigation",action:"External",label:"Link"}}},edit:{label:{profile:{category:"Navigation",action:"Edit",label:"Profile"},thumbnail:{category:"Navigation",action:"Edit",label:"Thumbnail"},bio:{category:"Navigation",action:"Edit",label:"Bio"}}},onPage:{label:{overview:{category:"Navigation",action:"On Page",label:"Overview"},teams:{category:"Navigation",action:"On Page",label:"Teams"},content:{category:"Navigation",action:"On Page",label:"Content"},favorites:{category:"Navigation",action:"On Page",label:"Favorites"}}},new:{label:{content:{category:"Navigation",action:"New",label:"Content",details:{apps:{category:"Navigation",action:"New",label:"Content",details:"Apps"},feedback:{category:"Navigation",action:"New",label:"Content",details:"Feedback"},templates:{category:"Navigation",action:"New",label:"Content",details:"Templates"},event:{category:"Navigation",action:"New",label:"Content",details:"Event"}}},groups:{category:"Navigation",action:"New",label:"Groups"}}}}},users:{},org:{}}},r={category:{CONTENT:"Content",INTERACTION:"Interaction",GROUPS:"Groups",NAVIGATION:"Navigation",USERS:"Users",ORG:"Org"},action:{DOWNLOAD:"Download",VIEW:"View",OPEN:"Open",SHARE:"Share",ZOOM:"Zoom",CLOSE:"Close",SEARCH:"Search",UPDATE:"Update",EXTERNAL:"External",DELETE:"Delete",VIEWED:"Viewed",CREATE:"Create",ENABLE:"Enable",DISABLE:"Disable",SELECT:"Select",DRAW:"Draw",DESELECT:"Deselect",EDIT:"Edit",ON_PAGE:"On-Page",NEW:"New"},label:{CONTENT:"Content",POPOVER:"Popover",LINK:"Link",IN:"In",OUT:"Out",POST_LIST:"Post List",THREAD:"Thread",PANEL:"Panel",QUERY:"Query",CATEGORY_CARD:"Category Card",SEARCH:"Search",TO:"To",HUB_STATUS:"Hub Status",RECENTS:"Recents",EMPTY:"Empty",EDITOR:"Editor",POST:"Post",TABLE:"Table",USERS:"Users",GROUPS:"Groups",DRAW:"Draw",SELECT:"Select",START:"Start",COMPLETE:"Complete",DELETE:"Delete",FILTER:"Filter",UPDATE:"Update",MODAL:"Modal",ITEM_DETAILS:"Item Details",UPLOAD:"Upload",URL:"URL",FILTERS:"Filters",PROFILE:"Profile",THUMBNAIL:"Thumbnail",OVERVIEW:"Overview",TEAMS:"Teams",FAVORITES:"Favorites",BIO:"Bio",CLICK:"Click",LOAD_MORE:"Load More",LOCATIONS:"Locations"},details:{DCAT:"DCAT",DCAT_US_1_1:"DCAT-US-1.1",DCAT_AP_2_0_1:"DCAT-AP-2.0.1",SHARE:"Share",CACHE:"Cache",EXPORT:"Export",LEGEND:"Legend",FOCUS:"Focus",LOSE_FOCUS:"Lose Focus",THREAD:"Thread",POST_LIST:"Post List",DETAILS:"Details",PROFILE:"Profile",OPTIONS:"Options",SELECT_TOOL:"Select Tool",POLYGON:"Polygon",POLYLINE:"Polyline",POINT:"Point",CLEAR:"Clear",UPDATE:"Update",HELP:"Help",RECENTS:"Recents",ADD_POST:"Add Post",ADD_CONTENT:"Add Content",NEW_CONTENT:"New Content",ADD_EXISTING_CONTENT:"Add Existing Content",ABOUT:"About",HOSTED_DOWNLOADS_DISABLED:"Hosted Downloads Disabled",HOSTED_DOWNLOADS_ENABLED:"Hosted Downloads Enabled",LIBRARY:"Library",SOURCE_PROJECT_SEARCH:"Source: Project Search",APPS:"Apps",FEEDBACK:"Feedback",TEMPLATES:"Templates",EVENT:"Event",MORE:"More",LESS:"Less",RESET:"Reset",DATE_UPDATED:"Date Updated"},element:{ACTIONS_MENU:"Actions Menu",CONTENT_HERO:"Content Hero",DOWNLOAD_CARD:"Download Card",EXPLORE_ALL_CONTENT:"Explore All Content",RESULTS_LIST:"Results List",ON_PAGE:"On-Page",RESET_FILTERS:"Reset Filters",CHIPS:"Chips"},response:{SUCCESS:"Success",FAILURE:"Failure"}}
var i=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.defaultDimensions=void 0,e.defaultDimensions={CATEGORY:"category",ACTION:"action",LABEL:"label"}})),s=Object(n.c)((function(t,e){var a=n.a&&n.a.__createBinding||(Object.create?function(t,e,a,n){void 0===n&&(n=a),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,n){void 0===n&&(n=a),t[n]=e[a]}),o=n.a&&n.a.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||a(e,t,n)}
Object.defineProperty(e,"__esModule",{value:!0}),o(i,e)})),l=Object(n.c)((function(t,e){var a,o=n.a&&n.a.__assign||function(){return(o=Object.assign||function(t){for(var e,a=1,n=arguments.length;a<n;a++)for(var o in e=arguments[a])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])
return t}).apply(this,arguments)},r=n.a&&n.a.__spreadArray||function(t,e,a){if(a||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o])
return t.concat(n||Array.prototype.slice.call(e))}
Object.defineProperty(e,"__esModule",{value:!0}),e.customDimensionsConfig=e.constantDimensions=e.dictionaryDimensions=e.dimensions=void 0,e.dimensions=o(o({},s.defaultDimensions),{DETAILS:"details",USER_TYPE:"userType",ID:"id",TYPE:"type",ORGANIZATION_ID:"organizationId",GROUP_ID:"groupId",GROUP_ACCESS:"groupAccess",GROUP_TYPE:"groupType",SEARCH:"search",GROUP_ORG_ID:"groupOrgId",SITE_ID:"siteId",ACCESS:"access",CONTENT_ORG_ID:"contentOrgId",ELEMENT:"element",RESPONSE:"response",POST_ID:"postId",PARENT_ID:"parentId",CHANNEL_ID:"channelId",CHANNEL_ACCESS:"channelAccess"}),e.dictionaryDimensions=[e.dimensions.CATEGORY,e.dimensions.ACTION,e.dimensions.LABEL,e.dimensions.DETAILS],e.constantDimensions=r(r([],e.dictionaryDimensions,!0),[e.dimensions.ELEMENT,e.dimensions.RESPONSE],!1),e.customDimensionsConfig=((a={})[e.dimensions.DETAILS]=1,a[e.dimensions.USER_TYPE]=2,a[e.dimensions.ID]=3,a[e.dimensions.TYPE]=4,a[e.dimensions.ORGANIZATION_ID]=5,a[e.dimensions.GROUP_ID]=6,a[e.dimensions.GROUP_ACCESS]=7,a[e.dimensions.GROUP_TYPE]=8,a[e.dimensions.SEARCH]=9,a[e.dimensions.GROUP_ORG_ID]=10,a[e.dimensions.SITE_ID]=11,a[e.dimensions.ACCESS]=12,a[e.dimensions.CONTENT_ORG_ID]=13,a[e.dimensions.ELEMENT]=14,a[e.dimensions.RESPONSE]=15,a[e.dimensions.POST_ID]=16,a[e.dimensions.PARENT_ID]=17,a[e.dimensions.CHANNEL_ID]=18,a[e.dimensions.CHANNEL_ACCESS]=19,a)})),c=Object(n.c)((function(t,e){var a
Object.defineProperty(e,"__esModule",{value:!0}),e.customMetricsConfig=e.metrics=void 0,e.metrics={POSITION:"position",SIZE:"size",DURATION:"duration",COUNT:"count"},e.customMetricsConfig=((a={})[e.metrics.POSITION]=1,a[e.metrics.SIZE]=2,a[e.metrics.DURATION]=3,a[e.metrics.COUNT]=4,a)})),d=Object(n.c)((function(t,e){var a=n.a&&n.a.__importDefault||function(t){return t&&t.__esModule?t:{default:t}}
Object.defineProperty(e,"__esModule",{value:!0}),e.constants=e.dictionary=e.customMetricsConfig=e.customDimensionsConfig=void 0
var i=a(o),s=a(r)
Object.defineProperty(e,"customDimensionsConfig",{enumerable:!0,get:function(){return l.customDimensionsConfig}}),Object.defineProperty(e,"customMetricsConfig",{enumerable:!0,get:function(){return c.customMetricsConfig}}),e.dictionary=i.default,e.constants=s.default}))},1036:function(t,e,a){"use strict"
a.d(e,"a",(function(){return l})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return s})),a.d(e,"d",(function(){return i}))
var n=a(62),o=a(325)
function r(t){return Object(n.e)(Object(o.a)(t.url),t)}function i(t){const[e,a]=t?t.split("_"):[]
return{itemId:e,layerId:a}}function s(t){const{itemId:e}=i(t)
return!(!e||(a=e,"{"===a[0]&&(a=a.substring(1,a.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}[-]?[0-9a-fA-F]{4}[-]?[0-9a-fA-F]{4}[-]?[0-9a-fA-F]{4}[-]?[0-9a-fA-F]{12}(\}){0,1}$/gi.test(a)))
var a}function l(t,e){return/.+::.+/.test(t)?t:`${e}::${t}`}},1043:function(t,e,a){"use strict"
a.d(e,"a",(function(){return l})),a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return c}))
var n=a(55),o=a(124),r=a(62),i=a(327)
function s(t,e){var a=Object(o.a)(e)+"/community/groups/"+t,i=Object(n.a)({httpMethod:"GET"},e)
return Object(r.e)(a,i)}function l(t,e){var a=Object(o.a)(e)+"/community/groups/"+t+"/users",i=Object(n.a)({httpMethod:"GET"},e)
return Object(r.e)(a,i)}function c(t,e){var a=Object(o.a)(e)+"/community/groups/"+t+"/userlist",n=Object(i.a)(e||{},["name","num","start","sortField","sortOrder","joined","memberType"],{httpMethod:"GET"})
return Object(r.e)(a,n)}},1052:function(t,e,a){"use strict"
a.d(e,"a",(function(){return r}))
var n=a(62),o=a(325)
function r(t){return Object(n.e)(Object(o.a)(t.url),t)}},1056:function(t,e,a){"use strict"
a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return l}))
var n=a(124),o=a(327),r=a(62)
function i(t){console&&console.warn&&console.warn.apply(console,[t])}var s=function(){function t(t){void 0===t&&(t=""),this.termStack=[],this.rangeStack=[],this.openGroups=0,this.q=t}return t.prototype.match=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]
return this.termStack=this.termStack.concat(t),this},t.prototype.in=function(t){var e="`in("+(t?'"'+t+'"':"")+")`"
return this.hasRange||this.hasTerms?(t&&"*"!==t&&(this.q+=t+":"),this.commit()):(i(e+" was called with no call to `match(...)` or `from(...)`/`to(...)`. Your query was not modified."),this)},t.prototype.startGroup=function(){return this.commit(),this.openGroups>0&&(this.q+=" "),this.openGroups++,this.q+="(",this},t.prototype.endGroup=function(){return this.openGroups<=0?(i("`endGroup(...)` was called without calling `startGroup(...)` first. Your query was not modified."),this):(this.commit(),this.openGroups--,this.q+=")",this)},t.prototype.and=function(){return this.addModifier("and")},t.prototype.or=function(){return this.addModifier("or")},t.prototype.not=function(){return this.addModifier("not")},t.prototype.from=function(t){return this.hasTerms?(i('`from(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01").  Your query was not modified.'),this):(this.rangeStack[0]=t,this)},t.prototype.to=function(t){return this.hasTerms?(i('`to(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01"). Your query was not modified.'),this):(this.rangeStack[1]=t,this)},t.prototype.boost=function(t){return this.commit(),this.q+="^"+t,this},t.prototype.toParam=function(){return this.commit(),this.cleanup(),this.q},t.prototype.clone=function(){return this.commit(),this.cleanup(),new t(this.q+"")},t.prototype.addModifier=function(t){return this.currentModifer?(i("You have called `"+this.currentModifer+"()` after `"+t+"()`. Your current query was not modified."),this):(this.commit(),""===this.q&&"not"!==t?(i("You have called `"+t+"()` without calling another method to modify your query first. Try calling `match()` first."),this):(this.currentModifer=t,this.q+=""===this.q?"":" ",this.q+=t.toUpperCase()+" ",this))},t.prototype.needsQuotes=function(t){return/\s|:/g.test(t)},t.prototype.formatTerm=function(t){return t instanceof Date?t.getTime():"string"==typeof t&&this.needsQuotes(t)?'"'+t+'"':t},t.prototype.commit=function(){var t=this
return this.currentModifer=void 0,this.hasRange&&(this.q+="["+this.formatTerm(this.rangeStack[0])+" TO "+this.formatTerm(this.rangeStack[1])+"]",this.rangeStack=[void 0,void 0]),this.hasTerms&&(this.q+=this.termStack.map((function(e){return t.formatTerm(e)})).join(" "),this.termStack=[]),this},Object.defineProperty(t.prototype,"hasTerms",{get:function(){return this.termStack.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasRange",{get:function(){return this.rangeStack.length&&this.rangeStack[0]&&this.rangeStack[1]},enumerable:!1,configurable:!0}),t.prototype.cleanup=function(){if(this.openGroups>0)for(i("Automatically closing "+this.openGroups+" group(s). You can use `endGroup(...)` to remove this warning.");this.openGroups>0;)this.q+=")",this.openGroups--
var t=this.q
this.q=t.replace(/( AND ?| NOT ?| OR ?)*$/,""),t!==this.q&&i("`startGroup(...)` was called without calling `endGroup(...)` first. Your query was not modified."),this.q=this.q.replace(/(\(\))*/,"")},t}()
function l(t,e){var a,i
switch(a="string"==typeof t||t instanceof s?{httpMethod:"GET",params:{q:t}}:Object(o.a)(t,["q","num","start","sortField","sortOrder","searchUserAccess","searchUserName","filter","countFields","countSize","categories","categoryFilters"],{httpMethod:"GET"}),e){case"item":i="/search"
break
case"group":i="/community/groups"
break
case"groupContent":if("string"==typeof t||t instanceof s||!t.groupId)return Promise.reject(new Error("you must pass a `groupId` option to `searchGroupContent`"))
i="/content/groups/"+t.groupId+"/search"
break
default:i="/portals/self/users/search"}var c=Object(n.a)(a)+i
return Object(r.e)(c,a).then((function(a){return a.nextStart&&-1!==a.nextStart&&(a.nextPage=function(){var n
return"string"==typeof t||t instanceof s?n={q:t,start:a.nextStart}:(n=t).start=a.nextStart,l(n,e)}),a}))}},1065:function(t,e,a){"use strict"
a.d(e,"a",(function(){return o}))
var n=a(1056)
function o(t){return Object(n.b)(t,"item")}},1085:function(t,e,a){"use strict"
a.d(e,"a",(function(){return c})),a.d(e,"b",(function(){return d})),a.d(e,"c",(function(){return u})),a.d(e,"d",(function(){return h}))
var n=a(55),o=a(124),r=a(146),i=a(327),s=a(62),l=a(1043)
function c(t){return Object(r.d)(t).then((function(e){var a=Object(o.a)(t)+"/content/users/"+e+"/createFolder"
return t.params=Object(n.a)({title:t.title},t.params),Object(s.e)(a,t)}))}function d(t){return function(t){return t.multipart&&!t.filename?Promise.reject(new Error("The filename is required for a multipart request.")):Object(r.d)(t).then((function(e){var a=Object(o.a)(t)+"/content/users/"+e,l=a+"/addItem"
t.folderId&&(l=a+"/"+t.folderId+"/addItem"),t.params=Object(n.a)(Object(n.a)({},t.params),Object(r.i)(t.item))
var c=Object(i.a)(t,["owner","folderId","file","dataUrl","text","async","multipart","filename","overwrite"],{params:Object(n.a)({},t.params)})
return Object(s.e)(l,c)}))}(Object(n.a)({folderId:null},t))}function u(t){return Object(l.b)(t.groupId,t).then((function(t){return t.userMembership.memberType})).catch((function(){return"none"}))}function h(t){var e=function(t){var e=t.authentication.username,a=t.owner||e
return Object(o.a)(t)+"/content/users/"+encodeURIComponent(a)+"/items/"+t.id+"/share"}(t)
return function(t){var e=t.authentication.username
return(t.owner||e)===e}(t)?p(e,t):function(t){return t.authentication.getUser(t).then((function(t){return t&&"org_admin"===t.role&&!t.roleId}))}(t).then((function(a){if(a)return p(e,t)
throw Error("This item can not be shared by "+t.authentication.username+". They are neither the item owner nor an organization admin.")}))}function p(t,e){return e.params=Object(n.a)({org:!1,everyone:!1},e.params),"private"===e.access&&(e.params.groups=" "),"org"===e.access&&(e.params.org=!0),"public"===e.access&&(e.params.account=!0,e.params.everyone=!0),Object(s.e)(t,e)}},971:function(t,e,a){"use strict"
a.r(e),a.d(e,"hub_download_card",(function(){return z}))
var n=a(323),o=a(1024),r=a(1029),i=a(1033),s=a(1025),l=a(1050),c=a(326),d=a(146),u=a(1065),h=a(324),p=a(1056),f=a(1036),m=a(1052),g=a(124),b=a(62),y=a(1085),w=a(328)
function I(t){if(t>=0&&t<64)return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t]}a(1027),a(325),a(55),a(327),a(1043)
var E=function(t){let e
for(t=""+t,e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return null
let a=""
for(e=0;e<t.length;e+=3){const n=[void 0,void 0,void 0,void 0]
n[0]=t.charCodeAt(e)>>2,n[1]=(3&t.charCodeAt(e))<<4,t.length>e+1&&(n[1]|=t.charCodeAt(e+1)>>4,n[2]=(15&t.charCodeAt(e+1))<<2),t.length>e+2&&(n[2]|=t.charCodeAt(e+2)>>6,n[3]=63&t.charCodeAt(e+2))
for(let t=0;t<n.length;t++)void 0===n[t]?a+="=":a+=I(n[t])}return a}
const O={csv:{name:"CSV",itemTypes:["CSV","CSV Collection"],supportsProjection:!0},kml:{name:"KML",itemTypes:["KML","KML Collection"],supportsProjection:!1},shapefile:{name:"Shapefile",itemTypes:["Shapefile"],supportsProjection:!0},fileGeodatabase:{name:"File Geodatabase",itemTypes:["File Geodatabase"],supportsProjection:!0},geojson:{name:"GeoJson",itemTypes:["GeoJson"],supportsProjection:!1},excel:{name:"Excel",itemTypes:["Microsoft Excel"],supportsProjection:!0},featureCollection:{name:"Feature Collection",itemTypes:["Feature Collection"],supportsProjection:!0}}
function D(t,e){const{onlyTypes:a,layerId:n,spatialRefId:o}=function(t){return t?{onlyTypes:t.onlyTypes,layerId:t.layerId,spatialRefId:t.spatialRefId}:{}}(e),r=Object.keys(O).map(t=>O[t]),i=new Set(Object(h.e)(r.filter(t=>!t.supportsProjection).map(t=>t.itemTypes)))
let s
s=a||Object(h.e)(r.map(t=>t.itemTypes))
const l=(new p.a).startGroup().match(v(t)).in("typekeywords").and().match(S(n)).in("typekeywords").endGroup().and().startGroup()
return function(t,e){const{types:a,noProjectionItemTypes:n,spatialRefId:o}=e,r=(t,e)=>{e.startGroup().match(/\s/g.test(t)?t:`"${t}"`).in("type").and().match(C(((t,e)=>{let a="4326"
return t&&!n.has(e)&&(a=t),a})(o,t))).in("typekeywords").endGroup()}
a.forEach((e,n)=>{r(e,t),n<a.length-1&&t.or()})}(l,{types:s,spatialRefId:o,noProjectionItemTypes:i}),l.endGroup(),l.toParam()}function C(t){return"spatialRefId:"+function(t){if("object"==typeof t){const{wkid:e,wkt:a}=t
return e?e+"":E(a)}return t}(function(t){let e
try{e=JSON.parse(t)}catch(a){e=t}return e}(t))}function v(t){return"exportItem:"+t}function S(t){return t?"exportLayer:0"+t:"exportLayer:null"}var T=Object(o.c)((function(t){var e=Object.prototype.hasOwnProperty,a="~"
function n(){}function o(t,e,a){this.fn=t,this.context=e,this.once=a||!1}function r(t,e,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function")
var s=new o(n,r||t,i),l=a?a+e:e
return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function i(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(a=!1)),s.prototype.eventNames=function(){var t,n,o=[]
if(0===this._eventsCount)return o
for(n in t=this._events)e.call(t,n)&&o.push(a?n.slice(1):n)
return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},s.prototype.listeners=function(t){var e=a?a+t:t,n=this._events[e]
if(!n)return[]
if(n.fn)return[n.fn]
for(var o=0,r=n.length,i=new Array(r);o<r;o++)i[o]=n[o].fn
return i},s.prototype.listenerCount=function(t){var e=a?a+t:t,n=this._events[e]
return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,o,r,i){var s=a?a+t:t
if(!this._events[s])return!1
var l,c,d=this._events[s],u=arguments.length
if(d.fn){switch(d.once&&this.removeListener(t,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0
case 2:return d.fn.call(d.context,e),!0
case 3:return d.fn.call(d.context,e,n),!0
case 4:return d.fn.call(d.context,e,n,o),!0
case 5:return d.fn.call(d.context,e,n,o,r),!0
case 6:return d.fn.call(d.context,e,n,o,r,i),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c]
d.fn.apply(d.context,l)}else{var h,p=d.length
for(c=0;c<p;c++)switch(d[c].once&&this.removeListener(t,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context)
break
case 2:d[c].fn.call(d[c].context,e)
break
case 3:d[c].fn.call(d[c].context,e,n)
break
case 4:d[c].fn.call(d[c].context,e,n,o)
break
default:if(!l)for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h]
d[c].fn.apply(d[c].context,l)}}return!0},s.prototype.on=function(t,e,a){return r(this,t,e,a,!1)},s.prototype.once=function(t,e,a){return r(this,t,e,a,!0)},s.prototype.removeListener=function(t,e,n,o){var r=a?a+t:t
if(!this._events[r])return this
if(!e)return i(this,r),this
var s=this._events[r]
if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||i(this,r)
else{for(var l=0,c=[],d=s.length;l<d;l++)(s[l].fn!==e||o&&!s[l].once||n&&s[l].context!==n)&&c.push(s[l])
c.length?this._events[r]=1===c.length?c[0]:c:i(this,r)}return this},s.prototype.removeAllListeners=function(t){var e
return t?(e=a?a+t:t,this._events[e]&&i(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=a,s.EventEmitter=s,t.exports=s}))
class P extends Error{constructor(t,e,a){super(t),this.status=a,this.url=e}}function A(t){const{host:e,route:a,query:n}=t,o=e.endsWith("/")?e:e+"/",r=new URL(a,o)
return r.search=function(t={}){const e=Object.keys(t).filter(e=>void 0!==t[e]).reduce((e,a)=>(e[a]=t[a],e),{})
return new URLSearchParams(e).toString()}(n),r.toString()}function j(t){const{datasetId:e,format:a,spatialRefId:n,geometry:o,where:r}=t
return`${e}:${a}:${n}:${o}:${r}`}const R={Shapefile:"shp",CSV:"csv","File Geodatabase":"fgdb",GeoJson:"geojson",KML:"kml"}
function _(t){if(!R[t])throw new Error("Unsupported Hub download format: "+t)
return R[t]}function L(t){const{host:e,datasetId:a,spatialRefId:n,geometry:o,where:r}=t,i=A({host:e,route:`/api/v3/datasets/${a}/downloads`,query:{spatialRefId:n,formats:_(t.format),geometry:o?JSON.stringify(o):void 0,where:r}})
return fetch(i).then(t=>{const{ok:e,status:a,statusText:n}=t
if(!e)throw new P(n,i,a)
return t.json()}).then(e=>(function({data:t}){if(!t)throw new Error('Unexpected API response; no "data" property.')
if(!Array.isArray(t))throw new Error('Unexpected API response; "data" is not an array.')
if(t.length>1)throw new Error('Unexpected API response; "data" contains more than one download.')}(e),function(t,e){const{data:[a]}=t
if(!a)return{downloadId:e,status:"not_ready"}
const{attributes:{contentLastModified:n,lastModified:o,status:r,errors:i,contentLength:s,cacheTime:l,source:{lastEditDate:c}},links:{content:d}}=a
return{downloadId:e,contentLastModified:n,lastEditDate:c,lastModified:o,status:r,errors:i||[],downloadUrl:d,contentLength:s,cacheTime:l}}(e,j(t))))}class N{disablePoll(){clearInterval(this.pollTimer),this.pollTimer=null}activatePoll(t){const{downloadId:e,eventEmitter:a,pollingInterval:n,existingFileDate:o=new Date(0).toISOString()}=t,r=new Date(o).getTime()
this.pollTimer=setInterval(()=>{L(t).then(t=>{if(function(t,e){const{status:a,lastModified:n}=t,o=new Date(n).getTime()
return"ready"===a||"ready_unknown"===a&&o>e}(t,r))return a.emit(e+"ExportComplete",{detail:{metadata:t}}),this.disablePoll()
if(function(t){return t&&("error_updating"===t.status||"error_creating"===t.status)}(t)){const{errors:[n]}=t
return a.emit(e+"ExportError",{detail:{error:n,metadata:t}}),this.disablePoll()}}).catch(t=>(a.emit(e+"PollingError",{detail:{error:t,metadata:{status:"error"}}}),this.disablePoll()))},n)}}var x,U,M
!function(t){t.READY="ready",t.READY_UNKNOWN="ready_unknown",t.STALE="stale",t.NOT_READY="not_ready",t.LOCKED="locked",t.STALE_LOCKED="stale_locked",t.DISABLED="disabled",t.CREATING="creating",t.UPDATING="updating",t.ERROR_CREATING="error_creating",t.ERROR_UPDATING="error_updating",t.ERROR="error"}(x||(x={}))
class k extends Error{constructor(t){super(t),Object.setPrototypeOf(this,k.prototype)}}function G(t){const{downloadId:e,datasetId:a,exportCreated:n,spatialRefId:o,eventEmitter:r,authentication:i}=t,{itemId:s,layerId:l}=Object(f.d)(a),c=[v(s),S(l),"modified:"+n,C(o)]
return Object(w.b)({item:{id:e,typekeywords:c.join(",")},authentication:i}).then(()=>Object(y.d)({id:e,authentication:i,access:"private"})).then(()=>function(t){return function(t){var e=t.folderId,a=t.start,n=void 0===a?1:a,o=t.num,r=void 0===o?10:o,i=t.authentication,s=e?"/"+e:""
return Object(d.d)(t).then((function(e){return Object(g.a)(t)+"/content/users/"+e+s})).then((function(t){return Object(b.e)(t,{httpMethod:"GET",authentication:i,params:{start:n,num:r}})}))}({authentication:t}).then(e=>{const a=e.folders.find(t=>"item-exports"===t.title)
return a?{folder:a}:Object(y.a)({authentication:t,title:"item-exports"})}).then(t=>{const{folder:e}=t
return e.id})}(i)).then(t=>Object(w.a)({itemId:e,folderId:t,authentication:i})).catch(t=>{var a
if(!t||"CONT_0011"!==t.code)throw a={id:e,authentication:i},Object(d.d)(a).then((function(t){var e=Object(g.a)(a)+"/content/users/"+t+"/items/"+a.id+"/delete"
return Object(b.e)(e,a)})),new k(t.message)}).then(()=>r.emit(e+"ExportComplete",{detail:{metadata:{downloadId:e,status:x.READY,lastModified:(new Date).toISOString(),downloadUrl:A({host:i.portal,route:`content/items/${e}/data`,query:{token:i.token}})}}}))}class F{disablePoll(){clearInterval(this.pollTimer),this.pollTimer=null}activatePoll(t){const{downloadId:e,datasetId:a,format:n,spatialRefId:o,jobId:r,authentication:i,exportCreated:s,eventEmitter:l,pollingInterval:c}=t
this.pollTimer=setInterval(()=>{Object(d.e)({id:e,jobId:r,jobType:"export",authentication:i}).then(t=>"completed"===t.status?G({datasetId:a,format:n,authentication:i,downloadId:e,spatialRefId:o,exportCreated:s,eventEmitter:l}).then(()=>{this.disablePoll()}):"failed"===t.status?(l.emit(e+"ExportError",{detail:{error:new Error(t.statusMessage),metadata:{status:x.ERROR,errors:[new Error(t.statusMessage)]}}}),this.disablePoll()):void 0).catch(t=>(t instanceof k?l.emit(e+"ExportError",{detail:{error:t,metadata:{status:x.ERROR,errors:[t]}}}):l.emit(e+"PollingError",{detail:{error:t,metadata:{status:x.ERROR,errors:[t]}}}),this.disablePoll()))},c)}}function q(t){const{datasetId:e,spatialRefId:a,where:n}=t,o=e.split("_")[1]
if(!o)return a?{targetSR:{wkid:Number(a)}}:{}
const r=[{id:Number(o),where:n}]
return a?{layers:r,targetSR:{wkid:Number(a)}}:{layers:r}}function H(t){const{host:e,datasetId:a,format:n,spatialRefId:o,geometry:r,where:i,title:s,target:l,authentication:c}=t
return l&&"hub"!==l?function(t){const{datasetId:e,title:a,format:n,authentication:o}=t,[r]=e.split("_")
return function(t){var e=t.authentication,a=t.id,n=t.title,o=t.exportFormat,r=t.exportParameters
return Object(d.d)(t).then((function(e){return Object(g.a)(t)+"/content/users/"+e+"/export"})).then((function(t){return Object(b.e)(t,{httpMethod:"POST",authentication:e,params:{itemId:a,title:n,exportFormat:o,exportParameters:r}})}))}({id:r,exportFormat:n,exportParameters:q(t),title:a,authentication:o}).then(t=>{const{size:e,jobId:a,exportItemId:n}=t
return{downloadId:n,jobId:a,size:e,exportCreated:Date.now()}})}({datasetId:a,format:n,title:s,authentication:c,spatialRefId:o,where:i}):function(t){const{host:e,datasetId:a,spatialRefId:n,geometry:o,where:r}=t,i={spatialRefId:n,format:_(t.format),geometry:o,where:r},s=A({host:e,route:`/api/v3/datasets/${a}/downloads`})
return fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(t=>{const{ok:e,status:a,statusText:n}=t
if(!e)throw new P(n,s,a)}).then(()=>({downloadId:j(t)}))}({host:e,datasetId:a,format:n,spatialRefId:o,geometry:r,where:i})}function V(t){const{format:e,layerId:a,layers:n}=t
return function(t,e){return void 0===t&&e.length>1}(a,n)&&(t=>t===U.CSV||t===U.KML)(e)?e+" Collection":e}function Y(t){return t.map(t=>{const{editingInfo:{lastEditDate:e}={}}=t
return e}).filter(t=>void 0!==t).sort((t,e)=>e-t)[0]}function B(t){return t.catch(t=>{if("ArcGISAuthError"===t.name)return t.retry(()=>Promise.resolve(null),1)
throw t})}!function(t){t.Shapefile="Shapefile",t.CSV="CSV",t.KML="KML",t.GeoJson="GeoJson",t.Excel="Excel",t["File Geodatabase"]="File Geodatabase",t["Feature Collection"]="Feature Collection",t["Scene Package"]="Scene Package"}(U||(U={})),function(t){t.FeatureService="Feature Service",t.MapService="Map Service"}(M||(M={}))
const K={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1}
function $(t,e){return"hub"===t||!!e}const z=class{constructor(t){Object(n.j)(this,t),this.hubTelemetry=Object(n.e)(this,"hubTelemetry",7),this.hubDownloadCardSuccess=Object(n.e)(this,"hubDownloadCardSuccess",7),this.exportRequested=!1,this.contentLengthString=null,this.poller=null,this.target="hub",this.spatialRefId="4326",Object(s.a)(this,"exportDatasetComplete","exportDatasetError","exportPollingError","download","downloadKeyDown","exportDataset","exportDatasetKeyDown")}async componentWillLoad(){this.resetUndefinedProps(),await this.setLocalization(),this.setAuthentication(),await this.fetchMetadataAndSetState(),this.setTranslations()}buildDownloadTelemetry({isSuccess:t=!0,isCached:e=!0}={}){return Object.assign(Object.assign({},e?i.a.dictionary.category.interaction.action.download.details.cache:i.a.dictionary.category.interaction.action.download.details.export),{label:this.format,response:t?i.a.constants.response.SUCCESS:i.a.constants.response.FAILURE})}resetUndefinedProps(){["spatialRefId","where","geometry","filename","target"].forEach(t=>{this[t]="undefined"===this[t]?void 0:this[t]}),this.spatialRefId||(this.spatialRefId="4326")}async setLocalization(){this.intl=await r.a.loadIntlForComponent(this.element),this.dateTimeFormatter=new Intl.DateTimeFormat(this.intl.locale,K),this.setLabels()}setLabels(){this.labels=["buttonDownload","fileCreated","fileSize","buttonOptions","menuRequest"].reduce((t,e)=>(t[e]=this.intl.t(e),t),{})}setAuthentication(){this.username&&this.token&&(this.authentication=new l.a({username:this.username,portal:this.host+"/sharing/rest",token:this.token}),this.authentication.getToken=()=>new Promise(t=>{t(this.token)}))}setTranslations(){this.setContentLengthString()}setContentLengthString(){const{metadata:{contentLength:t}={}}=this
if(t){const e=function(t){const e=["Bytes","KB","MB","GB","TB"],a=t
if(0===a)return"n/a"
const n=Math.floor(Math.log(a)/Math.log(1024))
return 0===n?[a,e[n]]:[(a/1024**n).toFixed(1),e[n]]}(t)
this.contentLengthString="string"==typeof e?this.intl.t(e.toLowerCase()):`${e[0]} ${this.intl.t(e[1].toLowerCase())}`}}async watchHandler(){this.resetUndefinedProps(),await this.fetchMetadataAndSetState()}async disconnectedCallback(){this.resetUndefinedProps(),this.poller&&this.poller.disablePoll()}async fetchMetadataAndSetState(){this.poller&&this.poller.disablePoll()
const t=this.getServiceParams()
try{this.metadata=await function(t){const{host:e,datasetId:a,spatialRefId:n,format:o,geometry:r,where:i,target:s,authentication:l}=t
return s&&"hub"!==s?function(t){const{datasetId:e,authentication:a,format:n,spatialRefId:o,target:r,portal:i}=t,{itemId:s,layerId:l}=Object(f.d)(e)
let h,p,g,b
return Object(d.g)(s,{authentication:a,portal:i}).then(t=>{const{type:e,modified:o,url:r}=t
return b=t,p=o,g=e,function(t){const{format:e,layerId:a,url:n,type:o,modified:r,authentication:i,portal:s}=t
return o!==M.FeatureService&&o!==M.MapService?Promise.resolve({modified:r,format:e}):B(Object(m.a)({url:n,authentication:i,portal:s})).then(t=>{const e=(t.layers||[]).map(t=>B(Object(f.b)({url:`${n}/${t.id}`,authentication:i,portal:s})))
return Promise.all(e)}).then(t=>({format:V({format:e,layerId:a,layers:t}),modified:Y(t)}))}({url:r,authentication:a,type:e,modified:o,format:n,layerId:l,portal:i})}).then(t=>{const{modified:e,format:n}=t
return h=e,Object(u.a)({q:D(s,{layerId:l,onlyTypes:[n],spatialRefId:o}),num:1,sortField:"modified",sortOrder:"DESC",authentication:a,portal:i})}).then(t=>function(t){const{cachedDownload:e,serviceLastEditDate:a,authentication:n,target:o,item:r,format:i,portal:s}=t,l=void 0===a?void 0:new Date(a).toISOString(),{created:d,id:u}=e||{},h=function(t,e){return"portal"===t&&e&&(new Date).getTime()-e<=6e5}(o,a),p=function(t,e){const a=e?e.toLowerCase():"",n=!1!==Object(c.a)(t,"properties.downloadsConfig.enabled"),o=Object(c.a)(t,"properties.downloadsConfig.formats")||{},r=!o[a]||!1!==o[a].enabled
return!!n&&r}(r,i)?function(t,e,a){return e?t?t>e?a?x.STALE_LOCKED:x.STALE:x.READY:x.READY_UNKNOWN:a?x.LOCKED:x.NOT_READY}(a,d,h):x.DISABLED
return e?{downloadId:u,status:p,lastEditDate:l,contentLastModified:new Date(d).toISOString(),lastModified:new Date(d).toISOString(),downloadUrl:A({host:s||n.portal,route:`content/items/${u}/data`,query:{token:null==n?void 0:n.token}})}:{downloadId:j(t),status:p,lastEditDate:l}}({cachedDownload:t.results[0],datasetId:e,format:n,spatialRefId:o,serviceLastEditDate:h,itemModifiedDate:p,itemType:g,authentication:a,target:r,item:b,portal:i})).catch(t=>{throw t})}({portal:e+"/sharing/rest",datasetId:a,format:o,authentication:l,spatialRefId:n,target:s}):L({host:e,datasetId:a,format:o,spatialRefId:n,geometry:r,where:i})}(t),this.pollingEvent=new T,this.exportInProgress()&&this.poll()}catch(t){this.apiError=t}}getServiceParams(){const t={host:this.host,datasetId:this.datasetId,format:this.format,target:this.target,authentication:this.authentication,spatialRefId:this.spatialRefId}
return this.where&&(t.where=this.where),this.geometry&&(t.geometry=this.geometry),t}poll(){const t=this.getServiceParams()
this.pollingEvent.on(this.metadata.downloadId+"ExportComplete",this.exportDatasetComplete),this.pollingEvent.on(this.metadata.downloadId+"ExportError",this.exportDatasetError),this.pollingEvent.on(this.metadata.downloadId+"PollingError",this.exportPollingError),this.poller=function(t){const{target:e,downloadId:a,datasetId:n,jobId:o,format:r,authentication:i,exportCreated:s,eventEmitter:l,pollingInterval:c,spatialRefId:d,geometry:u,where:h,host:p,existingFileDate:f}=t
return e&&"hub"!==e?function(t){const e=new F
return e.activatePoll(t),e}({downloadId:a,datasetId:n,jobId:o,authentication:i,exportCreated:s,format:r,spatialRefId:d,eventEmitter:l,pollingInterval:c,geometry:u,where:h}):function(t){const e=new N
return e.activatePoll(t),e}({host:p,downloadId:a,datasetId:n,format:r,eventEmitter:l,pollingInterval:c,spatialRefId:d,geometry:u,where:h,existingFileDate:f})}(Object.assign(Object.assign({},t),{downloadId:this.metadata.downloadId,jobId:this.metadata.jobId,exportCreated:this.metadata.exportCreated,eventEmitter:this.pollingEvent,pollingInterval:5e3,existingFileDate:new Date(this.metadata.lastModified||0).toISOString()}))}async download(){if(this.metadata&&this.metadata.downloadUrl)try{const t=this.transferFile(this.metadata.downloadUrl)
return this.hubTelemetry.emit(this.buildDownloadTelemetry()),this.hubDownloadCardSuccess.emit(),t}catch(t){throw this.hubTelemetry.emit(this.buildDownloadTelemetry({isSuccess:!1})),t}return await this.exportDataset()}transferFile(t){return"Feature Collection"===this.format?window.open(t):window.location.href=t}async exportDataset(){this.exportRequested=!0,this.metadata.status=this.downloadCached()?"updating":"creating"
const t=Object.assign({title:this.filename},this.getServiceParams())
try{const e=await H(t)
this.metadata=Object.assign(Object.assign({},this.metadata),e),this.poll()}catch(t){this.apiError=t,this.metadata.status="error",this.metadata.errors=[t]}}exportDatasetComplete(t){if(this.exportDatasetHandler(t),this.hubTelemetry.emit(this.buildDownloadTelemetry({isCached:!1})),this.hubDownloadCardSuccess.emit(),this.exportRequested){const{downloadUrl:t}=this.metadata
if(t)return this.transferFile(t)}}exportDatasetError(t){this.exportDatasetHandler(t),this.hubTelemetry.emit(this.buildDownloadTelemetry({isSuccess:!1,isCached:!1}))}exportPollingError(t){this.apiError=t.detail.error,this.exportDatasetHandler(t),this.hubTelemetry.emit(this.buildDownloadTelemetry({isSuccess:!1,isCached:!1}))}exportDatasetHandler(t){this.metadata=Object.assign(Object.assign({},this.metadata),t.detail.metadata),this.pollingEvent.off(this.metadata.downloadId+"ExportComplete",this.exportDatasetComplete),this.pollingEvent.off(this.metadata.downloadId+"ExportError",this.exportDatasetError),this.pollingEvent.off(this.metadata.downloadId+"PollingError",this.exportDatasetError)}renderNotice(){const{metadata:t,apiError:e,exportRequested:a}=this,{status:o}=t||{}
let r=o
"locked"===o?r="not_ready":"stale_locked"===o&&(r="stale")
const i=e?e.status||e.message:void 0
return Object(n.h)("hub-download-notice",{"api-error":i,"cannot-export":!$(this.target,this.username),"export-requested":a,"file-status":r})}exportInProgress(){const{metadata:{status:t}={}}=this
return"creating"===t||"updating"===t}downloadCached(){const{metadata:{status:t}={}}=this
return["ready","ready_unknown","stale","stale_locked","updating","error_updating"].includes(t)}downloadUpToDate(){return this.metadata&&"ready"===this.metadata.status}isFormatDownloadDisabled(){return this.metadata&&"disabled"===this.metadata.status}renderFileDescription(){const t=[],{metadata:{lastModified:e}={}}=this
return this.downloadCached()?(e&&("rtl"===this.intl.direction?t.push(Object(n.h)("dt",null,this.dateTimeFormatter.format(new Date(e))),Object(n.h)("dd",{class:"rtl"},this.labels.fileCreated)):t.push(Object(n.h)("dt",{class:"ltr"},this.labels.fileCreated),Object(n.h)("dd",null,this.dateTimeFormatter.format(new Date(e))))),this.contentLengthString&&("rtl"===this.intl.direction?t.push(Object(n.h)("dt",null,this.contentLengthString),Object(n.h)("dd",{class:"rtl"},this.labels.fileSize)):t.push(Object(n.h)("dt",{class:"ltr"},this.labels.fileSize),Object(n.h)("dd",null,this.contentLengthString))),t):null}exportDatasetKeyDown(t){["Enter"," "].includes(t.key)&&this.exportDataset()}downloadKeyDown(t){["Enter"," "].includes(t.key)&&this.download()}renderDownloadControl(){return this.shouldUseDownloadButton()?Object(n.h)("calcite-button",{appearance:"outline",color:"blue",disabled:this.shouldDisableDownload(),"icon-position":"start",onClick:this.download,scale:"m",width:"full"},this.labels.buttonDownload):Object(n.h)("calcite-dropdown",{active:!1,placement:"top",scale:"m",type:"click"},Object(n.h)("calcite-button",{appearance:"outline",color:"blue","icon-end":"caretUp",scale:"m",slot:"dropdown-trigger"},this.labels.buttonOptions),Object(n.h)("calcite-dropdown-group",{"selection-mode":"none"},Object(n.h)("calcite-dropdown-item",{hidden:this.exportInProgress(),onClick:this.exportDataset,onKeyDown:this.exportDatasetKeyDown,role:"menuitem","selection-mode":"none",tabindex:"0"},Object(n.h)("span",null,this.labels.menuRequest)),Object(n.h)("calcite-dropdown-item",{onClick:this.download,onKeyDown:this.downloadKeyDown,role:"menuitem","selection-mode":"none",tabindex:"0"},Object(n.h)("span",null,this.intl.t("menuDownload",{createdDate:this.dateTimeFormatter.format(new Date(this.metadata.lastModified))})))))}shouldUseDownloadButton(){return this.downloadUpToDate()||!this.downloadCached()||this.isFormatDownloadDisabled()||!$(this.target,this.username)}shouldDisableDownload(){return this.isFormatDownloadDisabled()||this.exportInProgress()&&!this.downloadCached()}render(){return Object(n.h)(n.b,{"data-element":"download-card"},Object(n.h)("calcite-card",{dir:this.intl.direction},Object(n.h)("h3",{slot:"title"},this.name),Object(n.h)("dl",{slot:"subtitle"},this.renderFileDescription()),Object(n.h)("div",{slot:"footer-leading"},this.renderNotice(),this.renderDownloadControl())))}static get assetsDirs(){return["locales"]}get element(){return Object(n.g)(this)}static get watchers(){return{host:["watchHandler"],datasetId:["watchHandler"],format:["watchHandler"],spatialRefId:["watchHandler"],where:["watchHandler"],geometry:["watchHandler"],target:["watchHandler"],username:["watchHandler"],token:["watchHandler"]}}}
z.style=":host{font-size:1em}calcite-card div{font-size:1em}h3{font-size:1.25em}dl{font-size:inherit}dt,dd,calcite-dropdown-item{font-size:0.875em}dt{float:left;clear:left;margin-right:0.25rem}dt.ltr::after{content:':'}dd.rtl::after{content:':'}dd{margin:0px;padding:0px;margin-left:110px;-webkit-margin-start:0;margin-inline-start:0}a{vertical-align:middle}calcite-icon{margin-left:0.25rem}a:visited{color:inherit}calcite-dropdown{width:100%;--calcite-dropdown-width:100%;position:relative}calcite-dropdown-item span{color:#323232}calcite-button{width:100%}calcite-card div{width:100%}"}}])
